(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    771592,      17371]
NotebookOptionsPosition[    735930,      16865]
NotebookOutlinePosition[    736456,      16884]
CellTagsIndexPosition[    736413,      16881]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Quit", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.8249921571543574`*^9, 3.8249921575722537`*^9}, 
   3.868652410576331*^9},
 CellLabel->
  "In[136]:=",ExpressionUUID->"bd09108c-6d4e-44ca-95b8-51671364dc03"],

Cell[CellGroupData[{

Cell["Introduction", "Title",
 CellChangeTimes->{{3.8241360989002566`*^9, 
  3.8241361021245675`*^9}},ExpressionUUID->"10bf2179-5cd1-4f5f-974b-\
8e58188d73ae"],

Cell[CellGroupData[{

Cell["Step 0: Preliminaries", "Subsection",
 CellChangeTimes->{{3.824136119204876*^9, 3.8241361229975357`*^9}, {
  3.824137078669838*^9, 
  3.824137082410861*^9}},ExpressionUUID->"2bc8e43f-60b8-46c3-9ef0-\
e2cad7283856"],

Cell["\<\
Before beginning, install MaTeX if you haven\[CloseCurlyQuote]t done so \
already (do not run initialization cells if you have to do this!):\
\>", "Text",
 CellChangeTimes->{{3.8013833876667857`*^9, 3.8013834362083683`*^9}, {
  3.801383878355521*^9, 3.801383912810277*^9}, {3.8014940173393373`*^9, 
  3.8014940264523973`*^9}, {3.8014941305788717`*^9, 
  3.8014941696941705`*^9}},ExpressionUUID->"d8409005-28ae-4865-a82d-\
105f787891b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ResourceFunction", "[", "\"\<MaTeXInstall\>\"", "]"}], "[", "]"}],
   ";"}]], "Input",
 CellChangeTimes->{{3.8013833260673394`*^9, 3.801383326071333*^9}, 
   3.801383554198249*^9, 3.8206388819301*^9, 3.820639236761095*^9},
 CellLabel->"In[80]:=",ExpressionUUID->"e2a33282-ece9-49e3-a694-b4b2ad44bd2c"],

Cell["\<\
See http://szhorvat.net/pelican/latex-typesetting-in-mathematica.html for \
more information about this package ().\
\>", "Text",
 CellChangeTimes->{{3.802672593056883*^9, 3.8026726122888937`*^9}, {
   3.803012644649568*^9, 3.8030126554815335`*^9}, {3.803012713277377*^9, 
   3.8030127285084076`*^9}, {3.803012799503366*^9, 3.8030128029253654`*^9}, {
   3.8031247002926483`*^9, 3.803124704772649*^9}, 
   3.8241361780796056`*^9},ExpressionUUID->"46cd8e13-16fd-4914-ae5c-\
c75d436a13d1"],

Cell[TextData[{
 "Now we can use MaTeX to include ",
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{"L", 
     StyleBox[
      AdjustmentBox["A",
       BoxBaselineShift->-0.4,
       BoxMargins->{{-0.5, -0.3}, {0, 0}}],
      FontSize->Smaller], "T", 
     AdjustmentBox["E",
      BoxBaselineShift->0.5,
      BoxMargins->{{-0.3, 0}, {0, 0}}], "X"}],
    SingleLetterItalics->False], TraditionalForm]],ExpressionUUID->
  "e9b22a64-4f85-4bd7-a968-551aa5a8d1f1"],
 " formulas in plots"
}], "Text",
 CellChangeTimes->{{3.824136164065467*^9, 
  3.824136187736906*^9}},ExpressionUUID->"230eba1e-d0d4-41c6-9109-\
6683f22c4ee9"],

Cell[BoxData[{
 RowBox[{"<<", "MaTeX`"}], "\[IndentingNewLine]", 
 RowBox[{"ParallelNeeds", "[", "\"\<MaTeX`\>\"", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8013672793165064`*^9, 3.8013673019918995`*^9}, 
   3.803124605400467*^9, {3.8031256998912735`*^9, 3.803125704738614*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"b877b078-10b5-414a-b6ea-42021d06cc75"],

Cell["\<\
Next, set the working directory to some directory where you have plenty of \
free space\
\>", "Text",
 CellChangeTimes->{{3.8241361961964426`*^9, 
  3.8241362425529385`*^9}},ExpressionUUID->"615da762-8b08-467d-9bb0-\
d0815964ba86"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "@", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.824136248482931*^9, 3.8241362558010263`*^9}, {
  3.8419064467028112`*^9, 3.8419064695845604`*^9}, {3.8419156525161715`*^9, 
  3.8419156875874214`*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"de92765d-2c4d-44bc-b566-f587eccb30b2"],

Cell[TextData[{
 StyleBox["WARNING:",
  FontWeight->"Bold"],
 " The simulations will produce very large files, so you may want to check \
first if you have enough space to save them on disk.\nYou can use ",
 Cell[BoxData[
  FormBox[
   StyleBox["SimulationSize",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "3a32153f-b58b-4ea9-9c5b-fa2da3843c8d"],
 " to estimate the resulting file size, like in the following example:"
}], "Text",
 CellChangeTimes->{{3.824136361880159*^9, 3.8241363744836206`*^9}, {
   3.8241364505289297`*^9, 3.8241364527982793`*^9}, {3.8241365025265656`*^9, 
   3.824136547541003*^9}, {3.8241367987169023`*^9, 3.8241368173093095`*^9}, {
   3.8241369757273474`*^9, 3.8241369815880823`*^9}, {3.824137022052701*^9, 
   3.824137054229932*^9}, 
   3.8241371463433647`*^9},ExpressionUUID->"33287a3a-a6ad-4501-b2c6-\
7f90e266b558"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nX", "=", "201"}], ",", 
     RowBox[{"nY", "=", "201"}], ",", 
     RowBox[{"nZ", "=", "201"}], ",", 
     RowBox[{"numSteps", "=", "30000"}], ",", 
     RowBox[{"checkpointInterval", "=", "500"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SimulationSize", "[", 
     RowBox[{"nX", ",", "nY", ",", "nZ"}], "]"}], "[", 
    RowBox[{"numSteps", ",", "checkpointInterval"}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8241366573429403`*^9, 3.8241366662723293`*^9}, {
   3.824136733529233*^9, 3.8241367467361565`*^9}, {3.8241367916328173`*^9, 
   3.824136868762476*^9}, {3.8241846478452992`*^9, 3.8241846663813105`*^9}, {
   3.8241866956326585`*^9, 3.824186700170211*^9}, {3.8241919458799534`*^9, 
   3.8241919459562073`*^9}, {3.824197154418654*^9, 3.8241971545437064`*^9}, {
   3.8241985557301025`*^9, 3.824198563503995*^9}, {3.8242066067438073`*^9, 
   3.824206616850329*^9}, {3.824207920457471*^9, 3.824207924228305*^9}, {
   3.824221093067155*^9, 3.824221102727722*^9}, {3.824612916314272*^9, 
   3.824612923259103*^9}, {3.841906487218459*^9, 3.841906524845338*^9}, 
   3.8419149580831404`*^9, {3.841916943006325*^9, 3.8419169463112593`*^9}, {
   3.8419919735870323`*^9, 3.841991985303032*^9}, {3.842495440926955*^9, 
   3.8424954466300535`*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"17453dc6-d650-4670-afb3-693b567e0412"],

Cell["\<\
You may want to launch all kernels before continuing, otherwise they shall be \
launched when necessary.\
\>", "Text",
 CellChangeTimes->{{3.803125182758561*^9, 
  3.8031252394292555`*^9}},ExpressionUUID->"c337e044-888a-4402-9111-\
01cdf6e8680b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LaunchKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<There are \>\"", ",", "$KernelCount", ",", 
   "\"\< kernels available!\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.8031252020740633`*^9, 3.803125211783021*^9}, {
  3.8031257265148416`*^9, 3.8031257385637226`*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"394eb3b0-7095-4f21-91b2-1671415cb270"],

Cell[TextData[{
 "Set the ",
 Cell[BoxData[
  FormBox[
   StyleBox["DEVICE",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "4030d8fe-6e91-4052-b1e6-9b22f09c403d"],
 " variable to ",
 Cell[BoxData[
  FormBox["\"\<GPU\>\"", TraditionalForm]],ExpressionUUID->
  "6d1935c5-68a8-41a1-aba1-5c28aa9017b5"],
 " for best performance or to ",
 Cell[BoxData[
  FormBox["\"\<CPU\>\"", TraditionalForm]],ExpressionUUID->
  "807d0d4f-e1e0-42bb-98f0-d63daaea5174"],
 " if you do not have a compatible GPU (you may use ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"DEVICE", "=", 
     RowBox[{"{", 
      RowBox[{"\"\<GPU\>\"", ",", "i"}], "}"}]}], ";"}], TraditionalForm]],
  ExpressionUUID->"0274f2ae-1e2f-43cf-b0d3-fba74e0357db"],
 " to choose a specific GPU if your system has more than one available):"
}], "Text",
 CellChangeTimes->{{3.801494341669832*^9, 3.8014944089418726`*^9}, {
   3.801494471169379*^9, 3.8014944932349863`*^9}, {3.802752234697291*^9, 
   3.8027523199653482`*^9}, {3.8031248520544004`*^9, 3.803124853140399*^9}, 
   3.8031251773661613`*^9, {3.8143678323674507`*^9, 
   3.8143678323674507`*^9}},ExpressionUUID->"875099d6-384c-4e9a-98b0-\
3f3e423935ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DEVICE", "=", "\"\<GPU\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8014939904647436`*^9, 3.801493991350872*^9}, {
   3.8014943460128345`*^9, 3.801494348691834*^9}, 3.802685552382524*^9, {
   3.8027522304463253`*^9, 3.802752233178294*^9}, {3.80767975377962*^9, 
   3.807679754124408*^9}, 3.807680090608426*^9, {3.8241369615260363`*^9, 
   3.824136961887247*^9}, 3.861785852557782*^9, 3.861804300925828*^9, 
   3.863354782511211*^9, 3.863600662275395*^9},
 CellLabel->
  "In[121]:=",ExpressionUUID->"eda00656-0c61-4c5d-b16b-5a04ad7dce81"],

Cell[TextData[{
 "Set the ",
 Cell[BoxData[
  FormBox[
   StyleBox["EXECUTIONSTEPS",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "21859dbb-3bce-4c0d-b22b-baeac6512756"],
 " variable to define how many steps are run per execution on the GPU (you \
may set it to 1 for CPU execution)"
}], "Text",
 CellChangeTimes->{{3.8240285694935303`*^9, 3.8240286106770134`*^9}, {
  3.824029349580325*^9, 
  3.824029368435068*^9}},ExpressionUUID->"0495c2ad-c806-4aa7-a92d-\
1b74e2b3ba9a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EXECUTIONSTEPS", "=", "10"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8240286121782537`*^9, 3.8240286158385315`*^9}, 
   3.8241369434675407`*^9, {3.8243096759648843`*^9, 3.824309676677637*^9}, {
   3.8419067505015535`*^9, 3.8419067685383945`*^9}, {3.8419068492618504`*^9, 
   3.8419068497192373`*^9}, {3.84190696764285*^9, 3.8419069678590465`*^9}, {
   3.8419070317684884`*^9, 3.8419070356812873`*^9}, 3.8419947279622746`*^9, {
   3.841995509458023*^9, 3.8419955095484076`*^9}, {3.841995738943164*^9, 
   3.841995739808267*^9}, 3.8419960103839264`*^9, 3.8419969566396465`*^9, {
   3.876472366820629*^9, 3.8764723669933424`*^9}, 3.8764727300028944`*^9, 
   3.8764778391126156`*^9, 3.876479424256854*^9, 3.876495286971481*^9, 
   3.876497968808692*^9, 3.8764998057178793`*^9},
 CellLabel->"In[4]:=",ExpressionUUID->"d69fbf29-3c84-4ec4-8504-d026c408d1c8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Step 1: Obtain a static vortex solution", "Subsection",
 CellChangeTimes->{{3.8241370663617344`*^9, 
  3.8241370839753036`*^9}},ExpressionUUID->"eb2294c5-bc49-4220-8b23-\
f16185eb55b7"],

Cell[TextData[{
 "You can use the function ",
 Cell[BoxData[
  FormBox[
   StyleBox["RadialState",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "e02d873e-cfef-4352-924e-eabf2bee796e"],
 " to get a static vortex solution. This function takes the following \
arguments:\n",
 StyleBox["\t- ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox["lR", TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"4eb43e63-44c3-44f3-86d7-d42f66ea2e71"],
 StyleBox[":",
  FontWeight->"Bold"],
 " the radial length, so that ",
 Cell[BoxData[
  FormBox[
   RowBox[{"r", "\[Element]", 
    RowBox[{"[", 
     RowBox[{"0", ",", "lR"}], "]"}]}], TraditionalForm]],ExpressionUUID->
  "52189a4b-3d36-494e-9b9a-69a6c4f3f578"],
 "\n",
 StyleBox["\t- ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox["nR", TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"bfbeb1d8-fafa-4707-b7c8-f5478cf0bf7f"],
 StyleBox[":",
  FontWeight->"Bold"],
 " the number of points in the discretization of the ",
 Cell[BoxData[
  FormBox["r", TraditionalForm]],ExpressionUUID->
  "2168ea6f-266b-476d-a5e3-eaef85ede6e4"],
 " coordinate\n",
 StyleBox["\t- ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox["\[Epsilon]", TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"7ca8c84a-7abb-4115-9f5d-742eb2dbeab5"],
 StyleBox[":",
  FontWeight->"Bold"],
 " a small shift of the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"r", "=", "0"}], TraditionalForm]],ExpressionUUID->
  "e73a6b44-4de0-4bd7-8819-3c076b026c6f"],
 " point to avoid division-by-zero errors\n\t",
 StyleBox["\t- ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   RowBox[{"v", ",", "\[Lambda]", ",", " ", "q", ",", " ", "\[Omega]"}], 
   TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"a016f756-5563-40a6-bfa2-92027dcc35bf"],
 StyleBox[":",
  FontWeight->"Bold"],
 " the physical parameters"
}], "Text",
 CellChangeTimes->{{3.8241370956406293`*^9, 3.824137098703806*^9}, {
  3.824137136865041*^9, 3.824137136865041*^9}, {3.824137169586314*^9, 
  3.824137183076543*^9}},ExpressionUUID->"bd70798e-d46a-4b4f-9fbe-\
fbfa7b05fbbc"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "TIRA", " ", "ESTE", " ", "BLOCK", " ", "DE", " ", "ABAJO", " ", 
   "PRIMERO"}], "*)"}]], "Input",
 CellChangeTimes->{{3.8652702998210807`*^9, 
  3.8652703110666523`*^9}},ExpressionUUID->"9f9b0f91-60cf-4fe5-baa1-\
b1054723d0af"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"lR", "=", 
      RowBox[{
       SqrtBox["2"], "220."}]}], ",", 
     RowBox[{"nR", "=", "12001"}], ",", 
     RowBox[{"\[Epsilon]", "=", 
      SuperscriptBox["10.", 
       RowBox[{"-", "5"}]]}], ",", 
     RowBox[{"v", "=", "5."}], ",", 
     RowBox[{"\[Lambda]", "=", ".25"}], ",", 
     RowBox[{"q", "=", 
      RowBox[{".3", "/", 
       SqrtBox["2"]}]}], ",", 
     RowBox[{"\[Omega]", "=", ".25"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Type1Vortex", "=", 
     RowBox[{
      RowBox[{"RadialState", "[", 
       RowBox[{"lR", ",", "nR", ",", "\[Epsilon]"}], "]"}], "[", 
      RowBox[{"v", ",", "\[Lambda]", ",", "q", ",", "\[Omega]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Vortex size = \>\"", ",", 
      RowBox[{"VortexSize", "@", "Type1Vortex"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.802672872832638*^9, 3.8026728734726286`*^9}, {
   3.802672918576615*^9, 3.802672919247876*^9}, {3.802678621090788*^9, 
   3.8026786405599294`*^9}, {3.805110817099432*^9, 3.8051108180903587`*^9}, {
   3.8051109064698086`*^9, 3.8051109351112347`*^9}, {3.8051109882018027`*^9, 
   3.8051109945821733`*^9}, {3.805111250876132*^9, 3.8051112519711075`*^9}, 
   3.8051113557556353`*^9, {3.8051113901331716`*^9, 3.80511139170546*^9}, {
   3.805111790533729*^9, 3.8051117915672708`*^9}, {3.805112116488392*^9, 
   3.805112116966158*^9}, {3.8051121668388977`*^9, 3.8051123189446683`*^9}, {
   3.805112385975032*^9, 3.80511242341959*^9}, {3.8051126023736825`*^9, 
   3.8051126058235245`*^9}, {3.807268005319886*^9, 3.807268072607915*^9}, {
   3.807268148832471*^9, 3.807268176756612*^9}, {3.807269443266103*^9, 
   3.80726944347608*^9}, {3.8073576284324255`*^9, 3.8073576288858223`*^9}, {
   3.807357693424838*^9, 3.8073577208423834`*^9}, {3.807357847066104*^9, 
   3.8073578481456585`*^9}, {3.8073579144404044`*^9, 
   3.8073580255665755`*^9}, {3.807358159507349*^9, 3.8073581602136364`*^9}, {
   3.8073621800657682`*^9, 3.807362192961951*^9}, {3.80744159526418*^9, 
   3.8074415954385743`*^9}, {3.807961470327861*^9, 3.8079615125832624`*^9}, {
   3.8079629828503475`*^9, 3.8079629841675863`*^9}, {3.8079630150620613`*^9, 
   3.80796304158582*^9}, {3.8079642342373405`*^9, 3.807964244716535*^9}, {
   3.808203293976232*^9, 3.808203294166235*^9}, {3.8093350462817383`*^9, 
   3.809335068710408*^9}, {3.809419325887742*^9, 3.8094193568624015`*^9}, 
   3.809426088902064*^9, {3.8133145487096634`*^9, 3.813314561739905*^9}, {
   3.813314610604224*^9, 3.8133146144142575`*^9}, {3.8134106848871255`*^9, 
   3.8134107064311237`*^9}, {3.824183541607894*^9, 3.8241835443088913`*^9}, 
   3.8636006693896303`*^9, {3.863628939112122*^9, 3.8636289419287567`*^9}, 
   3.8649232816376176`*^9, {3.8681994648886952`*^9, 3.8681994649659944`*^9}, 
   3.87199765446086*^9},
 CellLabel->
  "In[105]:=",ExpressionUUID->"63bf18d6-b566-40ff-9cde-58432a260da8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"lR", "=", 
      RowBox[{
       SqrtBox["2"], "200."}]}], ",", 
     RowBox[{"nR", "=", "12001"}], ",", 
     RowBox[{"\[Epsilon]", "=", 
      SuperscriptBox["10.", 
       RowBox[{"-", "5"}]]}], ",", 
     RowBox[{"v", "=", "5."}], ",", 
     RowBox[{"\[Lambda]", "=", ".25"}], ",", 
     RowBox[{"q", "=", "0.21213203435596423`"}], ",", 
     RowBox[{"\[Omega]", "=", "0.25"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Type2Vortex", "=", 
     RowBox[{
      RowBox[{"RadialState", "[", 
       RowBox[{"lR", ",", "nR", ",", "\[Epsilon]"}], "]"}], "[", 
      RowBox[{"v", ",", "\[Lambda]", ",", "q", ",", "\[Omega]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Vortex size = \>\"", ",", 
      RowBox[{"VortexSize", "@", "Type2Vortex"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.802672872832638*^9, 3.8026728734726286`*^9}, {
   3.802672918576615*^9, 3.802672919247876*^9}, {3.802678621090788*^9, 
   3.8026786405599294`*^9}, {3.805110817099432*^9, 3.8051108180903587`*^9}, {
   3.8051109064698086`*^9, 3.8051109351112347`*^9}, {3.8051109882018027`*^9, 
   3.8051109945821733`*^9}, {3.805111250876132*^9, 3.8051112519711075`*^9}, 
   3.8051113557556353`*^9, {3.8051113901331716`*^9, 3.80511139170546*^9}, {
   3.805111790533729*^9, 3.8051117915672708`*^9}, {3.805112116488392*^9, 
   3.805112116966158*^9}, {3.8051121668388977`*^9, 3.8051123189446683`*^9}, {
   3.805112385975032*^9, 3.80511242341959*^9}, {3.8051126023736825`*^9, 
   3.8051126058235245`*^9}, {3.807268005319886*^9, 3.807268072607915*^9}, {
   3.807268148832471*^9, 3.807268176756612*^9}, {3.807269443266103*^9, 
   3.80726944347608*^9}, {3.8073576284324255`*^9, 3.8073576288858223`*^9}, {
   3.807357693424838*^9, 3.8073577208423834`*^9}, {3.807357847066104*^9, 
   3.8073578481456585`*^9}, {3.8073579144404044`*^9, 
   3.8073580255665755`*^9}, {3.807358159507349*^9, 3.8073581602136364`*^9}, {
   3.8073621800657682`*^9, 3.807362192961951*^9}, {3.80744159526418*^9, 
   3.8074415954385743`*^9}, {3.807961470327861*^9, 3.8079615125832624`*^9}, {
   3.8079629828503475`*^9, 3.8079629841675863`*^9}, {3.8079630150620613`*^9, 
   3.80796304158582*^9}, {3.8079642342373405`*^9, 3.807964244716535*^9}, {
   3.808203293976232*^9, 3.808203294166235*^9}, {3.8093350462817383`*^9, 
   3.809335068710408*^9}, {3.809419325887742*^9, 3.8094193568624015`*^9}, 
   3.809426088902064*^9, {3.8133145487096634`*^9, 3.813314561739905*^9}, {
   3.813314610604224*^9, 3.8133146144142575`*^9}, {3.8241835468306265`*^9, 
   3.8241835594958363`*^9}, {3.8763800170859566`*^9, 3.876380022133437*^9}, {
   3.878658933433404*^9, 3.878658944475368*^9}, {3.8787194118500986`*^9, 
   3.878719412049082*^9}, {3.8787983465457478`*^9, 3.8787983517839365`*^9}, {
   3.878826644758234*^9, 3.878826674846136*^9}, {3.8788873520119867`*^9, 
   3.8788873782323008`*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"f0358cee-1759-4856-a079-f4b305167937"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Created static (radial) vortex in \"\>", "\[InvisibleSpace]", 
   "10.68`", "\[InvisibleSpace]", "\<\" seconds: lR = \"\>", 
   "\[InvisibleSpace]", "282.842712474619`", 
   "\[InvisibleSpace]", "\<\"; nR = \"\>", "\[InvisibleSpace]", "12001", 
   "\[InvisibleSpace]", "\<\"; |\[Chi](0)| = \"\>", "\[InvisibleSpace]", 
   "4.797072393462404`", 
   "\[InvisibleSpace]", "\<\"; {r\[Phi],r\[Chi],rA} = \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.7996869752842821`", ",", "2.330543632389831`", ",", 
     "1.342315450109104`"}], "}"}]}],
  SequenceForm[
  "Created static (radial) vortex in ", 10.68, " seconds: lR = ", 
   282.842712474619, "; nR = ", 12001, "; |\[Chi](0)| = ", 4.797072393462404, 
   "; {r\[Phi],r\[Chi],rA} = ", {0.7996869752842821, 2.330543632389831, 
   1.342315450109104}],
  Editable->False]], "Print",
 CellChangeTimes->{3.880295033455296*^9, 3.88035803642637*^9, 
  3.880442380406147*^9, 3.880528365825941*^9, 3.8806164204493675`*^9, 
  3.8844438628812923`*^9},
 CellLabel->
  "During evaluation of \
In[122]:=",ExpressionUUID->"9af924b4-f1a1-4291-85f2-a055e58064ad"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Vortex size = \"\>", "\[InvisibleSpace]", 
   "2.330543632389831`"}],
  SequenceForm["Vortex size = ", 2.330543632389831],
  Editable->False]], "Print",
 CellChangeTimes->{3.880295033455296*^9, 3.88035803642637*^9, 
  3.880442380406147*^9, 3.880528365825941*^9, 3.8806164204493675`*^9, 
  3.8844438631323414`*^9},
 CellLabel->
  "During evaluation of \
In[122]:=",ExpressionUUID->"bd1fd804-b469-486d-927b-6615207572f9"]
}, Open  ]]
}, Open  ]],

Cell[TextData[{
 StyleBox["Note:",
  FontWeight->"Bold"],
 " the result of the ",
 Cell[BoxData[
  FormBox["RadialState", TraditionalForm]],ExpressionUUID->
  "6e09a756-52dd-49b9-967e-0ac9578dfb1f"],
 " function is an Association with the following keys"
}], "Text",
 CellChangeTimes->{{3.8241848186672554`*^9, 3.8241848440593295`*^9}, {
  3.8241849118626876`*^9, 
  3.8241849152334013`*^9}},ExpressionUUID->"7a4e02b2-3edb-4d3c-a1e0-\
10863a6584c0"],

Cell[BoxData[
 RowBox[{"Keys", "@", "Type1Vortex"}]], "Input",
 CellChangeTimes->{{3.8241848463024664`*^9, 3.8241848509588413`*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"cac3a15a-f526-4aeb-b5c8-c9859f4daeba"],

Cell["You may access the corresponding values like so", "Text",
 CellChangeTimes->{{3.8241848602445774`*^9, 
  3.824184876844346*^9}},ExpressionUUID->"1944f320-0692-4a6b-a89b-\
42fa78c799b9"],

Cell[BoxData[
 RowBox[{"Type1Vortex", "@", "\"\<\[Phi]\>\""}]], "Input",
 CellChangeTimes->{{3.824184881438379*^9, 3.8241848885163374`*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"34d3994e-df0b-4c02-b89d-741ed0cd18cd"],

Cell[CellGroupData[{

Cell["Step 2: Prepare the initial state", "Subsubsection",
 CellChangeTimes->{{3.8008813003034096`*^9, 3.800881301695409*^9}, {
   3.8008813571684084`*^9, 3.80088137838241*^9}, 
   3.8043986124939575`*^9},ExpressionUUID->"a99d3d92-9d18-456c-9ba4-\
5a5c48c0288d"],

Cell[TextData[{
 "To prepare the initial state (which is used as a seed for time-evolution in \
the next step) you need to use the ",
 Cell[BoxData[
  FormBox[
   StyleBox["BiStringSeed",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "ba7b60f7-7a38-4d97-a6c1-137c12b169eb"],
 " function, which takes the following arguments:\n",
 StyleBox["\t- ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox["lX", TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"20ea92fe-a03f-4916-9275-cef85b95ac6c"],
 StyleBox[": ",
  FontWeight->"Bold"],
 "the spatial width, so that ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "\[Element]", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["lX", "2"]}], ",", 
      FractionBox["lX", "2"]}], "]"}]}], TraditionalForm]],ExpressionUUID->
  "2a4da1c8-c461-4c48-a0d6-97a9eb2173d0"],
 "\n",
 StyleBox["\t- ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox["nX", TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"baa6263c-4a12-4788-b346-ffebddc3b1ae"],
 StyleBox[":",
  FontWeight->"Bold"],
 " the number of points in the discretization of the ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "121f182c-7d00-4129-b62f-a61d38504457"],
 " coordinate\n",
 StyleBox["\t- ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox["lY", TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"ede13fe5-188f-4a51-82fc-738d42f58c32"],
 StyleBox[":",
  FontWeight->"Bold"],
 " the spatial height, so that ",
 Cell[BoxData[
  FormBox[
   RowBox[{"y", "\[Element]", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["lY", "2"]}], ",", 
      FractionBox["lY", "2"]}], "]"}]}], TraditionalForm]],ExpressionUUID->
  "5abb3814-edb8-4a8f-8208-330fb532b502"],
 "\n",
 StyleBox["\t- ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox["nY", TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"ba9930e6-daaf-4b17-9064-5277f5e0b2b9"],
 StyleBox[":",
  FontWeight->"Bold"],
 " the number of points in the discretization of the ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]],ExpressionUUID->
  "e6b85df4-bdc4-4b9f-93d2-ed731e7a4aae"],
 " coordinate\n\t",
 StyleBox["- lZ:",
  FontWeight->"Bold"],
 " the spatial height, so that ",
 Cell[BoxData[
  FormBox[
   RowBox[{"z", "\[Element]", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["lZ", "2"]}], ",", 
      FractionBox["lZ", "2"]}], "]"}]}], TraditionalForm]],ExpressionUUID->
  "93c0f019-b63a-433f-bee9-6ec3782615b7"],
 "\n",
 StyleBox["\t- ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox["nZ", TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"3b2b9402-f2fc-42d4-8cc4-92064e1e7700"],
 StyleBox[":",
  FontWeight->"Bold"],
 " the number of points in the discretization of the ",
 Cell[BoxData[
  FormBox["z", TraditionalForm]],ExpressionUUID->
  "ccaff915-1da6-4230-985e-f0b259f303c8"],
 " coordinate\n",
 StyleBox["\t- ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   RowBox[{"a", ",", "\[Beta]"}], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"1adafe01-474d-44cf-bece-0809c6a438fe"],
 StyleBox[":",
  FontWeight->"Bold"],
 " the parameters controlling the collision (strings will be separated by ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]x", "=", 
    RowBox[{"2", "a"}]}], TraditionalForm]],ExpressionUUID->
  "9d4aa48b-52da-4761-89b1-22a411eb2816"],
 " and have velocity ",
 Cell[BoxData[
  FormBox["\[Beta]", TraditionalForm]],ExpressionUUID->
  "85c23f3a-f427-437f-a61e-5ee135f0f501"],
 ")\n",
 StyleBox["\t- \[Alpha]1, \[Alpha]2: ",
  FontWeight->"Bold"],
 "the rotation angles for the \[Chi] fields of the left and right strings, \
respectively.\n",
 StyleBox["\t- v1, v2: ",
  FontWeight->"Bold"],
 "flags indicating whether to use the vortex (",
 Cell[BoxData[
  FormBox[
   RowBox[{"v", "=", "1"}], TraditionalForm]],ExpressionUUID->
  "6f1e17f6-6d8c-4abd-9fbb-bc6323da21cb"],
 ") or anti-vortex (",
 Cell[BoxData[
  FormBox[
   RowBox[{"v", "=", 
    RowBox[{"-", "1"}]}], TraditionalForm]],ExpressionUUID->
  "55663fe5-f2a6-4ad3-a9bc-9282534e2396"],
 ") solutions for the left and right strings, respectively\n\t",
 StyleBox["\t- ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   StyleBox["\[Theta]1",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "84fac0d3-79c0-4334-a1c1-2e5ed234c901"],
 StyleBox[", ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   StyleBox["\[Theta]2",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "b49a4483-4d5d-4751-a22c-b0d72bdfda7d"],
 StyleBox[": ",
  FontWeight->"Bold"],
 "the rotation angles for the strings around the ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "af99ac98-c5a7-4533-b320-be7359a5f218"],
 " (collision) axis\n\t",
 StyleBox["- ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox["state", TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"7c0935a9-cf6a-4aab-8cec-7b9f0db8f078"],
 StyleBox[":",
  FontWeight->"Bold"],
 " the static vortex state, as returned by the ",
 Cell[BoxData[
  FormBox["RadialState", TraditionalForm]],ExpressionUUID->
  "349da35d-1f57-4211-b6d8-83f8156785ea"],
 " function of the previous step\n\n",
 StyleBox["Notes:\n",
  FontWeight->"Bold"],
 "\t- The parameters ",
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{"lX", ",", "lY", ",", "lZ"}],
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "b4770355-4b1b-49c5-8b82-af1df2c351d7"],
 " and ",
 StyleBox["a",
  FontWeight->"Bold"],
 " are absolute lengths, so you may want to use ",
 Cell[BoxData[
  FormBox[
   StyleBox["VortexSize",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "34377cc4-790a-4005-a769-648fc63b7e7c"],
 " for proper scaling.\n\t- You may omit ",
 Cell[BoxData[
  FormBox[
   StyleBox["v1",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "43dcfb6c-6fa8-4868-ab4f-16a20caba4ba"],
 " and ",
 Cell[BoxData[
  FormBox[
   StyleBox["v2",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "906c2f3a-97cf-4b06-ad85-631c4644e851"],
 " to use vortex solutions in both cases.\n\nFor example, to get an initial \
configuration with orthogonal ",
 Cell[BoxData[
  FormBox["\[Chi]", TraditionalForm]],ExpressionUUID->
  "98c2cce9-7992-48a5-9def-41180324f33e"],
 "\[CloseCurlyQuote]s and orthogonal colliding strings, you may run (see the \
\[OpenCurlyDoubleQuote]Main code/Visualization functions\
\[CloseCurlyDoubleQuote] section for a description of the plotting \
functionality):"
}], "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQ/VZaQnZ24BtHt/8H1UB0ZYezNoi+c3ibLog2P99j
DKIjrlaagmjb8N22IPrZDnkvEM0kfScdRF+T2ZwLog+mHTGeA6RP+r8xAdHP
31xUnwukYxIrtUG00P9NT7uD3jheebnqK4jeaLLz9zQgLeGu8QdEz+EIObcV
SK/vLgDTpwW4rVnD3jiu7j4dCKKl7U82B0S8cWzoFG4B0Yoh7CJycW8c22N+
iIJou7UcD7sT3zhOS1jwHkRPeRQkvxlIL3F9AKZPKB9zBNGzGea4gmi1O7s8
QfSnEx+8wPzk934guu5pWSCI3sAyIRNEe4hPBNMHtly6y1P3xnFGncFbEM3x
xqGfF0j7leTMANG7/jFtAtEfjp0C0+seOLwD0QXhrR9B9Pucq4vEgfTn57OW
gWiJ4v9mG16+cXRVtTUH0QA2P80E
  "],ExpressionUUID->"6a3402e4-958f-499b-8181-f684751ea0d0"],

Cell[BoxData[
 RowBox[{"Lx", "=", 
  RowBox[{"First", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"120", ",", "120", ",", "120", ",", "3"}], "}"}], 
    RowBox[{"VortexSize", "@", "Type1Vortex"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.863600718216257*^9, {3.8652704856725836`*^9, 3.8652704930289764`*^9}, {
   3.8652903913084555`*^9, 3.865290391602461*^9}, {3.868199507144002*^9, 
   3.8681995168340473`*^9}, {3.868199555131838*^9, 3.86819955993316*^9}, 
   3.868609561096312*^9, 
   3.8686977503699813`*^9},ExpressionUUID->"3c323a71-1a58-4a02-a003-\
6e4ed214584c"],

Cell[BoxData[
 RowBox[{"delta", "=", 
  RowBox[{"Last", "@", 
   RowBox[{
    RowBox[{"Grid3D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"116.55848162941078`", ",", "101"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"116.55848162941078`", ",", "101"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"116.55848162941078`", ",", "101"}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8652704784253197`*^9, 3.8652704797201962`*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"ecf072b6-ca4e-458b-8c29-0c4b8daa4b45"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "TIRA", " ", "ESTE", " ", "BLOCK", " ", "DE", " ", "ABAJO", " ", "SEGUNDO", 
   " ", "CON", " ", "LOS", " ", "PARAMETROS", " ", "QUE", " ", "QUIERAS"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.8652703276421785`*^9, 
  3.865270338019946*^9}},ExpressionUUID->"f19cfe20-c5c1-4dbb-82b2-\
0efca1bef64e"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"lX", ",", 
     RowBox[{"nX", "=", "351"}], ",", "lY", ",", 
     RowBox[{"nY", "=", "351"}], ",", "lZ", ",", 
     RowBox[{"nZ", "=", "351"}], ",", 
     RowBox[{"state", "=", "Type1Vortex"}], ",", "a", ",", 
     RowBox[{"\[Beta]", "=", "0.6"}], ",", 
     RowBox[{"v1", "=", "1"}], ",", 
     RowBox[{"\[Alpha]1", "=", "0."}], ",", 
     RowBox[{"\[Theta]1", "=", "0."}], ",", 
     RowBox[{"v2", "=", "1"}], ",", 
     RowBox[{"\[Alpha]2", "=", "0."}], ",", 
     RowBox[{"\[Theta]2", "=", "0."}], ",", 
     RowBox[{"\[Nu]", "=", "0."}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lX", ",", "lY", ",", "lZ", ",", "a"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"120", ",", "120", ",", "120", ",", "3"}], "}"}], 
      RowBox[{"VortexSize", "@", "state"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"sampleSeed1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BiStringSeed", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "\[Alpha]1", ",", 
          RowBox[{"\[Pi]", "/", "2."}], ",", "\[Nu]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "\[Alpha]2", ",", 
          RowBox[{"\[Pi]", "/", "2."}], ",", "\[Nu]"}], "}"}], ",", "a", ",", 
        "\[Beta]", ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}]}], "]"}], "@", 
      "state"}]}], ";"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Phi]\[Chi]Plot", "[", 
     RowBox[{".75", ",", "False", ",", "True"}], "]"}], "@", "sampleSeed"}], 
   "*)"}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8008655175234547`*^9, 3.800865572441064*^9}, {
   3.800865655532649*^9, 3.800865664939019*^9}, {3.8008659126390123`*^9, 
   3.800865913900205*^9}, {3.800866180026248*^9, 3.8008661965193157`*^9}, {
   3.8008666616079464`*^9, 3.8008666619599876`*^9}, {3.800866702477378*^9, 
   3.800866725882569*^9}, {3.8008669928542557`*^9, 3.8008669946932564`*^9}, {
   3.800871890116412*^9, 3.8008719064843993`*^9}, {3.8008817692973204`*^9, 
   3.8008817867823486`*^9}, {3.800885598627492*^9, 3.800885628927495*^9}, {
   3.800885661093522*^9, 3.8008856663045225`*^9}, {3.8008859903423786`*^9, 
   3.8008859971363797`*^9}, {3.800886077186352*^9, 3.8008860784143486`*^9}, {
   3.8008862149615173`*^9, 3.8008862264630585`*^9}, {3.801374601635149*^9, 
   3.8013746104866834`*^9}, {3.8013746552042212`*^9, 3.801374655250216*^9}, {
   3.801374723585723*^9, 3.8013747368168364`*^9}, {3.8013759804885597`*^9, 
   3.8013759859298277`*^9}, {3.8013760225995626`*^9, 
   3.8013760482444105`*^9}, {3.8014551122863717`*^9, 3.801455113964009*^9}, {
   3.80145522148755*^9, 3.801455224260547*^9}, {3.801455454684285*^9, 
   3.8014554560818157`*^9}, {3.8014578669779243`*^9, 3.801457869986229*^9}, {
   3.801461650966761*^9, 3.8014616533797665`*^9}, 3.8020023787728558`*^9, 
   3.8020040351479917`*^9, {3.8027521942173414`*^9, 3.802752195456332*^9}, 
   3.804224177291499*^9, {3.804398721343706*^9, 3.80439872283424*^9}, {
   3.8073380130941696`*^9, 3.807338013300682*^9}, {3.809177239744445*^9, 
   3.8091772612784185`*^9}, {3.8092381709472494`*^9, 3.809238174449216*^9}, {
   3.8092383956506824`*^9, 3.809238407328707*^9}, {3.8092384453792825`*^9, 
   3.8092384546432247`*^9}, {3.80931912183934*^9, 3.8093191602498507`*^9}, {
   3.809319193193473*^9, 3.8093191936535845`*^9}, {3.80931951881666*^9, 
   3.809319523819171*^9}, {3.8206398062301455`*^9, 3.8206398074394927`*^9}, {
   3.820639869225546*^9, 3.820639870293442*^9}, {3.8239291802728786`*^9, 
   3.8239291803822155`*^9}, {3.8241831648149033`*^9, 3.824183175809044*^9}, {
   3.8241834414068575`*^9, 3.82418345273517*^9}, {3.824183597709011*^9, 
   3.824183645573535*^9}, {3.8241839855419664`*^9, 3.8241840529478545`*^9}, {
   3.824184167488969*^9, 3.824184182364702*^9}, {3.824184301263216*^9, 
   3.82418430479608*^9}, {3.8241844969721727`*^9, 3.8241844977567787`*^9}, {
   3.8241845322263722`*^9, 3.8241845359960938`*^9}, {3.824184575504114*^9, 
   3.824184579622549*^9}, {3.8241852377228055`*^9, 3.824185239209339*^9}, {
   3.824185282567751*^9, 3.824185283561133*^9}, {3.8241854932111673`*^9, 
   3.8241854953488283`*^9}, {3.824198492256491*^9, 3.8241984972746563`*^9}, {
   3.824203272150124*^9, 3.8242032934353576`*^9}, {3.8242064952047157`*^9, 
   3.824206499301737*^9}, {3.824230765612233*^9, 3.8242307657535734`*^9}, {
   3.8242313205108147`*^9, 3.8242313264191475`*^9}, {3.8242719659124117`*^9, 
   3.824271967209079*^9}, 3.824309689093691*^9, {3.8245790653806295`*^9, 
   3.8245790784780617`*^9}, {3.8246129031660366`*^9, 
   3.8246129032441435`*^9}, {3.824809627221728*^9, 3.8248096296945286`*^9}, {
   3.8248096634328623`*^9, 3.8248096669993896`*^9}, {3.8248814708753505`*^9, 
   3.824881502470664*^9}, {3.824881633405266*^9, 3.8248816355836897`*^9}, {
   3.8248817803864727`*^9, 3.8248817846507435`*^9}, {3.824988651635195*^9, 
   3.8249886535108824`*^9}, {3.830327896293076*^9, 3.8303279569286757`*^9}, {
   3.841907060552729*^9, 3.841907063354601*^9}, {3.841907100617566*^9, 
   3.841907118940539*^9}, {3.8419117071045375`*^9, 3.8419117286622696`*^9}, {
   3.841913080722766*^9, 3.8419130851484976`*^9}, {3.8419140237742643`*^9, 
   3.8419140257458344`*^9}, {3.8419141038850255`*^9, 3.841914108548415*^9}, {
   3.841915093242436*^9, 3.8419150985343313`*^9}, {3.84191572349866*^9, 
   3.841915734768656*^9}, {3.841990974601243*^9, 3.841990980185709*^9}, {
   3.841991366621995*^9, 3.8419913711286335`*^9}, {3.8419914376235685`*^9, 
   3.8419914628890996`*^9}, {3.841991741339259*^9, 3.841991746657942*^9}, {
   3.8419934585733423`*^9, 3.841993464194959*^9}, {3.8424246582567806`*^9, 
   3.8424246615829077`*^9}, {3.8424253898095536`*^9, 3.842425392639343*^9}, {
   3.8424256265969286`*^9, 3.84242563149798*^9}, {3.8611813251147795`*^9, 
   3.8611813273219304`*^9}, {3.861349973003378*^9, 3.861349991856573*^9}, {
   3.861785888556021*^9, 3.861785892511984*^9}, {3.8626093023615637`*^9, 
   3.8626093630818377`*^9}, {3.863600706237185*^9, 3.8636007106528406`*^9}, {
   3.8636288772808027`*^9, 3.863628888902158*^9}, 3.863629009883037*^9, 
   3.8648232908492746`*^9, 3.8648233700485153`*^9, {3.8648234090187263`*^9, 
   3.864823415899214*^9}, {3.864823453492628*^9, 3.8648234588683667`*^9}, 
   3.864824346014887*^9, {3.864923303397685*^9, 3.8649233087935886`*^9}, 
   3.8650170503052416`*^9, {3.8652500845216*^9, 3.865250088617935*^9}, {
   3.8652502295699224`*^9, 3.8652502304142876`*^9}, {3.865250337213297*^9, 
   3.8652503449444885`*^9}, {3.865250404009781*^9, 3.865250408000204*^9}, 
   3.8652703880419006`*^9, {3.865335072484088*^9, 3.865335072688635*^9}, {
   3.8681994964573126`*^9, 3.8681994993215165`*^9}, {3.868199565713134*^9, 
   3.8681995838724737`*^9}, {3.8685321025323257`*^9, 3.868532102896674*^9}, {
   3.8693038320138855`*^9, 3.869303842214114*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"7af1ef31-72e2-45a0-800d-5118c9e3daab"],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\<F:\\\\Vortex_simulations\\\\seeds_of_list\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.8630331580986423`*^9, 3.863033176693841*^9}, 
   3.8648232586967525`*^9, 3.8693039027161865`*^9, {3.869495638491722*^9, 
   3.869495640881545*^9}},ExpressionUUID->"258a0d9a-7d98-41d5-abc4-\
1063cf350a99"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sampleSeed", "=", 
   RowBox[{"ExportSeed", "[", 
    RowBox[{
    "\"\<seed351_v6lX279alphazerobetazero.h5\>\"", ",", "sampleSeed1"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.86303317939439*^9, 3.863033190663025*^9}, {
   3.864823262090534*^9, 3.86482330218396*^9}, {3.8648233533736577`*^9, 
   3.8648233757705355`*^9}, 3.8648234678044195`*^9, 3.8648243520774927`*^9, {
   3.8649233221663713`*^9, 3.8649233269743414`*^9}, 3.8650170682730193`*^9, {
   3.865250451768701*^9, 3.86525045481061*^9}, 3.865270420564779*^9, {
   3.868279666201437*^9, 3.868279675696154*^9}, {3.868532137570547*^9, 
   3.8685321441777067`*^9}, {3.8693039121783743`*^9, 
   3.8693039165867505`*^9}},ExpressionUUID->"d0d579ba-9165-4291-a108-\
8f2830c7a3e8"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"lX", ",", 
     RowBox[{"nX", "=", "101"}], ",", "lY", ",", 
     RowBox[{"nY", "=", "101"}], ",", "lZ", ",", 
     RowBox[{"nZ", "=", "101"}], ",", 
     RowBox[{"state", "=", "Type1Vortex"}], ",", "a", ",", 
     RowBox[{"\[Beta]", "=", "0.9"}], ",", 
     RowBox[{"v1", "=", "1"}], ",", 
     RowBox[{"\[Alpha]1", "=", "0."}], ",", 
     RowBox[{"\[Theta]1", "=", "0."}], ",", 
     RowBox[{"v2", "=", "1"}], ",", 
     RowBox[{"\[Alpha]2", "=", 
      RowBox[{"N", "@", "\[Pi]"}]}], ",", 
     RowBox[{"\[Theta]2", "=", 
      RowBox[{"\[Pi]", "/", "2."}]}], ",", 
     RowBox[{"\[Nu]", "=", "0."}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lX", ",", "lY", ",", "lZ", ",", "a"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"50", ",", "50", ",", "50", ",", "3"}], "}"}], 
      RowBox[{"VortexSize", "@", "state"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"sampleSeed1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BiStringSeed", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "\[Alpha]1", ",", 
          RowBox[{"\[Pi]", "/", "2."}], ",", "\[Nu]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "\[Alpha]2", ",", 
          RowBox[{"\[Pi]", "/", "2."}], ",", "\[Nu]"}], "}"}], ",", "a", ",", 
        "\[Beta]", ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}]}], "]"}], "@", 
      "state"}]}], ";"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Phi]\[Chi]Plot", "[", 
     RowBox[{".75", ",", "False", ",", "True"}], "]"}], "@", "sampleSeed"}], 
   "*)"}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8008655175234547`*^9, 3.800865572441064*^9}, {
   3.800865655532649*^9, 3.800865664939019*^9}, {3.8008659126390123`*^9, 
   3.800865913900205*^9}, {3.800866180026248*^9, 3.8008661965193157`*^9}, {
   3.8008666616079464`*^9, 3.8008666619599876`*^9}, {3.800866702477378*^9, 
   3.800866725882569*^9}, {3.8008669928542557`*^9, 3.8008669946932564`*^9}, {
   3.800871890116412*^9, 3.8008719064843993`*^9}, {3.8008817692973204`*^9, 
   3.8008817867823486`*^9}, {3.800885598627492*^9, 3.800885628927495*^9}, {
   3.800885661093522*^9, 3.8008856663045225`*^9}, {3.8008859903423786`*^9, 
   3.8008859971363797`*^9}, {3.800886077186352*^9, 3.8008860784143486`*^9}, {
   3.8008862149615173`*^9, 3.8008862264630585`*^9}, {3.801374601635149*^9, 
   3.8013746104866834`*^9}, {3.8013746552042212`*^9, 3.801374655250216*^9}, {
   3.801374723585723*^9, 3.8013747368168364`*^9}, {3.8013759804885597`*^9, 
   3.8013759859298277`*^9}, {3.8013760225995626`*^9, 
   3.8013760482444105`*^9}, {3.8014551122863717`*^9, 3.801455113964009*^9}, {
   3.80145522148755*^9, 3.801455224260547*^9}, {3.801455454684285*^9, 
   3.8014554560818157`*^9}, {3.8014578669779243`*^9, 3.801457869986229*^9}, {
   3.801461650966761*^9, 3.8014616533797665`*^9}, 3.8020023787728558`*^9, 
   3.8020040351479917`*^9, {3.8027521942173414`*^9, 3.802752195456332*^9}, 
   3.804224177291499*^9, {3.804398721343706*^9, 3.80439872283424*^9}, {
   3.8073380130941696`*^9, 3.807338013300682*^9}, {3.809177239744445*^9, 
   3.8091772612784185`*^9}, {3.8092381709472494`*^9, 3.809238174449216*^9}, {
   3.8092383956506824`*^9, 3.809238407328707*^9}, {3.8092384453792825`*^9, 
   3.8092384546432247`*^9}, {3.80931912183934*^9, 3.8093191602498507`*^9}, {
   3.809319193193473*^9, 3.8093191936535845`*^9}, {3.80931951881666*^9, 
   3.809319523819171*^9}, {3.8206398062301455`*^9, 3.8206398074394927`*^9}, {
   3.820639869225546*^9, 3.820639870293442*^9}, {3.8239291802728786`*^9, 
   3.8239291803822155`*^9}, {3.8241831648149033`*^9, 3.824183175809044*^9}, {
   3.8241834414068575`*^9, 3.82418345273517*^9}, {3.824183597709011*^9, 
   3.824183645573535*^9}, {3.8241839855419664`*^9, 3.8241840529478545`*^9}, {
   3.824184167488969*^9, 3.824184182364702*^9}, {3.824184301263216*^9, 
   3.82418430479608*^9}, {3.8241844969721727`*^9, 3.8241844977567787`*^9}, {
   3.8241845322263722`*^9, 3.8241845359960938`*^9}, {3.824184575504114*^9, 
   3.824184579622549*^9}, {3.8241852377228055`*^9, 3.824185239209339*^9}, {
   3.824185282567751*^9, 3.824185283561133*^9}, {3.8241854932111673`*^9, 
   3.8241854953488283`*^9}, {3.824198492256491*^9, 3.8241984972746563`*^9}, {
   3.824203272150124*^9, 3.8242032934353576`*^9}, {3.8242064952047157`*^9, 
   3.824206499301737*^9}, {3.824230765612233*^9, 3.8242307657535734`*^9}, {
   3.8242313205108147`*^9, 3.8242313264191475`*^9}, {3.8242719659124117`*^9, 
   3.824271967209079*^9}, 3.824309689093691*^9, {3.8245790653806295`*^9, 
   3.8245790784780617`*^9}, {3.8246129031660366`*^9, 
   3.8246129032441435`*^9}, {3.824809627221728*^9, 3.8248096296945286`*^9}, {
   3.8248096634328623`*^9, 3.8248096669993896`*^9}, {3.8248814708753505`*^9, 
   3.824881502470664*^9}, {3.824881633405266*^9, 3.8248816355836897`*^9}, {
   3.8248817803864727`*^9, 3.8248817846507435`*^9}, {3.824988651635195*^9, 
   3.8249886535108824`*^9}, {3.830327896293076*^9, 3.8303279569286757`*^9}, {
   3.841907060552729*^9, 3.841907063354601*^9}, {3.841907100617566*^9, 
   3.841907118940539*^9}, {3.8419117071045375`*^9, 3.8419117286622696`*^9}, {
   3.841913080722766*^9, 3.8419130851484976`*^9}, {3.8419140237742643`*^9, 
   3.8419140257458344`*^9}, {3.8419141038850255`*^9, 3.841914108548415*^9}, {
   3.841915093242436*^9, 3.8419150985343313`*^9}, {3.84191572349866*^9, 
   3.841915734768656*^9}, {3.841990974601243*^9, 3.841990980185709*^9}, {
   3.841991366621995*^9, 3.8419913711286335`*^9}, {3.8419914376235685`*^9, 
   3.8419914628890996`*^9}, {3.841991741339259*^9, 3.841991746657942*^9}, {
   3.8419934585733423`*^9, 3.841993464194959*^9}, {3.8424246582567806`*^9, 
   3.8424246615829077`*^9}, {3.8424253898095536`*^9, 3.842425392639343*^9}, {
   3.8424256265969286`*^9, 3.84242563149798*^9}, {3.8611813251147795`*^9, 
   3.8611813273219304`*^9}, {3.861349973003378*^9, 3.861349991856573*^9}, {
   3.861785888556021*^9, 3.861785892511984*^9}, {3.8626093023615637`*^9, 
   3.8626093630818377`*^9}, {3.863600706237185*^9, 3.8636007106528406`*^9}, {
   3.8636288772808027`*^9, 3.863628888902158*^9}, 3.863629009883037*^9, 
   3.8648232908492746`*^9, 3.8648233700485153`*^9, {3.8648234090187263`*^9, 
   3.864823415899214*^9}, {3.864823453492628*^9, 3.8648234588683667`*^9}, 
   3.864824346014887*^9, {3.864923303397685*^9, 3.8649233087935886`*^9}, 
   3.8650170503052416`*^9, {3.8652500845216*^9, 3.865250088617935*^9}, {
   3.8652502295699224`*^9, 3.8652502304142876`*^9}, {3.865250337213297*^9, 
   3.8652503449444885`*^9}, {3.865250404009781*^9, 3.865250408000204*^9}, 
   3.8652703880419006`*^9, 3.865270457093032*^9, {3.8653352263790073`*^9, 
   3.8653352265936885`*^9}},ExpressionUUID->"2c9e5d37-7426-44f2-8bef-\
fcf24c9dfc6a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sampleSeed", "=", 
   RowBox[{"ExportSeed", "[", 
    RowBox[{"\"\<seed101_v9lX116.h5\>\"", ",", "sampleSeed1"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.86303317939439*^9, 3.863033190663025*^9}, {
   3.864823262090534*^9, 3.86482330218396*^9}, {3.8648233533736577`*^9, 
   3.8648233757705355`*^9}, 3.8648234678044195`*^9, 3.8648243520774927`*^9, {
   3.8649233221663713`*^9, 3.8649233269743414`*^9}, 3.8650170682730193`*^9, {
   3.865250451768701*^9, 3.86525045481061*^9}, 3.865270420564779*^9, 
   3.865270460025923*^9},
 CellLabel->
  "In[103]:=",ExpressionUUID->"53b20b84-f573-431d-a18b-23cfccd824e6"],

Cell[TextData[{
 StyleBox["Note: ",
  FontWeight->"Bold"],
 "t",
 "he result of the ",
 Cell[BoxData[
  FormBox["BiStringSeed", TraditionalForm]],ExpressionUUID->
  "ee8be930-ec8d-4d91-8405-30d0fc337872"],
 " function is an Association with the following keys:"
}], "Text",
 CellChangeTimes->{{3.8241849033039665`*^9, 
  3.8241849517276936`*^9}},ExpressionUUID->"d56d85df-dbea-442e-8964-\
bdc7057b1949"],

Cell[BoxData[
 RowBox[{"Keys", "@", "sampleSeed"}]], "Input",
 CellChangeTimes->{{3.8241847975438833`*^9, 3.824184800461776*^9}, {
  3.8241849530745373`*^9, 3.824184953669636*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"700e483c-0238-483d-afe2-26cc24cf2caf"],

Cell["You may access the corresponding values like so", "Text",
 CellChangeTimes->{{3.824185519121329*^9, 
  3.8241855560068216`*^9}},ExpressionUUID->"0424866f-e0b0-443f-8c8a-\
d8c5b0f81a1d"],

Cell[BoxData[
 RowBox[{"sampleSeed", "@", "\"\<fields\>\""}]], "Input",
 CellChangeTimes->{{3.824185566808374*^9, 3.824185568631508*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"cb2ae4d1-eb32-4cf9-84ca-4c9dea23bdd3"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.862646266364565*^9, 
  3.86264626800307*^9}},ExpressionUUID->"d1239ec6-d2e6-471d-b7ac-\
b79d84f31fce"],

Cell[TextData[{
 "You can also export the seed for later use with ",
 Cell[BoxData[
  FormBox["ExportSeed", TraditionalForm]],ExpressionUUID->
  "8e2f469c-8b1a-4459-8e6d-4fcb0ae7219e"]
}], "Text",
 CellChangeTimes->{{3.842425639336479*^9, 
  3.8424256952114506`*^9}},ExpressionUUID->"917a6534-26fa-4b4b-bec4-\
5ca1e1333c97"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", "\"\<G:\\\\seeds130\\\\seeds351cuadrados\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.878798398433894*^9, 3.8787984059642544`*^9}, 
   3.884443982532192*^9},
 CellLabel->
  "In[123]:=",ExpressionUUID->"0682a395-94bd-45f4-8138-00a6c4ae409c"],

Cell[BoxData["\<\"G:\\\\seeds130\\\\seeds351cuadrados\"\>"], "Output",
 CellChangeTimes->{3.884443983590167*^9},
 CellLabel->
  "Out[123]=",ExpressionUUID->"caf936b2-582b-4c25-b947-854447405244"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"sampleSeed", "=", 
   RowBox[{
   "ImportSeed", "[", 
    "\"\<squareseed101_v5sep2lX279nocurrentsRingBonlyVortices.h5\>\"", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.86303317939439*^9, 3.863033190663025*^9}, 
   3.8787983850413895`*^9, {3.8788873315651474`*^9, 3.8788873332372394`*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"27de5397-3a70-499d-8841-880e6624654d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Keys", "@", "sampleSeed"}], "/.", "sampleSeed"}]], "Input",
 CellChangeTimes->{{3.862646278348122*^9, 3.8626462801637964`*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"7ccb58c9-d6e8-4404-8cda-c28619ffdbb5"],

Cell[BoxData[
 RowBox[{"ExportSeed", "[", 
  RowBox[{"\"\<D://seed_351v7LX116LR200.h5\>\"", ",", "sampleSeed"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.842425649246375*^9, 3.842425670499235*^9}, 
   3.861181385720924*^9, {3.861350042194565*^9, 3.861350046670209*^9}, {
   3.862609394640294*^9, 3.862609400880294*^9}, {3.863600733530016*^9, 
   3.8636007571175165`*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"2e56f7bd-e856-4eff-a7af-eb8511c76245"],

Cell[BoxData["Quit"], "Input",
 CellChangeTimes->{{3.872151190217271*^9, 3.8721511907440615`*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"5ac909b6-626a-416e-ad5a-39faaecc955a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"\[Alpha]1_", ",", "\[Alpha]2_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Alpha]2", "]"}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Alpha]2", "]"}], 
      RowBox[{"Cos", "[", "\[Alpha]1", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Alpha]2", "]"}], 
      RowBox[{"Sin", "[", "\[Alpha]1", "]"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8789061165801177`*^9, 3.8789061230282097`*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"2a6904d5-bb6a-4ead-a496-216bc99288c4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"f", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}], ",", 
   RowBox[{"\[Pi]", "/", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8789061198325725`*^9, 3.878906133639445*^9}, {
  3.8802949148286533`*^9, 3.880294930435831*^9}, {3.8803580289363403`*^9, 
  3.8803580473354025`*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"32ff5555-1389-457e-91dd-02eab13f1bf8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", 
   RowBox[{"-", "1"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.88035803861937*^9, 3.8803580478474016`*^9}},
 CellLabel->
  "Out[124]=",ExpressionUUID->"5b14b08e-a8d2-4608-9129-b53f9769cc1d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"f", "[", 
  RowBox[{"0", ",", 
   RowBox[{"\[Pi]", "/", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8789061511513257`*^9, 3.878906152026817*^9}, {
   3.8802325910142317`*^9, 3.8802325927282634`*^9}, 3.8802949535694866`*^9},
 CellLabel->
  "In[125]:=",ExpressionUUID->"d8170dc2-0520-4080-ab58-e905a097a153"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.880358058916593*^9},
 CellLabel->
  "Out[125]=",ExpressionUUID->"baa14b99-d1d6-4792-abf0-9ec6a8183607"]
}, Open  ]],

Cell["\<\
Note that we can also create initial seeds with four strings forming a \
square, like so:\
\>", "Text",
 CellChangeTimes->{{3.824989929945039*^9, 3.8249899322266464`*^9}, {
  3.8249899641429787`*^9, 
  3.824989980321124*^9}},ExpressionUUID->"83758110-c4bb-4c2c-9a8c-\
081c8a9f45c0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"lX", ",", 
     RowBox[{"nX", "=", "281"}], ",", "lY", ",", 
     RowBox[{"nY", "=", "281"}], ",", "lZ", ",", 
     RowBox[{"nZ", "=", "281"}], ",", 
     RowBox[{"state", "=", "Type2Vortex"}], ",", "a", ",", "b", ",", "c", ",", 
     RowBox[{"\[Beta]", "=", "0.1"}], ",", 
     RowBox[{"\[Beta]2", "=", "0.6"}], ",", 
     RowBox[{"v1", "=", "1"}], ",", 
     RowBox[{"v11", "=", "1"}], ",", 
     RowBox[{"\[Alpha]11", "=", "0."}], ",", 
     RowBox[{"\[Alpha]12", "=", "0."}], ",", 
     RowBox[{"\[Nu]1", "=", "0."}], ",", 
     RowBox[{"v2", "=", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"v22", "=", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"\[Alpha]21", "=", "0."}], ",", 
     RowBox[{"\[Alpha]22", "=", "0."}], ",", 
     RowBox[{"\[Nu]2", "=", "0."}], ",", 
     RowBox[{"v3", "=", "1"}], ",", 
     RowBox[{"v33", "=", "1"}], ",", 
     RowBox[{"\[Alpha]31", "=", "0."}], ",", 
     RowBox[{"\[Alpha]32", "=", "0."}], ",", 
     RowBox[{"\[Nu]3", "=", "0."}], ",", 
     RowBox[{"v4", "=", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"v44", "=", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"\[Alpha]41", "=", "0."}], ",", 
     RowBox[{"\[Alpha]42", "=", 
      RowBox[{
       RowBox[{"N", "@", "\[Pi]"}], "/", "2"}]}], ",", 
     RowBox[{"\[Nu]4", "=", "0."}], ",", " ", "delta"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lX", ",", "lY", ",", "lZ", ",", "a", ",", "b", ",", "c"}], 
      "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "40.", ",", "40.", ",", "40.", ",", "15.", ",", "4.", ",", "15."}], 
       "}"}], "*", 
      RowBox[{"VortexSize", "@", "state"}]}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"delta", "=", 
     RowBox[{"Last", "@", 
      RowBox[{
       RowBox[{"Grid3D", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "@", 
       RowBox[{"{", 
        RowBox[{"\"\<G:\\\\seeds130\\\\seeds351cuadrados\>\"", ",", 
         RowBox[{
         "\"\<parameters\>\"", "<>", "\"\<seedtry2\>\"", "<>", 
          "\"\<.json\>\""}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<\[Beta]\>\"", "->", "\[Beta]"}], ",", 
        RowBox[{"\"\<\[Beta]2\>\"", "->", "\[Beta]2"}], ",", 
        RowBox[{"\"\<v1\>\"", "->", "v11"}], ",", 
        RowBox[{"\"\<\[Alpha]11\>\"", "->", "\[Alpha]11"}], ",", 
        RowBox[{"\"\<\[Alpha]12\>\"", "->", "\[Alpha]12"}], ",", 
        RowBox[{"\"\<\[Vee]1\>\"", "->", "\[Nu]1"}], ",", 
        RowBox[{"\"\<v2\>\"", "->", "v2"}], ",", 
        RowBox[{"\"\<v22\>\"", "->", "v22"}], ",", 
        RowBox[{"\"\<\[Alpha]21\>\"", "->", "\[Alpha]21"}], ",", 
        RowBox[{"\"\<\[Alpha]22\>\"", "->", "\[Alpha]22"}], ",", 
        RowBox[{"\"\<lX\>\"", "\[Rule]", "lX"}], ",", 
        RowBox[{"\"\<nX\>\"", "\[Rule]", "nX"}], ",", 
        RowBox[{"\"\<lY\>\"", "\[Rule]", "lY"}], ",", 
        RowBox[{"\"\<nY\>\"", "\[Rule]", "nY"}], ",", 
        RowBox[{"\"\<a\>\"", "->", "a"}], ",", 
        RowBox[{"\"\<b\>\"", "->", "b"}], ",", 
        RowBox[{"\"\<c\>\"", "->", "c"}], ",", 
        RowBox[{"\"\<delta\>\"", "->", "delta"}]}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"sampleSquareSeed", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"SquareStringSeed", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "v1", ",", "v11", ",", "\[Alpha]11", ",", "\[Alpha]12", ",", 
          "\[Nu]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "v2", ",", "v22", ",", "\[Alpha]21", ",", "\[Alpha]22", ",", 
          "\[Nu]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "v3", ",", "v33", ",", "\[Alpha]31", ",", "\[Alpha]32", ",", 
          "\[Nu]3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "v4", ",", "v44", ",", "\[Alpha]41", ",", "\[Alpha]42", ",", 
          "\[Nu]4"}], "}"}], ",", "a", ",", "b", ",", "c", ",", "\[Beta]", 
        ",", "\[Beta]2"}], "]"}], "@", "state"}]}], ";"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Phi]\[Chi]Plot", "[", 
     RowBox[{".75", ",", "False", ",", "True", ",", "1."}], "]"}], "@", 
    "sampleSquareSeed"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.8249898785838137`*^9, 3.8249899504352736`*^9}, {
   3.82499147400193*^9, 3.824991475674907*^9}, {3.824991608232283*^9, 
   3.8249916160759077`*^9}, {3.8303474221703963`*^9, 3.830347570130745*^9}, {
   3.8303477343201995`*^9, 3.8303477372138014`*^9}, 3.8303497020211325`*^9, 
   3.83035027121789*^9, {3.8303509453630147`*^9, 3.830350957360236*^9}, {
   3.8611814000583334`*^9, 3.861181404281129*^9}, 3.861726284354129*^9, {
   3.865290323722131*^9, 3.8652903465626435`*^9}, {3.865290382195962*^9, 
   3.865290385923386*^9}, {3.865290494436067*^9, 3.865290503164477*^9}, {
   3.865290534013177*^9, 3.8652905373218727`*^9}, {3.8652906727292747`*^9, 
   3.865290675226304*^9}, {3.86529074644355*^9, 3.8652907636599245`*^9}, {
   3.8652908036675444`*^9, 3.865290842314412*^9}, {3.8653349069882946`*^9, 
   3.865334908012211*^9}, {3.8653349588676977`*^9, 3.8653349597858353`*^9}, {
   3.865335089043867*^9, 3.8653350892412395`*^9}, {3.8653352740802355`*^9, 
   3.865335290485735*^9}, {3.8653366134588346`*^9, 3.865336620561146*^9}, {
   3.871997667002351*^9, 3.871997703403672*^9}, 3.872151240848734*^9, {
   3.874395216039926*^9, 3.8743952531899757`*^9}, {3.874395511990461*^9, 
   3.874395513736418*^9}, {3.874398115785651*^9, 3.874398117600957*^9}, {
   3.8743987674059525`*^9, 3.8743988081912055`*^9}, {3.874398992873166*^9, 
   3.874399013295575*^9}, {3.874399511916207*^9, 3.8743995156983128`*^9}, {
   3.874399556813426*^9, 3.8743995574743295`*^9}, {3.874399806293657*^9, 
   3.8743998068631506`*^9}, {3.8743999729071574`*^9, 3.874399975392182*^9}, {
   3.874407893572406*^9, 3.874407912883333*^9}, {3.8744082923879104`*^9, 
   3.8744083020527897`*^9}, {3.874408394996148*^9, 3.8744084020602736`*^9}, {
   3.874414507838107*^9, 3.8744145214500737`*^9}, {3.8744202989954567`*^9, 
   3.8744203044641514`*^9}, {3.875790379456685*^9, 3.875790438060934*^9}, {
   3.875790897956046*^9, 3.875790912489443*^9}, {3.8757921226384263`*^9, 
   3.875792131605418*^9}, 3.875796709812648*^9, {3.875799800231041*^9, 
   3.875799802444559*^9}, {3.8764692109522963`*^9, 3.8764692130050592`*^9}, 
   3.8786601082920933`*^9, {3.878660150090741*^9, 3.878660190066884*^9}, {
   3.8788010076021037`*^9, 3.878801013530134*^9}, {3.878813038743506*^9, 
   3.8788130671473413`*^9}, {3.878815847408443*^9, 3.8788158702750344`*^9}, {
   3.8788173696630197`*^9, 3.878817374189767*^9}, {3.878820743831751*^9, 
   3.878820746057213*^9}, 3.8788306392776127`*^9, 3.8788341935104575`*^9, {
   3.8788874015204287`*^9, 3.8788874054507914`*^9}, {3.8788874865820503`*^9, 
   3.878887510192643*^9}, {3.8788876305701637`*^9, 3.8788876307272635`*^9}, {
   3.8788937482028084`*^9, 3.8788937496046715`*^9}, {3.8789061917094097`*^9, 
   3.878906194691367*^9}, {3.878913614927433*^9, 3.878913621825734*^9}, {
   3.8798594620385447`*^9, 3.879859464209879*^9}, {3.8798595567660723`*^9, 
   3.8798595778968887`*^9}, {3.880232603466323*^9, 3.8802326054373226`*^9}, {
   3.8802949226278*^9, 3.8802949637225823`*^9}, {3.8803583100122194`*^9, 
   3.880358312334252*^9}, {3.8804424453614597`*^9, 3.88044245101646*^9}, 
   3.880442712172252*^9, {3.8805283143718653`*^9, 3.880528315307865*^9}, {
   3.8806164019938283`*^9, 3.8806164224783683`*^9}, {3.88444390461558*^9, 
   3.884443956496936*^9}, {3.8844439901111774`*^9, 3.884444007154883*^9}, {
   3.8844447740268106`*^9, 
   3.8844448404311695`*^9}},ExpressionUUID->"238c3eed-6187-4359-aa88-\
cc86feb59a90"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.884444814451013*^9},
 CellLabel->
  "Out[124]=",ExpressionUUID->"50cdbd87-8998-4e2c-92fc-7f6bdf32695e"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.8844439023012705`*^9},ExpressionUUID->"b13d8131-98a1-4194-a39d-\
59d7dc3e5e6b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", "\"\<G:\\\\seeds130\\\\seeds351cuadrados\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.8789137962958193`*^9, 3.8789138008310657`*^9}, 
   3.884443996273426*^9},ExpressionUUID->"ea6664d9-4a01-42b8-b2cd-\
1804be5f5ad6"],

Cell[BoxData["\<\"F:\\\\Vortex_simulations\\\\seedssquare\\\\square\"\>"], \
"Output",
 CellChangeTimes->{3.8803546771873317`*^9, 3.880418049390866*^9, 
  3.8805054044605317`*^9, 3.8805844412547235`*^9, 3.880672566687999*^9},
 CellLabel->
  "Out[124]=",ExpressionUUID->"9facf7fc-3f86-44fb-b3d6-abd406ed51f6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExportSeed", "[", 
  RowBox[{"\"\<seedtry2.h5\>\"", ",", "sampleSquareSeed"}], "]"}]], "Input",
 CellChangeTimes->{{3.878913802420702*^9, 3.8789138178737507`*^9}, {
  3.8798595872871943`*^9, 3.8798595932854223`*^9}, {3.8802326244335623`*^9, 
  3.8802326276325617`*^9}, {3.8802950117868567`*^9, 3.880295012423856*^9}, {
  3.880358329899311*^9, 3.880358333022978*^9}, {3.880442728081493*^9, 
  3.880442731934493*^9}, {3.880528389354001*^9, 3.880528390487032*^9}, {
  3.8806164408515186`*^9, 3.880616443120551*^9}, {3.884444015288698*^9, 
  3.8844440171518993`*^9}},ExpressionUUID->"d0024213-be48-4790-b948-\
5ff5cb540800"],

Cell[BoxData["\<\"squareseed351_v5\[Lambda]0p25q0.212132\[Omega]\
0p25twouptwodown.h5\"\>"], "Output",
 CellChangeTimes->{3.8803547735033293`*^9, 3.880418146078865*^9, 
  3.880505499118531*^9, 3.8806726554389963`*^9},
 CellLabel->
  "Out[125]=",ExpressionUUID->"5c7760ac-456c-4e07-9d9e-d3953b8dfb84"]
}, Open  ]],

Cell[BoxData["Quit"], "Input",
 CellChangeTimes->{{3.879922214236067*^9, 3.879922214812911*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"7977ad08-1e11-479d-aa50-cb29b860e5ee"],

Cell[BoxData[
 RowBox[{"Lx", "=", 
  RowBox[{"First", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"78.", ",", "78.", ",", "78.", ",", "20.5"}], "}"}], 
    RowBox[{"VortexSize", "@", "Type2Vortex"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.863600718216257*^9, {3.8652704856725836`*^9, 3.8652704930289764`*^9}, {
   3.8652903913084555`*^9, 3.865290391602461*^9}, {3.868199507144002*^9, 
   3.8681995168340473`*^9}, {3.868199555131838*^9, 3.86819955993316*^9}, 
   3.868609561096312*^9, 3.8686977503699813`*^9, {3.8789251996622705`*^9, 
   3.878925231818463*^9}},
 CellLabel->
  "In[555]:=",ExpressionUUID->"ea5fd412-bf70-4317-890c-33763b79388d"],

Cell[BoxData[
 RowBox[{"delta", "=", 
  RowBox[{"Last", "@", 
   RowBox[{
    RowBox[{"Grid3D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Lx", ",", "301"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Lx", ",", "301"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Lx", ",", "301"}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8652704784253197`*^9, 3.8652704797201962`*^9}, {
  3.878925215879265*^9, 3.878925224803417*^9}},
 CellLabel->
  "In[556]:=",ExpressionUUID->"65b5d63a-7aee-45de-abcb-577d6a95b544"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.8788148023459625`*^9},ExpressionUUID->"87b9d3f5-3b96-4688-83b9-\
ae286ae09ae2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BPlot", "[", 
   RowBox[{
   "0.75", ",", "True", ",", "False", ",", "1.", ",", "12", ",", "0.95"}], 
   "]"}], "[", "sampleSquareSeed", "]"}]], "Input",
 CellChangeTimes->{3.874395958069761*^9},
 CellLabel->
  "In[444]:=",ExpressionUUID->"4da83574-415e-4ec4-bc8f-6cc1f6d0e960"],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", "\"\<D:\\\\seeds\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.8630331580986423`*^9, 3.863033176693841*^9}, 
   3.8648232586967525`*^9, {3.8719977240402756`*^9, 3.871997725345931*^9}, 
   3.874401022779684*^9},
 CellLabel->
  "In[129]:=",ExpressionUUID->"7800ef88-b243-4e99-a94c-589ed0cabc0a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sampleSeed", "=", 
   RowBox[{"ExportSeed", "[", 
    RowBox[{
    "\"\<squareseed101_v5\[Lambda]0p25q0.212132\[Omega]0p25orthogonalchis.h5\>\
\"", ",", "sampleSquareSeed"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.86303317939439*^9, 3.863033190663025*^9}, {
   3.864823262090534*^9, 3.86482330218396*^9}, {3.8648233533736577`*^9, 
   3.8648233757705355`*^9}, 3.8648234678044195`*^9, 3.8648243520774927`*^9, {
   3.8649233221663713`*^9, 3.8649233269743414`*^9}, 3.8650170682730193`*^9, {
   3.865250451768701*^9, 3.86525045481061*^9}, 3.865270420564779*^9, {
   3.865335547209731*^9, 3.8653355516543694`*^9}, 3.865337837945857*^9, {
   3.8719977348419685`*^9, 3.8719977466425047`*^9}, 3.8721512538501587`*^9, {
   3.874401030543681*^9, 3.8744010351917906`*^9}, {3.8757998202004128`*^9, 
   3.8757998331276546`*^9}, {3.8789019362163734`*^9, 3.878901992671298*^9}, {
   3.878907336957388*^9, 3.8789073386835284`*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"d02b3c88-b8d7-439b-8375-44f053b3b51e"],

Cell[BoxData[
 RowBox[{"SendMail", "[", 
  RowBox[{"\"\<gianni2k@gmail.com\>\"", ",", "\"\<Done square seed\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8719977681131625`*^9, 3.87199777977289*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"387c6d8d-4883-4548-9203-cdc6070f1d48"],

Cell["\<\
For testing purposes, it may be desirable to consider a single, static string\
\>", "Text",
 CellChangeTimes->{{3.830262582391036*^9, 
  3.83026260083601*^9}},ExpressionUUID->"5f46d9be-ae69-41da-8faf-\
50ee7411a485"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"lX", ",", 
     RowBox[{"nX", "=", "41"}], ",", "lY", ",", 
     RowBox[{"nY", "=", "41"}], ",", "lZ", ",", 
     RowBox[{"nZ", "=", "41"}], ",", 
     RowBox[{"state", "=", "Type1Vortex"}], ",", "a", ",", 
     RowBox[{"v1", "=", "1"}], ",", 
     RowBox[{"v2", "=", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"\[Alpha]1", "=", "0."}], ",", 
     RowBox[{"\[Alpha]2", "=", 
      FractionBox["\[Pi]", "2."]}], ",", 
     RowBox[{"\[Nu]", "=", "0."}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lX", ",", "lY", ",", "lZ", ",", "a"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "3"}], "}"}], 
      RowBox[{"VortexSize", "@", "state"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"sampleSeed", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"StaticStringSeed", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
       RowBox[{
       "v1", ",", "v2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Nu]"}], 
       "]"}], "@", "state"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"BPlot", "[", 
      RowBox[{
      "0.75", ",", "True", ",", "False", ",", "1.", ",", "8", ",", "0.95"}], 
      "]"}], "@", "sampleSeed"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8008655175234547`*^9, 3.800865572441064*^9}, {
   3.800865655532649*^9, 3.800865664939019*^9}, {3.8008659126390123`*^9, 
   3.800865913900205*^9}, {3.800866180026248*^9, 3.8008661965193157`*^9}, {
   3.8008666616079464`*^9, 3.8008666619599876`*^9}, {3.800866702477378*^9, 
   3.800866725882569*^9}, {3.8008669928542557`*^9, 3.8008669946932564`*^9}, {
   3.800871890116412*^9, 3.8008719064843993`*^9}, {3.8008817692973204`*^9, 
   3.8008817867823486`*^9}, {3.800885598627492*^9, 3.800885628927495*^9}, {
   3.800885661093522*^9, 3.8008856663045225`*^9}, {3.8008859903423786`*^9, 
   3.8008859971363797`*^9}, {3.800886077186352*^9, 3.8008860784143486`*^9}, {
   3.8008862149615173`*^9, 3.8008862264630585`*^9}, {3.801374601635149*^9, 
   3.8013746104866834`*^9}, {3.8013746552042212`*^9, 3.801374655250216*^9}, {
   3.801374723585723*^9, 3.8013747368168364`*^9}, {3.8013759804885597`*^9, 
   3.8013759859298277`*^9}, {3.8013760225995626`*^9, 
   3.8013760482444105`*^9}, {3.8014551122863717`*^9, 3.801455113964009*^9}, {
   3.80145522148755*^9, 3.801455224260547*^9}, {3.801455454684285*^9, 
   3.8014554560818157`*^9}, {3.8014578669779243`*^9, 3.801457869986229*^9}, {
   3.801461650966761*^9, 3.8014616533797665`*^9}, 3.8020023787728558`*^9, 
   3.8020040351479917`*^9, {3.8027521942173414`*^9, 3.802752195456332*^9}, 
   3.804224177291499*^9, {3.804398721343706*^9, 3.80439872283424*^9}, {
   3.8073380130941696`*^9, 3.807338013300682*^9}, {3.809177239744445*^9, 
   3.8091772612784185`*^9}, {3.8092381709472494`*^9, 3.809238174449216*^9}, {
   3.8092383956506824`*^9, 3.809238407328707*^9}, {3.8092384453792825`*^9, 
   3.8092384546432247`*^9}, {3.80931912183934*^9, 3.8093191602498507`*^9}, {
   3.809319193193473*^9, 3.8093191936535845`*^9}, {3.80931951881666*^9, 
   3.809319523819171*^9}, {3.8206398062301455`*^9, 3.8206398074394927`*^9}, {
   3.820639869225546*^9, 3.820639870293442*^9}, {3.8239291802728786`*^9, 
   3.8239291803822155`*^9}, {3.8241831648149033`*^9, 3.824183175809044*^9}, {
   3.8241834414068575`*^9, 3.82418345273517*^9}, {3.824183597709011*^9, 
   3.824183645573535*^9}, {3.8241839855419664`*^9, 3.8241840529478545`*^9}, {
   3.824184167488969*^9, 3.824184182364702*^9}, {3.824184301263216*^9, 
   3.82418430479608*^9}, {3.8241844969721727`*^9, 3.8241844977567787`*^9}, {
   3.8241845322263722`*^9, 3.8241845359960938`*^9}, {3.824184575504114*^9, 
   3.824184579622549*^9}, {3.8241852377228055`*^9, 3.824185239209339*^9}, {
   3.824185282567751*^9, 3.824185283561133*^9}, {3.8241854932111673`*^9, 
   3.8241854953488283`*^9}, {3.824198492256491*^9, 3.8241984972746563`*^9}, {
   3.824203272150124*^9, 3.8242032934353576`*^9}, {3.8242064952047157`*^9, 
   3.824206499301737*^9}, {3.824230765612233*^9, 3.8242307657535734`*^9}, {
   3.8242313205108147`*^9, 3.8242313264191475`*^9}, {3.8242719659124117`*^9, 
   3.824271967209079*^9}, 3.824309689093691*^9, {3.8245790653806295`*^9, 
   3.8245790784780617`*^9}, {3.8246129031660366`*^9, 
   3.8246129032441435`*^9}, {3.824809627221728*^9, 3.8248096296945286`*^9}, {
   3.8248096634328623`*^9, 3.8248096669993896`*^9}, {3.8248814708753505`*^9, 
   3.824881502470664*^9}, {3.824881633405266*^9, 3.8248816355836897`*^9}, {
   3.8248817803864727`*^9, 3.8248817846507435`*^9}, {3.824988651635195*^9, 
   3.8249886535108824`*^9}, {3.8302626041685057`*^9, 
   3.8302626260409756`*^9}, {3.8302627425565305`*^9, 3.830262742760483*^9}, {
   3.8302631423847876`*^9, 3.830263142573149*^9}, {3.830263182440739*^9, 
   3.8302631879005933`*^9}, {3.830263618663657*^9, 3.8302636324479675`*^9}, {
   3.830263933851011*^9, 3.8302639359153886`*^9}, {3.83026401064937*^9, 
   3.8302640109712267`*^9}, {3.8302643383104615`*^9, 3.830264361215211*^9}, {
   3.830317078878168*^9, 3.8303170789094005`*^9}, {3.830317728943594*^9, 
   3.830317729037356*^9}, 3.8303179407790327`*^9, {3.830318424695118*^9, 
   3.8303184369313145`*^9}, 3.830318693741629*^9, {3.8303194392735996`*^9, 
   3.830319439960726*^9}, {3.830325916290655*^9, 3.8303259358435893`*^9}, {
   3.830353796086507*^9, 3.8303537962101126`*^9}, 3.8303582608655305`*^9, {
   3.8743993635822544`*^9, 3.8743994105248384`*^9}, {3.874399446173912*^9, 
   3.8743994618014812`*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"0adddd70-5171-4b64-a900-95608303abbb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Step 3: Time-evolve the system from an initial seed ", "Subsubsection",
 CellChangeTimes->{{3.800881979293268*^9, 3.8008819795812693`*^9}, {
   3.8008820331002994`*^9, 3.8008820341247845`*^9}, {3.8008821363179927`*^9, 
   3.800882147072245*^9}, {3.8008836751908493`*^9, 3.8008836958318863`*^9}, 
   3.8043992373675194`*^9},ExpressionUUID->"2055f859-b118-4b0c-9c30-\
6caffb82ab7d"],

Cell[TextData[{
 "Now we are ready to make the strings collide using the ",
 Cell[BoxData[
  FormBox["RK4", TraditionalForm]],ExpressionUUID->
  "c2bdc1ec-3c66-48d9-acd0-7bb795f7e32d"],
 " function, which performs time-evolution by taking a given number of small \
steps in ",
 Cell[BoxData[
  FormBox["t", TraditionalForm]],ExpressionUUID->
  "179d6d0b-bcef-4f10-8dd9-8b9167eca777"],
 ". This function takes the following arguments:\n",
 StyleBox["\t- ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox["kerOrderX", TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"66bac632-60c1-44a0-a10c-94811132a5f3"],
 StyleBox[":",
  FontWeight->"Bold"],
 " the order of the finite-difference derivative approximation in the ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "0aed9d75-197a-408d-bf18-2fbd5f42bd2c"],
 " direction (usually 2)\n",
 StyleBox["\t- ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox["kerOrderY", TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"34453591-61fc-4871-b825-d2227ad60172"],
 StyleBox[":",
  FontWeight->"Bold"],
 " the order of the finite-difference derivative approximation in the ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]],ExpressionUUID->
  "47500bbe-5656-4d53-a3ce-52d0afc23d00"],
 " direction (usually 2)\n\t",
 StyleBox["\t- ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox["kerOrderZ", TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"d0f9ae47-e6e0-43a9-a4ba-10478f5d0be3"],
 StyleBox[":",
  FontWeight->"Bold"],
 " the order of the finite-difference derivative approximation in the ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]],ExpressionUUID->
  "7f7a000c-6a8b-4d50-82c2-ce1a11174ff8"],
 " direction (usually 2)\n",
 StyleBox["\t- ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox["dt", TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"0fd3bcf2-7c25-46e5-8e46-b6c01e3c9157"],
 StyleBox[":",
  FontWeight->"Bold"],
 " the (small) time interval to advance in each step\n",
 StyleBox["\t- ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox["numSteps", TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"710791e6-59d3-43b9-a33e-fc76ddb93e73"],
 StyleBox[":",
  FontWeight->"Bold"],
 " the total number of time-steps to take\n",
 StyleBox["\t- checkpointInterval: ",
  FontWeight->"Bold"],
 "the number of steps between taking successive snapshots of the system\n\t",
 StyleBox["- ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox["seed", TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"4cd9c3aa-6419-424d-991e-50f5da70fc7c"],
 StyleBox[":",
  FontWeight->"Bold"],
 " the initial seed, as returned by ",
 Cell[BoxData[
  FormBox["BiStringSeed", TraditionalForm]],ExpressionUUID->
  "f90e3f45-83c6-4bf2-b538-278d0af6a413"],
 " in the previous step\n",
 StyleBox["\t- outputFile: ",
  FontWeight->"Bold"],
 "the file where the simulation snapshots are saved to disk (for convenience \
and later analysis)\n\nFor example, the following code runs the \
time-evolution for the seed we prepared in the previous step, and saves a \
snapshot of the system every 100 time-steps to the sample.h5 file:"
}], "Text",
 CellChangeTimes->{{3.8008836690138483`*^9, 3.8008839408873997`*^9}, {
   3.800884093543131*^9, 3.8008843933328724`*^9}, {3.8008844938787346`*^9, 
   3.800884511732252*^9}, {3.8008845799244366`*^9, 3.800884581621434*^9}, {
   3.8008863440161495`*^9, 3.800886346909147*^9}, {3.8008870916912346`*^9, 
   3.8008870996912627`*^9}, {3.801374857738279*^9, 3.801374870532173*^9}, 
   3.8073383292187147`*^9, {3.8093208595218267`*^9, 3.809320865935896*^9}, {
   3.8143683549927273`*^9, 3.814368364223124*^9}, {3.82418563529996*^9, 
   3.8241856718794413`*^9}, {3.8241861003969574`*^9, 
   3.8241861093476973`*^9}, {3.8241979130867195`*^9, 3.82419794497571*^9}, {
   3.8242050623506556`*^9, 3.8242050633833475`*^9}, {3.824205180230942*^9, 
   3.8242051811592684`*^9}},ExpressionUUID->"401f9fa8-e228-4535-9424-\
90ce5e54eb28"],

Cell[BoxData["Quit"], "Input",
 CellChangeTimes->{{3.875968100779349*^9, 3.875968101462658*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"ebd24978-73b4-48fe-bf96-101404c34624"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "SetDirectory", "[", 
   "\"\<F:\\\\Vortex_simulations\\\\seedssquare\\\\square\>\"", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8612132482776136`*^9, 3.8612132745366096`*^9}, 
   3.875967928455513*^9, 3.8762958783429785`*^9, 3.876498215201013*^9, 
   3.876499792807377*^9},
 CellLabel->
  "In[115]:=",ExpressionUUID->"d6afdbf7-d842-4f7a-b9cc-7bdf7f787306"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sampleSquareSeed", "=", 
   RowBox[{
   "ImportSeed", "[", "\"\<squareseed201_statictype2maybevorton.h5\>\"", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.861213241378111*^9, 3.861213247525111*^9}, {
   3.8612132951816096`*^9, 3.8612133026966114`*^9}, 3.8631701779748316`*^9, {
   3.8632238947181997`*^9, 3.8632238950860033`*^9}, {3.8759677915908546`*^9, 
   3.8759677930064106`*^9}, {3.875967912060531*^9, 3.8759679388754168`*^9}, 
   3.8764982460973816`*^9, 3.876499744927456*^9},
 CellLabel->
  "In[116]:=",ExpressionUUID->"d40a1a77-58f9-42dd-ad2f-95e87955d723"],

Cell[BoxData["sampleSquareSeed"], "Input",
 CellChangeTimes->{{3.8759679447233853`*^9, 3.875967947422433*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"afb85f60-371f-440f-93fb-9d6866cbc2ff"],

Cell[BoxData[
 RowBox[{"Keys", "@", "sampleSeed"}]], "Input",
 CellChangeTimes->{{3.8612133050676136`*^9, 3.8612133089531126`*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"d7a24126-d723-4492-b2a2-3c33d338efdd"],

Cell[BoxData[
 RowBox[{"\"\<fields\>\"", "/.", "sampleSeed"}]], "Input",
 CellChangeTimes->{{3.8612133373921113`*^9, 3.861213344643611*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"a4f111d1-458c-4c12-a176-056485f919bf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
   "\"\<lX\>\"", ",", "\"\<\[Beta]\>\"", ",", "\"\<nX\>\"", ",", "\"\<v\>\"", 
    ",", "\"\<\[Lambda]\>\"", ",", "\"\<q\>\"", ",", "\"\<\[Omega]\>\""}], 
   "}"}], "/.", "sampleSeed"}]], "Input",
 CellChangeTimes->{{3.8612133186781096`*^9, 3.86121338557911*^9}, {
  3.8631702282376223`*^9, 3.863170236213151*^9}, {3.878798419141686*^9, 
  3.8787984265486045`*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"d8330c00-0f8e-4d27-9792-0f5410a43e03"],

Cell[BoxData[
 RowBox[{"delta", "=", 
  RowBox[{"Last", "@", 
   RowBox[{
    RowBox[{"Grid3D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ls", ",", "Nn"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ls", ",", "Nn"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ls", ",", "Nn"}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}]}]], "Input",
 CellLabel->
  "In[117]:=",ExpressionUUID->"67b35dac-8731-452f-8b1f-975c56fe26bc"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8631702876465893`*^9, 
  3.863170291030471*^9}},ExpressionUUID->"39ac896b-a9a3-4296-bca2-\
5a4bec90f157"],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\<C:\\\\Users\\\\WST\\\\Dropbox\\\\non-Abelian_global_vortex_string\\\\\
martin\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.874409645040922*^9, 3.8744096709318037`*^9}, 
   3.8758017472095537`*^9, 3.875968069647956*^9, 3.875969824341896*^9, 
   3.8762959581745768`*^9, 3.8787196852786474`*^9, 3.8787406147742395`*^9, {
   3.879157306675681*^9, 3.8791573230233755`*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"b0d4dc48-5b24-42c8-8012-8aad0835e9fa"],

Cell[BoxData[
 RowBox[{"sampleSquareSeed", "=", 
  RowBox[{"ImportSeed", "[", "\"\<trypython.h5\>\"", "]"}]}]], "Input",
 CellChangeTimes->{{3.879157335490774*^9, 3.8791573422375355`*^9}},
 CellLabel->
  "In[152]:=",ExpressionUUID->"7eadb021-46e1-4524-bc38-2c18e2d2876d"],

Cell[BoxData[
 RowBox[{"sampleSquareSeed", "=", 
  RowBox[{"SimulationFinalState", "[", 
   RowBox[{
   "SimulationLoad", "@", 
    "\"\<C:\\\\Users\\\\WST\\\\Dropbox\\\\non-Abelian_global_vortex_string\\\\\
martin.h5\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8788910541922264`*^9, 3.8788910792249904`*^9}, 
   3.87915730337772*^9},
 CellLabel->"",ExpressionUUID->"085ad4dc-2700-45f7-bb30-59f195b87a51"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"kerOrder", "=", "2"}], ",", 
     RowBox[{"dt", "=", ".001"}], ",", 
     RowBox[{"numSteps", "=", "500"}], ",", 
     RowBox[{"checkpointInterval", "=", "500"}], ",", 
     RowBox[{"state", "=", "sampleSquareSeed"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sampleSimulation", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"RK4Nest", "[", 
        RowBox[{
        "state", ",", "\"\<checkpython51.h5\>\"", ",", "numSteps", ",", 
         "checkpointInterval"}], "]"}], "[", 
       RowBox[{"kerOrder", ",", "kerOrder", ",", "kerOrder"}], "]"}], "[", 
      "dt", "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8240936174164696`*^9, 3.824093621801115*^9}, {
   3.8240936674799075`*^9, 3.8240937093871517`*^9}, {3.824094592274681*^9, 
   3.824094600944376*^9}, {3.824095357324941*^9, 3.8240954168133745`*^9}, 
   3.8240956200630207`*^9, 3.824095838048913*^9, {3.8240972660132923`*^9, 
   3.824097290907387*^9}, {3.8240981263128614`*^9, 3.8240981314460793`*^9}, {
   3.8241003904693623`*^9, 3.824100392510171*^9}, {3.8241011469386253`*^9, 
   3.8241011469698877`*^9}, {3.8241011883058333`*^9, 3.824101199385211*^9}, {
   3.8241020321785717`*^9, 3.8241020324878707`*^9}, {3.824108149840335*^9, 
   3.824108168303398*^9}, {3.824118813450972*^9, 3.8241188348096046`*^9}, {
   3.8241188714006524`*^9, 3.8241188818734183`*^9}, {3.824186131768591*^9, 
   3.82418620259708*^9}, 3.82419208178848*^9, {3.8241960905735717`*^9, 
   3.824196090698599*^9}, {3.82419800213855*^9, 3.8241980032074347`*^9}, 
   3.824199363420474*^9, {3.8242033321187387`*^9, 3.8242033346424246`*^9}, {
   3.824204769159194*^9, 3.8242047739224815`*^9}, {3.824206309785636*^9, 
   3.8242063098485956`*^9}, {3.8242066230041647`*^9, 
   3.8242066558739667`*^9}, {3.8242308032656155`*^9, 3.824230806313859*^9}, {
   3.8242720458535013`*^9, 3.8242720490770683`*^9}, {3.824309729234103*^9, 
   3.8243097303910275`*^9}, {3.8245791568142433`*^9, 3.824579157502578*^9}, {
   3.8249762664378915`*^9, 3.824976269047475*^9}, {3.824976307751562*^9, 
   3.8249763083458395`*^9}, 3.83026442666393*^9, {3.830328126980935*^9, 
   3.830328127967762*^9}, {3.8419919988549995`*^9, 3.841992006352064*^9}, {
   3.841994237442399*^9, 3.8419942375451565`*^9}, 3.8424253043629856`*^9, 
   3.842425529630307*^9, {3.842426430352555*^9, 3.8424264304551487`*^9}, {
   3.8424267833568363`*^9, 3.842426815330072*^9}, 3.861181448360958*^9, {
   3.86121350303011*^9, 3.8612135033071117`*^9}, {3.8612135416346097`*^9, 
   3.8612135498941097`*^9}, {3.8613500736632338`*^9, 3.8613500737782097`*^9}, 
   3.8617260879627333`*^9, {3.8617859177488003`*^9, 3.8617859364711986`*^9}, 
   3.8744093548695507`*^9, {3.8744096072447033`*^9, 3.874409614057728*^9}, {
   3.874409708884675*^9, 3.8744097314078965`*^9}, {3.874415461279112*^9, 
   3.8744154664317017`*^9}, {3.8744214414586096`*^9, 3.874421442760517*^9}, 
   3.875791129334134*^9, {3.8757922781341143`*^9, 3.8757922795906596`*^9}, {
   3.8757968927367544`*^9, 3.8757968937706146`*^9}, {3.87596807826379*^9, 
   3.875968082680352*^9}, {3.8762958206667585`*^9, 3.876295821290105*^9}, {
   3.876337310431317*^9, 3.8763373226689816`*^9}, {3.878719626241001*^9, 
   3.8787196370000525`*^9}, 3.8787196919603367`*^9, 3.8787405905897217`*^9, 
   3.8787409339215875`*^9, {3.878755023370369*^9, 3.87875502634159*^9}, 
   3.878756075923645*^9, {3.878803414892786*^9, 3.8788034149708424`*^9}, 
   3.878814836877661*^9, 3.87889108977063*^9, {3.878895051256695*^9, 
   3.8788950639431286`*^9}, {3.8789073538629837`*^9, 
   3.8789073581961656`*^9}, {3.87915734963431*^9, 3.8791573624390697`*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"5c12559d-b3ae-41a7-8386-93635d416f18"],

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{"\"\<fields\>\"", "/.", 
   RowBox[{"SimulationSnapshot", "[", 
    RowBox[{
     RowBox[{"SimulationLoad", "@", "\"\<checkpython51.h5\>\""}], ",", 
     "500"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8791574262064667`*^9, 3.879157471344438*^9}, 
   3.8791576125920763`*^9},
 CellLabel->
  "In[158]:=",ExpressionUUID->"c55b2a2f-7ee8-4a00-939c-330c83667765"],

Cell[BoxData[
 RowBox[{"Norm", "[", 
  RowBox[{"Normal", "@", 
   RowBox[{"Flatten", "@", 
    RowBox[{"test", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8791575017532597`*^9, 3.8791575212584853`*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"3975d977-c1ad-4652-a597-3fd01a86ea00"],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"Norm", "@", 
     RowBox[{"Normal", "@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"test", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}]}]}], ")"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "16"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8791574758404293`*^9, 3.879157493803404*^9}, {
  3.8791575265411105`*^9, 3.8791575439309626`*^9}, {3.879157780926818*^9, 
  3.879157781422002*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"998df0ee-b688-4a1c-9418-e5bf5137510e"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.878719601271428*^9, 
  3.8787196242067165`*^9}},ExpressionUUID->"dd880424-6f74-42a4-9c3c-\
3c1d70eb4f4a"],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\<F:\\\\Vortex_simulations\\\\simulsquares\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.8791575685309553`*^9, 3.8791575694190874`*^9}, 
   3.8791576689368343`*^9, 3.879157708525696*^9},
 CellLabel->
  "In[166]:=",ExpressionUUID->"d0c5d424-8326-4961-97b1-42dcab2e3c43"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"testpy", "=", 
   RowBox[{"\"\<fields\>\"", "/.", 
    RowBox[{"SimulationSnapshot", "[", 
     RowBox[{
      RowBox[{"SimulationLoad", "@", "\"\<simul_pytrypython.h5\>\""}], ",", 
      "500"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8791576173913007`*^9, 3.8791576222339516`*^9}, 
   3.879157653261587*^9, 3.879157695436098*^9},
 CellLabel->
  "In[167]:=",ExpressionUUID->"b75fcbca-1479-4dc4-9358-d15f3b8d35cb"],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"Norm", "@", 
     RowBox[{"Normal", "@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"testpy", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}]}]}], ")"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "16"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.8791577332929387`*^9, {3.8791577776932354`*^9, 3.879157777857543*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"70a4fbcf-1e06-4ed4-b87a-4952c27c8ab9"],

Cell[BoxData[
 RowBox[{"check", "=", 
  RowBox[{"SimulationSnapshot", "[", 
   RowBox[{"sampleSimulation", ",", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.876295993192526*^9, 3.876296011742304*^9}},
 CellLabel->
  "In[198]:=",ExpressionUUID->"0d243edf-ac1e-4cff-81b4-fa4725f99f3a"],

Cell[BoxData[
 RowBox[{"fields", "=", 
  RowBox[{"\"\<fields\>\"", "/.", "check"}]}]], "Input",
 CellChangeTimes->{{3.876296013349514*^9, 3.876296023725649*^9}},
 CellLabel->
  "In[199]:=",ExpressionUUID->"e4d36960-9f84-4ca6-9214-e057b58731ba"],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"fields", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "//", "Normal"}], "//", "Flatten"}], "//",
     "Norm"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "18"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8762960262257977`*^9, 3.876296039009544*^9}, {
  3.876296266103239*^9, 3.876296293174367*^9}},
 CellLabel->
  "In[205]:=",ExpressionUUID->"c3bfd89e-0441-4189-8a78-f10a0d6950e1"],

Cell[TextData[{
 "The ",
 Cell[BoxData[
  FormBox["RK4", TraditionalForm]],ExpressionUUID->
  "1784e268-9130-4ebb-8116-d017d2d56aea"],
 " function returns an Association describing the simulation, having the \
following keys"
}], "Text",
 CellChangeTimes->{{3.824197957034063*^9, 
  3.8241979860994053`*^9}},ExpressionUUID->"1b5db81d-5772-438e-a8cd-\
d49291ea22d6"],

Cell[BoxData[
 RowBox[{"Keys", "@", "sampleSimulation"}]], "Input",
 CellChangeTimes->{{3.8241979871565337`*^9, 3.8241980107560787`*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"fdc1536e-b2d5-4048-adf0-b9881bff358f"],

Cell["The list of snapshots available is accessed through", "Text",
 CellChangeTimes->{{3.824206664480729*^9, 
  3.8242066972689295`*^9}},ExpressionUUID->"a0167bbb-5c29-47e8-9968-\
e703487b3366"],

Cell[BoxData[
 RowBox[{"sampleSimulation", "@", "\"\<snapshots\>\""}]], "Input",
 CellChangeTimes->{{3.824206699621372*^9, 3.824206712959366*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"7cd534b1-f1dc-4acc-9a60-015e4ab5fb3f"],

Cell[TextData[{
 StyleBox["Note: ",
  FontWeight->"Bold"],
 "a",
 "fter a simulation is saved to a file, you can extend it by continuing from \
the last saved snapshot using the ",
 Cell[BoxData[
  FormBox["RK4Extender", TraditionalForm]],ExpressionUUID->
  "8f72c98b-f144-40d1-a054-39a331ca804d"],
 " function"
}], "Text",
 CellChangeTimes->{{3.82421126033585*^9, 3.824211278545258*^9}, {
  3.824211380346284*^9, 
  3.824211422100355*^9}},ExpressionUUID->"c92e8258-6dcf-4786-a8cb-\
c5f0c21fb209"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sampleSimulation", "=", 
   RowBox[{"RK4Extender", "[", 
    RowBox[{"\"\<sample.h5\>\"", ",", "10000"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.824207944474038*^9, 3.824207966281047*^9}, 
   3.8242079978191524`*^9, {3.8242080463696327`*^9, 3.8242080518614016`*^9}, {
   3.8242152208725367`*^9, 3.8242152270119677`*^9}, {3.82422105848382*^9, 
   3.8242210590326433`*^9}, {3.8242665081533375`*^9, 3.824266508964505*^9}, {
   3.8242727579989996`*^9, 3.824272759194158*^9}, {3.824273223451559*^9, 
   3.8242732237641964`*^9}, {3.8242761205985546`*^9, 3.824276133420182*^9}, 
   3.8242765284198227`*^9, 3.824276832263302*^9, {3.824277907252727*^9, 
   3.824277908704943*^9}, {3.824278110238922*^9, 3.824278110301412*^9}, {
   3.8243023862173495`*^9, 3.8243023869646606`*^9}, {3.8243614165139685`*^9, 
   3.824361417969804*^9}, {3.824579193742383*^9, 3.824579195053404*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"cb67c7b5-c1da-4bef-b541-fb2285bdd545"],

Cell[TextData[{
 "You may access any given snapshot for this simulation using the ",
 Cell[BoxData[
  FormBox["SimulationSnapshot", TraditionalForm]],ExpressionUUID->
  "d11aeca8-b2cc-453c-8436-5e701388c691"],
 " function"
}], "Text",
 CellChangeTimes->{{3.8241980193916655`*^9, 
  3.824198041073202*^9}},ExpressionUUID->"5d06fee7-8288-4995-a07b-\
c8e5b1f62d2e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]\[Chi]Plot", "[", 
   RowBox[{".75", ",", "False", ",", "True"}], "]"}], "@", 
  "sampleSeed1"}]], "Input",
 CellChangeTimes->{{3.865272165652494*^9, 3.865272166550495*^9}, {
  3.8652722019480495`*^9, 3.865272203168331*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"0ddee796-8057-439a-b51c-ee0fd7d76d7a"],

Cell[BoxData[
 RowBox[{"\[Phi]\[Chi]Plot", "@", 
  RowBox[{"SimulationSnapshot", "[", 
   RowBox[{"sampleSimulation", ",", "15000"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8243009651565647`*^9, 3.824301014565604*^9}, {
   3.8243074999603086`*^9, 3.82430751642962*^9}, {3.8243493282727585`*^9, 
   3.8243493350480385`*^9}, {3.824579211558*^9, 3.824579214861027*^9}, 
   3.8248817165591393`*^9, {3.824988669922828*^9, 3.8249886722047367`*^9}},
 CellLabel->
  "In[1245]:=",ExpressionUUID->"ad025a63-9122-40ff-8d04-0a400f390244"],

Cell[TextData[{
 "You can create a video of the simulation using the ",
 Cell[BoxData[
  FormBox["MakeVideo", TraditionalForm]],ExpressionUUID->
  "72af151a-9956-4375-8414-d7859e6b1a73"],
 " function ",
 StyleBox["[output removed to keep this notebook\[CloseCurlyQuote]s file size \
small]",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.8242062290519657`*^9, 3.824206245994405*^9}, 
   3.8242117842234173`*^9},ExpressionUUID->"4f6b53f1-d27e-42b0-ab05-\
645ddb4b5afe"],

Cell[BoxData["Quit"], "Input",
 CellChangeTimes->{{3.8790032437416277`*^9, 3.8790032441430087`*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"4606e522-e392-45a7-8803-50d0f398ddeb"],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\<F:\\\\Vortex_simulations\\\\simulsquares\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.8790029613551035`*^9, 3.8790029771138954`*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"29b34a1c-2e77-4626-b555-59b1f130e9e5"],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", "\"\<D:\\\\simul\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.8789117391928873`*^9, 3.8789117427143536`*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"437e18f7-9d35-4d99-82be-658fd327695a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tmp", "=", 
   RowBox[{
   "SimulationLoad", "@", 
    "\"\<simul_pysquareseed101_v5\[Lambda]0p25q0.212132\[Omega]\
0p25orthogonalchis.h5\>\""}]}], ";"}]], "Input",
 CellChangeTimes->{{3.824988639021212*^9, 3.824988642178091*^9}, {
   3.8303289198393183`*^9, 3.8303289263241596`*^9}, {3.830425943103628*^9, 
   3.8304259524533987`*^9}, {3.8304293336867247`*^9, 3.8304293378026724`*^9}, 
   3.8744143379859*^9, {3.8744201947248573`*^9, 3.874420196390914*^9}, {
   3.8744287816226997`*^9, 3.8744287961307783`*^9}, {3.8787201690794663`*^9, 
   3.878720170094763*^9}, 3.878820552895759*^9, 3.8788238429983807`*^9, 
   3.8788930029497423`*^9, 3.8788951006642485`*^9, 3.8789117515823765`*^9, 
   3.87900313921976*^9, {3.879069471848983*^9, 3.8790694835519342`*^9}, 
   3.879149200794041*^9},
 CellLabel->
  "In[172]:=",ExpressionUUID->"8c40eb66-376b-46ec-bb6f-e470259745ff"],

Cell[BoxData[
 RowBox[{"SimulationSnapshot", "[", 
  RowBox[{"tmp", ",", "2000"}], "]"}]], "Input",
 CellChangeTimes->{{3.8791492235455227`*^9, 3.8791492414517083`*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"c7317551-a605-4f62-97f0-344631945198"],

Cell[BoxData[
 RowBox[{"AssociateTo", "[", 
  RowBox[{
   RowBox[{"SimulationSnapshot", "[", 
    RowBox[{"tmp", ",", "32000"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<nX\>\"", "->", "101"}], ",", 
     RowBox[{"\"\<nY\>\"", "->", "101"}], ",", 
     RowBox[{"\"\<nZ\>\"", "->", "101"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8791493532412987`*^9, 3.8791494066352015`*^9}, {
   3.879149437742874*^9, 3.879149500148161*^9}, 3.8791495462040567`*^9, 
   3.879149616435279*^9},
 CellLabel->
  "In[148]:=",ExpressionUUID->"26cfd6a6-9c91-448b-b663-ffda725cc042"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]\[Chi]Plot", "[", 
   RowBox[{".75", ",", "False", ",", "True", ",", "1."}], "]"}], "@", 
  "%"}]], "Input",
 CellChangeTimes->{{3.879149264761511*^9, 3.879149265140608*^9}, {
  3.8791494149078865`*^9, 3.8791494411645083`*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"83bea63f-c9e6-42f3-88ec-24d542eb20d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeVideoExport", "[", 
   RowBox[{"\[Phi]\[Chi]Plot", "[", 
    RowBox[{".75", ",", "False", ",", "True", ",", "1."}], "]"}], "]"}], "[", 
  RowBox[{
  "\"\<simul_pysquareseed351_v5\[Lambda]0p25q0p212132\[Omega]0p25parallelchis_\
fields.h5\>\"", ",", "2", ",", "1", ",", "1", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.879003432244299*^9, 3.879003450721556*^9}, {
   3.879159204590333*^9, 3.8791592063152046`*^9}, 3.879159314130224*^9, 
   3.8791647512808294`*^9, 3.8797909864893727`*^9, 3.8801963894357595`*^9, {
   3.8801964444726696`*^9, 3.880196444961669*^9}, 3.8802016950880027`*^9},
 CellLabel->
  "In[122]:=",ExpressionUUID->"2fb13c1e-3aaf-42a1-a6f4-79c2c3fdd91a"],

Cell[BoxData[
 RowBox[{"SimulationSnapshot", "[", 
  RowBox[{
   RowBox[{
   "SimulationLoad", "@", 
    "\"\<simul_pysquareseed351_v5\[Lambda]0p25q0p212132\[Omega]\
0p25parallelchis_fields.h5\>\""}], ",", "500"}], "]"}]], "Input",
 CellChangeTimes->{{3.880203331152503*^9, 3.8802033453475037`*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"be4f1729-90c8-40c9-92f7-82bb163a6334"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\"\<fields\>\"", "/.", 
      RowBox[{"SimulationSnapshot", "[", 
       RowBox[{
        RowBox[{
        "SimulationLoad", "@", 
         "\"\<simul_pysquareseed351_v5\[Lambda]0p25q0p212132\[Omega]\
0p25parallelchis_fields.h5\>\""}], ",", "500"}], "]"}]}], ")"}], "//", 
    "Normal"}], "//", "Dimensions"}], "//", "Last"}]], "Input",
 CellChangeTimes->{{3.880203630555162*^9, 3.88020365366329*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"8eeec971-22f4-47e8-826f-0bf8aab554d9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]\[Chi]Plot", "[", 
   RowBox[{".75", ",", "False", ",", "True", ",", "1."}], "]"}], "@", 
  RowBox[{"AssociateTo", "[", 
   RowBox[{
    RowBox[{"SimulationSnapshot", "[", 
     RowBox[{
      RowBox[{
      "SimulationLoad", "@", 
       "\"\<simul_pysquareseed351_v5\[Lambda]0p25q0p212132\[Omega]\
0p25parallelchis_fields.h5\>\""}], ",", "500"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<nX\>\"", "->", "176"}], ",", 
      RowBox[{"\"\<nY\>\"", "->", "176"}], ",", 
      RowBox[{"\"\<nZ\>\"", "->", "176"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.88020343401941*^9, 3.8802034512224736`*^9}, {
  3.8802034938568554`*^9, 3.880203554273615*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"6121026b-79a1-4df2-be20-8bf83e0c3230"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeVideo", "[", 
   RowBox[{"\[Phi]\[Chi]Plot", "[", 
    RowBox[{".75", ",", "False", ",", "True", ",", "1."}], "]"}], "]"}], "[", 
  "tmp", "]"}]], "Input",
 CellChangeTimes->{{3.8304297390651536`*^9, 3.830429744185747*^9}, {
  3.8304306303441353`*^9, 3.8304306305740094`*^9}, {3.8744143686873875`*^9, 
  3.8744143704098473`*^9}, {3.8744144264630704`*^9, 3.8744144283977966`*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"486a25ff-7850-4e4c-affe-899100017b99"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeVideo", "[", 
   RowBox[{"\[Phi]2Plot", "[", 
    RowBox[{"1.", ",", "1."}], "]"}], "]"}], "[", "tmp", "]"}]], "Input",
 CellChangeTimes->{{3.8789013328100147`*^9, 3.8789013413241644`*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"d536f59b-f8ed-4bad-a01e-9f04fbd584e4"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<ringvortonortho.mp4\>\"", ",", 
   RowBox[{"Video", "@", "%"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.830450730576811*^9, 3.830450741079997*^9}, {
  3.878898801102248*^9, 3.8788988046398635`*^9}, {3.8789132252354975`*^9, 
  3.8789132256471777`*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"2ee76e0b-f9ae-4757-810b-5cc0806ddff8"],

Cell["And you may export this to a video file like so", "Text",
 CellChangeTimes->{{3.824208146860533*^9, 
  3.8242081747489133`*^9}},ExpressionUUID->"3cb8f53f-088c-4cd8-a821-\
ed895e95c717"],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\<F:\\\\Vortex_simulations\\\\simulsquares\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.8613506001913357`*^9, 3.8613506044553146`*^9}, {
   3.8744143174034405`*^9, 3.8744143232852526`*^9}, 3.875792062803323*^9, 
   3.8759568446628027`*^9, {3.8759975666217175`*^9, 3.875997566810331*^9}, 
   3.8760515082337675`*^9},
 CellLabel->
  "In[123]:=",ExpressionUUID->"e9276728-8459-431f-8491-c1abf6353f30"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\<mathematicasimulationvorton201.h5\>\"", ",", "sampleSimulation"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.824207801624473*^9, 3.824207821149917*^9}, {
   3.8242081709431133`*^9, 3.824208171319748*^9}, {3.824211184299472*^9, 
   3.824211184585856*^9}, {3.824220746320706*^9, 3.824220747455268*^9}, {
   3.8242665665107975`*^9, 3.82426657086051*^9}, 3.824268596958044*^9, {
   3.8242988502471113`*^9, 3.824298852875223*^9}, {3.82434934611909*^9, 
   3.824349352452018*^9}, {3.8243605749677296`*^9, 3.8243605784049516`*^9}, {
   3.824579224509903*^9, 3.8245792254366317`*^9}, {3.824811571869068*^9, 
   3.824811573049474*^9}, 3.8248126349799995`*^9, 3.8248160988086767`*^9, {
   3.824816312248756*^9, 3.824816312972213*^9}, {3.861350596455024*^9, 
   3.861350596690178*^9}, {3.8617305707064342`*^9, 3.8617305709429436`*^9}, {
   3.8757920663828754`*^9, 3.875792075749837*^9}, {3.875997537460377*^9, 
   3.8759975526210823`*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"8154d959-28bd-4c4f-b9f6-480a161896e0"],

Cell[BoxData["sampleSimulation"], "Input",
 CellChangeTimes->{{3.876039024621287*^9, 3.8760390268551774`*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"4b8631fb-2742-43ec-afcf-7af045b2d79e"],

Cell[BoxData[
 RowBox[{"SimulationFinalState", "@", "sampleSimulation"}]], "Input",
 CellChangeTimes->{{3.876051582087679*^9, 3.87605158344153*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"547acd7a-aefb-4a6e-8156-3e910e7dc16e"],

Cell[BoxData[
 RowBox[{"seedextend", "=", 
  RowBox[{"SimulationFinalState", "@", "sampleSimulation"}]}]], "Input",
 CellChangeTimes->{{3.8760518580743737`*^9, 3.876051867064889*^9}, 
   3.8760519032524834`*^9},
 CellLabel->
  "In[137]:=",ExpressionUUID->"b504b5e8-08d0-41da-8546-5136fc155c57"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"kerOrder", "=", "2"}], ",", 
     RowBox[{"dt", "=", ".001"}], ",", 
     RowBox[{"numSteps", "=", "20000"}], ",", 
     RowBox[{"checkpointInterval", "=", "500"}], ",", 
     RowBox[{"state", "=", "seedextend"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sampleSimulation2", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"RK4", "[", 
        RowBox[{"kerOrder", ",", "kerOrder", ",", "kerOrder"}], "]"}], "[", 
       RowBox[{"dt", ",", "numSteps", ",", "checkpointInterval"}], "]"}], "[", 
      RowBox[{"state", ",", "\"\<201vortonmaybeextended.h5\>\""}], "]"}]}], 
    ";"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.876051849296094*^9, 3.8760518774008694`*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"6ecfd033-53e4-4968-8598-fde288134277"],

Cell[BoxData["Quit"], "Input",
 CellChangeTimes->{{3.8759542852080708`*^9, 3.8759542945680003`*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"1f5612ab-b90c-48c5-a3c2-73869404488d"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.861981598640315*^9, 
  3.8619815998627496`*^9}},ExpressionUUID->"e0e99fbd-2472-41a9-af53-\
69445b3a4516"],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", "\"\<D:\\\\simul\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.876039120069762*^9, 3.8760391345220118`*^9}, 
   3.8763789927396617`*^9},
 CellLabel->
  "In[115]:=",ExpressionUUID->"1045a8dd-5a5f-49ad-9c15-c3a8eb0fb2de"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8760391118936515`*^9, 
  3.8760391180304556`*^9}},ExpressionUUID->"3aa6f3a6-3d28-486a-9ea1-\
33e76123924b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeVideoExport", "[", 
   RowBox[{"\[Phi]\[Chi]Plot", "[", 
    RowBox[{".75", ",", "False", ",", "True", ",", "1."}], "]"}], "]"}], "[", 
  RowBox[{
  "\"\<simul_pysquareseed351_v5\[Lambda]0p25q0p212132\[Omega]\
0p25orthogonalchis_fields.h5\>\"", ",", "4", ",", "1", ",", "1", ",", "1"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.875954732273388*^9, 3.875954762682538*^9}, 
   3.875956849737109*^9, 3.876039148231432*^9, 3.876040592053441*^9, {
   3.876041516002098*^9, 3.8760415160600853`*^9}, {3.8760826786128445`*^9, 
   3.8760826820860443`*^9}, 3.8761196313396835`*^9, 3.876379005893298*^9, 
   3.8797910456561365`*^9, 3.8798496278499737`*^9, 3.879853903190843*^9},
 CellLabel->
  "In[123]:=",ExpressionUUID->"6e4f668d-d6e3-4ee1-9461-83f68b1c09e2"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.879853969670949*^9, 3.8798540316342115`*^9}, {
  3.8798548409744635`*^9, 
  3.879854844991783*^9}},ExpressionUUID->"f4e7bd9a-ba22-41f1-a720-\
09bda7dcddb3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeVideo", "[", 
   RowBox[{"\[Phi]\[Chi]Plot", "[", 
    RowBox[{".75", ",", "False", ",", "True", ",", "1."}], "]"}], "]"}], "[", 
  "sampleSimulation", "]"}]], "Input",
 CellChangeTimes->{3.8757917366322155`*^9},
 CellLabel->
  "In[475]:=",ExpressionUUID->"93ec7e53-2164-48de-87c1-8236c3c29f69"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]2Plot", "[", 
   RowBox[{"1.", ",", "1."}], "]"}], "@", 
  RowBox[{"SimulationSnapshot", "[", 
   RowBox[{"sampleSimulation", ",", "7500"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8757965674877043`*^9, 3.8757966858390865`*^9}, {
  3.87579973811722*^9, 3.8757997786377654`*^9}},
 CellLabel->
  "In[485]:=",ExpressionUUID->"2f34e166-4fdc-4a2f-b543-b807365bbc70"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeVideo", "[", 
   RowBox[{"\[Phi]2Plot", "[", 
    RowBox[{"1.", ",", "1."}], "]"}], "]"}], "[", "sampleSimulation", 
  "]"}]], "Input",
 CellChangeTimes->{{3.8757919588242335`*^9, 3.875791974327577*^9}},
 CellLabel->
  "In[474]:=",ExpressionUUID->"c65c3788-7826-4c76-aac6-57c122e30039"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Main code", "Title",
 CellChangeTimes->{{3.824136569989891*^9, 
  3.8241365712699623`*^9}},ExpressionUUID->"3d16c9b1-a871-4d3e-8a36-\
7d5b44d97dbc"],

Cell[CellGroupData[{

Cell["Simulation handlers and helper functions", "Section",
 CellChangeTimes->{{3.824136577473591*^9, 
  3.8241365938906507`*^9}},ExpressionUUID->"ffd1bf7a-abf8-404a-9173-\
05f1b91a7f9b"],

Cell[TextData[{
 "Use ",
 Cell[BoxData[
  FormBox["SimulationSize", TraditionalForm]],ExpressionUUID->
  "13644f06-92af-4dfe-9e38-96c3b6137ba1"],
 " to estimate the disk space required to store a given simulation"
}], "Text",
 CellChangeTimes->{{3.8242118013394413`*^9, 
  3.824211821608612*^9}},ExpressionUUID->"ce79098f-deb5-4c8c-9524-\
8f14ef900f40"],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", "\"\<D:\\\\snaps\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.8619062178179026`*^9, 3.8619062219408283`*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"988a2715-c42e-4db6-a07c-4c2fbe617259"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "SimulationSize"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimulationSize", "[", 
    RowBox[{"nX_Integer", ",", "nY_Integer", ",", "nZ_Integer"}], "]"}], "[", 
   RowBox[{"numSteps_Integer", ",", "checkpointInterval_Integer"}], "]"}], ":=", 
  RowBox[{"UnitConvert", "[", 
   RowBox[{
    RowBox[{"N", "@", 
     RowBox[{"Quantity", "[", 
      RowBox[{
       RowBox[{"4", " ", "18", " ", "nX", " ", "nY", " ", "nZ", " ", 
        RowBox[{"Length", "@", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "numSteps", ",", "checkpointInterval"}], 
          "]"}]}]}], ",", "\"\<Bytes\>\""}], "]"}]}], ",", "\"\<GiB\>\""}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.824136549001436*^9, 3.824136553303042*^9}, {
  3.824136596755268*^9, 3.824136655205801*^9}, {3.8241367012508383`*^9, 
  3.8241367250696716`*^9}, {3.8241971382443304`*^9, 3.8241971408218155`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"4edac2ac-521b-41cf-993c-4294b8155fa0"],

Cell[TextData[{
 "Use ",
 Cell[BoxData[
  FormBox["SimulationLoad", TraditionalForm]],ExpressionUUID->
  "7f3bf223-5931-4a92-bb94-7bb7f919b847"],
 " to pre-load simulation data from a simulation file"
}], "Text",
 CellChangeTimes->{{3.8242118295214167`*^9, 
  3.8242118437648535`*^9}},ExpressionUUID->"e099e447-619f-451e-b8b6-\
6e10d7b831de"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "SimulationLoad"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimulationLoad", "[", "simulationFile_String", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"simulation", ",", "snapshots"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"simulation", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"simulationFile", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Attributes\>\"", ",", "\"\</\>\""}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"snapshots", "=", 
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"Sort", "[", 
        RowBox[{"FromDigits", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"StringReplace", "[", 
             RowBox[{"#", ",", 
              RowBox[{
               RowBox[{
               "\"\</\>\"", "~~", "x__", "~~", "\"\</\>\"", "~~", "__"}], ":>",
                "x"}]}], "]"}], "&"}], "/@", 
           RowBox[{"Import", "[", 
            RowBox[{"simulationFile", ",", "\"\<Datasets\>\""}], "]"}]}], 
          ")"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"simulation", ",", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<simulationFile\>\"", "\[Rule]", "simulationFile"}], ",", 
         RowBox[{"\"\<snapshots\>\"", "\[Rule]", "snapshots"}]}], "|>"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8241868225802546`*^9, 3.824186903793308*^9}, {
   3.8241869366754613`*^9, 3.824186937235575*^9}, {3.8241869819544244`*^9, 
   3.8241870581130667`*^9}, {3.824187187745474*^9, 3.8241872784824443`*^9}, {
   3.824187391695325*^9, 3.8241873971691113`*^9}, {3.8611832699078245`*^9, 
   3.8611832917318015`*^9}, 3.861788492772237*^9, {3.861788530468403*^9, 
   3.8617885347337284`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"54af700c-0dc2-48de-8cec-4107599b1e2d"],

Cell[TextData[{
 "Use ",
 Cell[BoxData[
  FormBox["SimulationSnapshot", TraditionalForm]],ExpressionUUID->
  "56e25445-2f8f-431a-9676-b5ffd9727bdd"],
 " to extract a snapshot from a given pre-loaded simulation"
}], "Text",
 CellChangeTimes->{{3.824211847304534*^9, 3.824211864945641*^9}, 
   3.824211913872817*^9},ExpressionUUID->"338c32ad-3cd2-455a-b8ce-\
fba507abbb21"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "SimulationSnapshot"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimulationSnapshot", "[", 
   RowBox[{"simulation_Association", ",", "snapshot_Integer"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "lR", ",", "nR", ",", "\[Epsilon]", ",", "v", ",", "\[Lambda]", ",", "q",
       ",", "\[Omega]", ",", "r\[Phi]", ",", "r\[Chi]", ",", "rA", ",", 
      "\[Chi]0", ",", "lX", ",", "nX", ",", "lY", ",", "nY", ",", "lZ", ",", 
      "nZ", ",", "dt", ",", "simulationFile", ",", "u", ",", "Du"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "lR", ",", "nR", ",", "\[Epsilon]", ",", "v", ",", "\[Lambda]", ",", 
        "q", ",", "\[Omega]", ",", "r\[Phi]", ",", "r\[Chi]", ",", "rA", ",", 
        "\[Chi]0", ",", "lX", ",", "nX", ",", "lY", ",", "nY", ",", "lZ", ",",
         "nZ", ",", "dt", ",", "simulationFile"}], "}"}], "=", 
      RowBox[{"simulation", "/@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<lR\>\"", ",", "\"\<nR\>\"", ",", "\"\<\[Epsilon]\>\"", ",", 
         "\"\<v\>\"", ",", "\"\<\[Lambda]\>\"", ",", "\"\<q\>\"", ",", 
         "\"\<\[Omega]\>\"", ",", "\"\<r\[Phi]\>\"", ",", "\"\<r\[Chi]\>\"", 
         ",", "\"\<rA\>\"", ",", "\"\<\[Chi]0\>\"", ",", "\"\<lX\>\"", ",", 
         "\"\<nX\>\"", ",", "\"\<lY\>\"", ",", "\"\<nY\>\"", ",", 
         "\"\<lZ\>\"", ",", "\"\<nZ\>\"", ",", "\"\<dt\>\"", ",", 
         "\"\<simulationFile\>\""}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"u", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"simulationFile", ",", 
        RowBox[{"\"\</\>\"", "<>", 
         RowBox[{"IntegerString", "[", 
          RowBox[{"snapshot", ",", "10", ",", "10"}], "]"}], "<>", 
         "\"\</u\>\""}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Du", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"simulationFile", ",", 
        RowBox[{"\"\</\>\"", "<>", 
         RowBox[{"IntegerString", "[", 
          RowBox[{"snapshot", ",", "10", ",", "10"}], "]"}], "<>", 
         "\"\</Du\>\""}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<lR\>\"", "\[Rule]", "lR"}], ",", 
       RowBox[{"\"\<nR\>\"", "\[Rule]", "nR"}], ",", 
       RowBox[{"\"\<\[Epsilon]\>\"", "\[Rule]", "\[Epsilon]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<v\>\"", "\[Rule]", "v"}], ",", 
       RowBox[{"\"\<\[Lambda]\>\"", "\[Rule]", "\[Lambda]"}], ",", 
       RowBox[{"\"\<q\>\"", "\[Rule]", "q"}], ",", 
       RowBox[{"\"\<\[Omega]\>\"", "\[Rule]", "\[Omega]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<r\[Phi]\>\"", "\[Rule]", "r\[Phi]"}], ",", 
       RowBox[{"\"\<r\[Chi]\>\"", "\[Rule]", "r\[Chi]"}], ",", 
       RowBox[{"\"\<rA\>\"", "\[Rule]", "rA"}], ",", 
       RowBox[{"\"\<\[Chi]0\>\"", "\[Rule]", "\[Chi]0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<lX\>\"", "\[Rule]", "lX"}], ",", 
       RowBox[{"\"\<nX\>\"", "\[Rule]", "nX"}], ",", 
       RowBox[{"\"\<lY\>\"", "\[Rule]", "lY"}], ",", 
       RowBox[{"\"\<nY\>\"", "\[Rule]", "nY"}], ",", 
       RowBox[{"\"\<lZ\>\"", "\[Rule]", "lZ"}], ",", 
       RowBox[{"\"\<nZ\>\"", "\[Rule]", "nZ"}], ",", 
       RowBox[{"\"\<t\>\"", "\[Rule]", 
        RowBox[{"snapshot", " ", "dt"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<fields\>\"", "\[Rule]", 
        RowBox[{"NumericArray", "[", 
         RowBox[{
          RowBox[{"Catenate", "@", 
           RowBox[{"{", 
            RowBox[{"u", ",", "Du"}], "}"}]}], ",", "\"\<Real32\>\""}], 
         "]"}]}]}], "\[IndentingNewLine]", "|>"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8241874091083107`*^9, 3.8241874320993624`*^9}, {
  3.8241874846898046`*^9, 3.8241874885918837`*^9}, {3.824187532107627*^9, 
  3.824187550353009*^9}, {3.8241876067543087`*^9, 3.824187672486165*^9}, {
  3.824187706628481*^9, 3.8241877730396137`*^9}, {3.824187847770897*^9, 
  3.824187868926981*^9}, {3.8242053864702578`*^9, 3.824205456683915*^9}, {
  3.8248764758482857`*^9, 3.8248765158346367`*^9}, {3.824975717455222*^9, 
  3.8249757818361673`*^9}, {3.8611833863114595`*^9, 3.8611835057488937`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"69feff70-27d4-48ee-8f10-771fd8df581e"],

Cell[TextData[{
 "Use ",
 Cell[BoxData[
  FormBox["SimulationFinalState", TraditionalForm]],ExpressionUUID->
  "fa2e3893-c18c-4973-8f6c-3f09bc6a94e6"],
 " to extract the last available snapshot from a given pre-loaded simulation"
}], "Text",
 CellChangeTimes->{{3.824211869751525*^9, 
  3.824211912146651*^9}},ExpressionUUID->"4e82ab4d-09d7-47bb-bc76-\
a328ff1bb7c2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "SimulationFinalState"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimulationFinalState", "[", "simulation_Association", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"SimulationSnapshot", "[", 
     RowBox[{"simulation", ",", 
      RowBox[{"Last", "@", 
       RowBox[{"simulation", "@", "\"\<snapshots\>\""}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8241907174135733`*^9, 3.8241907724836893`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"3b376a89-5369-43ef-b5da-e0d9d132c594"],

Cell[TextData[{
 "Use ",
 Cell[BoxData[
  FormBox["SimulationInitialState", TraditionalForm]],ExpressionUUID->
  "a7b93c45-2456-4bbe-b8e3-c895de4730ef"],
 " to extract the first snapshot (initial seed) from a given pre-loaded \
simulation"
}], "Text",
 CellChangeTimes->{{3.8242118931762123`*^9, 
  3.8242119102945538`*^9}},ExpressionUUID->"cec5caee-3e5c-4ee5-99a0-\
ae5b06da16d3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "SimulationInitialState"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimulationInitialState", "[", "simulation_Association", "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"SimulationSnapshot", "[", 
     RowBox[{"simulation", ",", 
      RowBox[{"First", "@", 
       RowBox[{"simulation", "@", "\"\<snapshots\>\""}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8241907846045384`*^9, 3.8241907893383245`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"5976d567-47c1-4f78-8369-2cda23941209"],

Cell[BoxData[
 RowBox[{
  RowBox[{"skippedSimulation", "[", 
   RowBox[{"simul_String", ",", "i_Integer", ",", "steps_Integer"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "simul1", ",", "simulsnapfields", ",", "ls", ",", "Nn", ",", "xs", ",", 
      "stepsxs"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"simul1", "=", 
      RowBox[{"SimulationSnapshot", "[", 
       RowBox[{
        RowBox[{"SimulationLoad", "[", "simul", "]"}], ",", 
        RowBox[{"500", "*", "i"}]}], "]"}]}], ";", "\[IndentingNewLine]", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ls", ",", "Nn"}], "}"}], "=", 
      RowBox[{"simul1", "/@", 
       RowBox[{"{", 
        RowBox[{"\"\<lX\>\"", ",", "\"\<nX\>\""}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"simulsnapfields", "=", 
      RowBox[{"\"\<fields\>\"", "/.", "simul1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xs", "=", 
      RowBox[{"First", "@", 
       RowBox[{
        RowBox[{"Grid3D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ls", ",", "Nn"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ls", ",", "Nn"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ls", ",", "Nn"}], "}"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"stepsxs", "=", 
      RowBox[{"xs", "[", 
       RowBox[{"[", 
        RowBox[{";;", ";;", 
         RowBox[{"2", "steps"}]}], "]"}], "]"}]}], ";", "\n", "     ", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"simul1", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<fields\>\"", "->", 
          RowBox[{"NumericArray", "[", 
           RowBox[{
            RowBox[{"simulsnapfields", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{";;", ";;", "1"}], ",", 
               RowBox[{";;", ";;", "steps"}], ",", 
               RowBox[{";;", ";;", "steps"}], ",", 
               RowBox[{";;", ";;", "steps"}]}], "]"}], "]"}], ",", 
            "\"\<Real32\>\""}], "]"}]}], ",", 
         RowBox[{"\"\<nX\>\"", "->", 
          RowBox[{"Length", "[", "stepsxs", "]"}]}], ",", 
         RowBox[{"\"\<nY\>\"", "->", 
          RowBox[{"Length", "[", "stepsxs", "]"}]}], ",", 
         RowBox[{"\"\<nZ\>\"", "->", 
          RowBox[{"Length", "[", "stepsxs", "]"}]}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.861977891915245*^9, 3.8619781149024315`*^9}, {
  3.8619781810562153`*^9, 3.861978182321664*^9}, {3.861978215657411*^9, 
  3.8619782265866594`*^9}, {3.861978314818207*^9, 3.8619783920547447`*^9}, {
  3.8619784488820667`*^9, 3.8619784818557673`*^9}, {3.8619785166182475`*^9, 
  3.861978598885208*^9}, {3.8802088633037157`*^9, 3.8802088797961054`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"553975b4-81c6-45f3-91b3-cbae6c09ed0c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\"\<fields\>\"", "/.", 
      RowBox[{"SimulationSnapshot", "[", 
       RowBox[{
        RowBox[{
        "SimulationLoad", "@", 
         "\"\<simul_pysquareseed351_v5\[Lambda]0p25q0p212132\[Omega]\
0p25parallelchis_fields.h5\>\""}], ",", "500"}], "]"}]}], ")"}], "//", 
    "Normal"}], "//", "Dimensions"}], "//", "Last"}]], "Input",ExpressionUUID->\
"5b8e3819-4264-4137-8cd3-3d652813c70a"],

Cell[BoxData[
 RowBox[{"skippedSimulation", "[", 
  RowBox[{
  "\"\<simul_pysquareseed351_v5\[Lambda]0p25q0p212132\[Omega]0p25parallelchis_\
fields.h5\>\"", ",", "1", ",", "4"}], "]"}]], "Input",
 CellChangeTimes->{3.8802088958702364`*^9},
 CellLabel->
  "In[130]:=",ExpressionUUID->"df6d9be2-0bda-4919-9fba-a7974fae9c87"],

Cell[BoxData[
 RowBox[{"skippedSimulation", "[", 
  RowBox[{
  "\"\<simul_pysquareseed351_v5\[Lambda]0p25q0p212132\[Omega]0p25parallelchis_\
fields.h5\>\"", ",", "1", ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.8802047582351313`*^9, 3.880204773255925*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"603c51fc-627e-4c4b-beec-faec90dc3928"],

Cell[BoxData[
 RowBox[{
  RowBox[{"choppedseed", "[", 
   RowBox[{"seed_", ",", "steps_Integer"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "simul1", ",", "simulsnapfields", ",", "ls", ",", "Nn", ",", "xs", ",", 
      "stepsxs"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"simul1", "=", "seed"}], ";", "\[IndentingNewLine]", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ls", ",", "Nn"}], "}"}], "=", 
      RowBox[{"simul1", "/@", 
       RowBox[{"{", 
        RowBox[{"\"\<lX\>\"", ",", "\"\<nX\>\""}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"simulsnapfields", "=", 
      RowBox[{"\"\<fields\>\"", "/.", "simul1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xs", "=", 
      RowBox[{"First", "@", 
       RowBox[{
        RowBox[{"Grid3D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ls", ",", "Nn"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ls", ",", "Nn"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ls", ",", "Nn"}], "}"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"stepsxs", "=", 
      RowBox[{"xs", "[", 
       RowBox[{"[", 
        RowBox[{";;", ";;", "steps"}], "]"}], "]"}]}], ";", "\n", "     ", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"simul1", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<fields\>\"", "->", 
          RowBox[{"NumericArray", "[", 
           RowBox[{"simulsnapfields", ",", "\"\<Real32\>\""}], "]"}]}], ",", 
         RowBox[{"\"\<nX\>\"", "->", 
          RowBox[{"Length", "[", "stepsxs", "]"}]}], ",", 
         RowBox[{"\"\<nY\>\"", "->", 
          RowBox[{"Length", "[", "stepsxs", "]"}]}], ",", 
         RowBox[{"\"\<nZ\>\"", "->", 
          RowBox[{"Length", "[", "stepsxs", "]"}]}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8636293693860874`*^9, 3.8636294154178004`*^9}, 
   3.8636294975274105`*^9},
 CellLabel->"In[16]:=",ExpressionUUID->"ddac07ce-b162-4dc7-90a5-a128f503e916"],

Cell[BoxData[
 RowBox[{
  RowBox[{"choppedSimulation", "[", 
   RowBox[{"simul_String", ",", "i_Integer", ",", "chop_Integer"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "simul1", ",", "simulsnapfields", ",", "ls", ",", "Nn", ",", "xs", ",", 
      "stepsxs", ",", "delta"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"simul1", "=", 
      RowBox[{"SimulationSnapshot", "[", 
       RowBox[{
        RowBox[{"SimulationLoad", "[", "simul", "]"}], ",", 
        RowBox[{"500", "*", "i"}]}], "]"}]}], ";", "\[IndentingNewLine]", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ls", ",", "Nn"}], "}"}], "=", 
      RowBox[{"simul1", "/@", 
       RowBox[{"{", 
        RowBox[{"\"\<lX\>\"", ",", "\"\<nX\>\""}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"simulsnapfields", "=", 
      RowBox[{"\"\<fields\>\"", "/.", "simul1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xs", "=", 
      RowBox[{"First", "@", 
       RowBox[{
        RowBox[{"Grid3D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ls", ",", "Nn"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ls", ",", "Nn"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ls", ",", "Nn"}], "}"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"delta", "=", 
      RowBox[{"Last", "@", 
       RowBox[{
        RowBox[{"Grid3D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ls", ",", "Nn"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ls", ",", "Nn"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ls", ",", "Nn"}], "}"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"stepsxs", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{"Drop", "[", 
         RowBox[{"xs", ",", "chop"}], "]"}], ",", 
        RowBox[{"-", "chop"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"First", "@", "xs"}], ",", 
        RowBox[{"Last", "@", "xs"}], ",", 
        RowBox[{"First", "@", "stepsxs"}], ",", 
        RowBox[{"Last", "@", "stepsxs"}]}], "}"}], "*)"}], "\n", " ", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"simul1", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<fields\>\"", "->", 
          RowBox[{"NumericArray", "[", 
           RowBox[{
            RowBox[{"simulsnapfields", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{";;", ";;", "1"}], ",", 
               RowBox[{
                RowBox[{"chop", "+", "1"}], ";;", 
                RowBox[{
                 RowBox[{"Length", "[", "xs", "]"}], "-", "chop"}]}], ",", 
               RowBox[{
                RowBox[{"chop", "+", "1"}], ";;", 
                RowBox[{
                 RowBox[{"Length", "[", "xs", "]"}], "-", "chop"}]}], ",", 
               RowBox[{
                RowBox[{"chop", "+", "1"}], ";;", 
                RowBox[{
                 RowBox[{"Length", "[", "xs", "]"}], "-", "chop"}]}]}], "]"}],
              "]"}], ",", "\"\<Real32\>\""}], "]"}]}], ",", 
         RowBox[{"\"\<nX\>\"", "->", 
          RowBox[{"Length", "[", "stepsxs", "]"}]}], ",", 
         RowBox[{"\"\<nY\>\"", "->", 
          RowBox[{"Length", "[", "stepsxs", "]"}]}], ",", 
         RowBox[{"\"\<nZ\>\"", "->", 
          RowBox[{"Length", "[", "stepsxs", "]"}]}], ",", 
         RowBox[{"\"\<originaln\>\"", "->", 
          RowBox[{"Length", "[", "xs", "]"}]}], ",", 
         RowBox[{"\"\<delta\>\"", "->", "delta"}], ",", 
         RowBox[{"\"\<lX\>\"", "->", 
          RowBox[{"2", "*", 
           RowBox[{"Abs", "[", 
            RowBox[{"Last", "@", "stepsxs"}], "]"}]}]}], ",", 
         RowBox[{"\"\<lY\>\"", "->", 
          RowBox[{"2", "*", 
           RowBox[{"Abs", "[", 
            RowBox[{"Last", "@", "stepsxs"}], "]"}]}]}], ",", 
         RowBox[{"\"\<lZ\>\"", "->", 
          RowBox[{"2", "*", 
           RowBox[{"Abs", "[", 
            RowBox[{"Last", "@", "stepsxs"}], "]"}]}]}]}], "}"}]}], "]"}]}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.871134660059493*^9, 3.8711346605188947`*^9}, {
   3.871134845081989*^9, 3.87113486872057*^9}, {3.871134910865469*^9, 
   3.871134920650041*^9}, {3.8711350074653807`*^9, 3.871135068097002*^9}, {
   3.871135162442099*^9, 3.8711351728731265`*^9}, {3.871135254266597*^9, 
   3.8711352710490646`*^9}, {3.8711423419949784`*^9, 
   3.8711423425034695`*^9}, {3.871142703549658*^9, 3.8711427261974344`*^9}, 
   3.8711428368182535`*^9, {3.871143018435502*^9, 3.8711430187768188`*^9}, {
   3.871143074896944*^9, 3.8711431158822036`*^9}, {3.871143154596798*^9, 
   3.8711431632051697`*^9}, {3.871143197438366*^9, 3.8711432610875473`*^9}, {
   3.871143303216502*^9, 3.871143308827482*^9}, {3.8711443704504013`*^9, 
   3.8711443743737717`*^9}, 3.87114442612124*^9, {3.871144525767116*^9, 
   3.8711445659124084`*^9}, {3.871144626221428*^9, 3.8711446580167036`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"cf7a9265-8f80-4bc8-bc4f-3f9b525fd615"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Visualization functions", "Section",
 CellChangeTimes->{{3.8241832604291*^9, 
  3.8241832630774355`*^9}},ExpressionUUID->"27a0c25d-0412-423d-a08c-\
1f54c83b3ec8"],

Cell["\<\
The following constants define the number of ticks to draw in the plot\
\[CloseCurlyQuote]s axes\
\>", "Text",
 CellChangeTimes->{{3.82421194418989*^9, 
  3.8242119625828223`*^9}},ExpressionUUID->"19003989-fed3-4882-88bd-\
f081c034149f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MAJORTICKS", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MINORTICKS", "=", "5"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823923958038434*^9, 3.823923969843253*^9}, {
  3.8242030579082603`*^9, 3.824203062513658*^9}, {3.8242119283454266`*^9, 
  3.8242119288105984`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"4a29aeae-9e66-4782-b4b4-86cbbd45ad40"],

Cell[TextData[{
 "The ",
 Cell[BoxData[
  FormBox["FRAMERATE", TraditionalForm]],ExpressionUUID->
  "9d0978ff-b38b-4aa6-8393-b5c2c68b088a"],
 " constant defines the framerate for output videos"
}], "Text",
 CellChangeTimes->{{3.824211967382373*^9, 
  3.824211983801593*^9}},ExpressionUUID->"a66ea96b-4f42-4f49-9643-\
94324f163c79"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FRAMERATE", "=", "30"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8242724227993927`*^9, 3.824272422878393*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"e7be79e0-5e7b-405d-8ee8-6ee260a22e2a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TeXLabel", "[", "s_String", "]"}], ":=", 
  RowBox[{"MaTeX", "[", 
   RowBox[{"s", ",", 
    RowBox[{"FontSize", "\[Rule]", "32"}], ",", 
    RowBox[{"Magnification", "\[Rule]", "1"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8241842582924356`*^9, 3.824184278331934*^9}, {
  3.8241843440766373`*^9, 3.8241843877595367`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"d403d44b-5206-47c5-81dd-bf0bb670c9e2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "ColorLegend"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ColorLegend", "[", 
    RowBox[{"scheme_String", ",", "range_Real", ",", "label_String"}], "]"}], 
   ":=", 
   RowBox[{"BarLegend", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ColorData", "[", "scheme", "]"}], "[", 
         FractionBox[
          RowBox[{"#", "+", "range"}], 
          RowBox[{"2", "range"}]], "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Abs", "@", "range"}]}], ",", 
         RowBox[{"Abs", "@", "range"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"LegendLabel", "\[Rule]", 
      RowBox[{"TeXLabel", "@", "label"}]}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8249843669662113`*^9, 3.8249844710709968`*^9}, {
  3.8249845025358324`*^9, 3.8249845364669156`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"f6419de4-5784-4e6a-af92-d6faf98e3fce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "BiColorScale"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BiColorScale", "[", 
   RowBox[{"v1_Real", ",", "v2_Real"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"BiColorScale", "[", 
    RowBox[{"v1", ",", "v2"}], "]"}], "=", 
   RowBox[{"Opacity", "[", 
    RowBox[{".5", ",", 
     RowBox[{"Blend", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}], "[", 
          "v1", "]"}], ",", 
         RowBox[{
          RowBox[{"ColorData", "[", "\"\<GreenPinkTones\>\"", "]"}], "[", 
          "v2", "]"}]}], "}"}], ",", 
       RowBox[{"2", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"v2", "-", ".5"}], ")"}], "2"]}]}], "]"}]}], 
    "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.824982018488838*^9, 3.824982021052187*^9}, {
  3.8249822463355446`*^9, 3.8249823047451673`*^9}, {3.824982369833173*^9, 
  3.824982373662141*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"c0e07ac4-e4bd-47ef-b9e7-e79090dcc5d1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "GetTicks"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetTicks", "[", 
    RowBox[{"l_Real", ",", "n_Integer"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "subx", ",", "major", ",", "minor"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "subx"}], "}"}], "=", 
       RowBox[{"FindDivisions", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["l", "2"]}], ",", 
           FractionBox["l", "2"]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"MAJORTICKS", ",", "MINORTICKS"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"major", "=", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"n", 
           RowBox[{"(", 
            RowBox[{
             FractionBox["x", "l"], "+", ".5"}], ")"}]}], ",", "x", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{".01", ",", "0"}], "}"}], ",", 
            RowBox[{"Length", "@", "x"}]}], "]"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"subx", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"DeleteDuplicates", "@", 
          RowBox[{"Flatten", "@", "subx"}]}], ",", "x"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"minor", "=", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"n", 
           RowBox[{"(", 
            RowBox[{
             FractionBox["subx", "l"], "+", ".5"}], ")"}]}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"\"\<\>\"", ",", 
            RowBox[{"Length", "@", "subx"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{".005", ",", "0"}], "}"}], ",", 
            RowBox[{"Length", "@", "subx"}]}], "]"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Join", "[", 
       RowBox[{"major", ",", "minor"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823923091814473*^9, 3.8239231301959105`*^9}, {
   3.823923171971675*^9, 3.823923217124467*^9}, {3.8239232574447947`*^9, 
   3.8239233566453705`*^9}, 3.823923531192498*^9, 3.823923562789784*^9, {
   3.8239236091549625`*^9, 3.82392374299518*^9}, {3.8239239557001486`*^9, 
   3.8239243197442455`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"7bc52b36-69fb-4b31-8e26-b63551f01026"],

Cell[TextData[{
 "Use ",
 Cell[BoxData[
  FormBox["\[Phi]2Plot", TraditionalForm]],ExpressionUUID->
  "60e822a4-b654-4e52-98c1-23a596eae84f"],
 " and ",
 Cell[BoxData[
  FormBox["\[Phi]2Plot2", TraditionalForm]],ExpressionUUID->
  "85af584e-bf43-4549-80be-62fea34b890d"],
 " to plot ",
 Cell[BoxData[
  FormBox[
   RowBox[{"|", "\[Phi]", 
    SuperscriptBox["|", "2"]}], TraditionalForm]],ExpressionUUID->
  "c27ba481-f085-4609-826b-ec8408ce712a"],
 " for a given snapshot"
}], "Text",
 CellChangeTimes->{{3.8242119947699833`*^9, 3.824212001830738*^9}, {
  3.8242120351143117`*^9, 3.82421205163988*^9}, {3.8248770300737095`*^9, 
  3.8248770345396295`*^9}},ExpressionUUID->"1f89cc16-c4a7-4229-a695-\
7ab6d2b6e65c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "\[Phi]2Plot"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2Plot", "[", "snapshot_Association", "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Phi]2Plot", "[", 
     RowBox[{"1.", ",", "1."}], "]"}], "[", "snapshot", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2Plot", "[", 
    RowBox[{"scale_Real", ",", "pow_Real"}], "]"}], "[", 
   "snapshot_Association", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "lX", ",", "nX", ",", "lY", ",", "nY", ",", "lZ", ",", "nZ", ",", "t", 
      ",", "v", ",", "data"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "lX", ",", "nX", ",", "lY", ",", "nY", ",", "lZ", ",", "nZ", ",", "t", 
        ",", "v"}], "}"}], "=", 
      RowBox[{"snapshot", "/@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<lX\>\"", ",", "\"\<nX\>\"", ",", "\"\<lY\>\"", ",", "\"\<nY\>\"",
          ",", "\"\<lZ\>\"", ",", "\"\<nZ\>\"", ",", "\"\<t\>\"", ",", 
         "\"\<v\>\""}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"Normal", "@", 
         SuperscriptBox[
          RowBox[{
           RowBox[{"snapshot", "[", "\"\<fields\>\"", "]"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}], "2"]}], "]"}],
        "/", 
       SuperscriptBox["v", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ListDensityPlot3D", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"data", ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "2", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"DataRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["lX", "2"]}], ",", 
            FractionBox["lX", "2"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["lY", "2"]}], ",", 
            FractionBox["lY", "2"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["lZ", "2"]}], ",", 
            FractionBox["lZ", "2"]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["lX", "2"]}], ",", 
            FractionBox["lX", "2"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["lY", "2"]}], ",", 
            FractionBox["lY", "2"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["lZ", "2"]}], ",", 
            FractionBox["lZ", "2"]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", "\[IndentingNewLine]", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"TeXLabel", "@", "\"\<x\>\""}], ",", 
          RowBox[{"TeXLabel", "@", "\"\<y\>\""}], ",", 
          RowBox[{"TeXLabel", "@", "\"\<z\>\""}]}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"TeXLabel", "[", 
         RowBox[{"\"\<t=\>\"", "<>", 
          RowBox[{"ToString", "@", 
           RowBox[{"DecimalForm", "[", 
            RowBox[{"t", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "2"}], "}"}]}], "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"OpacityFunction", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{"1", "-", 
             SuperscriptBox["#", "pow"]}], ",", ".1"}], "]"}], "&"}], ")"}]}],
        ",", 
       RowBox[{"OpacityFunctionScaling", "\[Rule]", "False"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ColorFunction", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", 
           RowBox[{"scale", 
            RowBox[{"(", 
             RowBox[{"1", "-", "#"}], ")"}]}], "]"}], "&"}], ")"}]}], ",", 
       RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82392797423106*^9, 3.823928139819769*^9}, {
   3.82392823024895*^9, 3.823928246222971*^9}, {3.8239283397458973`*^9, 
   3.8239283604827895`*^9}, {3.823928473796026*^9, 3.8239284834825573`*^9}, {
   3.8239286025395184`*^9, 3.8239287565611587`*^9}, {3.823928833682327*^9, 
   3.8239288357087097`*^9}, {3.8239288769263945`*^9, 3.823928900487258*^9}, {
   3.823928968905018*^9, 3.8239290649894037`*^9}, {3.823929239182889*^9, 
   3.8239292592432485`*^9}, {3.824099364981516*^9, 3.8240993717173357`*^9}, {
   3.8241843191235733`*^9, 3.82418433483665*^9}, {3.824185291617363*^9, 
   3.824185397683895*^9}, {3.8241854513977346`*^9, 3.8241854534834013`*^9}, {
   3.824188619927379*^9, 3.82418868975298*^9}, {3.8241887648847065`*^9, 
   3.824188767127432*^9}, {3.8241888801000443`*^9, 3.8241888847102575`*^9}, {
   3.8241889321507397`*^9, 3.8241889353830748`*^9}, {3.8241890219755535`*^9, 
   3.8241890224630213`*^9}, {3.824189138781062*^9, 3.8241891703748875`*^9}, {
   3.8241892475736446`*^9, 3.824189249079258*^9}, 3.8241892872242126`*^9, {
   3.8241894304707184`*^9, 3.8241894424377747`*^9}, {3.8241895170895863`*^9, 
   3.8241895179489665`*^9}, {3.8241895809527144`*^9, 
   3.8241896197360125`*^9}, {3.8241896499350986`*^9, 3.824189716768759*^9}, {
   3.8241897592139597`*^9, 3.8241898218947425`*^9}, {3.824189858467568*^9, 
   3.8241900293225374`*^9}, {3.8242039011626124`*^9, 
   3.8242039380701566`*^9}, {3.824204015083999*^9, 3.8242041676334915`*^9}, {
   3.824267364483844*^9, 3.8242673667637434`*^9}, {3.824267405232478*^9, 
   3.8242674112580013`*^9}, {3.824298780769496*^9, 3.8242988010738597`*^9}, {
   3.8248755698813725`*^9, 3.824875696481344*^9}, 3.824875735835549*^9, {
   3.8248757659305987`*^9, 3.8248757731917048`*^9}, {3.824875807052763*^9, 
   3.8248758296922646`*^9}, {3.8248758781170764`*^9, 
   3.8248758878060565`*^9}, {3.824875922938572*^9, 3.8248761215430317`*^9}, {
   3.8248761666997337`*^9, 3.824876192675622*^9}, {3.8248762332826853`*^9, 
   3.824876400715066*^9}, {3.824876551716026*^9, 3.8248765575689726`*^9}, {
   3.824876679650216*^9, 3.8248766848539376`*^9}, {3.8248767410145397`*^9, 
   3.8248767582388115`*^9}, {3.8248768869696426`*^9, 3.824876892428906*^9}, {
   3.8248791619783964`*^9, 3.8248791659598093`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"023ab5e7-0d4c-4fbd-af8f-4cae5d6da66e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "\[Phi]\[Chi]Plot"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]\[Chi]Plot", "[", 
    RowBox[{"contour_Real", ",", 
     RowBox[{"inc\[Chi]1_", "?", "BooleanQ"}], ",", 
     RowBox[{"inc\[Chi]3_", "?", "BooleanQ"}], ",", "\[Lambda]box_Real"}], 
    "]"}], "[", "snapshot_Association", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Chi]0", "=", 
       RowBox[{
        RowBox[{"Snapshot\[Chi]Range", "[", "contour", "]"}], "@", 
        "snapshot"}]}], ",", "lR", ",", "nR", ",", "\[Epsilon]", ",", "v", 
      ",", "\[Lambda]", ",", "q", ",", "\[Omega]", ",", "lX", ",", "nX", ",", 
      "lY", ",", "nY", ",", "lZ", ",", "nZ", ",", "t", ",", "\[Phi]data", ",",
       "xs", ",", "dx", ",", "ys", ",", "dy", ",", "zs", ",", "dz", ",", 
      "\[Chi]1", ",", "\[Chi]2", ",", "\[Chi]3", ",", "color", ",", "legend", 
      ",", "plot", ",", "stepsxs", ",", "stepsys", ",", "stepszs"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "lR", ",", "nR", ",", "\[Epsilon]", ",", "v", ",", "\[Lambda]", ",", 
        "q", ",", "\[Omega]", ",", "lX", ",", "nX", ",", "lY", ",", "nY", ",",
         "lZ", ",", "nZ", ",", "t"}], "}"}], "=", 
      RowBox[{"snapshot", "/@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<lR\>\"", ",", "\"\<nR\>\"", ",", "\"\<\[Epsilon]\>\"", ",", 
         "\"\<v\>\"", ",", "\"\<\[Lambda]\>\"", ",", "\"\<q\>\"", ",", 
         "\"\<\[Omega]\>\"", ",", "\"\<lX\>\"", ",", "\"\<nX\>\"", ",", 
         "\"\<lY\>\"", ",", "\"\<nY\>\"", ",", "\"\<lZ\>\"", ",", 
         "\"\<nZ\>\"", ",", "\"\<t\>\""}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Phi]data", "=", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"Normal", "@", 
         SuperscriptBox[
          RowBox[{
           RowBox[{"snapshot", "[", "\"\<fields\>\"", "]"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{";;", "2"}], "\[RightDoubleBracket]"}], "2"]}], "]"}], "/", 
       SuperscriptBox["v", "2"]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xs", ",", "dx"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ys", ",", "dy"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"zs", ",", "dz"}], "}"}]}], "}"}], "=", 
      RowBox[{"Grid3D", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lX", ",", "nX"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"lY", ",", "nY"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Chi]1", "=", 
      RowBox[{"If", "[", 
       RowBox[{"inc\[Chi]1", ",", 
        RowBox[{"Interpolation", "@", 
         RowBox[{"Transpose", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Tuples", "@", 
             RowBox[{"{", 
              RowBox[{"xs", ",", "ys", ",", "zs"}], "}"}]}], ",", 
            RowBox[{"Flatten", "@", 
             RowBox[{"Normal", "@", 
              RowBox[{
               RowBox[{"snapshot", "[", "\"\<fields\>\"", "]"}], 
               "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}]}], 
           "}"}]}]}], ",", 
        RowBox[{"0", "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Chi]2", "=", 
      RowBox[{"Interpolation", "@", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Tuples", "@", 
           RowBox[{"{", 
            RowBox[{"xs", ",", "ys", ",", "zs"}], "}"}]}], ",", 
          RowBox[{"Flatten", "@", 
           RowBox[{"Normal", "@", 
            RowBox[{
             RowBox[{"snapshot", "[", "\"\<fields\>\"", "]"}], 
             "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}]}]}], 
         "}"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Chi]3", "=", 
      RowBox[{"If", "[", 
       RowBox[{"inc\[Chi]3", ",", 
        RowBox[{"Interpolation", "@", 
         RowBox[{"Transpose", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Tuples", "@", 
             RowBox[{"{", 
              RowBox[{"xs", ",", "ys", ",", "zs"}], "}"}]}], ",", 
            RowBox[{"Flatten", "@", 
             RowBox[{"Normal", "@", 
              RowBox[{
               RowBox[{"snapshot", "[", "\"\<fields\>\"", "]"}], 
               "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}]}]}], 
           "}"}]}]}], ",", 
        RowBox[{"0", "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"color", "[", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"inc\[Chi]1", ",", "\[IndentingNewLine]", 
        RowBox[{"BiColorScale", "[", 
         RowBox[{
          RowBox[{"Round", "[", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"\[Chi]2", "[", 
               RowBox[{"x", ",", "y", ",", "z"}], "]"}], "+", "\[Chi]0"}], 
             RowBox[{"2", "\[Chi]0"}]], ",", ".01"}], "]"}], ",", 
          RowBox[{"Round", "[", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"-", 
               RowBox[{"\[Chi]1", "[", 
                RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "+", "\[Chi]0"}], 
             RowBox[{"2", "\[Chi]0"}]], ",", ".01"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"inc\[Chi]3", ",", "\[IndentingNewLine]", 
          RowBox[{"BiColorScale", "[", 
           RowBox[{
            RowBox[{"Round", "[", 
             RowBox[{
              FractionBox[
               RowBox[{
                RowBox[{"\[Chi]2", "[", 
                 RowBox[{"x", ",", "y", ",", "z"}], "]"}], "+", "\[Chi]0"}], 
               RowBox[{"2", "\[Chi]0"}]], ",", ".01"}], "]"}], ",", 
            RowBox[{"Round", "[", 
             RowBox[{
              FractionBox[
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"\[Chi]3", "[", 
                  RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "+", 
                "\[Chi]0"}], 
               RowBox[{"2", "\[Chi]0"}]], ",", ".01"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Opacity", "[", 
           RowBox[{".5", ",", 
            RowBox[{
             RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}], "[", 
             FractionBox[
              RowBox[{
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"x", ",", "y", ",", "z"}], "]"}], "+", "\[Chi]0"}], 
              RowBox[{"2", "\[Chi]0"}]], "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"legend", "=", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"inc\[Chi]1", ",", "\[IndentingNewLine]", 
        RowBox[{"Row", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ColorLegend", "[", 
            RowBox[{"\"\<GreenPinkTones\>\"", ",", 
             RowBox[{"-", "\[Chi]0"}], ",", "\"\<\\\\chi_1\>\""}], "]"}], ",", 
           RowBox[{"ColorLegend", "[", 
            RowBox[{
            "\"\<TemperatureMap\>\"", ",", "\[Chi]0", ",", 
             "\"\<\\\\chi_2\>\""}], "]"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"inc\[Chi]3", ",", "\[IndentingNewLine]", 
          RowBox[{"Row", "@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ColorLegend", "[", 
              RowBox[{
              "\"\<TemperatureMap\>\"", ",", "\[Chi]0", ",", 
               "\"\<\\\\chi_2\>\""}], "]"}], ",", 
             RowBox[{"ColorLegend", "[", 
              RowBox[{"\"\<GreenPinkTones\>\"", ",", 
               RowBox[{"-", "\[Chi]0"}], ",", "\"\<\\\\chi_3\>\""}], "]"}]}], 
            "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"ColorLegend", "[", 
           RowBox[{
           "\"\<TemperatureMap\>\"", ",", "\[Chi]0", ",", 
            "\"\<\\\\chi_2\>\""}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"plot", "=", 
      RowBox[{"ListContourPlot3D", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"\[Phi]data", ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "2", ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"DataRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["lX", "2"]}], ",", 
             FractionBox["lX", "2"]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["lY", "2"]}], ",", 
             FractionBox["lY", "2"]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["lZ", "2"]}], ",", 
             FractionBox["lZ", "2"]}], "}"}]}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Lambda]box", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", 
               FractionBox["lX", "2"]}], ",", 
              FractionBox["lX", "2"]}], "}"}]}], ",", 
           RowBox[{"\[Lambda]box", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", 
               FractionBox["lY", "2"]}], ",", 
              FractionBox["lY", "2"]}], "}"}]}], ",", 
           RowBox[{"\[Lambda]box", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", 
               FractionBox["lZ", "2"]}], ",", 
              FractionBox["lZ", "2"]}], "}"}]}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"TeXLabel", "@", "\"\<x\>\""}], ",", 
           RowBox[{"TeXLabel", "@", "\"\<y\>\""}], ",", 
           RowBox[{"TeXLabel", "@", "\"\<z\>\""}]}], "}"}]}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"TeXLabel", "[", 
          RowBox[{"\"\<t=\>\"", "<>", 
           RowBox[{"ToString", "@", 
            RowBox[{"DecimalForm", "[", 
             RowBox[{"t", ",", 
              RowBox[{"{", 
               RowBox[{"4", ",", "2"}], "}"}]}], "]"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Contours", "\[Rule]", 
         RowBox[{"{", "contour", "}"}]}], ",", 
        RowBox[{"Mesh", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
        RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Quality\>\""}], ",", 
        RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Legended", "[", 
      RowBox[{
       RowBox[{"plot", "/.", 
        RowBox[{
         RowBox[{"GraphicsComplex", "[", 
          RowBox[{"coords_", ",", "data_", ",", "options__"}], "]"}], 
         "\[RuleDelayed]", 
         RowBox[{"GraphicsComplex", "[", 
          RowBox[{"coords", ",", "data", ",", "options", ",", 
           RowBox[{"VertexColors", "\[Rule]", 
            RowBox[{"color", "/@", "coords"}]}]}], "]"}]}]}], ",", "legend"}],
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8248732186215715`*^9, 3.8248732754357634`*^9}, {
   3.8248733354025946`*^9, 3.824873619012109*^9}, {3.8248737011751275`*^9, 
   3.824873701347598*^9}, {3.8248737332490177`*^9, 3.824873769702985*^9}, {
   3.8248738029400263`*^9, 3.824873804974728*^9}, {3.824873861274317*^9, 
   3.8248740391830745`*^9}, {3.824874110095499*^9, 3.8248741114936485`*^9}, {
   3.824874216449646*^9, 3.8248742636176343`*^9}, {3.824874310757036*^9, 
   3.8248743230105295`*^9}, {3.8248743540676675`*^9, 3.82487438450975*^9}, {
   3.8248744572489495`*^9, 3.824874593703916*^9}, {3.8248746247110367`*^9, 
   3.824874765157715*^9}, {3.82487480427109*^9, 3.824875027254625*^9}, {
   3.824875075889077*^9, 3.8248750791496153`*^9}, {3.824875113513723*^9, 
   3.8248751741869764`*^9}, {3.824875230882244*^9, 3.82487525394064*^9}, {
   3.82487532624161*^9, 3.8248753420469637`*^9}, {3.824875377465579*^9, 
   3.824875380862054*^9}, {3.824875412120886*^9, 3.824875475065484*^9}, {
   3.824875523508093*^9, 3.824875538720596*^9}, {3.8248757217487645`*^9, 
   3.824875758371295*^9}, {3.824876773015751*^9, 3.824876779197568*^9}, {
   3.824876824171126*^9, 3.8248769613445597`*^9}, {3.824877534236532*^9, 
   3.824877543495103*^9}, 3.8248791589900846`*^9, {3.824882202402113*^9, 
   3.824882237159734*^9}, {3.8248822733887653`*^9, 3.8248827643333097`*^9}, {
   3.82488281995706*^9, 3.8248829413065276`*^9}, {3.824883014859762*^9, 
   3.824883075033721*^9}, {3.8248831083489695`*^9, 3.8248831437721596`*^9}, {
   3.824884615671008*^9, 3.8248846246900716`*^9}, {3.8249841315743694`*^9, 
   3.824984142579255*^9}, {3.8249841826285048`*^9, 3.8249842421450276`*^9}, {
   3.8249843073479815`*^9, 3.8249843360104136`*^9}, {3.8249845858698835`*^9, 
   3.824984724807763*^9}, {3.8249847645220013`*^9, 3.8249848953066916`*^9}, {
   3.8249849516851892`*^9, 3.824984971043666*^9}, {3.8249850610572553`*^9, 
   3.824985121372922*^9}, {3.824985257929776*^9, 3.8249852812623053`*^9}, {
   3.8249853161448956`*^9, 3.8249854034021497`*^9}, {3.8249854375529795`*^9, 
   3.824985443490842*^9}, 3.824985497772382*^9, {3.8249855440483913`*^9, 
   3.8249855769071617`*^9}, {3.824985638897813*^9, 3.8249857243772583`*^9}, {
   3.82498575841278*^9, 3.8249858407131176`*^9}, {3.8249858832283754`*^9, 
   3.8249860678047514`*^9}, {3.8249885039682536`*^9, 3.824988617841795*^9}, {
   3.8302628447875967`*^9, 3.8302628491960664`*^9}, {3.8302629184600534`*^9, 
   3.8302629202467227`*^9}, {3.830263687751649*^9, 3.8302638734447985`*^9}, {
   3.830264080577836*^9, 3.830264082342244*^9}, {3.8636290420229635`*^9, 
   3.863629074976954*^9}, {3.863629112929903*^9, 3.863629167187612*^9}, {
   3.8636292078326845`*^9, 3.863629208186326*^9}, {3.8636292518595977`*^9, 
   3.8636292521524305`*^9}, {3.863629619949751*^9, 3.863629620461671*^9}, {
   3.8636299099953976`*^9, 3.8636299221507535`*^9}, {3.868092663046764*^9, 
   3.8680926918441343`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"b78f5dd9-e99b-49e7-aeec-682b0e5b0aa1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "BPlot"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BPlot", "[", 
    RowBox[{"contour_Real", ",", 
     RowBox[{"inc\[Chi]1_", "?", "BooleanQ"}], ",", 
     RowBox[{"inc\[Chi]3_", "?", "BooleanQ"}], ",", "\[Lambda]box_Real", ",", 
     "skip_Integer", ",", "\[Lambda]1_Real"}], "]"}], "[", 
   "snapshot_Association", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"\[Chi]0", "=", 
        RowBox[{
         RowBox[{"Snapshot\[Chi]Range", "[", "contour", "]"}], "@", 
         "snapshot"}]}], ","}], "*)"}], 
     RowBox[{
     "lR", ",", "nR", ",", "\[Epsilon]", ",", "v", ",", "\[Lambda]", ",", "q",
       ",", "\[Omega]", ",", "lX", ",", "nX", ",", "lY", ",", "nY", ",", "lZ",
       ",", "nZ", ",", "t", ",", "Bdata", ",", "xs", ",", "dx", ",", "ys", 
      ",", "dy", ",", "zs", ",", "dz", ",", "\[Chi]1", ",", "\[Chi]2", ",", 
      "\[Chi]3", ",", "Ax", ",", "Ay", ",", "Az", ",", "color", ",", "legend",
       ",", "plot", ",", "stepsxs", ",", "stepsys", ",", "stepszs", ",", 
      "\[Phi]data", ",", 
      RowBox[{"kerOrderX", "=", "2"}], ",", "Ddx", ",", "Ddy", ",", "Ddz", 
      ",", "DyAx", ",", "DzAx", ",", "DyAz", ",", "DxAz", ",", "DxAy", ",", 
      "DzAy", ",", "DyAxp", ",", "DzAxp", ",", "DyAzp", ",", "DxAzp", ",", 
      "DxAyp", ",", "DzAyp", ",", "Bforplot", ",", "bdata2", ",", "pp", ",", 
      "\[Phi]data0"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "lR", ",", "nR", ",", "\[Epsilon]", ",", "v", ",", "\[Lambda]", ",", 
        "q", ",", "\[Omega]", ",", "lX", ",", "nX", ",", "lY", ",", "nY", ",",
         "lZ", ",", "nZ", ",", "t"}], "}"}], "=", 
      RowBox[{"snapshot", "/@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<lR\>\"", ",", "\"\<nR\>\"", ",", "\"\<\[Epsilon]\>\"", ",", 
         "\"\<v\>\"", ",", "\"\<\[Lambda]\>\"", ",", "\"\<q\>\"", ",", 
         "\"\<\[Omega]\>\"", ",", "\"\<lX\>\"", ",", "\"\<nX\>\"", ",", 
         "\"\<lY\>\"", ",", "\"\<nY\>\"", ",", "\"\<lZ\>\"", ",", 
         "\"\<nZ\>\"", ",", "\"\<t\>\""}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xs", ",", "dx"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ys", ",", "dy"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"zs", ",", "dz"}], "}"}]}], "}"}], "=", 
      RowBox[{"Grid3D", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lX", ",", "nX"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"lY", ",", "nY"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Phi]data0", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Normal", "@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"Normal", "@", 
            SuperscriptBox[
             RowBox[{
              RowBox[{"snapshot", "[", "\"\<fields\>\"", "]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{";;", "2"}], "\[RightDoubleBracket]"}], "2"]}], "]"}], 
          "/", 
          SuperscriptBox["v", "2"]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Phi]data", "=", 
      RowBox[{"Interpolation", "@", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Tuples", "@", 
           RowBox[{"{", 
            RowBox[{"xs", ",", "ys", ",", "zs"}], "}"}]}], ",", 
          RowBox[{"Flatten", "@", 
           RowBox[{"Normal", "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Total", "[", 
               RowBox[{"Normal", "@", 
                SuperscriptBox[
                 RowBox[{
                  RowBox[{"snapshot", "[", "\"\<fields\>\"", "]"}], 
                  "\[LeftDoubleBracket]", 
                  RowBox[{";;", "2"}], "\[RightDoubleBracket]"}], "2"]}], 
               "]"}], "/", 
              SuperscriptBox["v", "2"]}], ")"}]}]}]}], "}"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Ddx", "=", 
      RowBox[{
       RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
        RowBox[{
         RowBox[{"Derivative", "[", 
          RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"xs", ",", "ys", ",", "zs"}], "}"}], ",", 
         RowBox[{"\"\<DifferenceOrder\>\"", "\[Rule]", "2"}]}], "]"}], "[", 
       "\"\<DifferentiationMatrix\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ddy", "=", 
      RowBox[{
       RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
        RowBox[{
         RowBox[{"Derivative", "[", 
          RowBox[{"0", ",", "1", ",", "0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"xs", ",", "ys", ",", "zs"}], "}"}], ",", 
         RowBox[{"\"\<DifferenceOrder\>\"", "\[Rule]", "2"}]}], "]"}], "[", 
       "\"\<DifferentiationMatrix\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ddz", "=", 
      RowBox[{
       RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
        RowBox[{
         RowBox[{"Derivative", "[", 
          RowBox[{"0", ",", "0", ",", "1"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"xs", ",", "ys", ",", "zs"}], "}"}], ",", 
         RowBox[{"\"\<DifferenceOrder\>\"", "\[Rule]", "2"}]}], "]"}], "[", 
       "\"\<DifferentiationMatrix\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Ax", "=", 
        RowBox[{"Interpolation", "@", 
         RowBox[{"Transpose", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Tuples", "@", 
             RowBox[{"{", 
              RowBox[{"xs", ",", "ys", ",", "zs"}], "}"}]}], ",", 
            RowBox[{"Flatten", "@", 
             RowBox[{"Normal", "@", 
              RowBox[{
               RowBox[{"snapshot", "[", "\"\<fields\>\"", "]"}], 
               "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}]}]}]}], 
           "}"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Ay", "=", 
        RowBox[{"Interpolation", "@", 
         RowBox[{"Transpose", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Tuples", "@", 
             RowBox[{"{", 
              RowBox[{"xs", ",", "ys", ",", "zs"}], "}"}]}], ",", 
            RowBox[{"Flatten", "@", 
             RowBox[{"Normal", "@", 
              RowBox[{
               RowBox[{"snapshot", "[", "\"\<fields\>\"", "]"}], 
               "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}]}]}]}], 
           "}"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Az", "=", 
        RowBox[{"Interpolation", "@", 
         RowBox[{"Transpose", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Tuples", "@", 
             RowBox[{"{", 
              RowBox[{"xs", ",", "ys", ",", "zs"}], "}"}]}], ",", 
            RowBox[{"Flatten", "@", 
             RowBox[{"Normal", "@", 
              RowBox[{
               RowBox[{"snapshot", "[", "\"\<fields\>\"", "]"}], 
               "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}]}]}]}], 
           "}"}]}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Ax", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Normal", "@", 
        RowBox[{
         RowBox[{"snapshot", "[", "\"\<fields\>\"", "]"}], 
         "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Ay", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Normal", "@", 
        RowBox[{
         RowBox[{"snapshot", "[", "\"\<fields\>\"", "]"}], 
         "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Az", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Normal", "@", 
        RowBox[{
         RowBox[{"snapshot", "[", "\"\<fields\>\"", "]"}], 
         "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"DyAx", "=", 
      RowBox[{"Ddy", ".", "Ax"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DzAx", "=", 
      RowBox[{"Ddz", ".", "Ax"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DyAz", "=", 
      RowBox[{"Ddy", ".", "Az"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DxAz", "=", 
      RowBox[{"Ddx", ".", "Az"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DxAy", "=", 
      RowBox[{"Ddx", ".", "Ay"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DzAy", "=", 
      RowBox[{"Ddz", ".", "Ay"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Bdata", "=", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "DzAy"}], "+", "DyAz"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "DyAx"}], "+", "DxAy"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "DxAz"}], "+", "DzAx"}], ")"}], "2"]}]}], ";"}], 
      "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"DyAxp", "=", 
      RowBox[{
       RowBox[{"Nest", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Partition", "[", 
           RowBox[{"#", ",", "nX"}], "]"}], "&"}], ",", "DyAx", ",", "3"}], 
        "]"}], "//", "First"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DzAxp", "=", 
      RowBox[{
       RowBox[{"Nest", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Partition", "[", 
           RowBox[{"#", ",", "nX"}], "]"}], "&"}], ",", "DzAx", ",", "3"}], 
        "]"}], "//", "First"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DyAzp", "=", 
      RowBox[{
       RowBox[{"Nest", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Partition", "[", 
           RowBox[{"#", ",", "nX"}], "]"}], "&"}], ",", "DyAz", ",", "3"}], 
        "]"}], "//", "First"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DxAzp", "=", 
      RowBox[{
       RowBox[{"Nest", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Partition", "[", 
           RowBox[{"#", ",", "nX"}], "]"}], "&"}], ",", "DxAz", ",", "3"}], 
        "]"}], "//", "First"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DxAyp", "=", 
      RowBox[{
       RowBox[{"Nest", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Partition", "[", 
           RowBox[{"#", ",", "nX"}], "]"}], "&"}], ",", "DxAy", ",", "3"}], 
        "]"}], "//", "First"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DzAyp", "=", 
      RowBox[{
       RowBox[{"Nest", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Partition", "[", 
           RowBox[{"#", ",", "nX"}], "]"}], "&"}], ",", "DzAy", ",", "3"}], 
        "]"}], "//", "First"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Bdatavec", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "DzAyp"}], "+", "DyAzp"}], ")"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "DxAzp"}], "+", "DzAxp"}], ")"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "DyAxp"}], "+", "DxAyp"}], ")"}]}], "}"}]}], ";"}], 
      "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"pp", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "DzAyp"}], "+", "DyAzp"}], ")"}], "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "DxAzp"}], "+", "DzAxp"}], ")"}], "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "DyAxp"}], "+", "DxAyp"}], ")"}], "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nX", ",", "skip"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "nY", ",", "skip"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "nZ", ",", "skip"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"pp2", "=", 
        RowBox[{"Tuples", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "DzAyp"}], "+", "DyAzp"}], ")"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "DxAzp"}], "+", "DzAxp"}], ")"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "DyAxp"}], "+", "DxAyp"}], ")"}]}], "}"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"pp3", "=", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{"pp2", ",", "nX"}], "]"}], "//", "Dimensions"}]}]}], "*)"}],
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ListVectorPlot3D", "[", 
      RowBox[{"pp", ",", 
       RowBox[{"DataRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Lambda]1", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "lX"}], "/", "2"}], ",", 
             RowBox[{"lX", "/", "2"}]}], "}"}]}], ",", 
          RowBox[{"\[Lambda]1", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "lY"}], "/", "2"}], ",", 
             RowBox[{"lY", "/", "2"}]}], "}"}]}], ",", 
          RowBox[{"\[Lambda]1", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "lZ"}], "/", "2"}], ",", 
             RowBox[{"lZ", "/", "2"}]}], "}"}]}]}], "}"}]}], ",", 
       RowBox[{"VectorSizes", "\[Rule]", "2"}], ",", 
       RowBox[{"VectorScaling", "->", "Automatic"}], ",", 
       RowBox[{"VectorPoints", "\[Rule]", "15"}], ",", 
       RowBox[{"Mesh", "->", "False"}], ",", 
       RowBox[{"RegionFunction", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
           RowBox[{
            RowBox[{"\[Phi]data", "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}], "<", "0.995"}]}], 
          "]"}], ")"}]}], ",", 
       RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.872323692033218*^9, 3.872323694023489*^9}, {
   3.8723243755513225`*^9, 3.8723244126379166`*^9}, {3.8723297813166666`*^9, 
   3.872329782812992*^9}, {3.872329862380387*^9, 3.8723299167342873`*^9}, {
   3.8723299545548887`*^9, 3.872329969829489*^9}, {3.8723300197924156`*^9, 
   3.8723301287982516`*^9}, {3.872330269267745*^9, 3.872330271463751*^9}, {
   3.872331902632866*^9, 3.8723319353427167`*^9}, {3.872333042070998*^9, 
   3.8723330891261945`*^9}, {3.8723331477984676`*^9, 
   3.8723331817216167`*^9}, {3.8723332316535835`*^9, 3.872333432012562*^9}, {
   3.8723334652668543`*^9, 3.8723334684597816`*^9}, {3.872333750400669*^9, 
   3.8723337562803955`*^9}, {3.8723346250878243`*^9, 3.872334695658009*^9}, {
   3.872334791984767*^9, 3.8723348211838284`*^9}, {3.872335354286291*^9, 
   3.872335365586827*^9}, {3.8723356226335225`*^9, 3.872335626824597*^9}, {
   3.872335829952794*^9, 3.872335837000723*^9}, {3.8723360241533947`*^9, 
   3.8723360379870543`*^9}, {3.8723361046932826`*^9, 
   3.8723361084703813`*^9}, {3.87233621078566*^9, 3.8723362305417423`*^9}, {
   3.872336281387936*^9, 3.8723362977838435`*^9}, {3.872336339573547*^9, 
   3.87233633982232*^9}, {3.8723363941964593`*^9, 3.872336419446656*^9}, {
   3.8723365143719215`*^9, 3.872336525362812*^9}, {3.872336576884262*^9, 
   3.8723365954234314`*^9}, {3.8723367126082907`*^9, 
   3.8723367245907507`*^9}, {3.8723370659444394`*^9, 3.872337070386346*^9}, {
   3.872337234838231*^9, 3.872337237939412*^9}, {3.8723372901692443`*^9, 
   3.872337295431476*^9}, {3.872410252058942*^9, 3.872410295433268*^9}, {
   3.872410360660679*^9, 3.8724103780868855`*^9}, {3.8724104803255525`*^9, 
   3.872410488876672*^9}, {3.8724107616020703`*^9, 3.8724107987407436`*^9}, {
   3.872410895940032*^9, 3.872410910663881*^9}, {3.872411052451882*^9, 
   3.872411054418292*^9}, {3.8724111534024744`*^9, 3.8724112741793613`*^9}, {
   3.8724113080373735`*^9, 3.872411314970792*^9}, {3.872411354404874*^9, 
   3.8724114999751062`*^9}, {3.872411536714321*^9, 3.872411598204605*^9}, {
   3.8724116503452606`*^9, 3.8724116546048203`*^9}, {3.8724118305459805`*^9, 
   3.8724118570161743`*^9}, {3.8724120608623953`*^9, 
   3.8724120621893635`*^9}, {3.8724121427606726`*^9, 
   3.8724121678540907`*^9}, {3.8724124595131006`*^9, 
   3.8724124821264806`*^9}, {3.872412528455793*^9, 3.8724125327282953`*^9}, {
   3.8724136330287027`*^9, 3.872413638864397*^9}, {3.872413722064125*^9, 
   3.8724137334484835`*^9}, {3.87241392284067*^9, 3.872413923021985*^9}, {
   3.8724140104013906`*^9, 3.8724140203218603`*^9}, {3.87241409807056*^9, 
   3.872414104009117*^9}, {3.872414179872655*^9, 3.87241421384208*^9}, {
   3.872414244864731*^9, 3.8724142450696497`*^9}, {3.8724143023049245`*^9, 
   3.8724143024979415`*^9}, 3.872414339716817*^9, {3.8724144152757006`*^9, 
   3.872414425601199*^9}, {3.8724158294859886`*^9, 3.8724158479355373`*^9}, 
   3.872415890052889*^9, {3.872416051622398*^9, 3.8724160645127735`*^9}, {
   3.8724161304484615`*^9, 3.872416141878069*^9}, {3.8724162053108377`*^9, 
   3.872416214709835*^9}, {3.8724232497555857`*^9, 3.8724233307862625`*^9}, {
   3.872423373316401*^9, 3.8724233955164633`*^9}, {3.872423483025421*^9, 
   3.8724234855784283`*^9}, {3.872423518357853*^9, 3.8724235191912155`*^9}, {
   3.8724235588669987`*^9, 3.8724235826436005`*^9}, {3.8724237249745607`*^9, 
   3.8724237340802965`*^9}, {3.872424104482582*^9, 3.872424116372472*^9}, {
   3.872424250462429*^9, 3.8724242550963297`*^9}, {3.872424407886347*^9, 
   3.8724244093538733`*^9}, {3.8725881132741957`*^9, 
   3.8725881226321545`*^9}, {3.872588712435278*^9, 3.8725887133729863`*^9}, {
   3.87258906520498*^9, 3.872589075659237*^9}, {3.8725891200517654`*^9, 
   3.8725891205876083`*^9}, {3.872589794339161*^9, 3.872589800678049*^9}, {
   3.872589844108249*^9, 3.8725898611479793`*^9}, 3.872589992330765*^9, {
   3.872590135711911*^9, 3.8725901491815996`*^9}, {3.872590564641379*^9, 
   3.8725905678761253`*^9}, {3.872590608450515*^9, 3.8725906109073715`*^9}, {
   3.8725908478405657`*^9, 3.8725908707750053`*^9}, {3.8725909849641314`*^9, 
   3.8725910016883*^9}, {3.8725911037466965`*^9, 3.8725911043134623`*^9}, {
   3.872591170201745*^9, 3.87259117287754*^9}, {3.872591228394929*^9, 
   3.8725912425765944`*^9}, {3.872592633197234*^9, 3.8725926689483986`*^9}, 
   3.8725927393698587`*^9, {3.8725928433500752`*^9, 3.8725928435636396`*^9}, 
   3.8725928942669907`*^9, {3.872592952679781*^9, 3.872592953216754*^9}, {
   3.8725930178135777`*^9, 3.8725930244667277`*^9}, {3.8725930696242375`*^9, 
   3.8725930711653037`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"91681008-2f71-4920-a7ed-a34b4f8d84b4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "\[Chi]Plot"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Chi]Plot", "[", "i_Integer", "]"}], "[", 
    "snapshot_Association", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Chi]Plot", "[", "i", "]"}], "[", 
     RowBox[{"1.", ",", "2."}], "]"}], "[", "snapshot", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Chi]Plot", "[", "i_Integer", "]"}], "[", 
    RowBox[{"scale_Real", ",", "pow_Real"}], "]"}], "[", 
   "snapshot_Association", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{
         RowBox[{"snapshot", "[", "\"\<fields\>\"", "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"2", "+", "i"}], "\[RightDoubleBracket]"}], "]"}]}], ",", 
      "lX", ",", "nX", ",", "lY", ",", "nY", ",", "lZ", ",", "nZ", ",", 
      "\[Chi]0", ",", "color"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "lX", ",", "nX", ",", "lY", ",", "nY", ",", "lZ", ",", "nZ", ",", 
        "\[Chi]0"}], "}"}], "=", 
      RowBox[{"snapshot", "/@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<lX\>\"", ",", "\"\<nX\>\"", ",", "\"\<lY\>\"", ",", "\"\<nY\>\"",
          ",", "\"\<lZ\>\"", ",", "\"\<nZ\>\"", ",", "\"\<\[Chi]0\>\""}], 
        "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"color", "=", 
      RowBox[{
       RowBox[{"Opacity", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"2", "#"}], "-", "1"}], "]"}], "pow"], ",", 
         RowBox[{
          RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "@", "#"}]}], 
        "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"Image3D", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"scale", 
            RowBox[{"(", 
             RowBox[{".5", "+", 
              FractionBox["data", 
               RowBox[{"2", "\[Chi]0"}]]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "2", ",", "1"}], "}"}]}], "]"}], ",", 
         "\"\<Real32\>\"", ",", 
         RowBox[{"ColorFunction", "\[Rule]", "color"}]}], "]"}], ",", 
       RowBox[{"Boxed", "\[Rule]", "True"}], ",", 
       RowBox[{"Axes", "\[Rule]", "True"}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"TeXLabel", "@", "\"\<x\>\""}], ",", 
          RowBox[{"TeXLabel", "@", "\"\<y\>\""}], ",", 
          RowBox[{"TeXLabel", "@", "\"\<z\>\""}]}], "}"}]}], ",", 
       RowBox[{"BoxRatios", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"lX", ",", "lY", ",", "lZ"}], "}"}]}], ",", 
       RowBox[{"Ticks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"GetTicks", "[", 
           RowBox[{"lX", ",", "nX"}], "]"}], ",", 
          RowBox[{"GetTicks", "[", 
           RowBox[{"lY", ",", "nY"}], "]"}], ",", 
          RowBox[{"GetTicks", "[", 
           RowBox[{"lZ", ",", "nZ"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82392797423106*^9, 3.823928139819769*^9}, {
   3.82392823024895*^9, 3.823928246222971*^9}, {3.8239283397458973`*^9, 
   3.8239283604827895`*^9}, {3.823928473796026*^9, 3.8239284834825573`*^9}, {
   3.8239286025395184`*^9, 3.8239287565611587`*^9}, {3.823928833682327*^9, 
   3.8239288357087097`*^9}, {3.8239288769263945`*^9, 3.823928900487258*^9}, {
   3.823928968905018*^9, 3.8239290649894037`*^9}, {3.823929239182889*^9, 
   3.8239292592432485`*^9}, {3.824099364981516*^9, 3.8240993717173357`*^9}, {
   3.8241843191235733`*^9, 3.82418433483665*^9}, {3.824185291617363*^9, 
   3.824185397683895*^9}, {3.8241854513977346`*^9, 3.8241854534834013`*^9}, {
   3.824188619927379*^9, 3.82418868975298*^9}, {3.8241887648847065`*^9, 
   3.824188767127432*^9}, {3.8241888801000443`*^9, 3.8241888847102575`*^9}, {
   3.8241889321507397`*^9, 3.8241889353830748`*^9}, {3.8241890219755535`*^9, 
   3.8241890224630213`*^9}, {3.824189138781062*^9, 3.8241891703748875`*^9}, {
   3.8241892475736446`*^9, 3.824189249079258*^9}, 3.8241892872242126`*^9, {
   3.8241894304707184`*^9, 3.8241894424377747`*^9}, {3.8241895170895863`*^9, 
   3.8241895179489665`*^9}, {3.8241895809527144`*^9, 
   3.8241896197360125`*^9}, {3.8241896499350986`*^9, 3.824189716768759*^9}, {
   3.8241897592139597`*^9, 3.8241898218947425`*^9}, {3.824189858467568*^9, 
   3.8241900293225374`*^9}, {3.8242030789851313`*^9, 3.824203234628251*^9}, {
   3.824203419507112*^9, 3.8242034348004518`*^9}, {3.82420421222593*^9, 
   3.8242042593837924`*^9}, {3.8242042960003014`*^9, 
   3.8242043769900217`*^9}, {3.824204434284212*^9, 3.8242044369404564`*^9}, {
   3.824204477867696*^9, 3.824204565800352*^9}, {3.824204598006181*^9, 
   3.824204705160427*^9}, {3.8242673786727743`*^9, 3.8242673907094297`*^9}, {
   3.8242674235619097`*^9, 3.8242674327499704`*^9}, {3.824298794905631*^9, 
   3.824298813264415*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"a2ada6d9-9e60-4449-bcb7-fe520d688e06"],

Cell[TextData[{
 "Use ",
 Cell[BoxData[
  FormBox["MakeVideo", TraditionalForm]],ExpressionUUID->
  "1aeeb8dc-d72c-4f28-b35a-fbce8cdc76f4"],
 " to create a video from the simulation data, using ",
 Cell[BoxData[
  FormBox["plottingFunction", TraditionalForm]],ExpressionUUID->
  "97a645c8-0ed7-4f2e-be32-79cff3fd825a"],
 " to generate the video frames"
}], "Text",
 CellChangeTimes->{{3.824212124986745*^9, 3.8242121553044276`*^9}, {
  3.8242122081423583`*^9, 
  3.8242122458088565`*^9}},ExpressionUUID->"2e9b00f3-e1bb-4480-adff-\
441dc7640061"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "MakeVideo"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeVideo", "[", "plottingFunction_", "]"}], "[", 
   RowBox[{"simulation_Association", ",", 
    RowBox[{"skip_Integer", ":", "1"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"time", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ",", 
      RowBox[{"snapshots", "=", 
       RowBox[{
        RowBox[{"simulation", "[", "\"\<snapshots\>\"", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{";;", ";;", "skip"}], "\[RightDoubleBracket]"}]}]}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PrintTemporary", "@", 
      RowBox[{"ProgressIndicator", "[", 
       RowBox[{
        RowBox[{"Dynamic", "@", "i"}], ",", 
        RowBox[{"MinMax", "@", "snapshots"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"plots", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Rasterize", "@", 
         RowBox[{"plottingFunction", "@", 
          RowBox[{"SimulationSnapshot", "[", 
           RowBox[{"simulation", ",", "i"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "snapshots"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Video frames generated in \>\"", ",", 
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"AbsoluteTime", "[", "]"}], "-", "time"}], ",", 
         "\"\<s\>\""}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AnimatedImage", "[", 
      RowBox[{"plots", ",", 
       RowBox[{"FrameRate", "\[Rule]", "FRAMERATE"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82409852113439*^9, 3.8240986588824444`*^9}, {
   3.8240986976187744`*^9, 3.8240987185640497`*^9}, {3.8240988484397764`*^9, 
   3.8240990575949044`*^9}, {3.8240991368349466`*^9, 
   3.8240991808649783`*^9}, {3.824099221251857*^9, 3.8240992643736954`*^9}, {
   3.82409933378102*^9, 3.824099345858227*^9}, {3.8241004708592443`*^9, 
   3.824100655229224*^9}, {3.8241006923822165`*^9, 3.82410069277979*^9}, {
   3.8241007240872884`*^9, 3.8241007261899724`*^9}, {3.8241007592609835`*^9, 
   3.82410080492626*^9}, {3.8241008503684683`*^9, 3.824100907852079*^9}, {
   3.824187302987053*^9, 3.8241873763554735`*^9}, {3.824187562973913*^9, 
   3.8241875912571087`*^9}, {3.8241882962875614`*^9, 3.824188336454103*^9}, 
   3.8241900492028522`*^9, {3.824201951222639*^9, 3.8242019828057795`*^9}, {
   3.8242030669845686`*^9, 3.8242030679915147`*^9}, {3.8242047143402967`*^9, 
   3.824204730242507*^9}, {3.824205628897428*^9, 3.8242056299316645`*^9}, {
   3.8242060116560507`*^9, 3.8242060193148947`*^9}, {3.824301031592812*^9, 
   3.824301103904849*^9}, {3.8249861362485037`*^9, 3.8249861418291492`*^9}, 
   3.824986388521319*^9, {3.8249864190466375`*^9, 3.8249864196721745`*^9}, {
   3.824986629846386*^9, 3.8249866369586754`*^9}, {3.8249869126784177`*^9, 
   3.8249869144614735`*^9}, {3.8249923612090163`*^9, 
   3.8249923650228567`*^9}, {3.824992478240652*^9, 3.824992479991867*^9}, {
   3.830429655918355*^9, 3.8304296629859347`*^9}, {3.8304297214011745`*^9, 
   3.830429726888253*^9}, {3.8304306482441435`*^9, 3.830430648370325*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"1218717e-9c97-4c2a-b990-1bbb5194081e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"numberofSnapshots", "[", "simul_String", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"SimulationLoad", "[", "simul", "]"}], "[", "\"\<snapshots\>\"", 
     "]"}], "//", "Length"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.862906185989738*^9, 3.862906211632785*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"8c8255a7-c5a6-4d4b-80c0-e541e36205b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "MakeVideonew"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeVideonew", "[", "plottingFunction_", "]"}], "[", 
   RowBox[{
   "simul_String", ",", "skipf_Integer", ",", "skipsnap_Integer", ",", 
    "startfromsnap_Integer", ",", "stopsnap_Integer"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"time", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ",", 
      RowBox[{"snapshots", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"SimulationLoad", "[", "simul", "]"}], "[", 
         "\"\<snapshots\>\"", "]"}], "//", "Length"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PrintTemporary", "@", 
      RowBox[{"ProgressIndicator", "[", 
       RowBox[{
        RowBox[{"Dynamic", "@", "i"}], ",", 
        RowBox[{"{", 
         RowBox[{"startfromsnap", ",", 
          RowBox[{"snapshots", "-", "stopsnap"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"plots", "=", 
      RowBox[{"Rasterize", "/@", 
       RowBox[{"plottingFunction", "/@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"skippedSimulation", "[", 
           RowBox[{"simul", ",", "i", ",", "skipf"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "startfromsnap", ",", 
            RowBox[{"snapshots", "-", "stopsnap"}], ",", "skipsnap"}], 
           "}"}]}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Video frames generated in \>\"", ",", 
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"AbsoluteTime", "[", "]"}], "-", "time"}], ",", 
         "\"\<s\>\""}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AnimatedImage", "[", 
      RowBox[{"plots", ",", 
       RowBox[{"FrameRate", "\[Rule]", "FRAMERATE"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8622235353538404`*^9, 3.8622235384784017`*^9}, {
   3.862906058900691*^9, 3.8629060594656277`*^9}, {3.86290613356789*^9, 
   3.862906143783847*^9}, {3.862906560927082*^9, 3.8629065780076632`*^9}, {
   3.8629075379893775`*^9, 3.8629075556581664`*^9}, {3.862907824308792*^9, 
   3.8629078285072546`*^9}, 3.862907871231935*^9, {3.8635221834091725`*^9, 
   3.863522186184832*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"aab6802e-d85e-4de2-b99c-2f66805bd97f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "MakeVideoExport"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeVideoExport", "[", "plottingFunction_", "]"}], "[", 
   RowBox[{
   "simul_String", ",", "skipf_Integer", ",", "skipsnap_Integer", ",", 
    "startfromsnap_Integer", ",", "stopsnap_Integer"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"time", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ",", 
      RowBox[{"snapshots", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"SimulationLoad", "[", "simul", "]"}], "[", 
         "\"\<snapshots\>\"", "]"}], "//", "Length"}]}], ",", "vid", ",", 
      "plots"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PrintTemporary", "@", 
      RowBox[{"ProgressIndicator", "[", 
       RowBox[{
        RowBox[{"Dynamic", "@", "i"}], ",", 
        RowBox[{"{", 
         RowBox[{"startfromsnap", ",", 
          RowBox[{"snapshots", "-", "stopsnap"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"plots", "=", 
      RowBox[{"Rasterize", "/@", 
       RowBox[{"plottingFunction", "/@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"skippedSimulation", "[", 
           RowBox[{"simul", ",", "i", ",", "skipf"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "startfromsnap", ",", 
            RowBox[{"snapshots", "-", "stopsnap"}], ",", "skipsnap"}], 
           "}"}]}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Video frames generated in \>\"", ",", 
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"AbsoluteTime", "[", "]"}], "-", "time"}], ",", 
         "\"\<s\>\""}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"vid", "=", 
      RowBox[{"AnimatedImage", "[", 
       RowBox[{"plots", ",", 
        RowBox[{"FrameRate", "\[Rule]", "FRAMERATE"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "SetDirectory", "[", 
        "\"\<F:\\\\Vortex_simulations\\\\videos_of_list\>\"", "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"simul", "<>", "\"\<_video.mp4\>\""}], ",", 
       RowBox[{"Video", "@", "vid"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", 
      RowBox[{"vid", ",", "plots"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"SendMail", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<gianni2k@gmail.com\>\"", ",", 
         "\"\<martinonetto93@gmail.com\>\""}], "}"}], ",", 
       "\"\<Finished making video - \[DownExclamation]DALE con el \
otro!\>\""}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.868272398827426*^9, 3.8682724593918962`*^9}, {
   3.8682724974072*^9, 3.86827250626781*^9}, {3.868272660506833*^9, 
   3.8682726611171393`*^9}, {3.8682745534814167`*^9, 3.868274557436141*^9}, {
   3.868279028162809*^9, 3.8682790298678613`*^9}, {3.868279314744384*^9, 
   3.8682793154635735`*^9}, 3.8695653783882275`*^9, {3.870793288856251*^9, 
   3.8707933017353425`*^9}, {3.870793335813023*^9, 3.870793378971944*^9}, {
   3.876379026061356*^9, 3.8763790283156366`*^9}, 3.8797910038783855`*^9},
 CellLabel->"In[43]:=",ExpressionUUID->"9792d112-4e62-4951-8199-462ef9a80a18"],

Cell[BoxData[
 RowBox[{"skippedSimulation", "[", 
  RowBox[{
  "\"\<simul_pysquareseed351_v5\[Lambda]0p25q0p212132\[Omega]0p25parallelchis_\
fields.h5\>\"", ",", "1", ",", "2"}], "]"}]], "Input",
 CellLabel->
  "In[123]:=",ExpressionUUID->"9933f7d9-7374-4ede-a8b4-bccfc1f0aa35"],

Cell[BoxData[
 RowBox[{"numberofSnapshots", "[", 
  "\"\<simul_pysquareseed351_v5\[Lambda]0p25q0p212132\[Omega]0p25parallelchis_\
fields.h5\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.88020488681623*^9, 3.8802048917122297`*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"d3df1838-5571-48f8-a830-638492b436a3"],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\<F:\\\\Vortex_simulations\\\\simulsquares\>\"", "]"}]], "Input",
 CellLabel->
  "In[131]:=",ExpressionUUID->"39efd204-b024-4db0-968b-ce1e49283260"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeVideoExport", "[", 
   RowBox[{"\[Phi]\[Chi]Plot", "[", 
    RowBox[{".75", ",", "False", ",", "True", ",", "1."}], "]"}], "]"}], "[", 
  RowBox[{
  "\"\<simul_pysquareseed351_v5\[Lambda]0p25q0p212132\[Omega]0p25parallelchis_\
fields.h5\>\"", ",", "2", ",", "1", ",", "1", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.8802048631438255`*^9, 3.8802049404323015`*^9}, {
   3.880208329802387*^9, 3.880208330681387*^9}, {3.8802087430065427`*^9, 
   3.880208744848542*^9}, 3.880208974461852*^9},
 CellLabel->
  "In[135]:=",ExpressionUUID->"795798c0-17db-45e7-afc2-6109d7fefa86"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "MakeVideoExportchop"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeVideoExportchop", "[", "plottingFunction_", "]"}], "[", 
   RowBox[{
   "simul_String", ",", "chop_Integer", ",", "skipsnap_Integer", ",", 
    "startfromsnap_Integer", ",", "stopsnap_Integer"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"time", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ",", 
      RowBox[{"snapshots", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"SimulationLoad", "[", "simul", "]"}], "[", 
         "\"\<snapshots\>\"", "]"}], "//", "Length"}]}], ",", "vid", ",", 
      "plots"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PrintTemporary", "@", 
      RowBox[{"ProgressIndicator", "[", 
       RowBox[{
        RowBox[{"Dynamic", "@", "i"}], ",", 
        RowBox[{"{", 
         RowBox[{"startfromsnap", ",", 
          RowBox[{"snapshots", "-", "stopsnap"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"plots", "=", 
      RowBox[{"Rasterize", "/@", 
       RowBox[{"plottingFunction", "/@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"choppedSimulation", "[", 
           RowBox[{"simul", ",", "i", ",", "chop"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "startfromsnap", ",", 
            RowBox[{"snapshots", "-", "stopsnap"}], ",", "skipsnap"}], 
           "}"}]}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Video frames generated in \>\"", ",", 
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"AbsoluteTime", "[", "]"}], "-", "time"}], ",", 
         "\"\<s\>\""}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"vid", "=", 
      RowBox[{"AnimatedImage", "[", 
       RowBox[{"plots", ",", 
        RowBox[{"FrameRate", "\[Rule]", "FRAMERATE"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "SetDirectory", "[", 
      "\"\<F:\\\\Vortex_simulations\\\\videos_of_list\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"simul", "<>", "\"\<chop_video.mp4\>\""}], ",", 
       RowBox[{"Video", "@", "vid"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", 
      RowBox[{"vid", ",", "plots"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"SendMail", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<gianni2k@gmail.com\>\"", ",", 
         "\"\<martinonetto93@gmail.com\>\""}], "}"}], ",", 
       "\"\<Finished making video - \[DownExclamation]DALE con el \
otro!\>\""}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8711423512487183`*^9, 3.8711423981373434`*^9}, {
  3.871153633555145*^9, 3.87115363404086*^9}, {3.8712323938849125`*^9, 
  3.8712324108817067`*^9}, {3.871233013407443*^9, 3.8712330155445156`*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"0b4cc546-30cd-4d1c-ac85-15242f79599c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "MakeVideoBExportchop"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeVideoBExportchop", "[", "plottingFunction_", "]"}], "[", 
   RowBox[{
   "simul_String", ",", "chop_Integer", ",", "skipsnap_Integer", ",", 
    "startfromsnap_Integer", ",", "stopsnap_Integer"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"time", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ",", 
      RowBox[{"snapshots", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"SimulationLoad", "[", "simul", "]"}], "[", 
         "\"\<snapshots\>\"", "]"}], "//", "Length"}]}], ",", "vid", ",", 
      "plots"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PrintTemporary", "@", 
      RowBox[{"ProgressIndicator", "[", 
       RowBox[{
        RowBox[{"Dynamic", "@", "i"}], ",", 
        RowBox[{"{", 
         RowBox[{"startfromsnap", ",", 
          RowBox[{"snapshots", "-", "stopsnap"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"plots", "=", 
      RowBox[{"Rasterize", "/@", 
       RowBox[{"plottingFunction", "/@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"choppedSimulation", "[", 
           RowBox[{"simul", ",", "i", ",", "chop"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "startfromsnap", ",", 
            RowBox[{"snapshots", "-", "stopsnap"}], ",", "skipsnap"}], 
           "}"}]}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Video frames generated in \>\"", ",", 
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"AbsoluteTime", "[", "]"}], "-", "time"}], ",", 
         "\"\<s\>\""}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"vid", "=", 
      RowBox[{"AnimatedImage", "[", 
       RowBox[{"plots", ",", 
        RowBox[{"FrameRate", "\[Rule]", "FRAMERATE"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "SetDirectory", "[", 
      "\"\<F:\\\\Vortex_simulations\\\\videos_of_list\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"simul", "<>", "\"\<Bplot_chop_video.mp4\>\""}], ",", 
       RowBox[{"Video", "@", "vid"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", 
      RowBox[{"vid", ",", "plots"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"SendMail", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<gianni2k@gmail.com\>\"", ",", 
         "\"\<martinonetto93@gmail.com\>\""}], "}"}], ",", 
       "\"\<Finished making video - \[DownExclamation]DALE con el \
otro!\>\""}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.872329537320281*^9, 3.8723295426662407`*^9}, {
  3.8725915087931395`*^9, 3.872591509758565*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"4f96b43d-8d1d-4ae6-9268-645e1bf7c0a4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initial state creation", "Section",
 CellChangeTimes->{{3.824183215411398*^9, 
  3.8241832197314157`*^9}},ExpressionUUID->"c17ecf75-13ed-4806-ac22-\
3a48e0519ab0"],

Cell[CellGroupData[{

Cell["Finding vortex solutions", "Subsection",
 CellChangeTimes->{{3.8241833468783636`*^9, 
  3.8241833662693853`*^9}},ExpressionUUID->"24ccef59-aba1-49a1-8bdc-\
93ac039a9f35"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "RadialGrid"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RadialGrid", "[", 
   RowBox[{"lR_Real", ",", "nR_Integer", ",", "\[Epsilon]_Real"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "dr", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dr", "=", 
      RowBox[{"lR", "/", 
       RowBox[{"(", 
        RowBox[{"nR", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"dr", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Range", "@", "nR"}], "-", "1"}], ")"}]}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"UnitVector", "[", 
          RowBox[{"nR", ",", "1"}], "]"}]}]}], ",", "dr"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.801970157323563*^9, 3.801970180890548*^9}, {
  3.8238710982632875`*^9, 3.823871130249696*^9}, {3.8238713066334114`*^9, 
  3.8238713090535727`*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"0fab68e2-45f6-4fff-a16d-00a9a863cfa3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "RadialState"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RadialState", "[", 
    RowBox[{"lR_Real", ",", "nR_Integer", ",", "\[Epsilon]_Real"}], "]"}], 
   "[", 
   RowBox[{
   "v_Real", ",", "\[Lambda]_Real", ",", "q_Real", ",", "\[Omega]_Real"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"RadialState", "[", 
     RowBox[{"lR", ",", "nR", ",", "\[Epsilon]"}], "]"}], "[", 
    RowBox[{"v", ",", "\[Lambda]", ",", "q", ",", "\[Omega]"}], "]"}], "=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"time", "=", 
        RowBox[{"AbsoluteTime", "[", "]"}]}], ",", "r", ",", "dr", ",", "var",
        ",", "vardr", ",", "varddr", ",", "bc", ",", "bcs", ",", "eom", ",", 
       "eoms", ",", "eqs", ",", "vars", ",", "froot", ",", "x", ",", "dx", 
       ",", "y", ",", "dy", ",", "makeRadialFunction", ",", "\[Phi]", ",", 
       "\[Chi]", ",", "A\[Theta]", ",", "\[Phi]out", ",", "\[Phi]barout", ",",
        "\[Chi]out", ",", "Axout", ",", "Ayout", ",", "Axbarout", ",", 
       "Aybarout", ",", "r\[Phi]", ",", "r\[Chi]", ",", "rA"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r", ",", "dr"}], "}"}], "=", 
       RowBox[{"RadialGrid", "[", 
        RowBox[{"lR", ",", "nR", ",", "\[Epsilon]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vardr", "[", 
        RowBox[{"i_", ",", "n_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"var", "[", 
           RowBox[{"i", ",", 
            RowBox[{"n", "+", "1"}]}], "]"}], "-", 
          RowBox[{"var", "[", 
           RowBox[{"i", ",", 
            RowBox[{"n", "-", "1"}]}], "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", "dr"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"varddr", "[", 
        RowBox[{"i_", ",", "n_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"var", "[", 
           RowBox[{"i", ",", 
            RowBox[{"n", "+", "1"}]}], "]"}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"var", "[", 
            RowBox[{"i", ",", "n"}], "]"}]}], "+", 
          RowBox[{"var", "[", 
           RowBox[{"i", ",", 
            RowBox[{"n", "-", "1"}]}], "]"}]}], ")"}], "/", 
        SuperscriptBox["dr", "2"]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bc", "[", "1", "]"}], "=", 
       RowBox[{
        RowBox[{"var", "[", 
         RowBox[{"1", ",", "nR"}], "]"}], "-", "v"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bc", "[", "2", "]"}], "=", 
       RowBox[{
        RowBox[{"var", "[", 
         RowBox[{"1", ",", "1"}], "]"}], "-", 
        RowBox[{
         RowBox[{"vardr", "[", 
          RowBox[{"1", ",", "1"}], "]"}], "\[Epsilon]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bc", "[", "3", "]"}], "=", 
       RowBox[{"var", "[", 
        RowBox[{"2", ",", "nR"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bc", "[", "4", "]"}], "=", 
       RowBox[{"vardr", "[", 
        RowBox[{"2", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bc", "[", "5", "]"}], "=", 
       RowBox[{
        RowBox[{"var", "[", 
         RowBox[{"3", ",", "1"}], "]"}], "-", "1", "-", 
        RowBox[{
         RowBox[{"vardr", "[", 
          RowBox[{"3", ",", "1"}], "]"}], 
         RowBox[{"\[Epsilon]", "/", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bc", "[", "6", "]"}], "=", 
       RowBox[{"var", "[", 
        RowBox[{"3", ",", "nR"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"bcs", "=", 
       RowBox[{"bc", "/@", 
        RowBox[{"Range", "@", "6"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eom", "[", 
        RowBox[{"1", ",", "n_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"varddr", "[", 
           RowBox[{"1", ",", "n"}], "]"}], "+", 
          FractionBox[
           RowBox[{"vardr", "[", 
            RowBox[{"1", ",", "n"}], "]"}], 
           RowBox[{
           "r", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}]]}], 
         ")"}], "-", 
        RowBox[{"2", "\[Lambda]", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"var", "[", 
             RowBox[{"1", ",", "n"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"var", "[", 
             RowBox[{"2", ",", "n"}], "]"}], "2"], "-", 
           SuperscriptBox["v", "2"]}], ")"}], 
         RowBox[{"var", "[", 
          RowBox[{"1", ",", "n"}], "]"}]}], "-", 
        RowBox[{
         FractionBox["1", 
          SuperscriptBox[
           RowBox[{
           "r", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}], "2"]], 
         SuperscriptBox[
          RowBox[{"var", "[", 
           RowBox[{"3", ",", "n"}], "]"}], "2"], 
         RowBox[{"var", "[", 
          RowBox[{"1", ",", "n"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eom", "[", 
        RowBox[{"2", ",", "n_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"varddr", "[", 
           RowBox[{"2", ",", "n"}], "]"}], "+", 
          FractionBox[
           RowBox[{"vardr", "[", 
            RowBox[{"2", ",", "n"}], "]"}], 
           RowBox[{
           "r", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}]]}], 
         ")"}], "-", 
        RowBox[{"2", "\[Lambda]", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"var", "[", 
             RowBox[{"1", ",", "n"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"var", "[", 
             RowBox[{"2", ",", "n"}], "]"}], "2"], "-", 
           SuperscriptBox["v", "2"]}], ")"}], 
         RowBox[{"var", "[", 
          RowBox[{"2", ",", "n"}], "]"}]}], "-", 
        RowBox[{
         SuperscriptBox["\[Omega]", "2"], 
         RowBox[{"var", "[", 
          RowBox[{"2", ",", "n"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eom", "[", 
        RowBox[{"3", ",", "n_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"varddr", "[", 
           RowBox[{"3", ",", "n"}], "]"}], "-", 
          FractionBox[
           RowBox[{"vardr", "[", 
            RowBox[{"3", ",", "n"}], "]"}], 
           RowBox[{
           "r", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}]]}], 
         ")"}], "-", 
        RowBox[{"2", 
         SuperscriptBox["q", "2"], " ", 
         SuperscriptBox[
          RowBox[{"var", "[", 
           RowBox[{"1", ",", "n"}], "]"}], "2"], 
         RowBox[{"var", "[", 
          RowBox[{"3", ",", "n"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"eoms", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"eom", "[", 
          RowBox[{"i", ",", "n"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", 
           RowBox[{"nR", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"eqs", "=", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Join", "[", 
         RowBox[{"bcs", ",", "eoms"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vars", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"var", "[", 
                RowBox[{"1", ",", "n"}], "]"}], ",", "v"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"var", "[", 
                RowBox[{"2", ",", "n"}], "]"}], ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"var", "[", 
                RowBox[{"3", ",", "n"}], "]"}], ",", "1"}], "}"}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", "nR"}], "}"}]}], "]"}], ",", "1"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"froot", "=", 
       RowBox[{"FindRoot", "[", 
        RowBox[{"eqs", ",", "vars", ",", 
         RowBox[{"MaxIterations", "\[Rule]", "300"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\[Phi]", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "}"}], "~", "Join", "~", 
          RowBox[{"Select", "[", 
           RowBox[{"froot", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"First", "@", 
                RowBox[{"First", "@", "#"}]}], "\[Equal]", "1"}], "&&", 
              RowBox[{
               RowBox[{"Last", "@", 
                RowBox[{"First", "@", "#"}]}], "\[NotEqual]", "0"}]}], 
             "&"}]}], "]"}]}], "/.", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"var", "[", 
             RowBox[{"1", ",", "n_"}], "]"}], "\[Rule]", "val_"}], ")"}], 
          "\[RuleDelayed]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "r", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}], ",", 
            "val"}], "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Chi]", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"froot", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"First", "@", 
               RowBox[{"First", "@", "#"}]}], "\[Equal]", "2"}], "&&", 
             RowBox[{
              RowBox[{"Last", "@", 
               RowBox[{"First", "@", "#"}]}], "\[NotEqual]", "0"}]}], "&"}]}],
           "]"}], "/.", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"var", "[", 
             RowBox[{"2", ",", "n_"}], "]"}], "\[Rule]", "val_"}], ")"}], 
          "\[RuleDelayed]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "r", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}], ",", 
            "val"}], "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"A\[Theta]", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "}"}], "~", "Join", "~", 
          RowBox[{"Select", "[", 
           RowBox[{"froot", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"First", "@", 
                RowBox[{"First", "@", "#"}]}], "\[Equal]", "3"}], "&&", 
              RowBox[{
               RowBox[{"Last", "@", 
                RowBox[{"First", "@", "#"}]}], "\[NotEqual]", "0"}]}], 
             "&"}]}], "]"}]}], "/.", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"var", "[", 
             RowBox[{"3", ",", "n_"}], "]"}], "\[Rule]", "val_"}], ")"}], 
          "\[RuleDelayed]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "r", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}], ",", 
            FractionBox[
             RowBox[{"val", "-", "1"}], "q"]}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"r\[Phi]", "=", 
       RowBox[{"x", "/.", 
        RowBox[{"First", "@", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Phi]", "@", "x"}], "-", 
            RowBox[{"v", "/", "2"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "1", ",", "\[Epsilon]", ",", "lR"}], "}"}]}], 
          "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"r\[Chi]", "=", 
       RowBox[{"x", "/.", 
        RowBox[{"First", "@", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Chi]", "@", "x"}], "-", 
            RowBox[{
             RowBox[{"\[Chi]", "@", "0"}], "/", "2"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "1", ",", "\[Epsilon]", ",", "lR"}], "}"}]}], 
          "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rA", "=", 
       RowBox[{"x", "/.", 
        RowBox[{"First", "@", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"A\[Theta]", "@", "x"}], "-", 
            RowBox[{
             RowBox[{"A\[Theta]", "@", "lR"}], "/", "2"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "1", ",", "\[Epsilon]", ",", "lR"}], "}"}]}], 
          "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Created static (radial) vortex in \>\"", ",", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"AbsoluteTime", "[", "]"}], "-", "time"}], ",", ".01"}], 
         "]"}], ",", "\"\< seconds: lR = \>\"", ",", "lR", ",", 
        "\"\<; nR = \>\"", ",", "nR", ",", "\"\<; |\[Chi](0)| = \>\"", ",", 
        RowBox[{"\[Chi]", "@", "0"}], ",", 
        "\"\<; {r\[Phi],r\[Chi],rA} = \>\"", ",", 
        RowBox[{"{", 
         RowBox[{"r\[Phi]", ",", "r\[Chi]", ",", "rA"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<lR\>\"", "\[Rule]", "lR"}], ",", 
        RowBox[{"\"\<nR\>\"", "\[Rule]", "nR"}], ",", 
        RowBox[{"\"\<\[Epsilon]\>\"", "\[Rule]", "\[Epsilon]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<v\>\"", "\[Rule]", "v"}], ",", 
        RowBox[{"\"\<\[Lambda]\>\"", "\[Rule]", "\[Lambda]"}], ",", 
        RowBox[{"\"\<q\>\"", "\[Rule]", "q"}], ",", 
        RowBox[{"\"\<\[Omega]\>\"", "\[Rule]", "\[Omega]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<r\[Phi]\>\"", "\[Rule]", "r\[Phi]"}], ",", 
        RowBox[{"\"\<r\[Chi]\>\"", "\[Rule]", "r\[Chi]"}], ",", 
        RowBox[{"\"\<rA\>\"", "\[Rule]", "rA"}], ",", 
        RowBox[{"\"\<\[Chi]0\>\"", "\[Rule]", 
         RowBox[{"\[Chi]", "@", "0"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<\[Phi]\>\"", "\[Rule]", "\[Phi]"}], ",", 
        RowBox[{"\"\<\[Chi]\>\"", "\[Rule]", "\[Chi]"}], ",", 
        RowBox[{"\"\<A\[Theta]\>\"", "\[Rule]", "A\[Theta]"}]}], 
       "\[IndentingNewLine]", "|>"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.801970367711442*^9, 3.8019706424468393`*^9}, {
   3.801970817875329*^9, 3.801970818288257*^9}, {3.801971140866696*^9, 
   3.801971207224292*^9}, {3.8019715605206356`*^9, 3.801971600390994*^9}, {
   3.8019717035292177`*^9, 3.8019717231707244`*^9}, {3.8019717659413614`*^9, 
   3.8019719581763268`*^9}, {3.8019721362674885`*^9, 3.801972138801739*^9}, {
   3.801972175790846*^9, 3.801972283647173*^9}, {3.8019723695694356`*^9, 
   3.8019723698407288`*^9}, {3.801978713455549*^9, 3.801978742753211*^9}, 
   3.8019978727057467`*^9, {3.8019980321254873`*^9, 3.8019980703764753`*^9}, {
   3.801998117864607*^9, 3.8019981624138937`*^9}, {3.8019982281656013`*^9, 
   3.8019982730887165`*^9}, {3.801998395475688*^9, 3.8019984727563505`*^9}, {
   3.8019987765657845`*^9, 3.801998782000712*^9}, {3.8019998149672375`*^9, 
   3.8019998926547127`*^9}, {3.8020038820047884`*^9, 3.802003883815873*^9}, {
   3.8024319086514497`*^9, 3.802431913427595*^9}, {3.8026730485189066`*^9, 
   3.802673069700595*^9}, {3.802677205852607*^9, 3.802677210074729*^9}, {
   3.802677243433091*^9, 3.8026772443461065`*^9}, 3.80267836088875*^9, {
   3.8026788843423996`*^9, 3.802678888548524*^9}, {3.802678970982046*^9, 
   3.8026789710930176`*^9}, {3.8026795432725306`*^9, 3.802679566995633*^9}, {
   3.802679701237217*^9, 3.8026797033958673`*^9}, {3.802680389885953*^9, 
   3.8026803989612713`*^9}, {3.8026805211026754`*^9, 
   3.8026805379144735`*^9}, {3.802680617587753*^9, 3.8026806192328067`*^9}, {
   3.802680663057762*^9, 3.802680665279617*^9}, 3.8026820420118847`*^9, {
   3.802682094796878*^9, 3.802682116572754*^9}, {3.8026860021875534`*^9, 
   3.8026860156818476`*^9}, {3.802686120029909*^9, 3.8026861226065235`*^9}, {
   3.802686205274166*^9, 3.8026862210665483`*^9}, {3.8026865357052755`*^9, 
   3.802686539163415*^9}, {3.802686569703097*^9, 3.8026865826350965`*^9}, {
   3.8026887958539267`*^9, 3.8026888105089293`*^9}, {3.8026888461799393`*^9, 
   3.802688867371896*^9}, {3.8026895013858957`*^9, 3.8026895473664913`*^9}, 
   3.802689594825694*^9, {3.802689688666298*^9, 3.8026896897660728`*^9}, {
   3.8028486610827246`*^9, 3.8028486612256937`*^9}, {3.803126491992042*^9, 
   3.8031264943750453`*^9}, {3.8031265468231134`*^9, 3.803126548309111*^9}, {
   3.8031265952101507`*^9, 3.80312660093315*^9}, {3.803295614355072*^9, 
   3.8032956563362846`*^9}, {3.80744119308352*^9, 3.807441208934823*^9}, {
   3.8074413344224553`*^9, 3.8074413490459986`*^9}, {3.807958029782299*^9, 
   3.8079580300734515`*^9}, {3.807964127347695*^9, 3.80796413080912*^9}, {
   3.8082217079418106`*^9, 3.8082217617757273`*^9}, 3.808221873678582*^9, {
   3.809104813968099*^9, 3.8091048667191525`*^9}, {3.809152023818137*^9, 
   3.809152119047494*^9}, {3.8091522057222433`*^9, 3.809152207268168*^9}, {
   3.8091522425554047`*^9, 3.8091522616387863`*^9}, {3.809152709266282*^9, 
   3.8091527198506227`*^9}, {3.8091527957508926`*^9, 3.809152942829911*^9}, {
   3.8091532423473344`*^9, 3.8091533145157347`*^9}, {3.809153373319192*^9, 
   3.809153376452364*^9}, {3.8091534641261044`*^9, 3.809153502448798*^9}, {
   3.809153622958084*^9, 3.8091536292681165`*^9}, {3.8091537700179863`*^9, 
   3.809153801568319*^9}, {3.8091552164302936`*^9, 3.809155219148775*^9}, {
   3.809155305251279*^9, 3.8091553101927843`*^9}, {3.8091553530359173`*^9, 
   3.8091553531456914`*^9}, {3.809155564572341*^9, 3.809155608216404*^9}, {
   3.809155689439094*^9, 3.8091556939477687`*^9}, {3.809179302527472*^9, 
   3.809179305997115*^9}, {3.8091794072942905`*^9, 3.8091795118676176`*^9}, {
   3.8091796245916667`*^9, 3.809179634459969*^9}, {3.8091796933407955`*^9, 
   3.809179694844591*^9}, {3.809179728674683*^9, 3.809179735749284*^9}, {
   3.809179773165593*^9, 3.809179784421843*^9}, {3.8091798448246536`*^9, 
   3.809179845217241*^9}, {3.8091799073563566`*^9, 3.8091799491775827`*^9}, {
   3.809180081967558*^9, 3.809180083371642*^9}, {3.8091801839458237`*^9, 
   3.809180209963501*^9}, {3.8091803597566805`*^9, 3.8091803831648016`*^9}, {
   3.8091804186036825`*^9, 3.8091804189224377`*^9}, {3.809188943240241*^9, 
   3.8091889464872394`*^9}, {3.8091892878311005`*^9, 3.809189304361893*^9}, {
   3.8092391903399897`*^9, 3.809239238625069*^9}, {3.8092654233510385`*^9, 
   3.8092655205235014`*^9}, {3.809265594844542*^9, 3.8092656097369876`*^9}, {
   3.809265655819275*^9, 3.8092656570094767`*^9}, {3.8092662239070835`*^9, 
   3.809266240039616*^9}, {3.809271586532343*^9, 3.809271587426345*^9}, {
   3.809316068331608*^9, 3.8093160731010747`*^9}, {3.809317749428443*^9, 
   3.8093177507191753`*^9}, {3.8093434961810427`*^9, 
   3.8093435053903713`*^9}, {3.8093516873801003`*^9, 
   3.8093517297237177`*^9}, {3.809351767482113*^9, 3.8093518121219935`*^9}, {
   3.8102886059087114`*^9, 3.810288607540141*^9}, 3.810288870387497*^9, {
   3.81028899619508*^9, 3.8102890236506805`*^9}, {3.8102890808691945`*^9, 
   3.8102890818448644`*^9}, {3.810289157685244*^9, 3.810289176151565*^9}, {
   3.8102900176667337`*^9, 3.8102900208960247`*^9}, {3.810290141874711*^9, 
   3.810290145269432*^9}, {3.8102901892798223`*^9, 3.810290212910432*^9}, {
   3.8102902690214286`*^9, 3.81029027277884*^9}, 3.810290499045828*^9, {
   3.810290542641962*^9, 3.8102905898438225`*^9}, {3.8102907194064827`*^9, 
   3.8102907459880886`*^9}, {3.8102908395483837`*^9, 
   3.8102908491013174`*^9}, {3.810290890319439*^9, 3.8102909214847813`*^9}, {
   3.810290972620082*^9, 3.810290983612249*^9}, {3.810291170060425*^9, 
   3.8102911706032543`*^9}, {3.810291300842713*^9, 3.810291374957429*^9}, 
   3.8102916439144545`*^9, {3.810291684283745*^9, 3.81029168799212*^9}, {
   3.8102944018797874`*^9, 3.8102944224629245`*^9}, {3.8102944841932635`*^9, 
   3.810294513584618*^9}, {3.810294784423826*^9, 3.810294797667802*^9}, {
   3.810294978025505*^9, 3.8102950250756974`*^9}, {3.810295888010515*^9, 
   3.8102959080953226`*^9}, {3.81029594513538*^9, 3.81029595045614*^9}, {
   3.810296195032378*^9, 3.8102962170011454`*^9}, {3.8102962600493946`*^9, 
   3.8102962910520735`*^9}, {3.8102964953152623`*^9, 3.810296502175214*^9}, {
   3.810297435507894*^9, 3.8102974365608673`*^9}, {3.8104648599291277`*^9, 
   3.810464918453689*^9}, {3.823871319950941*^9, 3.823871328857029*^9}, {
   3.8238713678631463`*^9, 3.82387140832495*^9}, {3.823871439933831*^9, 
   3.823871501186493*^9}, {3.8238715353675737`*^9, 3.8238717336634035`*^9}, {
   3.8238718177610793`*^9, 3.823871819510118*^9}, {3.8238721143525534`*^9, 
   3.8238721328157516`*^9}, {3.823925711799402*^9, 3.8239257119850907`*^9}, {
   3.8242035287653875`*^9, 3.8242035324066725`*^9}, {3.824203570958697*^9, 
   3.8242035731462135`*^9}, {3.824970126947427*^9, 3.824970164730315*^9}, {
   3.824974693373561*^9, 3.824974699737669*^9}, {3.8249755718220377`*^9, 
   3.8249755751829576`*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"d5953371-a362-4f19-a43c-668e4d135221"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "VortexSize"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VortexSize", "[", "state_Association", "]"}], ":=", 
  RowBox[{"Max", "[", 
   RowBox[{"state", "/@", 
    RowBox[{"{", 
     RowBox[{"\"\<r\[Phi]\>\"", ",", "\"\<r\[Chi]\>\"", ",", "\"\<rA\>\""}], 
     "}"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8091799654944525`*^9, 3.8091800227706747`*^9}, {
   3.809180063003543*^9, 3.8091800657783265`*^9}, {3.8091801689320707`*^9, 
   3.8091801717315187`*^9}, 3.8091804040039577`*^9, {3.824118665458319*^9, 
   3.824118719047221*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"75232812-55f2-405d-b318-b39179c762e7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "Snapshot\[Chi]Range"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Snapshot\[Chi]Range", "[", "f_Real", "]"}], "[", 
   "snapshot_Association", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Snapshot\[Chi]Range", "[", "f", "]"}], "[", "snapshot", "]"}], 
   "=", "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "lR", ",", "nR", ",", "\[Epsilon]", ",", "v", ",", "\[Lambda]", ",", 
       "q", ",", "\[Omega]", ",", "state", ",", "\[Phi]", ",", "\[Chi]", ",", 
       "r\[Phi]", ",", "\[Chi]0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "lR", ",", "nR", ",", "\[Epsilon]", ",", "v", ",", "\[Lambda]", ",", 
         "q", ",", "\[Omega]"}], "}"}], "=", 
       RowBox[{"snapshot", "/@", 
        RowBox[{"{", 
         RowBox[{
         "\"\<lR\>\"", ",", "\"\<nR\>\"", ",", "\"\<\[Epsilon]\>\"", ",", 
          "\"\<v\>\"", ",", "\"\<\[Lambda]\>\"", ",", "\"\<q\>\"", ",", 
          "\"\<\[Omega]\>\""}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{
        RowBox[{"RadialState", "[", 
         RowBox[{"lR", ",", "nR", ",", "\[Epsilon]"}], "]"}], "[", 
        RowBox[{"v", ",", "\[Lambda]", ",", "q", ",", "\[Omega]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Phi]", ",", "\[Chi]", ",", "r\[Phi]", ",", "\[Chi]0"}], 
        "}"}], "=", 
       RowBox[{"state", "/@", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\[Phi]\>\"", ",", "\"\<\[Chi]\>\"", ",", "\"\<r\[Phi]\>\"", 
          ",", "\"\<\[Chi]0\>\""}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Chi]", "[", 
       RowBox[{"r", "/.", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"\[Phi]", "[", "r", "]"}], "2"], "-", 
           RowBox[{"f", " ", 
            SuperscriptBox["v", "2"]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "r\[Phi]"}], "}"}]}], "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8249701844871097`*^9, 3.8249703851917963`*^9}, {
   3.824974607041219*^9, 3.824974653669305*^9}, {3.824974715870846*^9, 
   3.82497475589085*^9}, 3.824975144530517*^9, {3.8249752132883797`*^9, 
   3.8249752165474653`*^9}, {3.824975332911331*^9, 3.824975338163378*^9}, {
   3.824975369486912*^9, 3.824975541167971*^9}, 3.8249755922668614`*^9, 
   3.8249759902616944`*^9, {3.830262998592169*^9, 3.830263001016279*^9}, {
   3.8302640447034044`*^9, 3.8302640448364906`*^9}, {3.865269909078492*^9, 
   3.86526991324751*^9}, {3.86527003955474*^9, 3.865270043977688*^9}, {
   3.865270153365032*^9, 3.865270157727029*^9}, {3.8653318052373695`*^9, 
   3.865331807047988*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"9e6af472-9825-4797-8548-cc05962806e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Creating strings from vortices", "Subsection",
 CellChangeTimes->{{3.8241833707725763`*^9, 
  3.824183396838261*^9}},ExpressionUUID->"fe3d819f-6982-4e37-90bc-\
578cf35a0436"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "SignQ"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SignQ", "[", "v_Integer", "]"}], ":=", 
   RowBox[{
    RowBox[{"v", "===", "1"}], "||", 
    RowBox[{"v", "===", 
     RowBox[{"-", "1"}]}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8092667286439*^9, 3.809266757440406*^9}, {
  3.8092716217826915`*^9, 3.8092716233913665`*^9}, {3.8238719240460534`*^9, 
  3.8238719348662868`*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"760e6e71-519b-48ed-bcfc-ef40ed51de56"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "State2String"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"State2String", "[", 
    RowBox[{
     RowBox[{"type_Integer", "?", "SignQ"}], ",", "\[Alpha]1_Real", ",", 
     "\[Alpha]2_Real", ",", "\[Nu]_Real"}], "]"}], "[", "state_Association", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Phi]r", ",", "\[Chi]r", ",", "A\[Theta]", ",", "\[Epsilon]", ",", 
      "\[Phi]", ",", "\[Chi]", ",", "Ax", ",", "Ay", ",", "Az"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Phi]r", ",", "\[Chi]r", ",", "A\[Theta]", ",", "\[Epsilon]"}], 
       "}"}], "=", 
      RowBox[{"state", "/@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\[Phi]\>\"", ",", "\"\<\[Chi]\>\"", ",", "\"\<A\[Theta]\>\"", 
         ",", "\"\<\[Epsilon]\>\""}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Phi]", "=", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"\[Phi]r", "@", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["#1", "2"], "+", 
            SuperscriptBox["#2", "2"]}]]}], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "type", " ", 
           RowBox[{"Arg", "[", 
            RowBox[{"#1", "+", 
             RowBox[{"\[ImaginaryI]", "#2"}]}], "]"}]}]]}], "]"}], "&"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Chi]", "=", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Alpha]2", "]"}], ",", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Alpha]2", "]"}], 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Alpha]1", "+", 
              RowBox[{
               RowBox[{"Abs", "@", "\[Nu]"}], 
               RowBox[{"(", 
                RowBox[{"#4", "-", 
                 RowBox[{
                  RowBox[{"Sign", "@", "\[Nu]"}], "#3"}]}], ")"}]}]}], 
             "]"}]}], ",", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Alpha]2", "]"}], 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Alpha]1", "+", 
              RowBox[{
               RowBox[{"Abs", "@", "\[Nu]"}], 
               RowBox[{"(", 
                RowBox[{"#4", "-", 
                 RowBox[{
                  RowBox[{"Sign", "@", "\[Nu]"}], "#3"}]}], ")"}]}]}], 
             "]"}]}]}], "}"}], 
         RowBox[{"\[Chi]r", "@", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["#1", "2"], "+", 
            SuperscriptBox["#2", "2"]}]]}]}], "]"}], "&"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Ax", "=", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"-", "type"}], 
         FractionBox["#2", 
          RowBox[{
           SuperscriptBox["#1", "2"], "+", 
           SuperscriptBox["#2", "2"], "+", 
           SuperscriptBox["\[Epsilon]", "2"]}]], " ", 
         RowBox[{"A\[Theta]", "@", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["#1", "2"], "+", 
            SuperscriptBox["#2", "2"], "+", 
            SuperscriptBox["\[Epsilon]", "2"]}]]}]}], "]"}], "&"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Ay", "=", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"type", 
         FractionBox["#1", 
          RowBox[{
           SuperscriptBox["#1", "2"], "+", 
           SuperscriptBox["#2", "2"], "+", 
           SuperscriptBox["\[Epsilon]", "2"]}]], " ", 
         RowBox[{"A\[Theta]", "@", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["#1", "2"], "+", 
            SuperscriptBox["#2", "2"], "+", 
            SuperscriptBox["\[Epsilon]", "2"]}]]}]}], "]"}], "&"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Az", "=", 
      RowBox[{"0", "&"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<lR\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<lR\>\""}]}], ",", 
       RowBox[{"\"\<nR\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<nR\>\""}]}], ",", 
       RowBox[{"\"\<\[Epsilon]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Epsilon]\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<v\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<v\>\""}]}], ",", 
       RowBox[{"\"\<\[Lambda]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Lambda]\>\""}]}], ",", 
       RowBox[{"\"\<q\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<q\>\""}]}], ",", 
       RowBox[{"\"\<\[Omega]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Omega]\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<r\[Phi]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<r\[Phi]\>\""}]}], ",", 
       RowBox[{"\"\<r\[Chi]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<r\[Chi]\>\""}]}], ",", 
       RowBox[{"\"\<rA\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<rA\>\""}]}], ",", 
       RowBox[{"\"\<\[Chi]0\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Chi]0\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<lX\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"state", "@", "\"\<lR\>\""}], "/", 
         SqrtBox["2"]}]}], ",", 
       RowBox[{"\"\<lY\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"state", "@", "\"\<lR\>\""}], "/", 
         SqrtBox["2"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<\[Phi]\>\"", "\[Rule]", "\[Phi]"}], ",", 
       RowBox[{"\"\<\[Chi]\>\"", "\[Rule]", "\[Chi]"}], ",", 
       RowBox[{"\"\<Ax\>\"", "\[Rule]", "Ax"}], ",", 
       RowBox[{"\"\<Ay\>\"", "\[Rule]", "Ay"}], ",", 
       RowBox[{"\"\<Az\>\"", "\[Rule]", "Az"}]}], "\[IndentingNewLine]", 
      "|>"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.809265582199331*^9, 3.809265589383751*^9}, {
   3.809265672709119*^9, 3.8092658750289087`*^9}, {3.809265983751335*^9, 
   3.809266011108235*^9}, {3.809266051523666*^9, 3.809266119544161*^9}, {
   3.8092661592853165`*^9, 3.8092662014443502`*^9}, {3.8092662830762777`*^9, 
   3.8092663885321054`*^9}, {3.8092671983456025`*^9, 3.809267218449543*^9}, {
   3.8092672879585543`*^9, 3.80926730094452*^9}, {3.809315709894777*^9, 
   3.8093157420597563`*^9}, {3.8102925169632792`*^9, 3.810292520354377*^9}, {
   3.8102966221866813`*^9, 3.8102966325029135`*^9}, {3.8102972793770914`*^9, 
   3.810297298879483*^9}, {3.8103040607630672`*^9, 3.8103040667147317`*^9}, {
   3.810304141322403*^9, 3.8103041467741165`*^9}, {3.810461239957264*^9, 
   3.8104612453038416`*^9}, {3.8104617643691206`*^9, 3.810461776326338*^9}, 
   3.8104641242455373`*^9, {3.823871969820508*^9, 3.8238719772555823`*^9}, {
   3.823872028416895*^9, 3.8238721063789763`*^9}, {3.823872143288538*^9, 
   3.823872150886425*^9}, {3.8238723379501333`*^9, 3.8238724675506907`*^9}, {
   3.8238725376378746`*^9, 3.8238725443333874`*^9}, {3.8239253021911116`*^9, 
   3.8239253529898944`*^9}, {3.8239257273086567`*^9, 3.82392575303907*^9}, {
   3.8239258117241592`*^9, 3.8239258496771727`*^9}, {3.823925881148484*^9, 
   3.8239259064291334`*^9}, {3.8239264194548235`*^9, 
   3.8239264312002583`*^9}, {3.8242036722632103`*^9, 3.8242036779752707`*^9}, 
   3.8242037218768287`*^9, {3.8249749070226746`*^9, 3.82497492413868*^9}, {
   3.8249751804953804`*^9, 3.824975241415984*^9}, {3.825136335615833*^9, 
   3.825136397694528*^9}, {3.8302530318913755`*^9, 3.8302530559118433`*^9}, {
   3.8302531409897995`*^9, 3.8302531833259296`*^9}, {3.830263467929145*^9, 
   3.8302634681021395`*^9}, {3.8303207092016973`*^9, 
   3.8303207143938656`*^9}, {3.830325271649313*^9, 3.830325289703823*^9}, {
   3.8303509195690355`*^9, 3.830350932572076*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"b8531f2d-8289-46d1-aa54-d55cfb4c1e90"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8789060918282733`*^9, 
  3.8789061096464577`*^9}},ExpressionUUID->"1a2e0b96-fff3-4763-85d6-\
59087e104783"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "State2String2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"State2String2", "[", 
    RowBox[{
     RowBox[{"type1_Integer", "?", "SignQ"}], ",", 
     RowBox[{"type2_Integer", "?", "SignQ"}], ",", "\[Alpha]1_Real", ",", 
     "\[Alpha]2_Real", ",", "\[Nu]_Real"}], "]"}], "[", "state_Association", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Phi]r", ",", "\[Chi]r", ",", "A\[Theta]", ",", "\[Epsilon]", ",", 
      "\[Phi]", ",", "\[Chi]", ",", "Ax", ",", "Ay", ",", "Az"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Phi]r", ",", "\[Chi]r", ",", "A\[Theta]", ",", "\[Epsilon]"}], 
       "}"}], "=", 
      RowBox[{"state", "/@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\[Phi]\>\"", ",", "\"\<\[Chi]\>\"", ",", "\"\<A\[Theta]\>\"", 
         ",", "\"\<\[Epsilon]\>\""}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Phi]", "=", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"\[Phi]r", "@", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["#1", "2"], "+", 
            SuperscriptBox["#2", "2"]}]]}], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "type1", " ", 
           RowBox[{"Arg", "[", 
            RowBox[{"#1", "+", 
             RowBox[{"\[ImaginaryI]", "#2"}]}], "]"}]}]]}], "]"}], "&"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Chi]", "=", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Alpha]2", "]"}], ",", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Alpha]2", "]"}], 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Alpha]1", "+", 
              RowBox[{
               RowBox[{"Abs", "@", "\[Nu]"}], 
               RowBox[{"(", 
                RowBox[{"#4", "-", 
                 RowBox[{
                  RowBox[{"Sign", "@", "\[Nu]"}], "#3"}]}], ")"}]}]}], 
             "]"}]}], ",", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Alpha]2", "]"}], 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Alpha]1", "+", 
              RowBox[{
               RowBox[{"Abs", "@", "\[Nu]"}], 
               RowBox[{"(", 
                RowBox[{"#4", "-", 
                 RowBox[{
                  RowBox[{"Sign", "@", "\[Nu]"}], "#3"}]}], ")"}]}]}], 
             "]"}]}]}], "}"}], 
         RowBox[{"\[Chi]r", "@", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["#1", "2"], "+", 
            SuperscriptBox["#2", "2"]}]]}]}], "]"}], "&"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Ax", "=", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"-", "type2"}], 
         FractionBox["#2", 
          RowBox[{
           SuperscriptBox["#1", "2"], "+", 
           SuperscriptBox["#2", "2"], "+", 
           SuperscriptBox["\[Epsilon]", "2"]}]], " ", 
         RowBox[{"A\[Theta]", "@", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["#1", "2"], "+", 
            SuperscriptBox["#2", "2"], "+", 
            SuperscriptBox["\[Epsilon]", "2"]}]]}]}], "]"}], "&"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Ay", "=", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"type2", 
         FractionBox["#1", 
          RowBox[{
           SuperscriptBox["#1", "2"], "+", 
           SuperscriptBox["#2", "2"], "+", 
           SuperscriptBox["\[Epsilon]", "2"]}]], " ", 
         RowBox[{"A\[Theta]", "@", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["#1", "2"], "+", 
            SuperscriptBox["#2", "2"], "+", 
            SuperscriptBox["\[Epsilon]", "2"]}]]}]}], "]"}], "&"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Az", "=", 
      RowBox[{"0", "&"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<lR\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<lR\>\""}]}], ",", 
       RowBox[{"\"\<nR\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<nR\>\""}]}], ",", 
       RowBox[{"\"\<\[Epsilon]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Epsilon]\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<v\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<v\>\""}]}], ",", 
       RowBox[{"\"\<\[Lambda]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Lambda]\>\""}]}], ",", 
       RowBox[{"\"\<q\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<q\>\""}]}], ",", 
       RowBox[{"\"\<\[Omega]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Omega]\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<r\[Phi]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<r\[Phi]\>\""}]}], ",", 
       RowBox[{"\"\<r\[Chi]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<r\[Chi]\>\""}]}], ",", 
       RowBox[{"\"\<rA\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<rA\>\""}]}], ",", 
       RowBox[{"\"\<\[Chi]0\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Chi]0\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<lX\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"state", "@", "\"\<lR\>\""}], "/", 
         SqrtBox["2"]}]}], ",", 
       RowBox[{"\"\<lY\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"state", "@", "\"\<lR\>\""}], "/", 
         SqrtBox["2"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<\[Phi]\>\"", "\[Rule]", "\[Phi]"}], ",", 
       RowBox[{"\"\<\[Chi]\>\"", "\[Rule]", "\[Chi]"}], ",", 
       RowBox[{"\"\<Ax\>\"", "\[Rule]", "Ax"}], ",", 
       RowBox[{"\"\<Ay\>\"", "\[Rule]", "Ay"}], ",", 
       RowBox[{"\"\<Az\>\"", "\[Rule]", "Az"}]}], "\[IndentingNewLine]", 
      "|>"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.809265582199331*^9, 3.809265589383751*^9}, {
   3.809265672709119*^9, 3.8092658750289087`*^9}, {3.809265983751335*^9, 
   3.809266011108235*^9}, {3.809266051523666*^9, 3.809266119544161*^9}, {
   3.8092661592853165`*^9, 3.8092662014443502`*^9}, {3.8092662830762777`*^9, 
   3.8092663885321054`*^9}, {3.8092671983456025`*^9, 3.809267218449543*^9}, {
   3.8092672879585543`*^9, 3.80926730094452*^9}, {3.809315709894777*^9, 
   3.8093157420597563`*^9}, {3.8102925169632792`*^9, 3.810292520354377*^9}, {
   3.8102966221866813`*^9, 3.8102966325029135`*^9}, {3.8102972793770914`*^9, 
   3.810297298879483*^9}, {3.8103040607630672`*^9, 3.8103040667147317`*^9}, {
   3.810304141322403*^9, 3.8103041467741165`*^9}, {3.810461239957264*^9, 
   3.8104612453038416`*^9}, {3.8104617643691206`*^9, 3.810461776326338*^9}, 
   3.8104641242455373`*^9, {3.823871969820508*^9, 3.8238719772555823`*^9}, {
   3.823872028416895*^9, 3.8238721063789763`*^9}, {3.823872143288538*^9, 
   3.823872150886425*^9}, {3.8238723379501333`*^9, 3.8238724675506907`*^9}, {
   3.8238725376378746`*^9, 3.8238725443333874`*^9}, {3.8239253021911116`*^9, 
   3.8239253529898944`*^9}, {3.8239257273086567`*^9, 3.82392575303907*^9}, {
   3.8239258117241592`*^9, 3.8239258496771727`*^9}, {3.823925881148484*^9, 
   3.8239259064291334`*^9}, {3.8239264194548235`*^9, 
   3.8239264312002583`*^9}, {3.8242036722632103`*^9, 3.8242036779752707`*^9}, 
   3.8242037218768287`*^9, {3.8249749070226746`*^9, 3.82497492413868*^9}, {
   3.8249751804953804`*^9, 3.824975241415984*^9}, {3.825136335615833*^9, 
   3.825136397694528*^9}, {3.8302530318913755`*^9, 3.8302530559118433`*^9}, {
   3.8302531409897995`*^9, 3.8302531833259296`*^9}, {3.830263467929145*^9, 
   3.8302634681021395`*^9}, {3.8303207092016973`*^9, 
   3.8303207143938656`*^9}, {3.830325271649313*^9, 3.830325289703823*^9}, {
   3.8303509195690355`*^9, 3.830350932572076*^9}, {3.8743985732808867`*^9, 
   3.874398605591355*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"71ee7b64-7b00-4554-8fdb-c2745d73ecc6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "Grid3D"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Grid3D", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"lX_", ",", "nX_Integer"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"lY_", ",", "nY_Integer"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"lZ_", ",", "nZ_Integer"}], "}"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dx", ",", "dy", ",", "dz"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dx", ",", "dy", ",", "dz"}], "}"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lX", ",", "lY", ",", "lZ"}], "}"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"nX", ",", "nY", ",", "nZ"}], "}"}], "-", "1"}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"dx", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Range", "@", "nX"}], "-", "1"}], ")"}]}], "-", 
          RowBox[{"lX", "/", "2"}]}], ",", "dx"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"dy", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Range", "@", "nY"}], "-", "1"}], ")"}]}], "-", 
          RowBox[{"lY", "/", "2"}]}], ",", "dy"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"dz", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Range", "@", "nZ"}], "-", "1"}], ")"}]}], "-", 
          RowBox[{"lZ", "/", "2"}]}], ",", "dz"}], "}"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8008477761415567`*^9, 3.8008478971634407`*^9}, {
  3.8008487508286896`*^9, 3.80084875260066*^9}, {3.8008487826499767`*^9, 
  3.8008487838319826`*^9}, {3.800848820841282*^9, 3.800848837625389*^9}, {
  3.8008488773514805`*^9, 3.8008488846629906`*^9}, {3.8008489599623995`*^9, 
  3.8008489655594034`*^9}, {3.800849753830514*^9, 3.800849801012352*^9}, {
  3.8238726163716316`*^9, 3.823872660493373*^9}, {3.865268971519082*^9, 
  3.8652689737833424`*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"1f8de27a-2d0c-447c-9db9-118e22b5211f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "xBoost"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xBoost", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[CapitalDelta]x_Real", ",", "\[CapitalDelta]y_Real", ",", 
       "\[CapitalDelta]z_Real"}], "}"}], ",", "\[Beta]x_Real"}], "]"}], "[", 
   "func_", "]"}], ":=", 
  RowBox[{
   RowBox[{"func", "[", 
    RowBox[{
     FractionBox[
      RowBox[{"#2", "-", "\[CapitalDelta]x", "+", 
       RowBox[{"\[Beta]x", "#1"}]}], 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["\[Beta]x", "2"]}]]], ",", 
     RowBox[{"#3", "-", "\[CapitalDelta]y"}], ",", 
     RowBox[{"#4", "-", "\[CapitalDelta]z"}], ",", 
     FractionBox[
      RowBox[{"#1", "+", 
       RowBox[{"\[Beta]x", " ", 
        RowBox[{"(", 
         RowBox[{"#2", "-", "\[CapitalDelta]x"}], ")"}]}]}], 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["\[Beta]x", "2"]}]]]}], "]"}], "&"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.801370603320181*^9, 3.8013706549209223`*^9}, {
   3.801370685596139*^9, 3.8013707227213345`*^9}, {3.801372330833934*^9, 
   3.801372331878893*^9}, {3.80137532194495*^9, 3.801375356281929*^9}, {
   3.8014595714470043`*^9, 3.8014595739290533`*^9}, {3.8014607630205803`*^9, 
   3.8014607858871775`*^9}, {3.809322150508735*^9, 3.809322173649521*^9}, {
   3.8159993435863266`*^9, 3.8159994040213413`*^9}, {3.8159998178598194`*^9, 
   3.8159998505162024`*^9}, {3.815999903397151*^9, 3.8159999060192375`*^9}, {
   3.8239217580541077`*^9, 3.8239217641096745`*^9}, {3.8248093877917476`*^9, 
   3.824809394345093*^9}, {3.8248094403559694`*^9, 3.8248094874765663`*^9}, {
   3.8303255219240427`*^9, 3.8303255274588213`*^9}, {3.8303257052152953`*^9, 
   3.830325723353224*^9}, {3.8788003545970316`*^9, 3.8788003606205883`*^9}, {
   3.8788038948695283`*^9, 3.8788039029064283`*^9}, 3.878807731189062*^9},
 CellLabel->"In[65]:=",ExpressionUUID->"c9493be2-53f6-460a-95d3-e5f6f7bbfa6c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "xBoostgeneral"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xBoostgeneral", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[CapitalDelta]x_Real", ",", "\[CapitalDelta]y_Real", ",", 
       "\[CapitalDelta]z_Real"}], "}"}], ",", "\[Beta]x_Real", ",", 
     "\[Beta]y_Real", ",", "\[Beta]z_Real"}], "]"}], "[", "func_", "]"}], ":=", 
  RowBox[{
   RowBox[{"func", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Beta]x", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Beta]x", "2"], "+", 
           SuperscriptBox["\[Beta]y", "2"], "+", 
           SuperscriptBox["\[Beta]z", "2"]}], ")"}], " ", "#1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Beta]x", "2"], "+", 
           RowBox[{
            SqrtBox[
             RowBox[{"1", "-", 
              SuperscriptBox["\[Beta]x", "2"], "-", 
              SuperscriptBox["\[Beta]y", "2"], "-", 
              SuperscriptBox["\[Beta]z", "2"]}]], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[Beta]y", "2"], "+", 
              SuperscriptBox["\[Beta]z", "2"]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "\[CapitalDelta]x"}], "+", "#2"}], ")"}]}], "+", 
        RowBox[{"\[Beta]x", " ", "\[Beta]y", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox["\[Beta]x", "2"], "-", 
             SuperscriptBox["\[Beta]y", "2"], "-", 
             SuperscriptBox["\[Beta]z", "2"]}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"\[CapitalDelta]y", "-", "#3"}], ")"}]}], "+", 
        RowBox[{"\[Beta]x", " ", "\[Beta]z", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox["\[Beta]x", "2"], "-", 
             SuperscriptBox["\[Beta]y", "2"], "-", 
             SuperscriptBox["\[Beta]z", "2"]}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"\[CapitalDelta]z", "-", "#4"}], ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Beta]x", "2"], "-", 
          SuperscriptBox["\[Beta]y", "2"], "-", 
          SuperscriptBox["\[Beta]z", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Beta]x", "2"], "+", 
          SuperscriptBox["\[Beta]y", "2"], "+", 
          SuperscriptBox["\[Beta]z", "2"]}], ")"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Beta]y", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Beta]x", "2"], "+", 
           SuperscriptBox["\[Beta]y", "2"], "+", 
           SuperscriptBox["\[Beta]z", "2"]}], ")"}], " ", "#1"}], "+", 
        RowBox[{"\[Beta]x", " ", "\[Beta]y", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox["\[Beta]x", "2"], "-", 
             SuperscriptBox["\[Beta]y", "2"], "-", 
             SuperscriptBox["\[Beta]z", "2"]}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"\[CapitalDelta]x", "-", "#2"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Beta]y", "2"], "+", 
           RowBox[{
            SqrtBox[
             RowBox[{"1", "-", 
              SuperscriptBox["\[Beta]x", "2"], "-", 
              SuperscriptBox["\[Beta]y", "2"], "-", 
              SuperscriptBox["\[Beta]z", "2"]}]], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[Beta]x", "2"], "+", 
              SuperscriptBox["\[Beta]z", "2"]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "\[CapitalDelta]y"}], "+", "#3"}], ")"}]}], "+", 
        RowBox[{"\[Beta]y", " ", "\[Beta]z", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox["\[Beta]x", "2"], "-", 
             SuperscriptBox["\[Beta]y", "2"], "-", 
             SuperscriptBox["\[Beta]z", "2"]}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"\[CapitalDelta]z", "-", "#4"}], ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Beta]x", "2"], "-", 
          SuperscriptBox["\[Beta]y", "2"], "-", 
          SuperscriptBox["\[Beta]z", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Beta]x", "2"], "+", 
          SuperscriptBox["\[Beta]y", "2"], "+", 
          SuperscriptBox["\[Beta]z", "2"]}], ")"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Beta]z", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Beta]x", "2"], "+", 
           SuperscriptBox["\[Beta]y", "2"], "+", 
           SuperscriptBox["\[Beta]z", "2"]}], ")"}], " ", "#1"}], "+", 
        RowBox[{"\[Beta]x", " ", "\[Beta]z", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox["\[Beta]x", "2"], "-", 
             SuperscriptBox["\[Beta]y", "2"], "-", 
             SuperscriptBox["\[Beta]z", "2"]}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"\[CapitalDelta]x", "-", "#2"}], ")"}]}], "+", 
        RowBox[{"\[Beta]y", " ", "\[Beta]z", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox["\[Beta]x", "2"], "-", 
             SuperscriptBox["\[Beta]y", "2"], "-", 
             SuperscriptBox["\[Beta]z", "2"]}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"\[CapitalDelta]y", "-", "#3"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Beta]z", "2"], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[Beta]x", "2"], "+", 
              SuperscriptBox["\[Beta]y", "2"]}], ")"}], " ", 
            SqrtBox[
             RowBox[{"1", "-", 
              SuperscriptBox["\[Beta]x", "2"], "-", 
              SuperscriptBox["\[Beta]y", "2"], "-", 
              SuperscriptBox["\[Beta]z", "2"]}]]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "\[CapitalDelta]z"}], "+", "#4"}], ")"}]}]}], ")"}], 
      "/", 
      RowBox[{"(", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Beta]x", "2"], "-", 
          SuperscriptBox["\[Beta]y", "2"], "-", 
          SuperscriptBox["\[Beta]z", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Beta]x", "2"], "+", 
          SuperscriptBox["\[Beta]y", "2"], "+", 
          SuperscriptBox["\[Beta]z", "2"]}], ")"}]}], ")"}]}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Beta]z"}], " ", "\[CapitalDelta]z"}], "+", "#1", "+", 
       RowBox[{"\[Beta]x", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "\[CapitalDelta]x"}], "+", "#2"}], ")"}]}], "+", 
       RowBox[{"\[Beta]y", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "\[CapitalDelta]y"}], "+", "#3"}], ")"}]}], "+", 
       RowBox[{"\[Beta]z", " ", "#4"}]}], 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["\[Beta]x", "2"], "-", 
        SuperscriptBox["\[Beta]y", "2"], "-", 
        SuperscriptBox["\[Beta]z", "2"]}]]]}], "]"}], "&"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQ/cYu629n0BtHo4q7zF1AepLwZnYQrSMazgOip62P
ugqin8jXgGkOWzvvHiA9gbXTH0Tf8c3L2wqkz+3aC6ZnrEhg3gakDyXbsIHo
fvcLU7YkvnF8cGLLdBBtcPjT24K8N45X1jV8BdFLmq01C4H07pYAXRBdtvWN
MYieMdfBBEQ77D7o3Vv7xrGkqdkHRP8PrdxqV//GkYHbexuIlkrh3gOiORze
HwTRhybaKh3pfOO4at07ML35sZoliJ7jm20Nom/ND5n56+kbR00e+1kgepai
kov0szeOz/aZgOkWr1RfEP02b6kfiF7m8iEMRDv5Lo8F0Y/brNeA6FXL/DeC
aAA+0qVZ
  "],
 CellLabel->"In[67]:=",ExpressionUUID->"57ca39f7-537c-414f-8b0e-e2ac5425586d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "PrepareString"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrepareString", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"type1_Integer", "?", "SignQ"}], ",", 
       RowBox[{"type2_Integer", "?", "SignQ"}], ",", "\[Alpha]1_Real", ",", 
       "\[Alpha]2_Real", ",", "\[Nu]1_Real"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]xy_Real", ",", "\[Theta]yz_Real"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\[CapitalDelta]x_Real", ",", "\[CapitalDelta]y_Real", ",", 
       "\[CapitalDelta]z_Real"}], "}"}], ",", "\[Beta]x_Real"}], "]"}], "[", 
   "state_Association", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"m", "=", 
       RowBox[{
        RowBox[{"RotationMatrix", "[", 
         RowBox[{"\[Theta]yz", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], ".", 
        RowBox[{"RotationMatrix", "[", 
         RowBox[{"\[Theta]xy", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], ",", 
      RowBox[{"\[Gamma]", "=", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["\[Beta]x", "2"]}]]}], ",", "minv", ",", "\[Phi]", 
      ",", "\[Chi]", ",", "Ax", ",", "Ay", ",", "Az", ",", "\[Phi]b", ",", 
      "\[Chi]b", ",", "Axb", ",", "Ayb", ",", "Azb", ",", "A0b", ",", "x", 
      ",", "y", ",", "z", ",", "\[Phi]f", ",", "\[Chi]f", ",", "Axf", ",", 
      "Ayf", ",", "Azf", ",", "A0f"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"minv", "=", 
      RowBox[{"Inverse", "@", "m"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Phi]", ",", "\[Chi]", ",", "Ax", ",", "Ay", ",", "Az"}], 
       "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"State2String2", "[", 
         RowBox[{
         "type1", ",", "type2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", 
          "\[Nu]1"}], "]"}], "@", "state"}], "/@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\[Phi]\>\"", ",", "\"\<\[Chi]\>\"", ",", "\"\<Ax\>\"", ",", 
         "\"\<Ay\>\"", ",", "\"\<Az\>\""}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Phi]b", ",", "\[Chi]b", ",", "Ayb", ",", "Azb"}], "}"}], 
      "=", 
      RowBox[{
       RowBox[{"xBoost", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CapitalDelta]x", ",", "\[CapitalDelta]y", ",", 
           "\[CapitalDelta]z"}], "}"}], ",", "\[Beta]x"}], "]"}], "/@", 
       RowBox[{"{", 
        RowBox[{"\[Phi]", ",", "\[Chi]", ",", "Ay", ",", "Az"}], "}"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Axb", "[", 
       RowBox[{"t_", ",", "x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"Ax", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", "-", "\[CapitalDelta]x", "+", 
            RowBox[{"\[Beta]x", " ", "t"}]}], ")"}], "/", "\[Gamma]"}], ",", 
         RowBox[{"y", "-", "\[CapitalDelta]y"}], ",", 
         RowBox[{"z", "-", "\[CapitalDelta]z"}]}], "]"}], "/", "\[Gamma]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A0b", "[", 
       RowBox[{"t_", ",", "x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
      RowBox[{"\[Beta]x", " ", 
       RowBox[{
        RowBox[{"Ax", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x", "-", "\[CapitalDelta]x", "+", 
             RowBox[{"\[Beta]x", " ", "t"}]}], ")"}], "/", "\[Gamma]"}], ",", 
          RowBox[{"y", "-", "\[CapitalDelta]y"}], ",", 
          RowBox[{"z", "-", "\[CapitalDelta]z"}]}], "]"}], "/", 
        "\[Gamma]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"xp_", ",", "yp_", ",", "zp_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"minv", ".", 
         RowBox[{"{", 
          RowBox[{"xp", ",", "yp", ",", "zp"}], "}"}]}], ")"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"xp_", ",", "yp_", ",", "zp_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"minv", ".", 
         RowBox[{"{", 
          RowBox[{"xp", ",", "yp", ",", "zp"}], "}"}]}], ")"}], 
       "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"xp_", ",", "yp_", ",", "zp_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"minv", ".", 
         RowBox[{"{", 
          RowBox[{"xp", ",", "yp", ",", "zp"}], "}"}]}], ")"}], 
       "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Phi]f", "[", 
       RowBox[{"t_", ",", "xp_", ",", "yp_", ",", "zp_"}], "]"}], ":=", 
      RowBox[{"\[Phi]b", "[", 
       RowBox[{"t", ",", 
        RowBox[{"x", "[", 
         RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Chi]f", "[", 
       RowBox[{"t_", ",", "xp_", ",", "yp_", ",", "zp_"}], "]"}], ":=", 
      RowBox[{"\[Chi]b", "[", 
       RowBox[{"t", ",", 
        RowBox[{"x", "[", 
         RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Axf", "[", 
       RowBox[{"t_", ",", "xp_", ",", "yp_", ",", "zp_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m", ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Axb", "[", 
            RowBox[{"t", ",", 
             RowBox[{"x", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"y", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"z", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}]}], "]"}], ",", 
           RowBox[{"Ayb", "[", 
            RowBox[{"t", ",", 
             RowBox[{"x", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"y", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"z", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}]}], "]"}], ",", 
           RowBox[{"Azb", "[", 
            RowBox[{"t", ",", 
             RowBox[{"x", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"y", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"z", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}]}], "]"}]}], "}"}]}],
         ")"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Ayf", "[", 
       RowBox[{"t_", ",", "xp_", ",", "yp_", ",", "zp_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m", ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Axb", "[", 
            RowBox[{"t", ",", 
             RowBox[{"x", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"y", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"z", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}]}], "]"}], ",", 
           RowBox[{"Ayb", "[", 
            RowBox[{"t", ",", 
             RowBox[{"x", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"y", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"z", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}]}], "]"}], ",", 
           RowBox[{"Azb", "[", 
            RowBox[{"t", ",", 
             RowBox[{"x", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"y", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"z", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}]}], "]"}]}], "}"}]}],
         ")"}], "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Azf", "[", 
       RowBox[{"t_", ",", "xp_", ",", "yp_", ",", "zp_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m", ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Axb", "[", 
            RowBox[{"t", ",", 
             RowBox[{"x", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"y", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"z", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}]}], "]"}], ",", 
           RowBox[{"Ayb", "[", 
            RowBox[{"t", ",", 
             RowBox[{"x", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"y", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"z", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}]}], "]"}], ",", 
           RowBox[{"Azb", "[", 
            RowBox[{"t", ",", 
             RowBox[{"x", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"y", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"z", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}]}], "]"}]}], "}"}]}],
         ")"}], "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A0f", "[", 
       RowBox[{"t_", ",", "xp_", ",", "yp_", ",", "zp_"}], "]"}], ":=", 
      RowBox[{"A0b", "[", 
       RowBox[{"t", ",", 
        RowBox[{"x", "[", 
         RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<lR\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<lR\>\""}]}], ",", 
       RowBox[{"\"\<nR\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<nR\>\""}]}], ",", 
       RowBox[{"\"\<\[Epsilon]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Epsilon]\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<v\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<v\>\""}]}], ",", 
       RowBox[{"\"\<\[Lambda]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Lambda]\>\""}]}], ",", 
       RowBox[{"\"\<q\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<q\>\""}]}], ",", 
       RowBox[{"\"\<\[Omega]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Omega]\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<r\[Phi]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<r\[Phi]\>\""}]}], ",", 
       RowBox[{"\"\<r\[Chi]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<r\[Chi]\>\""}]}], ",", 
       RowBox[{"\"\<rA\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<rA\>\""}]}], ",", 
       RowBox[{"\"\<\[Chi]0\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Chi]0\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<\[CapitalDelta]x\>\"", "\[Rule]", "\[CapitalDelta]x"}], 
       ",", 
       RowBox[{"\"\<\[CapitalDelta]y\>\"", "\[Rule]", "\[CapitalDelta]y"}], 
       ",", 
       RowBox[{"\"\<\[Beta]x\>\"", "\[Rule]", "\[Beta]x"}], ",", 
       RowBox[{"\"\<\[Theta]xy\>\"", "\[Rule]", "\[Theta]xy"}], ",", 
       RowBox[{"\"\<\[Theta]yz\>\"", "\[Rule]", "\[Theta]yz"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<\[Phi]\>\"", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Evaluate", "@", 
           RowBox[{"\[Phi]f", "[", 
            RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4"}], "]"}]}], "&"}], 
         ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<\[Chi]\>\"", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Evaluate", "@", 
           RowBox[{"\[Chi]f", "[", 
            RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4"}], "]"}]}], "&"}], 
         ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<Ax\>\"", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Evaluate", "@", 
           RowBox[{"Axf", "[", 
            RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4"}], "]"}]}], "&"}], 
         ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<Ay\>\"", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Evaluate", "@", 
           RowBox[{"Ayf", "[", 
            RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4"}], "]"}]}], "&"}], 
         ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<Az\>\"", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Evaluate", "@", 
           RowBox[{"Azf", "[", 
            RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4"}], "]"}]}], "&"}], 
         ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<A0\>\"", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Evaluate", "@", 
           RowBox[{"A0f", "[", 
            RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4"}], "]"}]}], "&"}], 
         ")"}]}]}], "\[IndentingNewLine]", "|>"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8158075472629547`*^9, 3.8158077033048463`*^9}, {
   3.815807847209219*^9, 3.8158078998354783`*^9}, {3.815807957181091*^9, 
   3.8158079744542933`*^9}, {3.8158081768889537`*^9, 3.815808327708107*^9}, {
   3.8158084563571897`*^9, 3.815808516277392*^9}, {3.8158085887324133`*^9, 
   3.8158087270549974`*^9}, {3.815809034936612*^9, 3.8158090511401715`*^9}, {
   3.8158090930315332`*^9, 3.8158091763409605`*^9}, {3.81580920696308*^9, 
   3.815809210436359*^9}, {3.815809255949845*^9, 3.815809314094891*^9}, {
   3.8158093658988266`*^9, 3.815809382706862*^9}, {3.815809413318904*^9, 
   3.815809432418019*^9}, {3.8158095386761627`*^9, 3.8158096741577263`*^9}, {
   3.81580970646659*^9, 3.8158098651418424`*^9}, {3.815811212093974*^9, 
   3.8158112132123766`*^9}, {3.8159997876877565`*^9, 
   3.8159997943368635`*^9}, {3.815999869104211*^9, 3.815999893041023*^9}, {
   3.81599993021967*^9, 3.8159999389421325`*^9}, 3.8160051600997005`*^9, {
   3.823871894000953*^9, 3.8238718960672283`*^9}, {3.8238769336562448`*^9, 
   3.823876946791911*^9}, {3.8238771713087883`*^9, 3.8238773247039866`*^9}, {
   3.823877442663305*^9, 3.8238775068156047`*^9}, {3.8238775767739697`*^9, 
   3.8238776706382017`*^9}, {3.8238777247089915`*^9, 3.823877742057912*^9}, {
   3.823877784804416*^9, 3.823877801877864*^9}, {3.823921774790779*^9, 
   3.8239217769532676`*^9}, {3.823921806996565*^9, 3.8239218267546444`*^9}, 
   3.8239218766538396`*^9, {3.823924563266675*^9, 3.823924568274645*^9}, {
   3.8239246344230657`*^9, 3.8239246353945103`*^9}, {3.8239246749809713`*^9, 
   3.823924699154463*^9}, {3.8239250076485367`*^9, 3.823925056735458*^9}, {
   3.823925377312067*^9, 3.8239254137614627`*^9}, {3.8239255668655033`*^9, 
   3.823925612917856*^9}, {3.823925996637082*^9, 3.823926122236102*^9}, {
   3.8239263800281377`*^9, 3.823926415365836*^9}, {3.8239264753471727`*^9, 
   3.823926475532343*^9}, {3.823926515470249*^9, 3.823926516910271*^9}, {
   3.823926564715702*^9, 3.82392668425552*^9}, {3.8239267363305225`*^9, 
   3.823926738784274*^9}, {3.8239268312511997`*^9, 3.8239268333233585`*^9}, {
   3.823926878642115*^9, 3.823926983675339*^9}, {3.8239270242388396`*^9, 
   3.823927029146434*^9}, {3.8242037113405776`*^9, 3.824203711513528*^9}, {
   3.824809362029803*^9, 3.824809377304432*^9}, {3.82480950244132*^9, 
   3.8248095837427483`*^9}, {3.8249749505903153`*^9, 3.824974953544851*^9}, {
   3.824975089821473*^9, 3.8249750900878496`*^9}, {3.8249752519808183`*^9, 
   3.824975264279797*^9}, 3.825136450033769*^9, {3.8302532691519213`*^9, 
   3.8302532796949883`*^9}, {3.830253400899658*^9, 3.8302535556158905`*^9}, {
   3.8302536040312366`*^9, 3.8302536359180994`*^9}, {3.830253706676361*^9, 
   3.8302537097269793`*^9}, {3.830263388288637*^9, 3.8302634502584224`*^9}, {
   3.8303187199848022`*^9, 3.830318727568217*^9}, {3.8303191731618547`*^9, 
   3.8303191760908785`*^9}, {3.8303253580972757`*^9, 
   3.8303254397429624`*^9}, {3.8303257812612877`*^9, 3.830325786342256*^9}, {
   3.8743986155060873`*^9, 3.8743986288123364`*^9}, {3.874398887227358*^9, 
   3.874398902029831*^9}, {3.8786620304626846`*^9, 3.8786620319834003`*^9}, {
   3.878670309809404*^9, 3.8786703379039536`*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"2290b599-7f53-4357-ba21-7917ad8c923a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "PrepareStringgenBoost"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrepareStringgenBoost", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"type1_Integer", "?", "SignQ"}], ",", 
       RowBox[{"type2_Integer", "?", "SignQ"}], ",", "\[Alpha]1_Real", ",", 
       "\[Alpha]2_Real", ",", "\[Nu]1_Real"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]xy_Real", ",", "\[Theta]yz_Real"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\[CapitalDelta]x_Real", ",", "\[CapitalDelta]y_Real", ",", 
       "\[CapitalDelta]z_Real"}], "}"}], ",", "\[Beta]x_Real", ",", 
     "\[Beta]y_Real", ",", "\[Beta]z_Real"}], "]"}], "[", "state_Association",
    "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"m", "=", 
       RowBox[{
        RowBox[{"RotationMatrix", "[", 
         RowBox[{"\[Theta]yz", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], ".", 
        RowBox[{"RotationMatrix", "[", 
         RowBox[{"\[Theta]xy", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], ",", 
      RowBox[{"\[Gamma]", "=", 
       SqrtBox[
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Beta]x", "2"], "+", 
           SuperscriptBox["\[Beta]y", "2"], "+", 
           SuperscriptBox["\[Beta]z", "2"]}], ")"}]}]]}], ",", "minv", ",", 
      "\[Phi]", ",", "\[Chi]", ",", "Ax", ",", "Ay", ",", "Az", ",", 
      "\[Phi]b", ",", "\[Chi]b", ",", "Axb", ",", "Ayb", ",", "Azb", ",", 
      "A0b", ",", "x", ",", "y", ",", "z", ",", "\[Phi]f", ",", "\[Chi]f", 
      ",", "Axf", ",", "Ayf", ",", "Azf", ",", "A0f"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"minv", "=", 
      RowBox[{"Inverse", "@", "m"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Phi]", ",", "\[Chi]", ",", "Ax", ",", "Ay", ",", "Az"}], 
       "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"State2String2", "[", 
         RowBox[{
         "type1", ",", "type2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", 
          "\[Nu]1"}], "]"}], "@", "state"}], "/@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\[Phi]\>\"", ",", "\"\<\[Chi]\>\"", ",", "\"\<Ax\>\"", ",", 
         "\"\<Ay\>\"", ",", "\"\<Az\>\""}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Phi]b", ",", "\[Chi]b", ",", "Ayb", ",", "Azb", ",", "Axb"}], "}"}],
       "=", 
      RowBox[{
       RowBox[{"xBoostgeneral", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CapitalDelta]x", ",", "\[CapitalDelta]y", ",", 
           "\[CapitalDelta]z"}], "}"}], ",", "\[Beta]x", ",", "\[Beta]y", ",",
          "\[Beta]z"}], "]"}], "/@", 
       RowBox[{"{", 
        RowBox[{"\[Phi]", ",", "\[Chi]", ",", "Ay", ",", "Az", ",", "Ax"}], 
        "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"Axb", "[", 
         RowBox[{"t_", ",", "x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"Ax", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"x", "-", "\[CapitalDelta]x", "+", 
              RowBox[{"\[Beta]x", " ", "t"}]}], ")"}], "/", "\[Gamma]"}], ",", 
           RowBox[{"y", "-", "\[CapitalDelta]y"}], ",", 
           RowBox[{"z", "-", "\[CapitalDelta]z"}]}], "]"}], "/", 
         "\[Gamma]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A0b", "[", 
       RowBox[{"t_", ",", "x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"\[Beta]x", " ", 
        RowBox[{
         RowBox[{"Ax", "[", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"t", " ", "\[Beta]x", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Beta]x", "2"], "+", 
                SuperscriptBox["\[Beta]y", "2"], "+", 
                SuperscriptBox["\[Beta]z", "2"]}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Beta]x", "2"], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["\[Beta]y", "2"], "+", 
                   SuperscriptBox["\[Beta]z", "2"]}], ")"}], " ", 
                 "\[Gamma]"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"x", "-", "\[CapitalDelta]x"}], ")"}]}], "-", 
             RowBox[{"\[Beta]x", " ", "\[Beta]y", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"y", "-", "\[CapitalDelta]y"}], ")"}]}], "-", 
             RowBox[{"\[Beta]x", " ", "\[Beta]z", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"z", "-", "\[CapitalDelta]z"}], ")"}]}]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Beta]x", "2"], "+", 
               SuperscriptBox["\[Beta]y", "2"], "+", 
               SuperscriptBox["\[Beta]z", "2"]}], ")"}], " ", "\[Gamma]"}]], 
           ",", 
           FractionBox[
            RowBox[{
             RowBox[{"t", " ", "\[Beta]y", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Beta]x", "2"], "+", 
                SuperscriptBox["\[Beta]y", "2"], "+", 
                SuperscriptBox["\[Beta]z", "2"]}], ")"}]}], "-", 
             RowBox[{"\[Beta]x", " ", "\[Beta]y", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"x", "-", "\[CapitalDelta]x"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Beta]y", "2"], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["\[Beta]x", "2"], "+", 
                   SuperscriptBox["\[Beta]z", "2"]}], ")"}], " ", 
                 "\[Gamma]"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"y", "-", "\[CapitalDelta]y"}], ")"}]}], "-", 
             RowBox[{"\[Beta]y", " ", "\[Beta]z", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"z", "-", "\[CapitalDelta]z"}], ")"}]}]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Beta]x", "2"], "+", 
               SuperscriptBox["\[Beta]y", "2"], "+", 
               SuperscriptBox["\[Beta]z", "2"]}], ")"}], " ", "\[Gamma]"}]], 
           ",", 
           FractionBox[
            RowBox[{
             RowBox[{"t", " ", "\[Beta]z", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Beta]x", "2"], "+", 
                SuperscriptBox["\[Beta]y", "2"], "+", 
                SuperscriptBox["\[Beta]z", "2"]}], ")"}]}], "-", 
             RowBox[{"\[Beta]x", " ", "\[Beta]z", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"x", "-", "\[CapitalDelta]x"}], ")"}]}], "-", 
             RowBox[{"\[Beta]y", " ", "\[Beta]z", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"y", "-", "\[CapitalDelta]y"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Beta]z", "2"], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["\[Beta]x", "2"], "+", 
                   SuperscriptBox["\[Beta]y", "2"]}], ")"}], " ", 
                 "\[Gamma]"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"z", "-", "\[CapitalDelta]z"}], ")"}]}]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Beta]x", "2"], "+", 
               SuperscriptBox["\[Beta]y", "2"], "+", 
               SuperscriptBox["\[Beta]z", "2"]}], ")"}], " ", "\[Gamma]"}]]}],
           "]"}], "/", "\[Gamma]"}]}], "+", 
       RowBox[{"\[Beta]y", " ", 
        RowBox[{
         RowBox[{"Ay", "[", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"t", " ", "\[Beta]x", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Beta]x", "2"], "+", 
                SuperscriptBox["\[Beta]y", "2"], "+", 
                SuperscriptBox["\[Beta]z", "2"]}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Beta]x", "2"], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["\[Beta]y", "2"], "+", 
                   SuperscriptBox["\[Beta]z", "2"]}], ")"}], " ", 
                 "\[Gamma]"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"x", "-", "\[CapitalDelta]x"}], ")"}]}], "-", 
             RowBox[{"\[Beta]x", " ", "\[Beta]y", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"y", "-", "\[CapitalDelta]y"}], ")"}]}], "-", 
             RowBox[{"\[Beta]x", " ", "\[Beta]z", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"z", "-", "\[CapitalDelta]z"}], ")"}]}]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Beta]x", "2"], "+", 
               SuperscriptBox["\[Beta]y", "2"], "+", 
               SuperscriptBox["\[Beta]z", "2"]}], ")"}], " ", "\[Gamma]"}]], 
           ",", 
           FractionBox[
            RowBox[{
             RowBox[{"t", " ", "\[Beta]y", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Beta]x", "2"], "+", 
                SuperscriptBox["\[Beta]y", "2"], "+", 
                SuperscriptBox["\[Beta]z", "2"]}], ")"}]}], "-", 
             RowBox[{"\[Beta]x", " ", "\[Beta]y", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"x", "-", "\[CapitalDelta]x"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Beta]y", "2"], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["\[Beta]x", "2"], "+", 
                   SuperscriptBox["\[Beta]z", "2"]}], ")"}], " ", 
                 "\[Gamma]"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"y", "-", "\[CapitalDelta]y"}], ")"}]}], "-", 
             RowBox[{"\[Beta]y", " ", "\[Beta]z", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"z", "-", "\[CapitalDelta]z"}], ")"}]}]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Beta]x", "2"], "+", 
               SuperscriptBox["\[Beta]y", "2"], "+", 
               SuperscriptBox["\[Beta]z", "2"]}], ")"}], " ", "\[Gamma]"}]], 
           ",", 
           FractionBox[
            RowBox[{
             RowBox[{"t", " ", "\[Beta]z", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Beta]x", "2"], "+", 
                SuperscriptBox["\[Beta]y", "2"], "+", 
                SuperscriptBox["\[Beta]z", "2"]}], ")"}]}], "-", 
             RowBox[{"\[Beta]x", " ", "\[Beta]z", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"x", "-", "\[CapitalDelta]x"}], ")"}]}], "-", 
             RowBox[{"\[Beta]y", " ", "\[Beta]z", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"y", "-", "\[CapitalDelta]y"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Beta]z", "2"], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["\[Beta]x", "2"], "+", 
                   SuperscriptBox["\[Beta]y", "2"]}], ")"}], " ", 
                 "\[Gamma]"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"z", "-", "\[CapitalDelta]z"}], ")"}]}]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Beta]x", "2"], "+", 
               SuperscriptBox["\[Beta]y", "2"], "+", 
               SuperscriptBox["\[Beta]z", "2"]}], ")"}], " ", "\[Gamma]"}]]}],
           "]"}], "/", "\[Gamma]"}]}], "+", 
       RowBox[{"\[Beta]z", " ", 
        RowBox[{
         RowBox[{"Az", "[", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"t", " ", "\[Beta]x", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Beta]x", "2"], "+", 
                SuperscriptBox["\[Beta]y", "2"], "+", 
                SuperscriptBox["\[Beta]z", "2"]}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Beta]x", "2"], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["\[Beta]y", "2"], "+", 
                   SuperscriptBox["\[Beta]z", "2"]}], ")"}], " ", 
                 "\[Gamma]"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"x", "-", "\[CapitalDelta]x"}], ")"}]}], "-", 
             RowBox[{"\[Beta]x", " ", "\[Beta]y", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"y", "-", "\[CapitalDelta]y"}], ")"}]}], "-", 
             RowBox[{"\[Beta]x", " ", "\[Beta]z", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"z", "-", "\[CapitalDelta]z"}], ")"}]}]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Beta]x", "2"], "+", 
               SuperscriptBox["\[Beta]y", "2"], "+", 
               SuperscriptBox["\[Beta]z", "2"]}], ")"}], " ", "\[Gamma]"}]], 
           ",", 
           FractionBox[
            RowBox[{
             RowBox[{"t", " ", "\[Beta]y", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Beta]x", "2"], "+", 
                SuperscriptBox["\[Beta]y", "2"], "+", 
                SuperscriptBox["\[Beta]z", "2"]}], ")"}]}], "-", 
             RowBox[{"\[Beta]x", " ", "\[Beta]y", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"x", "-", "\[CapitalDelta]x"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Beta]y", "2"], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["\[Beta]x", "2"], "+", 
                   SuperscriptBox["\[Beta]z", "2"]}], ")"}], " ", 
                 "\[Gamma]"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"y", "-", "\[CapitalDelta]y"}], ")"}]}], "-", 
             RowBox[{"\[Beta]y", " ", "\[Beta]z", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"z", "-", "\[CapitalDelta]z"}], ")"}]}]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Beta]x", "2"], "+", 
               SuperscriptBox["\[Beta]y", "2"], "+", 
               SuperscriptBox["\[Beta]z", "2"]}], ")"}], " ", "\[Gamma]"}]], 
           ",", 
           FractionBox[
            RowBox[{
             RowBox[{"t", " ", "\[Beta]z", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Beta]x", "2"], "+", 
                SuperscriptBox["\[Beta]y", "2"], "+", 
                SuperscriptBox["\[Beta]z", "2"]}], ")"}]}], "-", 
             RowBox[{"\[Beta]x", " ", "\[Beta]z", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"x", "-", "\[CapitalDelta]x"}], ")"}]}], "-", 
             RowBox[{"\[Beta]y", " ", "\[Beta]z", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"y", "-", "\[CapitalDelta]y"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Beta]z", "2"], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["\[Beta]x", "2"], "+", 
                   SuperscriptBox["\[Beta]y", "2"]}], ")"}], " ", 
                 "\[Gamma]"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"z", "-", "\[CapitalDelta]z"}], ")"}]}]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Beta]x", "2"], "+", 
               SuperscriptBox["\[Beta]y", "2"], "+", 
               SuperscriptBox["\[Beta]z", "2"]}], ")"}], " ", "\[Gamma]"}]]}],
           "]"}], "/", "\[Gamma]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"xp_", ",", "yp_", ",", "zp_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"minv", ".", 
         RowBox[{"{", 
          RowBox[{"xp", ",", "yp", ",", "zp"}], "}"}]}], ")"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"xp_", ",", "yp_", ",", "zp_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"minv", ".", 
         RowBox[{"{", 
          RowBox[{"xp", ",", "yp", ",", "zp"}], "}"}]}], ")"}], 
       "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"xp_", ",", "yp_", ",", "zp_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"minv", ".", 
         RowBox[{"{", 
          RowBox[{"xp", ",", "yp", ",", "zp"}], "}"}]}], ")"}], 
       "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Phi]f", "[", 
       RowBox[{"t_", ",", "xp_", ",", "yp_", ",", "zp_"}], "]"}], ":=", 
      RowBox[{"\[Phi]b", "[", 
       RowBox[{"t", ",", 
        RowBox[{"x", "[", 
         RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Chi]f", "[", 
       RowBox[{"t_", ",", "xp_", ",", "yp_", ",", "zp_"}], "]"}], ":=", 
      RowBox[{"\[Chi]b", "[", 
       RowBox[{"t", ",", 
        RowBox[{"x", "[", 
         RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Axf", "[", 
       RowBox[{"t_", ",", "xp_", ",", "yp_", ",", "zp_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m", ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Axb", "[", 
            RowBox[{"t", ",", 
             RowBox[{"x", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"y", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"z", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}]}], "]"}], ",", 
           RowBox[{"Ayb", "[", 
            RowBox[{"t", ",", 
             RowBox[{"x", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"y", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"z", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}]}], "]"}], ",", 
           RowBox[{"Azb", "[", 
            RowBox[{"t", ",", 
             RowBox[{"x", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"y", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"z", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}]}], "]"}]}], "}"}]}],
         ")"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Ayf", "[", 
       RowBox[{"t_", ",", "xp_", ",", "yp_", ",", "zp_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m", ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Axb", "[", 
            RowBox[{"t", ",", 
             RowBox[{"x", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"y", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"z", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}]}], "]"}], ",", 
           RowBox[{"Ayb", "[", 
            RowBox[{"t", ",", 
             RowBox[{"x", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"y", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"z", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}]}], "]"}], ",", 
           RowBox[{"Azb", "[", 
            RowBox[{"t", ",", 
             RowBox[{"x", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"y", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"z", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}]}], "]"}]}], "}"}]}],
         ")"}], "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Azf", "[", 
       RowBox[{"t_", ",", "xp_", ",", "yp_", ",", "zp_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m", ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Axb", "[", 
            RowBox[{"t", ",", 
             RowBox[{"x", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"y", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"z", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}]}], "]"}], ",", 
           RowBox[{"Ayb", "[", 
            RowBox[{"t", ",", 
             RowBox[{"x", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"y", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"z", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}]}], "]"}], ",", 
           RowBox[{"Azb", "[", 
            RowBox[{"t", ",", 
             RowBox[{"x", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"y", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
             RowBox[{"z", "[", 
              RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}]}], "]"}]}], "}"}]}],
         ")"}], "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A0f", "[", 
       RowBox[{"t_", ",", "xp_", ",", "yp_", ",", "zp_"}], "]"}], ":=", 
      RowBox[{"A0b", "[", 
       RowBox[{"t", ",", 
        RowBox[{"x", "[", 
         RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"xp", ",", "yp", ",", "zp"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<lR\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<lR\>\""}]}], ",", 
       RowBox[{"\"\<nR\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<nR\>\""}]}], ",", 
       RowBox[{"\"\<\[Epsilon]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Epsilon]\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<v\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<v\>\""}]}], ",", 
       RowBox[{"\"\<\[Lambda]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Lambda]\>\""}]}], ",", 
       RowBox[{"\"\<q\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<q\>\""}]}], ",", 
       RowBox[{"\"\<\[Omega]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Omega]\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<r\[Phi]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<r\[Phi]\>\""}]}], ",", 
       RowBox[{"\"\<r\[Chi]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<r\[Chi]\>\""}]}], ",", 
       RowBox[{"\"\<rA\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<rA\>\""}]}], ",", 
       RowBox[{"\"\<\[Chi]0\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Chi]0\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<\[CapitalDelta]x\>\"", "\[Rule]", "\[CapitalDelta]x"}], 
       ",", 
       RowBox[{"\"\<\[CapitalDelta]y\>\"", "\[Rule]", "\[CapitalDelta]y"}], 
       ",", 
       RowBox[{"\"\<\[Beta]x\>\"", "\[Rule]", "\[Beta]x"}], ",", 
       RowBox[{"\"\<\[Theta]xy\>\"", "\[Rule]", "\[Theta]xy"}], ",", 
       RowBox[{"\"\<\[Theta]yz\>\"", "\[Rule]", "\[Theta]yz"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<\[Phi]\>\"", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Evaluate", "@", 
           RowBox[{"\[Phi]f", "[", 
            RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4"}], "]"}]}], "&"}], 
         ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<\[Chi]\>\"", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Evaluate", "@", 
           RowBox[{"\[Chi]f", "[", 
            RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4"}], "]"}]}], "&"}], 
         ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<Ax\>\"", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Evaluate", "@", 
           RowBox[{"Axf", "[", 
            RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4"}], "]"}]}], "&"}], 
         ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<Ay\>\"", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Evaluate", "@", 
           RowBox[{"Ayf", "[", 
            RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4"}], "]"}]}], "&"}], 
         ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<Az\>\"", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Evaluate", "@", 
           RowBox[{"Azf", "[", 
            RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4"}], "]"}]}], "&"}], 
         ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<A0\>\"", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Evaluate", "@", 
           RowBox[{"A0f", "[", 
            RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4"}], "]"}]}], "&"}], 
         ")"}]}]}], "\[IndentingNewLine]", "|>"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8158075472629547`*^9, 3.8158077033048463`*^9}, {
   3.815807847209219*^9, 3.8158078998354783`*^9}, {3.815807957181091*^9, 
   3.8158079744542933`*^9}, {3.8158081768889537`*^9, 3.815808327708107*^9}, {
   3.8158084563571897`*^9, 3.815808516277392*^9}, {3.8158085887324133`*^9, 
   3.8158087270549974`*^9}, {3.815809034936612*^9, 3.8158090511401715`*^9}, {
   3.8158090930315332`*^9, 3.8158091763409605`*^9}, {3.81580920696308*^9, 
   3.815809210436359*^9}, {3.815809255949845*^9, 3.815809314094891*^9}, {
   3.8158093658988266`*^9, 3.815809382706862*^9}, {3.815809413318904*^9, 
   3.815809432418019*^9}, {3.8158095386761627`*^9, 3.8158096741577263`*^9}, {
   3.81580970646659*^9, 3.8158098651418424`*^9}, {3.815811212093974*^9, 
   3.8158112132123766`*^9}, {3.8159997876877565`*^9, 
   3.8159997943368635`*^9}, {3.815999869104211*^9, 3.815999893041023*^9}, {
   3.81599993021967*^9, 3.8159999389421325`*^9}, 3.8160051600997005`*^9, {
   3.823871894000953*^9, 3.8238718960672283`*^9}, {3.8238769336562448`*^9, 
   3.823876946791911*^9}, {3.8238771713087883`*^9, 3.8238773247039866`*^9}, {
   3.823877442663305*^9, 3.8238775068156047`*^9}, {3.8238775767739697`*^9, 
   3.8238776706382017`*^9}, {3.8238777247089915`*^9, 3.823877742057912*^9}, {
   3.823877784804416*^9, 3.823877801877864*^9}, {3.823921774790779*^9, 
   3.8239217769532676`*^9}, {3.823921806996565*^9, 3.8239218267546444`*^9}, 
   3.8239218766538396`*^9, {3.823924563266675*^9, 3.823924568274645*^9}, {
   3.8239246344230657`*^9, 3.8239246353945103`*^9}, {3.8239246749809713`*^9, 
   3.823924699154463*^9}, {3.8239250076485367`*^9, 3.823925056735458*^9}, {
   3.823925377312067*^9, 3.8239254137614627`*^9}, {3.8239255668655033`*^9, 
   3.823925612917856*^9}, {3.823925996637082*^9, 3.823926122236102*^9}, {
   3.8239263800281377`*^9, 3.823926415365836*^9}, {3.8239264753471727`*^9, 
   3.823926475532343*^9}, {3.823926515470249*^9, 3.823926516910271*^9}, {
   3.823926564715702*^9, 3.82392668425552*^9}, {3.8239267363305225`*^9, 
   3.823926738784274*^9}, {3.8239268312511997`*^9, 3.8239268333233585`*^9}, {
   3.823926878642115*^9, 3.823926983675339*^9}, {3.8239270242388396`*^9, 
   3.823927029146434*^9}, {3.8242037113405776`*^9, 3.824203711513528*^9}, {
   3.824809362029803*^9, 3.824809377304432*^9}, {3.82480950244132*^9, 
   3.8248095837427483`*^9}, {3.8249749505903153`*^9, 3.824974953544851*^9}, {
   3.824975089821473*^9, 3.8249750900878496`*^9}, {3.8249752519808183`*^9, 
   3.824975264279797*^9}, 3.825136450033769*^9, {3.8302532691519213`*^9, 
   3.8302532796949883`*^9}, {3.830253400899658*^9, 3.8302535556158905`*^9}, {
   3.8302536040312366`*^9, 3.8302536359180994`*^9}, {3.830253706676361*^9, 
   3.8302537097269793`*^9}, {3.830263388288637*^9, 3.8302634502584224`*^9}, {
   3.8303187199848022`*^9, 3.830318727568217*^9}, {3.8303191731618547`*^9, 
   3.8303191760908785`*^9}, {3.8303253580972757`*^9, 
   3.8303254397429624`*^9}, {3.8303257812612877`*^9, 3.830325786342256*^9}, {
   3.8743986155060873`*^9, 3.8743986288123364`*^9}, {3.874398887227358*^9, 
   3.874398902029831*^9}, {3.8786620304626846`*^9, 3.8786620319834003`*^9}, {
   3.878670309809404*^9, 3.8786703379039536`*^9}, {3.8787386879823585`*^9, 
   3.878738718443018*^9}, 3.8787387715525475`*^9, {3.8787388293452682`*^9, 
   3.8787388463750577`*^9}, {3.878738957230565*^9, 3.8787390242876005`*^9}, {
   3.8787393506199284`*^9, 3.8787393796117325`*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"e460a8a0-48fe-44f9-a973-4114d7ac7eb1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Overlapping string states", "Subsection",
 CellChangeTimes->{{3.8241834038429728`*^9, 
  3.82418340743934*^9}},ExpressionUUID->"fb509134-cfdf-43f6-8d25-\
75a0e3fd4214"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Abrikosov", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lX_", ",", "nX_Integer"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"lY_", ",", "nY_Integer"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"lZ_", ",", "nZ_Integer"}], "}"}]}], "]"}], "[", 
   RowBox[{"strings", ":", 
    RowBox[{"{", "__Association", "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"time", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ",", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "@", "strings"}]}], ",", "\[IndentingNewLine]", "t", 
      ",", "x", ",", "y", ",", "z", ",", "\[IndentingNewLine]", "v", ",", 
      "\[Lambda]", ",", "q", ",", "\[Omega]", ",", "\[IndentingNewLine]", 
      "\[Phi]s", ",", "\[Chi]s", ",", "A0s", ",", "Axs", ",", "Ays", ",", 
      "Azs", ",", "\[IndentingNewLine]", "\[Phi]", ",", "\[Chi]", ",", "A0", 
      ",", "Ax", ",", "Ay", ",", "Az", ",", "\[Pi]1to2", ",", "\[Pi]3to5", 
      ",", "\[Pi]1Ax", ",", "\[Pi]2Ay", ",", "\[Pi]3Az", ",", "\[Pi]4A0", ",",
       "\[IndentingNewLine]", "xs", ",", "dx", ",", "ys", ",", "dy", ",", 
      "zs", ",", "dz", ",", "\[IndentingNewLine]", "seed12", ",", "seed345", 
      ",", "seed6", ",", "seed7", ",", "seed8", ",", "seed9", ",", 
      "seed\[Pi]12", ",", "seed\[Pi]345", ",", "seed\[Pi]6", ",", 
      "seed\[Pi]7", ",", "seed\[Pi]8", ",", "seed\[Pi]9", ",", "stepsxs", ",",
       "stepsys", ",", "stepszs", ",", "tablefunc"}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", ",", "\[Lambda]", ",", "q", ",", "\[Omega]"}], "}"}], "=", 
      RowBox[{
       RowBox[{"First", "@", "strings"}], "/@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<v\>\"", ",", "\"\<\[Lambda]\>\"", ",", "\"\<q\>\"", ",", 
         "\"\<\[Omega]\>\""}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Phi]s", ",", "\[Chi]s", ",", "Axs", ",", "Ays", ",", "Azs", ",", 
        "A0s"}], "}"}], "=", 
      RowBox[{"Through", "/@", 
       RowBox[{"strings", "/@", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\[Phi]\>\"", ",", "\"\<\[Chi]\>\"", ",", "\"\<Ax\>\"", ",", 
          "\"\<Ay\>\"", ",", "\"\<Az\>\"", ",", "\"\<A0\>\""}], "}"}]}]}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{"t_", ",", "x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"Product", "[", 
        RowBox[{
         RowBox[{"\[Phi]p", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Phi]p", ",", "\[Phi]s"}], "}"}]}], "]"}], "/", 
       SuperscriptBox["v", 
        RowBox[{"n", "-", "1"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Chi]", "[", 
       RowBox[{"t_", ",", "x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"\[Chi]p", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Chi]p", ",", "\[Chi]s"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Ax", "[", 
       RowBox[{"t_", ",", "x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"Axp", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"Axp", ",", "Axs"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Ay", "[", 
       RowBox[{"t_", ",", "x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"Ayp", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"Ayp", ",", "Ays"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Az", "[", 
       RowBox[{"t_", ",", "x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"Azp", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"Azp", ",", "Azs"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A0", "[", 
       RowBox[{"t_", ",", "x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"A0p", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"A0p", ",", "A0s"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Pi]1to2", "=", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"\[Phi]", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "t"}], 
        "]"}], "/.", 
       RowBox[{"t", "\[Rule]", "0"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Pi]3to5", "=", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"\[Chi]", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "t"}], 
        "]"}], "/.", 
       RowBox[{"t", "\[Rule]", "0"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Pi]1Ax", "=", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"Ax", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "t"}], 
        "]"}], "/.", 
       RowBox[{"t", "\[Rule]", "0"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Pi]2Ay", "=", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"Ay", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "t"}], 
        "]"}], "/.", 
       RowBox[{"t", "\[Rule]", "0"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Pi]3Az", "=", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"Az", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "t"}], 
        "]"}], "/.", 
       RowBox[{"t", "\[Rule]", "0"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Pi]4A0", "=", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"A0", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "t"}], 
        "]"}], "/.", 
       RowBox[{"t", "\[Rule]", "0"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xs", ",", "dx"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ys", ",", "dy"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"zs", ",", "dz"}], "}"}]}], "}"}], "=", 
      RowBox[{"Grid3D", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lX", ",", "nX"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"lY", ",", "nY"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"seed12", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"tablefunc", "@", 
         RowBox[{"ReIm", "@", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{"0", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"seed345", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"tablefunc", "@", 
         RowBox[{"\[Chi]", "[", 
          RowBox[{"0", ",", "x", ",", "y", ",", "z"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"seed\[Pi]12", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"tablefunc", "@", 
         RowBox[{"ReIm", "@", "\[Pi]1to2"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"seed\[Pi]345", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"tablefunc", "@", "\[Pi]3to5"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tablefunc", "[", "xx_", "]"}], ":=", 
      RowBox[{"(*", "Parallel", "*)"}], 
      RowBox[{"Table", "[", 
       RowBox[{"xx", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "xs"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", "ys"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "zs"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "seed6", ",", "seed7", ",", "seed8", ",", "seed9", ",", "seed\[Pi]6", 
        ",", "seed\[Pi]7", ",", "seed\[Pi]8", ",", "seed\[Pi]9"}], "}"}], "=", 
      RowBox[{"tablefunc", "/@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Ax", "[", 
          RowBox[{"0", ",", "x", ",", "y", ",", "z"}], "]"}], ",", 
         RowBox[{"Ay", "[", 
          RowBox[{"0", ",", "x", ",", "y", ",", "z"}], "]"}], ",", 
         RowBox[{"Az", "[", 
          RowBox[{"0", ",", "x", ",", "y", ",", "z"}], "]"}], ",", 
         RowBox[{"A0", "[", 
          RowBox[{"0", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "\[Pi]1Ax",
          ",", "\[Pi]2Ay", ",", "\[Pi]3Az", ",", "\[Pi]4A0"}], "}"}]}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"seed6", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Ax", "[", 
           RowBox[{"0", ",", "x", ",", "y", ",", "z"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "stepsxs"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "stepsys"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", "stepszs"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"seed7", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Ay", "[", 
           RowBox[{"0", ",", "x", ",", "y", ",", "z"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "stepsxs"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "stepsys"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", "stepszs"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"seed8", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Az", "[", 
           RowBox[{"0", ",", "x", ",", "y", ",", "z"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "stepsxs"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "stepsys"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", "stepszs"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"seed9", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"A0", "[", 
           RowBox[{"0", ",", "x", ",", "y", ",", "z"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "stepsxs"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "stepsys"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", "stepszs"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"seed\[Pi]6", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"\[Pi]1Ax", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "stepsxs"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "stepsys"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", "stepszs"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"seed\[Pi]7", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"\[Pi]2Ay", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "stepsxs"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "stepsys"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", "stepszs"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"seed\[Pi]8", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"\[Pi]3Az", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "stepsxs"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "stepsys"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", "stepszs"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"seed\[Pi]9", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"\[Pi]4A0", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "stepsxs"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "stepsys"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", "stepszs"}], "}"}]}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Created initial state in \>\"", ",", 
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"AbsoluteTime", "[", "]"}], "-", "time"}], ",", 
         "\"\<s\>\""}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"NumericArray", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"seed12", ",", "seed345", ",", 
         RowBox[{"{", 
          RowBox[{"seed6", ",", "seed7", ",", "seed8", ",", "seed9"}], "}"}], 
         ",", "seed\[Pi]12", ",", "seed\[Pi]345", ",", 
         RowBox[{"{", 
          RowBox[{
          "seed\[Pi]6", ",", "seed\[Pi]7", ",", "seed\[Pi]8", ",", 
           "seed\[Pi]9"}], "}"}]}], "]"}], ",", "\"\<Real32\>\""}], "]"}]}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.816006645194456*^9, 3.8160068286357203`*^9}, {
   3.8239252024651346`*^9, 3.823925203902404*^9}, {3.8239252339076138`*^9, 
   3.8239252791087675`*^9}, {3.823926133073866*^9, 3.8239261695651865`*^9}, {
   3.823927206861911*^9, 3.8239277063498325`*^9}, {3.8239287761696625`*^9, 
   3.8239287781565876`*^9}, {3.8239288098592796`*^9, 3.823928814712346*^9}, {
   3.824192048917274*^9, 3.824192054636838*^9}, {3.8419139948915486`*^9, 
   3.841914005913793*^9}, {3.841991305537928*^9, 3.8419913367386985`*^9}, {
   3.8419914843767123`*^9, 3.841991557805277*^9}, {3.841991619428872*^9, 
   3.8419916204309473`*^9}, {3.8419916572557564`*^9, 3.841991727147575*^9}, {
   3.8636284285584717`*^9, 3.863628497553045*^9}, {3.8636285318810587`*^9, 
   3.8636285554492674`*^9}, {3.863800554112962*^9, 3.863800567821185*^9}, {
   3.863800960601162*^9, 3.863800969894408*^9}, {3.863801867544054*^9, 
   3.8638019988839264`*^9}, 3.8638020813536663`*^9, {3.863802132764103*^9, 
   3.8638021567508745`*^9}, {3.8638025734158216`*^9, 
   3.8638026154407487`*^9}, {3.865334993612656*^9, 3.8653350039144063`*^9}, {
   3.865335102731479*^9, 3.8653351045015554`*^9}, {3.874395319972559*^9, 
   3.874395322920833*^9}, {3.878671454959408*^9, 3.878671467971363*^9}, {
   3.878671503179417*^9, 3.8786715137721825`*^9}, {3.8798593748725615`*^9, 
   3.879859376019826*^9}, 3.8802949833917017`*^9, {3.8805284021400123`*^9, 
   3.8805284034470425`*^9}, 3.880616459057252*^9},
 CellLabel->"In[73]:=",ExpressionUUID->"6049fdc6-c756-4bb7-9651-74757786aebe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "StaticStringSeed"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StaticStringSeed", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lX_", ",", "nX_Integer"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"lY_", ",", "nY_Integer"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"lZ_", ",", "nZ_Integer"}], "}"}]}], "]"}], "[", 
    RowBox[{
     RowBox[{"v1_", "?", "SignQ"}], ",", 
     RowBox[{"v2_", "?", "SignQ"}], ",", "\[Alpha]11_Real", ",", 
     "\[Alpha]12_Real", ",", "\[Nu]1_Real"}], "]"}], "[", "state_Association",
    "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"string", ",", "initialState"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"string", "=", 
      RowBox[{
       RowBox[{"PrepareString", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "v1", ",", "v2", ",", "\[Alpha]11", ",", "\[Alpha]12", ",", 
           "\[Nu]1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.", ",", "0."}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.", ",", "0.", ",", "0."}], "}"}], ",", "0."}], "]"}], 
       "@", "state"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"initialState", "=", 
      RowBox[{
       RowBox[{"Abrikosov", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "@", 
       RowBox[{"{", "string", "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<lR\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<lR\>\""}]}], ",", 
       RowBox[{"\"\<nR\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<nR\>\""}]}], ",", 
       RowBox[{"\"\<\[Epsilon]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Epsilon]\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<v\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<v\>\""}]}], ",", 
       RowBox[{"\"\<\[Lambda]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Lambda]\>\""}]}], ",", 
       RowBox[{"\"\<q\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<q\>\""}]}], ",", 
       RowBox[{"\"\<\[Omega]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Omega]\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<r\[Phi]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<r\[Phi]\>\""}]}], ",", 
       RowBox[{"\"\<r\[Chi]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<r\[Chi]\>\""}]}], ",", 
       RowBox[{"\"\<rA\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<rA\>\""}]}], ",", 
       RowBox[{"\"\<\[Chi]0\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Chi]0\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<lX\>\"", "\[Rule]", "lX"}], ",", 
       RowBox[{"\"\<nX\>\"", "\[Rule]", "nX"}], ",", 
       RowBox[{"\"\<lY\>\"", "\[Rule]", "lY"}], ",", 
       RowBox[{"\"\<nY\>\"", "\[Rule]", "nY"}], ",", 
       RowBox[{"\"\<lZ\>\"", "\[Rule]", "lZ"}], ",", 
       RowBox[{"\"\<nZ\>\"", "\[Rule]", "nZ"}], ",", 
       RowBox[{"\"\<t\>\"", "\[Rule]", "0."}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<v1\>\"", "\[Rule]", "v1"}], ",", 
       RowBox[{"\"\<\[Alpha]11\>\"", "\[Rule]", "\[Alpha]11"}], ",", 
       RowBox[{"\"\<\[Alpha]12\>\"", "\[Rule]", "\[Alpha]12"}], ",", 
       RowBox[{"\"\<\[Nu]1\>\"", "\[Rule]", "\[Nu]1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<fields\>\"", "\[Rule]", "initialState"}]}], 
      "\[IndentingNewLine]", "|>"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8302623428801503`*^9, 3.8302624753909025`*^9}, {
  3.8302625236971216`*^9, 3.8302625413287535`*^9}, {3.8302631117829475`*^9, 
  3.8302631229192343`*^9}, {3.8302634992580013`*^9, 3.830263582841606*^9}, {
  3.8303258417211056`*^9, 3.8303258873000064`*^9}, {3.863628589332876*^9, 
  3.8636285970526896`*^9}, {3.8653350122434444`*^9, 3.865335013371686*^9}, {
  3.8653351071997175`*^9, 3.8653351090063243`*^9}, {3.8743993335608387`*^9, 
  3.8743993465766068`*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"ed41a946-cb9f-4b88-90e9-009ed53d0ccc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "OneStringSeed"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OneStringSeed", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lX_", ",", "nX_Integer"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"lY_", ",", "nY_Integer"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"lZ_", ",", "nZ_Integer"}], "}"}]}], "]"}], "[", 
    RowBox[{
     RowBox[{"v1_", "?", "SignQ"}], ",", 
     RowBox[{"v2_", "?", "SignQ"}], ",", "\[Alpha]11_Real", ",", 
     "\[Alpha]12_Real", ",", "\[Nu]1_Real", ",", "\[Theta]xy_Real", ",", 
     "\[Theta]yz_Real", ",", "a_Real", ",", "\[Beta]_Real"}], "]"}], "[", 
   "state_Association", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"string", ",", "initialState"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"string", "=", 
      RowBox[{
       RowBox[{"PrepareString", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "v1", ",", "v2", ",", "\[Alpha]11", ",", "\[Alpha]12", ",", 
           "\[Nu]1"}], "}"}], ",", 
         RowBox[{"N", "@", 
          RowBox[{"{", 
           RowBox[{"\[Theta]xy", ",", "\[Theta]yz"}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "a"}], ",", "a", ",", "0."}], "}"}], ",", "\[Beta]"}],
         "]"}], "@", "state"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"initialState", "=", 
      RowBox[{
       RowBox[{"Abrikosov", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "@", 
       RowBox[{"{", "string", "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<lR\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<lR\>\""}]}], ",", 
       RowBox[{"\"\<nR\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<nR\>\""}]}], ",", 
       RowBox[{"\"\<\[Epsilon]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Epsilon]\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<v\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<v\>\""}]}], ",", 
       RowBox[{"\"\<\[Lambda]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Lambda]\>\""}]}], ",", 
       RowBox[{"\"\<q\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<q\>\""}]}], ",", 
       RowBox[{"\"\<\[Omega]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Omega]\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<r\[Phi]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<r\[Phi]\>\""}]}], ",", 
       RowBox[{"\"\<r\[Chi]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<r\[Chi]\>\""}]}], ",", 
       RowBox[{"\"\<rA\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<rA\>\""}]}], ",", 
       RowBox[{"\"\<\[Chi]0\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Chi]0\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<lX\>\"", "\[Rule]", "lX"}], ",", 
       RowBox[{"\"\<nX\>\"", "\[Rule]", "nX"}], ",", 
       RowBox[{"\"\<lY\>\"", "\[Rule]", "lY"}], ",", 
       RowBox[{"\"\<nY\>\"", "\[Rule]", "nY"}], ",", 
       RowBox[{"\"\<lZ\>\"", "\[Rule]", "lZ"}], ",", 
       RowBox[{"\"\<nZ\>\"", "\[Rule]", "nZ"}], ",", 
       RowBox[{"\"\<t\>\"", "\[Rule]", "0."}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<v1\>\"", "\[Rule]", "v1"}], ",", 
       RowBox[{"\"\<\[Alpha]11\>\"", "\[Rule]", "\[Alpha]11"}], ",", 
       RowBox[{"\"\<\[Alpha]12\>\"", "\[Rule]", "\[Alpha]12"}], ",", 
       RowBox[{"\"\<\[Nu]1\>\"", "\[Rule]", "\[Nu]1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<fields\>\"", "\[Rule]", "initialState"}]}], 
      "\[IndentingNewLine]", "|>"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8302623428801503`*^9, 3.8302624753909025`*^9}, {
   3.8302625236971216`*^9, 3.8302625413287535`*^9}, {3.8302631117829475`*^9, 
   3.8302631229192343`*^9}, {3.8302634992580013`*^9, 3.830263582841606*^9}, {
   3.8303258417211056`*^9, 3.8303258873000064`*^9}, {3.863628589332876*^9, 
   3.8636285970526896`*^9}, {3.8653350122434444`*^9, 3.865335013371686*^9}, {
   3.8653351071997175`*^9, 3.8653351090063243`*^9}, {3.8743993335608387`*^9, 
   3.8743993465766068`*^9}, {3.8788015692141647`*^9, 
   3.8788016429910192`*^9}, {3.8788021796375775`*^9, 3.8788021831499405`*^9}, 
   3.878802687190362*^9, {3.8788027437957883`*^9, 3.878802770786212*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"3136cdc3-d1e3-4b0a-bd99-4d97f87ccd28"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "BiStringSeed"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BiStringSeed", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lX_", ",", "nX_Integer"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"lY_", ",", "nY_Integer"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"lZ_", ",", "nZ_Integer"}], "}"}]}], "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v1_", "?", "SignQ"}], ",", "\[Alpha]11_Real", ",", 
       "\[Alpha]12_Real", ",", "\[Nu]1_Real"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v2_", "?", "SignQ"}], ",", "\[Alpha]21_Real", ",", 
       "\[Alpha]22_Real", ",", "\[Nu]2_Real"}], "}"}], ",", "a_Real", ",", 
     "\[Beta]_Real", ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]1_Real", ",", "\[Theta]2_Real"}], "}"}]}], "]"}], "[", 
   "state_Association", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"string1", ",", "string2", ",", "initialState"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"string1", "=", 
      RowBox[{
       RowBox[{"PrepareString", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"v1", ",", "\[Alpha]11", ",", "\[Alpha]12", ",", "\[Nu]1"}],
           "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.", ",", "\[Theta]1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "0.", ",", "0."}], "}"}], ",", "\[Beta]"}], "]"}],
        "@", "state"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"string2", "=", 
      RowBox[{
       RowBox[{"PrepareString", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"v2", ",", "\[Alpha]21", ",", "\[Alpha]22", ",", "\[Nu]2"}],
           "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "@", "\[Pi]"}], ",", "\[Theta]2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "0.", ",", "0."}], "}"}], ",", "\[Beta]"}], "]"}],
        "@", "state"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"initialState", "=", 
      RowBox[{
       RowBox[{"Abrikosov", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "@", 
       RowBox[{"{", 
        RowBox[{"string1", ",", "string2"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<lR\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<lR\>\""}]}], ",", 
       RowBox[{"\"\<nR\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<nR\>\""}]}], ",", 
       RowBox[{"\"\<\[Epsilon]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Epsilon]\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<v\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<v\>\""}]}], ",", 
       RowBox[{"\"\<\[Lambda]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Lambda]\>\""}]}], ",", 
       RowBox[{"\"\<q\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<q\>\""}]}], ",", 
       RowBox[{"\"\<\[Omega]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Omega]\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<r\[Phi]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<r\[Phi]\>\""}]}], ",", 
       RowBox[{"\"\<r\[Chi]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<r\[Chi]\>\""}]}], ",", 
       RowBox[{"\"\<rA\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<rA\>\""}]}], ",", 
       RowBox[{"\"\<\[Chi]0\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Chi]0\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<lX\>\"", "\[Rule]", "lX"}], ",", 
       RowBox[{"\"\<nX\>\"", "\[Rule]", "nX"}], ",", 
       RowBox[{"\"\<lY\>\"", "\[Rule]", "lY"}], ",", 
       RowBox[{"\"\<nY\>\"", "\[Rule]", "nY"}], ",", 
       RowBox[{"\"\<lZ\>\"", "\[Rule]", "lZ"}], ",", 
       RowBox[{"\"\<nZ\>\"", "\[Rule]", "nZ"}], ",", 
       RowBox[{"\"\<t\>\"", "\[Rule]", "0."}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<v1\>\"", "\[Rule]", "v1"}], ",", 
       RowBox[{"\"\<\[Alpha]11\>\"", "\[Rule]", "\[Alpha]11"}], ",", 
       RowBox[{"\"\<\[Alpha]12\>\"", "\[Rule]", "\[Alpha]12"}], ",", 
       RowBox[{"\"\<\[Nu]1\>\"", "\[Rule]", "\[Nu]1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<v2\>\"", "\[Rule]", "v2"}], ",", 
       RowBox[{"\"\<\[Alpha]21\>\"", "\[Rule]", "\[Alpha]21"}], ",", 
       RowBox[{"\"\<\[Alpha]22\>\"", "\[Rule]", "\[Alpha]22"}], ",", 
       RowBox[{"\"\<\[Nu]2\>\"", "\[Rule]", "\[Nu]2"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<a\>\"", "\[Rule]", "a"}], ",", 
       RowBox[{"\"\<\[Beta]\>\"", "\[Rule]", "\[Beta]"}], ",", 
       RowBox[{"\"\<\[Theta]1\>\"", "\[Rule]", "\[Theta]1"}], ",", 
       RowBox[{"\"\<\[Theta]2\>\"", "\[Rule]", "\[Theta]2"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<fields\>\"", "\[Rule]", "initialState"}]}], 
      "\[IndentingNewLine]", "|>"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8241836863098497`*^9, 3.8241839621200695`*^9}, {
  3.8241849711566753`*^9, 3.824185158833659*^9}, {3.824185258397224*^9, 
  3.8241852658107915`*^9}, {3.824185404242503*^9, 3.8241854047276974`*^9}, {
  3.8242038025402126`*^9, 3.82420381261878*^9}, {3.8248096153867636`*^9, 
  3.824809618212766*^9}, {3.8248815467606497`*^9, 3.824881549944423*^9}, {
  3.824974990803705*^9, 3.8249750201203527`*^9}, {3.8249750979564533`*^9, 
  3.8249750980970774`*^9}, {3.824975312025305*^9, 3.824975312197178*^9}, {
  3.830327418005046*^9, 3.8303274955886517`*^9}, {3.8303275639083757`*^9, 
  3.8303276230458336`*^9}, {3.8303278082990904`*^9, 3.830327879781417*^9}, {
  3.8636286047133102`*^9, 3.86362861106973*^9}, {3.865335017513455*^9, 
  3.865335019192808*^9}, {3.865335111952756*^9, 3.8653351138067846`*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"3a2c8054-9fd6-4757-955e-2d3c089166e9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "SquareStringSeed"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SquareStringSeed", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lX_", ",", "nX_Integer"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"lY_", ",", "nY_Integer"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"lZ_", ",", "nZ_Integer"}], "}"}]}], "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v1_", "?", "SignQ"}], ",", 
       RowBox[{"v11_", "?", "SignQ"}], ",", "\[Alpha]11_Real", ",", 
       "\[Alpha]12_Real", ",", "\[Nu]1_Real"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v2_", "?", "SignQ"}], ",", 
       RowBox[{"v22_", "?", "SignQ"}], ",", "\[Alpha]21_Real", ",", 
       "\[Alpha]22_Real", ",", "\[Nu]2_Real"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v3_", "?", "SignQ"}], ",", 
       RowBox[{"v33_", "?", "SignQ"}], ",", "\[Alpha]31_Real", ",", 
       "\[Alpha]32_Real", ",", "\[Nu]3_Real"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v4_", "?", "SignQ"}], ",", 
       RowBox[{"v44_", "?", "SignQ"}], ",", "\[Alpha]41_Real", ",", 
       "\[Alpha]42_Real", ",", "\[Nu]4_Real"}], "}"}], ",", "a_Real", ",", 
     "b_Real", ",", "c_Real", ",", "\[Beta]_Real", ",", "\[Beta]2_Real"}], 
    "]"}], "[", "state_Association", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "string1", ",", "string2", ",", "string3", ",", "string4", ",", 
      "initialState"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"string1", "=", 
      RowBox[{
       RowBox[{"PrepareString", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "v1", ",", "v11", ",", "\[Alpha]11", ",", "\[Alpha]12", ",", 
           "\[Nu]1"}], "}"}], ",", 
         RowBox[{"N", "@", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"0.", ",", "a", ",", "0."}], "}"}], ",", "\[Beta]"}], "]"}],
        "@", "state"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"string2", "=", 
      RowBox[{
       RowBox[{"PrepareString", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "v2", ",", "v22", ",", "\[Alpha]21", ",", "\[Alpha]22", ",", 
           "\[Nu]2"}], "}"}], ",", 
         RowBox[{"N", "@", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"0.", ",", 
           RowBox[{"-", "a"}], ",", "0."}], "}"}], ",", 
         RowBox[{"-", "\[Beta]"}]}], "]"}], "@", "state"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"string3", "=", 
      RowBox[{
       RowBox[{"PrepareString", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "v3", ",", "v33", ",", "\[Alpha]31", ",", "\[Alpha]32", ",", 
           "\[Nu]3"}], "}"}], ",", 
         RowBox[{"N", "@", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            FractionBox["\[Pi]", "2"]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "c", ",", "0."}], "}"}], ",", "\[Beta]2"}], "]"}],
        "@", "state"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"string4", "=", 
      RowBox[{
       RowBox[{"PrepareString", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "v4", ",", "v44", ",", "\[Alpha]41", ",", "\[Alpha]42", ",", 
           "\[Nu]4"}], "}"}], ",", 
         RowBox[{"N", "@", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            FractionBox["\[Pi]", "2"]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "b"}], ",", 
           RowBox[{"-", "c"}], ",", "0."}], "}"}], ",", 
         RowBox[{"-", "\[Beta]2"}]}], "]"}], "@", "state"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"initialState", "=", 
      RowBox[{
       RowBox[{"Abrikosov", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "@", 
       RowBox[{"{", 
        RowBox[{"string1", ",", "string2", ",", "string3", ",", "string4"}], 
        "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<lR\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<lR\>\""}]}], ",", 
       RowBox[{"\"\<nR\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<nR\>\""}]}], ",", 
       RowBox[{"\"\<\[Epsilon]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Epsilon]\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<v\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<v\>\""}]}], ",", 
       RowBox[{"\"\<\[Lambda]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Lambda]\>\""}]}], ",", 
       RowBox[{"\"\<q\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<q\>\""}]}], ",", 
       RowBox[{"\"\<\[Omega]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Omega]\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<r\[Phi]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<r\[Phi]\>\""}]}], ",", 
       RowBox[{"\"\<r\[Chi]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<r\[Chi]\>\""}]}], ",", 
       RowBox[{"\"\<rA\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<rA\>\""}]}], ",", 
       RowBox[{"\"\<\[Chi]0\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Chi]0\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<lX\>\"", "\[Rule]", "lX"}], ",", 
       RowBox[{"\"\<nX\>\"", "\[Rule]", "nX"}], ",", 
       RowBox[{"\"\<lY\>\"", "\[Rule]", "lY"}], ",", 
       RowBox[{"\"\<nY\>\"", "\[Rule]", "nY"}], ",", 
       RowBox[{"\"\<lZ\>\"", "\[Rule]", "lZ"}], ",", 
       RowBox[{"\"\<nZ\>\"", "\[Rule]", "nZ"}], ",", 
       RowBox[{"\"\<t\>\"", "\[Rule]", "0."}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<v1\>\"", "\[Rule]", "v1"}], ",", 
       RowBox[{"\"\<\[Alpha]11\>\"", "\[Rule]", "\[Alpha]11"}], ",", 
       RowBox[{"\"\<\[Alpha]12\>\"", "\[Rule]", "\[Alpha]12"}], ",", 
       RowBox[{"\"\<\[Nu]1\>\"", "\[Rule]", "\[Nu]1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<v2\>\"", "\[Rule]", "v2"}], ",", 
       RowBox[{"\"\<\[Alpha]21\>\"", "\[Rule]", "\[Alpha]21"}], ",", 
       RowBox[{"\"\<\[Alpha]22\>\"", "\[Rule]", "\[Alpha]22"}], ",", 
       RowBox[{"\"\<\[Nu]2\>\"", "\[Rule]", "\[Nu]2"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<v3\>\"", "\[Rule]", "v3"}], ",", 
       RowBox[{"\"\<\[Alpha]31\>\"", "\[Rule]", "\[Alpha]31"}], ",", 
       RowBox[{"\"\<\[Alpha]32\>\"", "\[Rule]", "\[Alpha]32"}], ",", 
       RowBox[{"\"\<\[Nu]3\>\"", "\[Rule]", "\[Nu]3"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<v4\>\"", "\[Rule]", "v4"}], ",", 
       RowBox[{"\"\<\[Alpha]41\>\"", "\[Rule]", "\[Alpha]41"}], ",", 
       RowBox[{"\"\<\[Alpha]42\>\"", "\[Rule]", "\[Alpha]42"}], ",", 
       RowBox[{"\"\<\[Nu]4\>\"", "\[Rule]", "\[Nu]4"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<a\>\"", "\[Rule]", "a"}], ",", 
       RowBox[{"\"\<\[Beta]\>\"", "\[Rule]", "\[Beta]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<fields\>\"", "\[Rule]", "initialState"}]}], 
      "\[IndentingNewLine]", "|>"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdzFkow3EAB/BhyZEXKWHlyBFeZg+KhD97oSYtSSJHU4aSa85opZUp97E0
M5IZ2R7WbGrJFSOM5D7WHmjjL9cLEv7f38O3z8v3+w0vrxVWuLNYrFAmkBM2
05baRVMXJ2wpnHDkyiBfYOqFjQ79EPwdcQ5Dw2eIAtpd6hmyaxqfh4usDWL3
2bEDmm+Sn+CjgPcOi740xJqUl/cyxkRLyyeMe74e62csVTvHYfXb+hSsqtsm
Fnzkm2F3VDHx54obON3D/HhrQiGXv6U8ZLTfyVRQUpg+CwP8E5ZgvKdkGfq0
T5tgSnyCBUbeVxIbRi/XYOMrxwYHRhTirF2a2jptroLKEp5Kvk9TeYP1RJ2s
Vwud+iOi8dgr6PKWplbdrByo2sleTHqgqe9zKVHYmaGHMZMiI9zxzdyEwYYV
Yl9ttBWKtbo9OPcXdgp5CjmxvGOjMpkx4qRVDL1XFUtQ4rLpYDrbrk1jzJlV
LkDVaI4PxbjgJ/SFotgDDxF6mlw2/AdbPBP8
  "],
 CellLabel->"In[80]:=",ExpressionUUID->"6753d486-b59a-4164-9585-f2b59599ff6e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "SquareStringSeedgenboost"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SquareStringSeedgenboost", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lX_", ",", "nX_Integer"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"lY_", ",", "nY_Integer"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"lZ_", ",", "nZ_Integer"}], "}"}]}], "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v1_", "?", "SignQ"}], ",", 
       RowBox[{"v11_", "?", "SignQ"}], ",", "\[Alpha]11_Real", ",", 
       "\[Alpha]12_Real", ",", "\[Nu]1_Real"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v2_", "?", "SignQ"}], ",", 
       RowBox[{"v22_", "?", "SignQ"}], ",", "\[Alpha]21_Real", ",", 
       "\[Alpha]22_Real", ",", "\[Nu]2_Real"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v3_", "?", "SignQ"}], ",", 
       RowBox[{"v33_", "?", "SignQ"}], ",", "\[Alpha]31_Real", ",", 
       "\[Alpha]32_Real", ",", "\[Nu]3_Real"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v4_", "?", "SignQ"}], ",", 
       RowBox[{"v44_", "?", "SignQ"}], ",", "\[Alpha]41_Real", ",", 
       "\[Alpha]42_Real", ",", "\[Nu]4_Real"}], "}"}], ",", "a_Real", ",", 
     "\[Beta]x_Real", ",", "\[Beta]y_Real", ",", "\[Beta]z_Real"}], "]"}], 
   "[", "state_Association", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "string1", ",", "string2", ",", "string3", ",", "string4", ",", 
      "initialState"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"string1", "=", 
      RowBox[{
       RowBox[{"PrepareStringgenBoost", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "v1", ",", "v11", ",", "\[Alpha]11", ",", "\[Alpha]12", ",", 
           "\[Nu]1"}], "}"}], ",", 
         RowBox[{"N", "@", 
          RowBox[{"{", 
           RowBox[{
            FractionBox["\[Pi]", "2"], ",", "0"}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "0.", ",", "0."}], "}"}], ",", "0.", ",", 
         "\[Beta]y", ",", "0."}], "]"}], "@", "state"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"string2", "=", 
      RowBox[{
       RowBox[{"PrepareStringgenBoost", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "v2", ",", "v22", ",", "\[Alpha]21", ",", "\[Alpha]22", ",", 
           "\[Nu]2"}], "}"}], ",", 
         RowBox[{"N", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["\[Pi]", "2"]}], ",", "0"}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "0.", ",", "0."}], "}"}], ",", "0.", ",", 
         "\[Beta]y", ",", "0."}], "]"}], "@", "state"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"string3", "=", 
      RowBox[{
       RowBox[{"PrepareStringgenBoost", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "v3", ",", "v33", ",", "\[Alpha]31", ",", "\[Alpha]32", ",", 
           "\[Nu]3"}], "}"}], ",", 
         RowBox[{"N", "@", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            FractionBox["\[Pi]", "2"]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "a", ",", "0."}], "}"}], ",", "\[Beta]x", ",", 
         "0.", ",", "0."}], "]"}], "@", "state"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"string4", "=", 
      RowBox[{
       RowBox[{"PrepareStringgenBoost", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "v4", ",", "v44", ",", "\[Alpha]41", ",", "\[Alpha]42", ",", 
           "\[Nu]4"}], "}"}], ",", 
         RowBox[{"N", "@", 
          RowBox[{"{", 
           RowBox[{"\[Pi]", ",", 
            FractionBox["\[Pi]", "2"]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "a", ",", "0."}], "}"}], ",", "\[Beta]x", ",", 
         "0.", ",", "0."}], "]"}], "@", "state"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"initialState", "=", 
      RowBox[{
       RowBox[{"Abrikosov", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "@", 
       RowBox[{"{", 
        RowBox[{"string1", ",", "string2", ",", "string3", ",", "string4"}], 
        "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<lR\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<lR\>\""}]}], ",", 
       RowBox[{"\"\<nR\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<nR\>\""}]}], ",", 
       RowBox[{"\"\<\[Epsilon]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Epsilon]\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<v\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<v\>\""}]}], ",", 
       RowBox[{"\"\<\[Lambda]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Lambda]\>\""}]}], ",", 
       RowBox[{"\"\<q\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<q\>\""}]}], ",", 
       RowBox[{"\"\<\[Omega]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Omega]\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<r\[Phi]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<r\[Phi]\>\""}]}], ",", 
       RowBox[{"\"\<r\[Chi]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<r\[Chi]\>\""}]}], ",", 
       RowBox[{"\"\<rA\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<rA\>\""}]}], ",", 
       RowBox[{"\"\<\[Chi]0\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Chi]0\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<lX\>\"", "\[Rule]", "lX"}], ",", 
       RowBox[{"\"\<nX\>\"", "\[Rule]", "nX"}], ",", 
       RowBox[{"\"\<lY\>\"", "\[Rule]", "lY"}], ",", 
       RowBox[{"\"\<nY\>\"", "\[Rule]", "nY"}], ",", 
       RowBox[{"\"\<lZ\>\"", "\[Rule]", "lZ"}], ",", 
       RowBox[{"\"\<nZ\>\"", "\[Rule]", "nZ"}], ",", 
       RowBox[{"\"\<t\>\"", "\[Rule]", "0."}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<v1\>\"", "\[Rule]", "v1"}], ",", 
       RowBox[{"\"\<\[Alpha]11\>\"", "\[Rule]", "\[Alpha]11"}], ",", 
       RowBox[{"\"\<\[Alpha]12\>\"", "\[Rule]", "\[Alpha]12"}], ",", 
       RowBox[{"\"\<\[Nu]1\>\"", "\[Rule]", "\[Nu]1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<v2\>\"", "\[Rule]", "v2"}], ",", 
       RowBox[{"\"\<\[Alpha]21\>\"", "\[Rule]", "\[Alpha]21"}], ",", 
       RowBox[{"\"\<\[Alpha]22\>\"", "\[Rule]", "\[Alpha]22"}], ",", 
       RowBox[{"\"\<\[Nu]2\>\"", "\[Rule]", "\[Nu]2"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<v3\>\"", "\[Rule]", "v3"}], ",", 
       RowBox[{"\"\<\[Alpha]31\>\"", "\[Rule]", "\[Alpha]31"}], ",", 
       RowBox[{"\"\<\[Alpha]32\>\"", "\[Rule]", "\[Alpha]32"}], ",", 
       RowBox[{"\"\<\[Nu]3\>\"", "\[Rule]", "\[Nu]3"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<v4\>\"", "\[Rule]", "v4"}], ",", 
       RowBox[{"\"\<\[Alpha]41\>\"", "\[Rule]", "\[Alpha]41"}], ",", 
       RowBox[{"\"\<\[Alpha]42\>\"", "\[Rule]", "\[Alpha]42"}], ",", 
       RowBox[{"\"\<\[Nu]4\>\"", "\[Rule]", "\[Nu]4"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<a\>\"", "\[Rule]", "a"}], ",", 
       RowBox[{"\"\<\[Beta]\>\"", "\[Rule]", "\[Beta]x"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<fields\>\"", "\[Rule]", "initialState"}]}], 
      "\[IndentingNewLine]", "|>"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQLaOwqMqu/o3jjcssjSB61sOANhDt4ru9G0SXPFw/
CUT/m/JiMoje/EN6Boi+/3LBIrC+0ukrQPRqhkNguuXaxYcgescdq9cg+pWv
0ScQHfNzOZjOsXn/KRFIm+2p+AGitd7entYPpBMWvJgOorM/HpwPorMKj4Hp
iM9hO0B0i2osmP5zy0B8YSfQHM7l8iDawOXInHNA+v69tnkguizKYQmIFhEy
XAuitdnKtoForuqF20G0jbbhHhCt8jQDTBdPvXkARJd8kDkPoidMmZHpefKN
45Gr5Vkgek680byuM28cQyYWgel1bd0rQfSL9RfA9NaLHJI3775x3Md4QgZE
z1ledUr62RtHn0dmF0H0i/aeH3JA+qUI/y8QHfY++r4SkF5w+fcDEA0AJH/Z
2g==
  "],
 CellLabel->"In[82]:=",ExpressionUUID->"8445807b-69bc-4fcd-ae3b-c99ad99db46f"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.878739538535183*^9},ExpressionUUID->"447cc4ae-02ff-40ee-b8e4-\
daaa5c2354fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "SquareStringSeedStatic"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SquareStringSeedStatic", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lX_", ",", "nX_Integer"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"lY_", ",", "nY_Integer"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"lZ_", ",", "nZ_Integer"}], "}"}]}], "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v1_", "?", "SignQ"}], ",", 
       RowBox[{"v11_", "?", "SignQ"}], ",", "\[Alpha]11_Real", ",", 
       "\[Alpha]12_Real", ",", "\[Nu]1_Real"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v2_", "?", "SignQ"}], ",", 
       RowBox[{"v22_", "?", "SignQ"}], ",", "\[Alpha]21_Real", ",", 
       "\[Alpha]22_Real", ",", "\[Nu]2_Real"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v3_", "?", "SignQ"}], ",", 
       RowBox[{"v33_", "?", "SignQ"}], ",", "\[Alpha]31_Real", ",", 
       "\[Alpha]32_Real", ",", "\[Nu]3_Real"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v4_", "?", "SignQ"}], ",", 
       RowBox[{"v44_", "?", "SignQ"}], ",", "\[Alpha]41_Real", ",", 
       "\[Alpha]42_Real", ",", "\[Nu]4_Real"}], "}"}], ",", "a_Real", ",", 
     "b_Real", ",", "c_Real"}], "]"}], "[", "state_Association", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "string1", ",", "string2", ",", "string3", ",", "string4", ",", 
      "initialState"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"string1", "=", 
      RowBox[{
       RowBox[{"PrepareString", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "v1", ",", "v11", ",", "\[Alpha]11", ",", "\[Alpha]12", ",", 
           "\[Nu]1"}], "}"}], ",", 
         RowBox[{"N", "@", 
          RowBox[{"{", 
           RowBox[{
            FractionBox["\[Pi]", "2"], ",", "0"}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "0.", ",", "0."}], "}"}], ",", "0."}], "]"}], "@",
        "state"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"string2", "=", 
      RowBox[{
       RowBox[{"PrepareString", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "v2", ",", "v22", ",", "\[Alpha]21", ",", "\[Alpha]22", ",", 
           "\[Nu]2"}], "}"}], ",", 
         RowBox[{"N", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["\[Pi]", "2"]}], ",", "0"}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "0.", ",", "0."}], "}"}], ",", "0."}], "]"}], "@",
        "state"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"string3", "=", 
      RowBox[{
       RowBox[{"PrepareString", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "v3", ",", "v33", ",", "\[Alpha]31", ",", "\[Alpha]32", ",", 
           "\[Nu]3"}], "}"}], ",", 
         RowBox[{"N", "@", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            FractionBox["\[Pi]", "2"]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"c", ",", "b", ",", "0."}], "}"}], ",", "0."}], "]"}], "@", 
       "state"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"string4", "=", 
      RowBox[{
       RowBox[{"PrepareString", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "v4", ",", "v44", ",", "\[Alpha]41", ",", "\[Alpha]42", ",", 
           "\[Nu]4"}], "}"}], ",", 
         RowBox[{"N", "@", 
          RowBox[{"{", 
           RowBox[{"\[Pi]", ",", 
            FractionBox["\[Pi]", "2"]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"c", ",", "b", ",", "0."}], "}"}], ",", "0."}], "]"}], "@", 
       "state"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"initialState", "=", 
      RowBox[{
       RowBox[{"Abrikosov", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "@", 
       RowBox[{"{", 
        RowBox[{"string1", ",", "string2", ",", "string3", ",", "string4"}], 
        "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<lR\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<lR\>\""}]}], ",", 
       RowBox[{"\"\<nR\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<nR\>\""}]}], ",", 
       RowBox[{"\"\<\[Epsilon]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Epsilon]\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<v\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<v\>\""}]}], ",", 
       RowBox[{"\"\<\[Lambda]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Lambda]\>\""}]}], ",", 
       RowBox[{"\"\<q\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<q\>\""}]}], ",", 
       RowBox[{"\"\<\[Omega]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Omega]\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<r\[Phi]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<r\[Phi]\>\""}]}], ",", 
       RowBox[{"\"\<r\[Chi]\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<r\[Chi]\>\""}]}], ",", 
       RowBox[{"\"\<rA\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<rA\>\""}]}], ",", 
       RowBox[{"\"\<\[Chi]0\>\"", "\[Rule]", 
        RowBox[{"state", "@", "\"\<\[Chi]0\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<lX\>\"", "\[Rule]", "lX"}], ",", 
       RowBox[{"\"\<nX\>\"", "\[Rule]", "nX"}], ",", 
       RowBox[{"\"\<lY\>\"", "\[Rule]", "lY"}], ",", 
       RowBox[{"\"\<nY\>\"", "\[Rule]", "nY"}], ",", 
       RowBox[{"\"\<lZ\>\"", "\[Rule]", "lZ"}], ",", 
       RowBox[{"\"\<nZ\>\"", "\[Rule]", "nZ"}], ",", 
       RowBox[{"\"\<t\>\"", "\[Rule]", "0."}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<v1\>\"", "\[Rule]", "v1"}], ",", 
       RowBox[{"\"\<\[Alpha]11\>\"", "\[Rule]", "\[Alpha]11"}], ",", 
       RowBox[{"\"\<\[Alpha]12\>\"", "\[Rule]", "\[Alpha]12"}], ",", 
       RowBox[{"\"\<\[Nu]1\>\"", "\[Rule]", "\[Nu]1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<v2\>\"", "\[Rule]", "v2"}], ",", 
       RowBox[{"\"\<\[Alpha]21\>\"", "\[Rule]", "\[Alpha]21"}], ",", 
       RowBox[{"\"\<\[Alpha]22\>\"", "\[Rule]", "\[Alpha]22"}], ",", 
       RowBox[{"\"\<\[Nu]2\>\"", "\[Rule]", "\[Nu]2"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<v3\>\"", "\[Rule]", "v3"}], ",", 
       RowBox[{"\"\<\[Alpha]31\>\"", "\[Rule]", "\[Alpha]31"}], ",", 
       RowBox[{"\"\<\[Alpha]32\>\"", "\[Rule]", "\[Alpha]32"}], ",", 
       RowBox[{"\"\<\[Nu]3\>\"", "\[Rule]", "\[Nu]3"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<v4\>\"", "\[Rule]", "v4"}], ",", 
       RowBox[{"\"\<\[Alpha]41\>\"", "\[Rule]", "\[Alpha]41"}], ",", 
       RowBox[{"\"\<\[Alpha]42\>\"", "\[Rule]", "\[Alpha]42"}], ",", 
       RowBox[{"\"\<\[Nu]4\>\"", "\[Rule]", "\[Nu]4"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<a\>\"", "\[Rule]", "a"}], ",", 
       RowBox[{"\"\<b\>\"", "->", "b"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<fields\>\"", "\[Rule]", "initialState"}]}], 
      "\[IndentingNewLine]", "|>"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.875790327631626*^9, 3.875790362272999*^9}, {
  3.875790880117571*^9, 3.8757908844230356`*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"0f89bd3d-4d6b-454e-9047-92636868f96b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Import / Export seeds", "Subsection",
 CellChangeTimes->{{3.8419165228741813`*^9, 
  3.841916529864596*^9}},ExpressionUUID->"8aec3de4-4265-456e-a44a-\
9694e3a5be6b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "ExportSeed"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExportSeed", "[", 
    RowBox[{"filename_String", ",", "seed_Association"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"filename", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<fields\>\"", "\[Rule]", 
        RowBox[{"seed", "@", "\"\<fields\>\""}]}], ",", 
       RowBox[{"\"\<fields\>\"", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<Attributes\>\"", "\[Rule]", 
          RowBox[{"Normal", "@", 
           RowBox[{"KeyDrop", "[", 
            RowBox[{"seed", ",", "\"\<fields\>\""}], "]"}]}]}], "}"}]}]}], 
      "}"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8419159109865437`*^9, 3.841915921447466*^9}, {
  3.8419159545769567`*^9, 3.841916001272786*^9}, {3.841916153840742*^9, 
  3.8419163176574306`*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"6bde7676-0283-41dc-bdbc-d37b180d2c26"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "ImportSeed"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ImportSeed", "[", "filename_String", "]"}], ":=", 
  RowBox[{"Append", "[", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{"filename", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Attributes\>\"", ",", "\"\<fields\>\""}], "}"}]}], "]"}], 
    ",", 
    RowBox[{"\"\<fields\>\"", "->", 
     RowBox[{"NumericArray", "[", 
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{"filename", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Datasets\>\"", ",", "\"\<fields\>\""}], "}"}]}], "]"}],
        ",", "\"\<Real32\>\""}], "]"}]}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8419163396276436`*^9, 3.8419164435139647`*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"d72fdb1f-f8c5-45b2-9d72-5335887e8f1c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fourth other Runge-Kutta", "Section",
 CellChangeTimes->{{3.8240941697847986`*^9, 
  3.8240941749514313`*^9}},ExpressionUUID->"231f76a5-4215-4379-86f2-\
b236affed8f5"],

Cell[CellGroupData[{

Cell["Auxiliary definitions", "Subsection",
 CellChangeTimes->{{3.8008477214554043`*^9, 3.8008477279465895`*^9}, {
  3.800848482551206*^9, 
  3.800848483641203*^9}},ExpressionUUID->"f3bfdaa4-f6ea-4b9c-8767-\
6360022d1948"],

Cell[TextData[{
 Cell[BoxData[
  FormBox["UFDWeights", TraditionalForm]],ExpressionUUID->
  "b650decd-b167-4561-8aa9-b255b15908c6"],
 " defines the kernel weights to use when computing finite difference \
derivatives on regular grids (see the tutorial on ",
 Cell[BoxData[
  FormBox["NDSolveMethodOfLines", TraditionalForm]],ExpressionUUID->
  "fab8451c-45e1-42dd-a495-524170dbb8f3"],
 " for more details)"
}], "Text",
 CellChangeTimes->{{3.800848160907199*^9, 
  3.800848231835684*^9}},ExpressionUUID->"dbf594ef-369f-483e-968c-\
0c9b0c94e717"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "@", "UFDWeights"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UFDWeights", "[", 
   RowBox[{"derOrder_Integer", ",", " ", 
    RowBox[{"kerOrder_Integer", "?", "EvenQ"}]}], "]"}], ":=", 
  RowBox[{"CoefficientList", "[", 
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Xi]", 
          RowBox[{"kerOrder", "/", "2"}]], 
         SuperscriptBox[
          RowBox[{"Log", "[", "\[Xi]", "]"}], "derOrder"]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Xi]", ",", "1", ",", "kerOrder"}], "}"}]}], "]"}], "/", 
      SuperscriptBox["h", "derOrder"]}], "]"}], ",", "\[Xi]"}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.8006764782903085`*^9, {3.8006765309993596`*^9, 3.8006765448074245`*^9}, {
   3.800676579334037*^9, 3.8006765860131702`*^9}, {3.8006766951701994`*^9, 
   3.800676697246682*^9}, {3.800677133001123*^9, 3.8006771519763365`*^9}, {
   3.800847911454443*^9, 3.8008479523313093`*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"023288c2-200c-45c4-86b9-f900cbe225d4"],

Cell[TextData[{
 Cell[BoxData[
  FormBox["NNDer3D", TraditionalForm]],ExpressionUUID->
  "ac27d188-40f2-44b9-aba5-17cbfcfc57fd"],
 " defines neural networks to compute finite difference derivatives of any \
order in a regular 3D grid, imposing Neumann boundary conditions in both \
directions:\n\t- compute the ",
 Cell[BoxData[
  FormBox["derOrderX", TraditionalForm]],ExpressionUUID->
  "83bb6e76-855c-4e20-b6f3-e6195b250171"],
 " derivative in ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "030f5084-83dd-4a68-8a19-789f81553877"],
 ", ",
 Cell[BoxData[
  FormBox["derOrderY", TraditionalForm]],ExpressionUUID->
  "d5887432-0228-472b-bed9-9b9790d45029"],
 " derivative in ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]],ExpressionUUID->
  "da32c149-6aa8-4eae-bf54-cc3da65f7661"],
 " and ",
 Cell[BoxData[
  FormBox["derOrderZ", TraditionalForm]],ExpressionUUID->
  "fb9541dd-0e3c-45b6-af98-6102d81fc60c"],
 " derivative in ",
 Cell[BoxData[
  FormBox["z", TraditionalForm]],ExpressionUUID->
  "53d758de-b712-479d-9c5e-6de59e1599b5"],
 "\n\t- finite difference order is ",
 Cell[BoxData[
  FormBox["kerOrderX", TraditionalForm]],ExpressionUUID->
  "6dfec5f2-ab29-4877-ac9a-d10edd6300f9"],
 " in ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "a02f2266-afbb-4a78-a9e3-fc88260f08fb"],
 ", ",
 Cell[BoxData[
  FormBox["kerOrderY", TraditionalForm]],ExpressionUUID->
  "c8e7407c-e08c-4797-92da-421f63558af4"],
 " in ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]],ExpressionUUID->
  "a8272f31-6766-402f-9295-f37f815b6f90"],
 " and ",
 Cell[BoxData[
  FormBox["kerOrderZ", TraditionalForm]],ExpressionUUID->
  "78951f5c-3450-49ea-b420-f356ba1bb448"],
 " in ",
 Cell[BoxData[
  FormBox["z", TraditionalForm]],ExpressionUUID->
  "a6cdce64-ef62-4e16-9a78-7253097c5439"],
 "\n\t- resulting neural network has signature ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[DoubleStruckCapitalR]", 
     RowBox[{"(", 
      RowBox[{"n", ",", "Nx", ",", "Ny", ",", "Nz"}], ")"}]], "\[Rule]", 
    SuperscriptBox["\[DoubleStruckCapitalR]", 
     RowBox[{"(", 
      RowBox[{"n", ",", "Nx", ",", "Ny", ",", "Nz"}], ")"}]]}], 
   TraditionalForm]],ExpressionUUID->"b3e5539d-dfce-4c49-b7aa-c0aefc921ff1"]
}], "Text",
 CellChangeTimes->{{3.8008483298163047`*^9, 3.8008483395773416`*^9}, {
  3.800848398746598*^9, 3.8008484364556847`*^9}, {3.8008484919122396`*^9, 
  3.800848610872342*^9}, {3.8008486673222303`*^9, 3.8008486725542793`*^9}, {
  3.800849054837804*^9, 3.800849186120633*^9}, {3.8240392297239666`*^9, 
  3.8240392881919756`*^9}},ExpressionUUID->"993dc8d4-2594-43c0-ba1d-\
da4c5ef1aa8b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "PeriodicPaddingLayer"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PeriodicPaddingLayer", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", "l_Integer", "}"}]}], "]"}], ":=", 
   RowBox[{"Sequence", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PeriodicPaddingLayer", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n_Integer", ",", "m_Integer"}], "}"}], ",", 
    RowBox[{"{", "l_Integer", "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"NetGraph", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<left\>\"", "\[Rule]", 
       RowBox[{"PartLayer", "@", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{";;", ",", 
            RowBox[{"l", "-", "1"}]}], "]"}], ",", 
          RowBox[{";;", "m"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<right\>\"", "\[Rule]", 
       RowBox[{"PartLayer", "@", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{";;", ",", 
            RowBox[{"l", "-", "1"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"-", "n"}], ";;"}]}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<catenate\>\"", "->", 
       RowBox[{"CatenateLayer", "@", "l"}]}]}], "\[IndentingNewLine]", "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"NetPort", "@", "\"\<Input\>\""}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<left\>\"", ",", "\"\<right\>\""}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<right\>\"", ",", 
         RowBox[{"NetPort", "@", "\"\<Input\>\""}], ",", "\"\<left\>\""}], 
        "}"}], "\[Rule]", "\"\<catenate\>\""}]}], "\[IndentingNewLine]", 
     "}"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PeriodicPaddingLayer", "[", 
   RowBox[{"specs", ":", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"_Integer", ",", "_Integer"}], "}"}], ".."}], "}"}]}], "]"}], ":=", 
  RowBox[{"NetChain", "@", 
   RowBox[{"MapIndexed", "[", 
    RowBox[{"PeriodicPaddingLayer", ",", "specs"}], "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8303503204551888`*^9, 3.830350322754682*^9}, {
  3.8303503565127707`*^9, 3.830350704127986*^9}, {3.8303510712491302`*^9, 
  3.8303510734879026`*^9}, {3.8303511452844267`*^9, 3.830351198502482*^9}, {
  3.83035127752195*^9, 3.8303512887019563`*^9}, {3.8303514273304405`*^9, 
  3.8303514895039268`*^9}, {3.8303515659774733`*^9, 3.830351572805066*^9}, {
  3.830351614149571*^9, 3.8303516289183536`*^9}, {3.8303517023600035`*^9, 
  3.83035170476258*^9}, {3.8303520160414314`*^9, 3.8303520994177923`*^9}, {
  3.830352441193761*^9, 3.830352460487267*^9}, {3.8303540642106895`*^9, 
  3.83035407307294*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"b84cac42-2021-4a21-8816-6b5267723c1e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "NNDer3D"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NNDer3D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lX_Real", ",", "nX_Integer"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"lY_Real", ",", "nY_Integer"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"lZ_Real", ",", "nZ_Integer"}], "}"}]}], "]"}], "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"derOrderX_Integer", ",", 
      RowBox[{"kerOrderX_Integer", "?", "EvenQ"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"derOrderY_Integer", ",", 
      RowBox[{"kerOrderY_Integer", "?", "EvenQ"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"derOrderZ_Integer", ",", 
      RowBox[{"kerOrderZ_Integer", "?", "EvenQ"}]}], "}"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "xs", ",", "dx", ",", "ys", ",", "dy", ",", "zs", ",", "dz", ",", "xw", 
      ",", "yw", ",", "zw", ",", "kernel"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xs", ",", "dx"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ys", ",", "dy"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"zs", ",", "dz"}], "}"}]}], "}"}], "=", 
      RowBox[{"Grid3D", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lX", ",", "nX"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"lY", ",", "nY"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xw", "=", 
      RowBox[{
       RowBox[{"UFDWeights", "[", 
        RowBox[{"derOrderX", ",", "kerOrderX"}], "]"}], "/.", 
       RowBox[{"h", "\[Rule]", "dx"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"yw", "=", 
      RowBox[{
       RowBox[{"UFDWeights", "[", 
        RowBox[{"derOrderY", ",", "kerOrderY"}], "]"}], "/.", 
       RowBox[{"h", "\[Rule]", "dy"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"zw", "=", 
      RowBox[{
       RowBox[{"UFDWeights", "[", 
        RowBox[{"derOrderZ", ",", "kerOrderZ"}], "]"}], "/.", 
       RowBox[{"h", "\[Rule]", "dz"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"kernel", "=", 
      RowBox[{"TensorProduct", "[", 
       RowBox[{
        RowBox[{"IdentityMatrix", "@", "1"}], ",", "xw", ",", "yw", ",", 
        "zw"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NetChain", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ReshapeLayer", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "nX", ",", "nY", ",", "nZ"}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PaddingLayer", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"kerOrderX", "/", "2"}], ",", 
               RowBox[{"kerOrderX", "/", "2"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"kerOrderY", "/", "2"}], ",", 
               RowBox[{"kerOrderY", "/", "2"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"kerOrderZ", "/", "2"}], ",", 
               RowBox[{"kerOrderZ", "/", "2"}]}], "}"}]}], "}"}], ",", 
           RowBox[{"Padding", "\[Rule]", "\"\<Fixed\>\""}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"PeriodicPaddingLayer", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"kerOrderX", "/", "2"}], ",", 
                RowBox[{"kerOrderX", "/", "2"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"kerOrderY", "/", "2"}], ",", 
                RowBox[{"kerOrderY", "/", "2"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"kerOrderZ", "/", "2"}], ",", 
                RowBox[{"kerOrderZ", "/", "2"}]}], "}"}]}], "}"}]}], ","}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"ConvolutionLayer", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"kerOrderX", "+", "1"}], ",", 
             RowBox[{"kerOrderY", "+", "1"}], ",", 
             RowBox[{"kerOrderZ", "+", "1"}]}], "}"}], ",", 
           RowBox[{"\"\<Biases\>\"", "\[Rule]", "None"}], ",", 
           RowBox[{"\"\<Weights\>\"", "\[Rule]", "kernel"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ReshapeLayer", "[", 
          RowBox[{"{", 
           RowBox[{"nX", ",", "nY", ",", "nZ"}], "}"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"\"\<Input\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"nX", ",", "nY", ",", "nY"}], "}"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NNDer3D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lX_Real", ",", "nX_Integer"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"lY_Real", ",", "nY_Integer"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"lZ_Real", ",", "nZ_Integer"}], "}"}]}], "]"}], "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"derOrderX_Integer", ",", 
      RowBox[{"kerOrderX_Integer", "?", "EvenQ"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"derOrderY_Integer", ",", 
      RowBox[{"kerOrderY_Integer", "?", "EvenQ"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"derOrderZ_Integer", ",", 
      RowBox[{"kerOrderZ_Integer", "?", "EvenQ"}]}], "}"}], ",", 
    "n_Integer"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "xs", ",", "dx", ",", "ys", ",", "dy", ",", "zs", ",", "dz", ",", "xw", 
      ",", "yw", ",", "zw", ",", "kernel"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xs", ",", "dx"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ys", ",", "dy"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"zs", ",", "dz"}], "}"}]}], "}"}], "=", 
      RowBox[{"Grid3D", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lX", ",", "nX"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"lY", ",", "nY"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xw", "=", 
      RowBox[{
       RowBox[{"UFDWeights", "[", 
        RowBox[{"derOrderX", ",", "kerOrderX"}], "]"}], "/.", 
       RowBox[{"h", "\[Rule]", "dx"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"yw", "=", 
      RowBox[{
       RowBox[{"UFDWeights", "[", 
        RowBox[{"derOrderY", ",", "kerOrderY"}], "]"}], "/.", 
       RowBox[{"h", "\[Rule]", "dy"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"zw", "=", 
      RowBox[{
       RowBox[{"UFDWeights", "[", 
        RowBox[{"derOrderZ", ",", "kerOrderZ"}], "]"}], "/.", 
       RowBox[{"h", "\[Rule]", "dz"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"kernel", "=", 
      RowBox[{"TensorProduct", "[", 
       RowBox[{
        RowBox[{"IdentityMatrix", "@", "n"}], ",", "xw", ",", "yw", ",", 
        "zw"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NetChain", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"PaddingLayer", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"kerOrderX", "/", "2"}], ",", 
               RowBox[{"kerOrderX", "/", "2"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"kerOrderY", "/", "2"}], ",", 
               RowBox[{"kerOrderY", "/", "2"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"kerOrderZ", "/", "2"}], ",", 
               RowBox[{"kerOrderZ", "/", "2"}]}], "}"}]}], "}"}], ",", 
           RowBox[{"Padding", "\[Rule]", "\"\<Fixed\>\""}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"PeriodicPaddingLayer", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"kerOrderX", "/", "2"}], ",", 
                RowBox[{"kerOrderX", "/", "2"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"kerOrderY", "/", "2"}], ",", 
                RowBox[{"kerOrderY", "/", "2"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"kerOrderZ", "/", "2"}], ",", 
                RowBox[{"kerOrderZ", "/", "2"}]}], "}"}]}], "}"}]}], ","}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"ConvolutionLayer", "[", 
          RowBox[{"n", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"kerOrderX", "+", "1"}], ",", 
             RowBox[{"kerOrderY", "+", "1"}], ",", 
             RowBox[{"kerOrderZ", "+", "1"}]}], "}"}], ",", 
           RowBox[{"\"\<Biases\>\"", "\[Rule]", "None"}], ",", 
           RowBox[{"\"\<Weights\>\"", "\[Rule]", "kernel"}]}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"\"\<Input\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"n", ",", "nX", ",", "nY", ",", "nY"}], "}"}]}]}], "]"}]}]}],
    "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8006841250544205`*^9, 3.8006841255500393`*^9}, {
   3.8006841860033383`*^9, 3.8006843100864997`*^9}, 3.800684459902713*^9, {
   3.800684597906616*^9, 3.800684619021141*^9}, {3.8008483107323313`*^9, 
   3.8008483151463366`*^9}, {3.80084861260236*^9, 3.800848648217975*^9}, {
   3.800848678984007*^9, 3.8008486810479755`*^9}, {3.800848728921095*^9, 
   3.800848741081689*^9}, {3.8008488075452557`*^9, 3.8008488583774786`*^9}, {
   3.800848889387001*^9, 3.8008490417828007`*^9}, {3.800849605429953*^9, 
   3.8008496488057933`*^9}, 3.8008497505285234`*^9, {3.8008498208573627`*^9, 
   3.8008498366813574`*^9}, {3.8240389875393367`*^9, 3.824039064357231*^9}, {
   3.824039111472465*^9, 3.824039121480313*^9}, {3.8240392057021413`*^9, 
   3.824039206752776*^9}, {3.8303536998533525`*^9, 3.8303537162115316`*^9}, {
   3.830415469595398*^9, 3.830415472996726*^9}, {3.8424130241472464`*^9, 
   3.8424130242778797`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"badea568-5f37-4e99-94e9-77ed2ab7ff15"]
}, Closed]],

Cell[CellGroupData[{

Cell["Evaluating equations", "Subsection",
 CellChangeTimes->{{3.8240389700847254`*^9, 
  3.8240389736531367`*^9}},ExpressionUUID->"ab89dca9-81a3-435e-aec2-\
a17614f7ea33"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "NNEqs"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NNEqs", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lX_Real", ",", "nX_Integer"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"lY_Real", ",", "nY_Integer"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"lZ_Real", ",", "nZ_Integer"}], "}"}]}], "]"}], "[", 
    RowBox[{
    "kerOrderX_Integer", ",", "kerOrderY_Integer", ",", "kerOrderZ_Integer"}],
     "]"}], "[", 
   RowBox[{
   "v_Real", ",", "\[Lambda]_Real", ",", "q_Real", ",", "\[Omega]_Real"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"V", "=", "v"}], ",", 
      RowBox[{"\[CapitalLambda]", "=", "\[Lambda]"}], ",", 
      RowBox[{"Q", "=", "q"}], ",", 
      RowBox[{"\[CapitalOmega]", "=", "\[Omega]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"NetGraph", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<Dx\[Phi]r\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "kerOrderX"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Dy\[Phi]r\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "kerOrderY"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Dz\[Phi]r\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "kerOrderZ"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2x\[Phi]r\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "kerOrderX"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2y\[Phi]r\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "kerOrderY"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2z\[Phi]r\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "kerOrderZ"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Dx\[Phi]i\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "kerOrderX"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Dy\[Phi]i\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "kerOrderY"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Dz\[Phi]i\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "kerOrderZ"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2x\[Phi]i\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "kerOrderX"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2y\[Phi]i\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "kerOrderY"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2z\[Phi]i\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "kerOrderZ"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2x\[Chi]1\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "kerOrderX"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2y\[Chi]1\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "kerOrderY"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2z\[Chi]1\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "kerOrderZ"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2x\[Chi]2\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "kerOrderX"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2y\[Chi]2\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "kerOrderY"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2z\[Chi]2\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "kerOrderZ"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2x\[Chi]3\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "kerOrderX"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2y\[Chi]3\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "kerOrderY"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2z\[Chi]3\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "kerOrderZ"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2xAx\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "kerOrderX"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2yAx\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "kerOrderY"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2zAx\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "kerOrderZ"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2xAy\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "kerOrderX"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2yAy\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "kerOrderY"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2zAy\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "kerOrderZ"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2xAz\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "kerOrderX"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2yAz\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "kerOrderY"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2zAz\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "kerOrderZ"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2xAt\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "kerOrderX"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2yAt\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "kerOrderY"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2zAt\>\"", "->", 
         RowBox[{
          RowBox[{"NNDer3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "kerOrderZ"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<EQ1\>\"", "->", 
         RowBox[{"FunctionLayer", "@", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\[Phi]r", ",", "D2x\[Phi]r", ",", "D2y\[Phi]r", ",", 
              "D2z\[Phi]r", ",", "\[Phi]i", ",", "Dx\[Phi]i", ",", 
              "Dy\[Phi]i", ",", "Dz\[Phi]i", ",", "\[Chi]1", ",", "\[Chi]2", 
              ",", "\[Chi]3", ",", "Ax", ",", "Ay", ",", "Az", ",", "At", ",",
               "Dt\[Phi]i"}], "}"}], ",", 
            RowBox[{"D2x\[Phi]r", "+", "D2y\[Phi]r", "+", "D2z\[Phi]r", "-", 
             RowBox[{"2", "\[CapitalLambda]", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Phi]r", "2"], "+", 
                SuperscriptBox["\[Phi]i", "2"], "+", 
                SuperscriptBox["\[Chi]1", "2"], "+", 
                SuperscriptBox["\[Chi]2", "2"], "+", 
                SuperscriptBox["\[Chi]3", "2"], "-", 
                SuperscriptBox["V", "2"]}], ")"}], "\[Phi]r"}], "-", 
             RowBox[{"2", "Q", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Ax", " ", "Dx\[Phi]i"}], "+", 
                RowBox[{"Ay", " ", "Dy\[Phi]i"}], "+", 
                RowBox[{"Az", " ", "Dz\[Phi]i"}], "-", 
                RowBox[{"At", " ", "Dt\[Phi]i"}]}], ")"}]}], "-", 
             RowBox[{
              SuperscriptBox["Q", "2"], 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Ax", "2"], "+", 
                SuperscriptBox["Ay", "2"], "+", 
                SuperscriptBox["Az", "2"], "-", 
                SuperscriptBox["At", "2"]}], ")"}], "\[Phi]r"}]}]}], 
           "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<EQ2\>\"", "->", 
         RowBox[{"FunctionLayer", "@", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\[Phi]r", ",", "Dx\[Phi]r", ",", "Dy\[Phi]r", ",", "Dz\[Phi]r", 
              ",", "\[Phi]i", ",", "D2x\[Phi]i", ",", "D2y\[Phi]i", ",", 
              "D2z\[Phi]i", ",", "\[Chi]1", ",", "\[Chi]2", ",", "\[Chi]3", 
              ",", "Ax", ",", "Ay", ",", "At", ",", "Az", ",", "Dt\[Phi]r"}], 
             "}"}], ",", 
            RowBox[{"D2x\[Phi]i", "+", "D2y\[Phi]i", "+", "D2z\[Phi]i", "-", 
             RowBox[{"2", "\[CapitalLambda]", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Phi]r", "2"], "+", 
                SuperscriptBox["\[Phi]i", "2"], "+", 
                SuperscriptBox["\[Chi]1", "2"], "+", 
                SuperscriptBox["\[Chi]2", "2"], "+", 
                SuperscriptBox["\[Chi]3", "2"], "-", 
                SuperscriptBox["V", "2"]}], ")"}], "\[Phi]i"}], "+", 
             RowBox[{"2", "Q", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Ax", " ", "Dx\[Phi]r"}], "+", 
                RowBox[{"Ay", " ", "Dy\[Phi]r"}], "+", 
                RowBox[{"Az", " ", "Dz\[Phi]r"}], "-", 
                RowBox[{"At", " ", "Dt\[Phi]r"}]}], ")"}]}], "-", 
             RowBox[{
              SuperscriptBox["Q", "2"], 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Ax", "2"], "+", 
                SuperscriptBox["Ay", "2"], "+", 
                SuperscriptBox["Az", "2"], "-", 
                SuperscriptBox["At", "2"]}], ")"}], "\[Phi]i"}]}]}], 
           "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<EQ3\>\"", "->", 
         RowBox[{"FunctionLayer", "@", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\[Phi]r", ",", "\[Phi]i", ",", "\[Chi]1", ",", "D2x\[Chi]1", 
              ",", "D2y\[Chi]1", ",", "D2z\[Chi]1", ",", "\[Chi]2", ",", 
              "\[Chi]3"}], "}"}], ",", 
            RowBox[{"D2x\[Chi]1", "+", "D2y\[Chi]1", "+", "D2z\[Chi]1", "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "\[CapitalLambda]", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["\[Phi]r", "2"], "+", 
                   SuperscriptBox["\[Phi]i", "2"], "+", 
                   SuperscriptBox["\[Chi]1", "2"], "+", 
                   SuperscriptBox["\[Chi]2", "2"], "+", 
                   SuperscriptBox["\[Chi]3", "2"], "-", 
                   SuperscriptBox["V", "2"]}], ")"}]}], "+", 
                SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], 
              "\[Chi]1"}]}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<EQ4\>\"", "->", 
         RowBox[{"FunctionLayer", "@", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\[Phi]r", ",", "\[Phi]i", ",", "\[Chi]1", ",", "\[Chi]2", ",", 
              "D2x\[Chi]2", ",", "D2y\[Chi]2", ",", "D2z\[Chi]2", ",", 
              "\[Chi]3"}], "}"}], ",", 
            RowBox[{"D2x\[Chi]2", "+", "D2y\[Chi]2", "+", "D2z\[Chi]2", "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "\[CapitalLambda]", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["\[Phi]r", "2"], "+", 
                   SuperscriptBox["\[Phi]i", "2"], "+", 
                   SuperscriptBox["\[Chi]1", "2"], "+", 
                   SuperscriptBox["\[Chi]2", "2"], "+", 
                   SuperscriptBox["\[Chi]3", "2"], "-", 
                   SuperscriptBox["V", "2"]}], ")"}]}], "+", 
                SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], 
              "\[Chi]2"}]}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<EQ5\>\"", "->", 
         RowBox[{"FunctionLayer", "@", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\[Phi]r", ",", "\[Phi]i", ",", "\[Chi]1", ",", "\[Chi]2", ",", 
              "\[Chi]3", ",", "D2x\[Chi]3", ",", "D2y\[Chi]3", ",", 
              "D2z\[Chi]3"}], "}"}], ",", 
            RowBox[{"D2x\[Chi]3", "+", "D2y\[Chi]3", "+", "D2z\[Chi]3", "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "\[CapitalLambda]", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["\[Phi]r", "2"], "+", 
                   SuperscriptBox["\[Phi]i", "2"], "+", 
                   SuperscriptBox["\[Chi]1", "2"], "+", 
                   SuperscriptBox["\[Chi]2", "2"], "+", 
                   SuperscriptBox["\[Chi]3", "2"], "-", 
                   SuperscriptBox["V", "2"]}], ")"}]}], "+", 
                SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], 
              "\[Chi]3"}]}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<EQ6\>\"", "->", 
         RowBox[{"FunctionLayer", "@", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\[Phi]r", ",", "Dx\[Phi]r", ",", "\[Phi]i", ",", "Dx\[Phi]i", 
              ",", "Ax", ",", "D2xAx", ",", "D2yAx", ",", "D2zAx"}], "}"}], 
            ",", 
            RowBox[{"D2xAx", "+", "D2yAx", "+", "D2zAx", "-", 
             RowBox[{"2", 
              SuperscriptBox["Q", "2"], 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Phi]r", "2"], "+", 
                SuperscriptBox["\[Phi]i", "2"]}], ")"}], "Ax"}], "+", 
             RowBox[{"2", "Q", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Phi]i", " ", "Dx\[Phi]r"}], "-", 
                RowBox[{"\[Phi]r", " ", "Dx\[Phi]i"}]}], ")"}]}]}]}], 
           "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<EQ7\>\"", "->", 
         RowBox[{"FunctionLayer", "@", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\[Phi]r", ",", "Dy\[Phi]r", ",", "\[Phi]i", ",", "Dy\[Phi]i", 
              ",", "Ay", ",", "D2xAy", ",", "D2yAy", ",", "D2zAy"}], "}"}], 
            ",", 
            RowBox[{"D2xAy", "+", "D2yAy", "+", "D2zAy", "-", 
             RowBox[{"2", 
              SuperscriptBox["Q", "2"], 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Phi]r", "2"], "+", 
                SuperscriptBox["\[Phi]i", "2"]}], ")"}], "Ay"}], "+", 
             RowBox[{"2", "Q", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Phi]i", " ", "Dy\[Phi]r"}], "-", 
                RowBox[{"\[Phi]r", " ", "Dy\[Phi]i"}]}], ")"}]}]}]}], 
           "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<EQ8\>\"", "->", 
         RowBox[{"FunctionLayer", "@", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\[Phi]r", ",", "Dz\[Phi]r", ",", "\[Phi]i", ",", "Dz\[Phi]i", 
              ",", "Az", ",", "D2xAz", ",", "D2yAz", ",", "D2zAz"}], "}"}], 
            ",", 
            RowBox[{"D2xAz", "+", "D2yAz", "+", "D2zAz", "-", 
             RowBox[{"2", 
              SuperscriptBox["Q", "2"], 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Phi]r", "2"], "+", 
                SuperscriptBox["\[Phi]i", "2"]}], ")"}], "Az"}], "+", 
             RowBox[{"2", "Q", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Phi]i", " ", "Dz\[Phi]r"}], "-", 
                RowBox[{"\[Phi]r", " ", "Dz\[Phi]i"}]}], ")"}]}]}]}], 
           "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<EQ9\>\"", "->", 
         RowBox[{"FunctionLayer", "@", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\[Phi]r", ",", "Dt\[Phi]r", ",", "\[Phi]i", ",", "Dt\[Phi]i", 
              ",", "At", ",", "D2xAt", ",", "D2yAt", ",", "D2zAt"}], "}"}], 
            ",", 
            RowBox[{"D2xAt", "+", "D2yAt", "+", "D2zAt", "-", 
             RowBox[{"2", 
              SuperscriptBox["Q", "2"], 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Phi]r", "2"], "+", 
                SuperscriptBox["\[Phi]i", "2"]}], ")"}], "At"}], "+", 
             RowBox[{"2", "Q", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Phi]i", " ", "Dt\[Phi]r"}], "-", 
                RowBox[{"\[Phi]r", " ", "Dt\[Phi]i"}]}], ")"}]}]}]}], 
           "]"}]}]}]}], "\[IndentingNewLine]", "|>"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<\[Phi]r\>\"", "]"}], "->", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Dx\[Phi]r\>\"", ",", "\"\<Dy\[Phi]r\>\"", ",", 
           "\"\<Dz\[Phi]r\>\"", ",", "\"\<D2x\[Phi]r\>\"", ",", 
           "\"\<D2y\[Phi]r\>\"", ",", "\"\<D2z\[Phi]r\>\"", ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ1\>\"", ",", "\"\<\[Phi]r\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ2\>\"", ",", "\"\<\[Phi]r\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ3\>\"", ",", "\"\<\[Phi]r\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ4\>\"", ",", "\"\<\[Phi]r\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ5\>\"", ",", "\"\<\[Phi]r\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ6\>\"", ",", "\"\<\[Phi]r\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ7\>\"", ",", "\"\<\[Phi]r\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ8\>\"", ",", "\"\<\[Phi]r\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ9\>\"", ",", "\"\<\[Phi]r\>\""}], "]"}]}], "}"}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<Dx\[Phi]r\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ2\>\"", ",", "\"\<Dx\[Phi]r\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ6\>\"", ",", "\"\<Dx\[Phi]r\>\""}], "]"}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<Dy\[Phi]r\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ2\>\"", ",", "\"\<Dy\[Phi]r\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ7\>\"", ",", "\"\<Dy\[Phi]r\>\""}], "]"}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<Dz\[Phi]r\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ2\>\"", ",", "\"\<Dz\[Phi]r\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ8\>\"", ",", "\"\<Dz\[Phi]r\>\""}], "]"}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<D2x\[Phi]r\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<EQ1\>\"", ",", "\"\<D2x\[Phi]r\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2y\[Phi]r\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<EQ1\>\"", ",", "\"\<D2y\[Phi]r\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2z\[Phi]r\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<EQ1\>\"", ",", "\"\<D2z\[Phi]r\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<Dt\[Phi]r\>\"", "]"}], "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ2\>\"", ",", "\"\<Dt\[Phi]r\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ9\>\"", ",", "\"\<Dt\[Phi]r\>\""}], "]"}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<\[Phi]i\>\"", "]"}], "->", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Dx\[Phi]i\>\"", ",", "\"\<Dy\[Phi]i\>\"", ",", 
           "\"\<Dz\[Phi]i\>\"", ",", "\"\<D2x\[Phi]i\>\"", ",", 
           "\"\<D2y\[Phi]i\>\"", ",", "\"\<D2z\[Phi]i\>\"", ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ1\>\"", ",", "\"\<\[Phi]i\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ2\>\"", ",", "\"\<\[Phi]i\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ3\>\"", ",", "\"\<\[Phi]i\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ4\>\"", ",", "\"\<\[Phi]i\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ5\>\"", ",", "\"\<\[Phi]i\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ6\>\"", ",", "\"\<\[Phi]i\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ7\>\"", ",", "\"\<\[Phi]i\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ8\>\"", ",", "\"\<\[Phi]i\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ9\>\"", ",", "\"\<\[Phi]i\>\""}], "]"}]}], "}"}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<Dx\[Phi]i\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ1\>\"", ",", "\"\<Dx\[Phi]i\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ6\>\"", ",", "\"\<Dx\[Phi]i\>\""}], "]"}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<Dy\[Phi]i\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ1\>\"", ",", "\"\<Dy\[Phi]i\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ7\>\"", ",", "\"\<Dy\[Phi]i\>\""}], "]"}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<Dz\[Phi]i\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ1\>\"", ",", "\"\<Dz\[Phi]i\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ8\>\"", ",", "\"\<Dz\[Phi]i\>\""}], "]"}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<D2x\[Phi]i\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<EQ2\>\"", ",", "\"\<D2x\[Phi]i\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2y\[Phi]i\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<EQ2\>\"", ",", "\"\<D2y\[Phi]i\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2z\[Phi]i\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<EQ2\>\"", ",", "\"\<D2z\[Phi]i\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<Dt\[Phi]i\>\"", "]"}], "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ1\>\"", ",", "\"\<Dt\[Phi]i\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ9\>\"", ",", "\"\<Dt\[Phi]i\>\""}], "]"}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<\[Chi]1\>\"", "]"}], "->", 
         RowBox[{"{", 
          RowBox[{
          "\"\<D2x\[Chi]1\>\"", ",", "\"\<D2y\[Chi]1\>\"", ",", 
           "\"\<D2z\[Chi]1\>\"", ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ1\>\"", ",", "\"\<\[Chi]1\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ2\>\"", ",", "\"\<\[Chi]1\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ3\>\"", ",", "\"\<\[Chi]1\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ4\>\"", ",", "\"\<\[Chi]1\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ5\>\"", ",", "\"\<\[Chi]1\>\""}], "]"}]}], "}"}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<D2x\[Chi]1\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<EQ3\>\"", ",", "\"\<D2x\[Chi]1\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2y\[Chi]1\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<EQ3\>\"", ",", "\"\<D2y\[Chi]1\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2z\[Chi]1\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<EQ3\>\"", ",", "\"\<D2z\[Chi]1\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<\[Chi]2\>\"", "]"}], "->", 
         RowBox[{"{", 
          RowBox[{
          "\"\<D2x\[Chi]2\>\"", ",", "\"\<D2y\[Chi]2\>\"", ",", 
           "\"\<D2z\[Chi]2\>\"", ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ1\>\"", ",", "\"\<\[Chi]2\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ2\>\"", ",", "\"\<\[Chi]2\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ3\>\"", ",", "\"\<\[Chi]2\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ4\>\"", ",", "\"\<\[Chi]2\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ5\>\"", ",", "\"\<\[Chi]2\>\""}], "]"}]}], "}"}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<D2x\[Chi]2\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<EQ4\>\"", ",", "\"\<D2x\[Chi]2\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2y\[Chi]2\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<EQ4\>\"", ",", "\"\<D2y\[Chi]2\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2z\[Chi]2\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<EQ4\>\"", ",", "\"\<D2z\[Chi]2\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<\[Chi]3\>\"", "]"}], "->", 
         RowBox[{"{", 
          RowBox[{
          "\"\<D2x\[Chi]3\>\"", ",", "\"\<D2y\[Chi]3\>\"", ",", 
           "\"\<D2z\[Chi]3\>\"", ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ1\>\"", ",", "\"\<\[Chi]3\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ2\>\"", ",", "\"\<\[Chi]3\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ3\>\"", ",", "\"\<\[Chi]3\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ4\>\"", ",", "\"\<\[Chi]3\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ5\>\"", ",", "\"\<\[Chi]3\>\""}], "]"}]}], "}"}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<D2x\[Chi]3\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<EQ5\>\"", ",", "\"\<D2x\[Chi]3\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2y\[Chi]3\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<EQ5\>\"", ",", "\"\<D2y\[Chi]3\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2z\[Chi]3\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<EQ5\>\"", ",", "\"\<D2z\[Chi]3\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<Ax\>\"", "]"}], "->", 
         RowBox[{"{", 
          RowBox[{
          "\"\<D2xAx\>\"", ",", "\"\<D2yAx\>\"", ",", "\"\<D2zAx\>\"", ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ1\>\"", ",", "\"\<Ax\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ2\>\"", ",", "\"\<Ax\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ6\>\"", ",", "\"\<Ax\>\""}], "]"}]}], "}"}]}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"\"\<D2xAx\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<EQ6\>\"", ",", "\"\<D2xAx\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2yAx\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<EQ6\>\"", ",", "\"\<D2yAx\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2zAx\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<EQ6\>\"", ",", "\"\<D2zAx\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<Ay\>\"", "]"}], "->", 
         RowBox[{"{", 
          RowBox[{
          "\"\<D2xAy\>\"", ",", "\"\<D2yAy\>\"", ",", "\"\<D2zAy\>\"", ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ1\>\"", ",", "\"\<Ay\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ2\>\"", ",", "\"\<Ay\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ7\>\"", ",", "\"\<Ay\>\""}], "]"}]}], "}"}]}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"\"\<D2xAy\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<EQ7\>\"", ",", "\"\<D2xAy\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2yAy\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<EQ7\>\"", ",", "\"\<D2yAy\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2zAy\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<EQ7\>\"", ",", "\"\<D2zAy\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<Az\>\"", "]"}], "->", 
         RowBox[{"{", 
          RowBox[{
          "\"\<D2xAz\>\"", ",", "\"\<D2yAz\>\"", ",", "\"\<D2zAz\>\"", ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ1\>\"", ",", "\"\<Az\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ2\>\"", ",", "\"\<Az\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ8\>\"", ",", "\"\<Az\>\""}], "]"}]}], "}"}]}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"\"\<D2xAz\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<EQ8\>\"", ",", "\"\<D2xAz\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2yAz\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<EQ8\>\"", ",", "\"\<D2yAz\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2zAz\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<EQ8\>\"", ",", "\"\<D2zAz\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<At\>\"", "]"}], "->", 
         RowBox[{"{", 
          RowBox[{
          "\"\<D2xAt\>\"", ",", "\"\<D2yAt\>\"", ",", "\"\<D2zAt\>\"", ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ1\>\"", ",", "\"\<At\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ2\>\"", ",", "\"\<At\>\""}], "]"}], ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<EQ9\>\"", ",", "\"\<At\>\""}], "]"}]}], "}"}]}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"\"\<D2xAt\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<EQ9\>\"", ",", "\"\<D2xAt\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2yAt\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<EQ9\>\"", ",", "\"\<D2yAt\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<D2zAt\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<EQ9\>\"", ",", "\"\<D2zAt\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<EQ1\>\"", "->", 
         RowBox[{"NetPort", "[", "\"\<EQ1\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<EQ2\>\"", "->", 
         RowBox[{"NetPort", "[", "\"\<EQ2\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<EQ3\>\"", "->", 
         RowBox[{"NetPort", "[", "\"\<EQ3\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<EQ4\>\"", "->", 
         RowBox[{"NetPort", "[", "\"\<EQ4\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<EQ5\>\"", "->", 
         RowBox[{"NetPort", "[", "\"\<EQ5\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<EQ6\>\"", "->", 
         RowBox[{"NetPort", "[", "\"\<EQ6\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<EQ7\>\"", "->", 
         RowBox[{"NetPort", "[", "\"\<EQ7\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<EQ8\>\"", "->", 
         RowBox[{"NetPort", "[", "\"\<EQ8\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<EQ9\>\"", "->", 
         RowBox[{"NetPort", "[", "\"\<EQ9\>\"", "]"}]}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<\[Phi]r\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"nX", ",", "nY", ",", "nZ"}], "}"}]}], ",", " ", 
      RowBox[{"\"\<\[Phi]i\>\"", "->", 
       RowBox[{"{", 
        RowBox[{"nX", ",", "nY", ",", "nZ"}], "}"}]}], ",", 
      RowBox[{"\"\<\[Chi]1\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"nX", ",", "nY", ",", "nZ"}], "}"}]}], ",", " ", 
      RowBox[{"\"\<\[Chi]2\>\"", "->", 
       RowBox[{"{", 
        RowBox[{"nX", ",", "nY", ",", "nZ"}], "}"}]}], ",", 
      RowBox[{"\"\<\[Chi]3\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"nX", ",", "nY", ",", "nZ"}], "}"}]}], ",", " ", 
      RowBox[{"\"\<Ax\>\"", "->", 
       RowBox[{"{", 
        RowBox[{"nX", ",", "nY", ",", "nZ"}], "}"}]}], ",", " ", 
      RowBox[{"\"\<Ay\>\"", "->", 
       RowBox[{"{", 
        RowBox[{"nX", ",", "nY", ",", "nZ"}], "}"}]}], ",", 
      RowBox[{"\"\<Az\>\"", "->", 
       RowBox[{"{", 
        RowBox[{"nX", ",", "nY", ",", "nZ"}], "}"}]}], ",", " ", 
      RowBox[{"\"\<At\>\"", "->", 
       RowBox[{"{", 
        RowBox[{"nX", ",", "nY", ",", "nZ"}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Dt\[Phi]r\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"nX", ",", "nY", ",", "nZ"}], "}"}]}], ",", " ", 
      RowBox[{"\"\<Dt\[Phi]i\>\"", "->", 
       RowBox[{"{", 
        RowBox[{"nX", ",", "nY", ",", "nZ"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.842069857236431*^9, 3.842070109409867*^9}, 
   3.84207017297717*^9, {3.842070218977905*^9, 3.842070254944353*^9}, {
   3.842070320065686*^9, 3.8420703546398373`*^9}, {3.8420825541631193`*^9, 
   3.8420825650451374`*^9}, {3.8420826989237857`*^9, 3.842082708040352*^9}, {
   3.842082781841059*^9, 3.8420832078388495`*^9}, {3.8420832485146866`*^9, 
   3.8420832511878033`*^9}, {3.8420853556055717`*^9, 3.842085363277019*^9}, {
   3.842085437003318*^9, 3.84208553302822*^9}, {3.842085613256412*^9, 
   3.842085692395794*^9}, {3.8420857943809023`*^9, 3.8420858460118885`*^9}, {
   3.842086120007492*^9, 3.8420861773537188`*^9}, {3.84208805178578*^9, 
   3.842088110409831*^9}, 3.842089110232258*^9, {3.842089244769021*^9, 
   3.8420892448316827`*^9}, {3.8420902207134666`*^9, 3.842090224324815*^9}, {
   3.842091510837927*^9, 3.8420915110254974`*^9}, {3.8420919298636637`*^9, 
   3.8420919322881155`*^9}, {3.842091992966485*^9, 3.8420920186538715`*^9}, {
   3.842092401799938*^9, 3.8420924185979557`*^9}, {3.842092513518263*^9, 
   3.8420925306717825`*^9}, {3.842092566662004*^9, 3.842092647317174*^9}, {
   3.8420926889854975`*^9, 3.842092703268107*^9}, {3.8420927341111674`*^9, 
   3.8420929048972745`*^9}, {3.8424129374992204`*^9, 3.842412939570629*^9}, {
   3.8424130456358395`*^9, 3.8424135602189465`*^9}, {3.8424135947532067`*^9, 
   3.8424136282356224`*^9}, {3.8424136613573685`*^9, 
   3.8424137068659697`*^9}, {3.842413742667821*^9, 3.8424137587292423`*^9}, {
   3.8424137933293104`*^9, 3.8424138027126217`*^9}, {3.8424138353561306`*^9, 
   3.842413989656704*^9}, {3.842414089424446*^9, 3.84241417702221*^9}, {
   3.8424142156791153`*^9, 3.842414453375693*^9}, {3.842414528679905*^9, 
   3.8424145296171455`*^9}, {3.842415271092685*^9, 3.8424152746812696`*^9}, {
   3.876337259468935*^9, 3.8763372689940944`*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"d5ab4c83-0f36-4bb2-abb1-21dd15fc0862"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "NNEqsWrapper"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NNEqsWrapper", "[", 
    RowBox[{"nX_Integer", ",", "nY_Integer", ",", "nZ_Integer"}], "]"}], "[", 
   "net_NetGraph", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"NetGraph", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<\[Phi]r\>\"", "->", 
       RowBox[{"PartLayer", "[", "1", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<\[Phi]i\>\"", "->", 
       RowBox[{"PartLayer", "[", "2", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<\[Chi]1\>\"", "->", 
       RowBox[{"PartLayer", "[", "3", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<\[Chi]2\>\"", "->", 
       RowBox[{"PartLayer", "[", "4", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<\[Chi]3\>\"", "->", 
       RowBox[{"PartLayer", "[", "5", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<Ax\>\"", "->", 
       RowBox[{"PartLayer", "[", "6", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<Ay\>\"", "->", 
       RowBox[{"PartLayer", "[", "7", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<Az\>\"", "->", 
       RowBox[{"PartLayer", "[", "8", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<At\>\"", "->", 
       RowBox[{"PartLayer", "[", "9", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<Dt\[Phi]r\>\"", "->", 
       RowBox[{"PartLayer", "[", "1", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<Dt\[Phi]i\>\"", "->", 
       RowBox[{"PartLayer", "[", "2", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<net\>\"", "->", "net"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<reshape1\>\"", "->", 
       RowBox[{"ReshapeLayer", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "nX", ",", "nY", ",", "nZ"}], "}"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<reshape2\>\"", "->", 
       RowBox[{"ReshapeLayer", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "nX", ",", "nY", ",", "nZ"}], "}"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<reshape3\>\"", "->", 
       RowBox[{"ReshapeLayer", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "nX", ",", "nY", ",", "nZ"}], "}"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<reshape4\>\"", "->", 
       RowBox[{"ReshapeLayer", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "nX", ",", "nY", ",", "nZ"}], "}"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<reshape5\>\"", "->", 
       RowBox[{"ReshapeLayer", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "nX", ",", "nY", ",", "nZ"}], "}"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<reshape6\>\"", "->", 
       RowBox[{"ReshapeLayer", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "nX", ",", "nY", ",", "nZ"}], "}"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<reshape7\>\"", "->", 
       RowBox[{"ReshapeLayer", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "nX", ",", "nY", ",", "nZ"}], "}"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<reshape8\>\"", "->", 
       RowBox[{"ReshapeLayer", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "nX", ",", "nY", ",", "nZ"}], "}"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<reshape9\>\"", "->", 
       RowBox[{"ReshapeLayer", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "nX", ",", "nY", ",", "nZ"}], "}"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<catenate\>\"", "->", 
       RowBox[{"CatenateLayer", "[", "]"}]}]}], "\[IndentingNewLine]", "|>"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"NetPort", "[", "\"\<u\>\"", "]"}], "->", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\[Phi]r\>\"", ",", "\"\<\[Phi]i\>\"", ",", "\"\<\[Chi]1\>\"", 
         ",", "\"\<\[Chi]2\>\"", ",", "\"\<\[Chi]3\>\"", ",", "\"\<Ax\>\"", 
         ",", "\"\<Ay\>\"", ",", "\"\<Az\>\"", ",", "\"\<At\>\""}], "}"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NetPort", "[", "\"\<Du\>\"", "]"}], "->", 
       RowBox[{"{", 
        RowBox[{"\"\<Dt\[Phi]r\>\"", ",", "\"\<Dt\[Phi]i\>\""}], "}"}]}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"\"\<\[Phi]r\>\"", "->", 
       RowBox[{"NetPort", "[", 
        RowBox[{"\"\<net\>\"", ",", "\"\<\[Phi]r\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<\[Phi]i\>\"", "->", 
       RowBox[{"NetPort", "[", 
        RowBox[{"\"\<net\>\"", ",", "\"\<\[Phi]i\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<\[Chi]1\>\"", "->", 
       RowBox[{"NetPort", "[", 
        RowBox[{"\"\<net\>\"", ",", "\"\<\[Chi]1\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<\[Chi]2\>\"", "->", 
       RowBox[{"NetPort", "[", 
        RowBox[{"\"\<net\>\"", ",", "\"\<\[Chi]2\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<\[Chi]3\>\"", "->", 
       RowBox[{"NetPort", "[", 
        RowBox[{"\"\<net\>\"", ",", "\"\<\[Chi]3\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Ax\>\"", "->", 
       RowBox[{"NetPort", "[", 
        RowBox[{"\"\<net\>\"", ",", "\"\<Ax\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Ay\>\"", "->", 
       RowBox[{"NetPort", "[", 
        RowBox[{"\"\<net\>\"", ",", "\"\<Ay\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Az\>\"", "->", 
       RowBox[{"NetPort", "[", 
        RowBox[{"\"\<net\>\"", ",", "\"\<Az\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<At\>\"", "->", 
       RowBox[{"NetPort", "[", 
        RowBox[{"\"\<net\>\"", ",", "\"\<At\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Dt\[Phi]r\>\"", "->", 
       RowBox[{"NetPort", "[", 
        RowBox[{"\"\<net\>\"", ",", "\"\<Dt\[Phi]r\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Dt\[Phi]i\>\"", "->", 
       RowBox[{"NetPort", "[", 
        RowBox[{"\"\<net\>\"", ",", "\"\<Dt\[Phi]i\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NetPort", "[", 
        RowBox[{"\"\<net\>\"", ",", "\"\<EQ1\>\""}], "]"}], "->", 
       RowBox[{"\"\<reshape1\>\"", "->", "\"\<catenate\>\""}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NetPort", "[", 
        RowBox[{"\"\<net\>\"", ",", "\"\<EQ2\>\""}], "]"}], "->", 
       RowBox[{"\"\<reshape2\>\"", "->", "\"\<catenate\>\""}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NetPort", "[", 
        RowBox[{"\"\<net\>\"", ",", "\"\<EQ3\>\""}], "]"}], "->", 
       RowBox[{"\"\<reshape3\>\"", "->", "\"\<catenate\>\""}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NetPort", "[", 
        RowBox[{"\"\<net\>\"", ",", "\"\<EQ4\>\""}], "]"}], "->", 
       RowBox[{"\"\<reshape4\>\"", "->", "\"\<catenate\>\""}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NetPort", "[", 
        RowBox[{"\"\<net\>\"", ",", "\"\<EQ5\>\""}], "]"}], "->", 
       RowBox[{"\"\<reshape5\>\"", "->", "\"\<catenate\>\""}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NetPort", "[", 
        RowBox[{"\"\<net\>\"", ",", "\"\<EQ6\>\""}], "]"}], "->", 
       RowBox[{"\"\<reshape6\>\"", "->", "\"\<catenate\>\""}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NetPort", "[", 
        RowBox[{"\"\<net\>\"", ",", "\"\<EQ7\>\""}], "]"}], "->", 
       RowBox[{"\"\<reshape7\>\"", "->", "\"\<catenate\>\""}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NetPort", "[", 
        RowBox[{"\"\<net\>\"", ",", "\"\<EQ8\>\""}], "]"}], "->", 
       RowBox[{"\"\<reshape8\>\"", "->", "\"\<catenate\>\""}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NetPort", "[", 
        RowBox[{"\"\<net\>\"", ",", "\"\<EQ9\>\""}], "]"}], "->", 
       RowBox[{"\"\<reshape9\>\"", "->", "\"\<catenate\>\""}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<catenate\>\"", "->", 
       RowBox[{"NetPort", "[", "\"\<k\>\"", "]"}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<u\>\"", "->", 
     RowBox[{"{", 
      RowBox[{"9", ",", "nX", ",", "nY", ",", "nZ"}], "}"}]}], ",", 
    RowBox[{"\"\<Du\>\"", "->", 
     RowBox[{"{", 
      RowBox[{"9", ",", "nX", ",", "nY", ",", "nZ"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8424148131454916`*^9, 3.842414896930049*^9}, {
   3.8424149288920717`*^9, 3.842415090286746*^9}, {3.8424151796448793`*^9, 
   3.842415219647864*^9}, {3.842415458078594*^9, 3.842415495048671*^9}, {
   3.842415543140912*^9, 3.84241557945193*^9}, {3.8424156116628723`*^9, 
   3.842415643514065*^9}, {3.842415706321948*^9, 3.8424157707473154`*^9}, 
   3.842419392111354*^9},
 CellLabel->
  "In[101]:=",ExpressionUUID->"312f349b-9aac-4a26-8862-20ab253a54cf"],

Cell[CellGroupData[{

Cell["Checks and timings", "Subsubsection",
 CellChangeTimes->{{3.8424145710268717`*^9, 
  3.8424145867300215`*^9}},ExpressionUUID->"6529f40d-80ba-412e-9029-\
03af047fb1be"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "NNEqsOld"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NNEqsOld", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lX_Real", ",", "nX_Integer"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"lY_Real", ",", "nY_Integer"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"lZ_Real", ",", "nZ_Integer"}], "}"}]}], "]"}], "[", 
    RowBox[{
     RowBox[{"kerOrderX_Integer", "?", "EvenQ"}], ",", 
     RowBox[{"kerOrderY_Integer", "?", "EvenQ"}], ",", 
     RowBox[{"kerOrderZ_Integer", "?", "EvenQ"}]}], "]"}], "[", 
   RowBox[{
   "v_Real", ",", "\[Lambda]_Real", ",", "q_Real", ",", "\[Omega]_Real"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"NNEqsOld", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lX", ",", "nX"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"lY", ",", "nY"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
     RowBox[{"kerOrderX", ",", "kerOrderY", ",", "kerOrderZ"}], "]"}], "[", 
    RowBox[{"v", ",", "\[Lambda]", ",", "q", ",", "\[Omega]"}], "]"}], "=", 
   "\[IndentingNewLine]", 
   RowBox[{"NetGraph", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<u1\>\"", "\[Rule]", 
        RowBox[{"PartLayer", "@", "1"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u2\>\"", "\[Rule]", 
        RowBox[{"PartLayer", "@", "2"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u6\>\"", "\[Rule]", 
        RowBox[{"PartLayer", "@", "6"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u7\>\"", "\[Rule]", 
        RowBox[{"PartLayer", "@", "7"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u8\>\"", "\[Rule]", 
        RowBox[{"PartLayer", "@", "8"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u9\>\"", "\[Rule]", 
        RowBox[{"PartLayer", "@", "9"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u10\>\"", "\[Rule]", 
        RowBox[{"PartLayer", "@", "10"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u11\>\"", "\[Rule]", 
        RowBox[{"PartLayer", "@", "11"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u[1:2]\>\"", "\[Rule]", 
        RowBox[{"PartLayer", "[", 
         RowBox[{"1", ";;", "2"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u[3:5]\>\"", "\[Rule]", 
        RowBox[{"PartLayer", "[", 
         RowBox[{"3", ";;", "5"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u[1:9]\>\"", "\[Rule]", 
        RowBox[{"PartLayer", "[", 
         RowBox[{"1", ";;", "9"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Dx[1:2]\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"NNDer3D", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lX", ",", "nX"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"lY", ",", "nY"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "kerOrderX"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", "2"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Dxu1\>\"", "\[Rule]", 
        RowBox[{"PartLayer", "@", "1"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Dxu2\>\"", "\[Rule]", 
        RowBox[{"PartLayer", "@", "2"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Dy[1:2]\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"NNDer3D", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lX", ",", "nX"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"lY", ",", "nY"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "kerOrderY"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", "2"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Dyu1\>\"", "\[Rule]", 
        RowBox[{"PartLayer", "@", "1"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Dyu2\>\"", "\[Rule]", 
        RowBox[{"PartLayer", "@", "2"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Dz[1:2]\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"NNDer3D", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lX", ",", "nX"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"lY", ",", "nY"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "kerOrderZ"}], "}"}], ",", "2"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Dzu1\>\"", "\[Rule]", 
        RowBox[{"PartLayer", "@", "1"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Dzu2\>\"", "\[Rule]", 
        RowBox[{"PartLayer", "@", "2"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<D2x[1:9]\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"NNDer3D", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lX", ",", "nX"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"lY", ",", "nY"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2", ",", "kerOrderX"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", "9"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<D2y[1:9]\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"NNDer3D", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lX", ",", "nX"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"lY", ",", "nY"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "kerOrderY"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", "9"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<D2z[1:9]\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"NNDer3D", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lX", ",", "nX"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"lY", ",", "nY"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "kerOrderZ"}], "}"}], ",", "9"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<(D2x+D2y+D2z)[1:9]\>\"", "\[Rule]", 
        RowBox[{"TotalLayer", "[", "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u^2\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Times"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u^2[1:5]\>\"", "\[Rule]", 
        RowBox[{"PartLayer", "[", 
         RowBox[{"1", ";;", "5"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u^2[1:2]\>\"", "\[Rule]", 
        RowBox[{"PartLayer", "[", 
         RowBox[{"1", ";;", "2"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u^2[6:8]\>\"", "\[Rule]", 
        RowBox[{"PartLayer", "[", 
         RowBox[{"6", ";;", "8"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u9^2\>\"", "\[Rule]", 
        RowBox[{"PartLayer", "@", "9"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Sum[u^2[1:5]]\>\"", "\[Rule]", 
        RowBox[{"AggregationLayer", "[", 
         RowBox[{"Total", ",", "1"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Sum[u^2[1:2]]\>\"", "\[Rule]", 
        RowBox[{"AggregationLayer", "[", 
         RowBox[{"Total", ",", "1"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Sum[u^2[6:8]]\>\"", "\[Rule]", 
        RowBox[{"AggregationLayer", "[", 
         RowBox[{"Total", ",", "1"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Sum[u^2[1:5]]-v^2\>\"", "\[Rule]", 
        RowBox[{"ConstantPlusLayer", "[", 
         RowBox[{"\"\<Biases\>\"", "\[Rule]", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["v", "2"]}], ",", 
            RowBox[{"{", 
             RowBox[{"nX", ",", "nY", ",", "nZ"}], "}"}]}], "]"}]}], "]"}]}], 
       ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<-2\[Lambda](Sum[u^2[1:5]]-v^2)\>\"", "\[Rule]", 
        RowBox[{"ConstantTimesLayer", "[", 
         RowBox[{"\"\<Scaling\>\"", "\[Rule]", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], "\[Lambda]"}], ",", 
            RowBox[{"{", 
             RowBox[{"nX", ",", "nY", ",", "nZ"}], "}"}]}], "]"}]}], "]"}]}], 
       ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<-2q^2 Sum[u^2[1:2]]\>\"", "\[Rule]", 
        RowBox[{"ConstantTimesLayer", "[", 
         RowBox[{"\"\<Scaling\>\"", "\[Rule]", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], 
             SuperscriptBox["q", "2"]}], ",", 
            RowBox[{"{", 
             RowBox[{"nX", ",", "nY", ",", "nZ"}], "}"}]}], "]"}]}], "]"}]}], 
       ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u6^2+u7^2+u8^2-u9^2\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Subtract"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<-q^2 (u6^2+u7^2+u8^2-u9^2)\>\"", "\[Rule]", 
        RowBox[{"ConstantTimesLayer", "[", 
         RowBox[{"\"\<Scaling\>\"", "\[Rule]", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["q", "2"]}], ",", 
            RowBox[{"{", 
             RowBox[{"nX", ",", "nY", ",", "nZ"}], "}"}]}], "]"}]}], "]"}]}], 
       ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
       "\"\<-2\[Lambda](Sum[u^2[1:5]]-v^2)-q^2 (u6^2+u7^2+u8^2-u9^2)\>\"", 
        "\[Rule]", 
        RowBox[{"TotalLayer", "[", "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
       "\"\<(-2\[Lambda](Sum[u^2[1:5]]-v^2)-q^2 (u6^2+u7^2+u8^2-u9^2))u1\>\"",
         "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Times"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u9 u11\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Times"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u6 Dxu2\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Times"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u7 Dyu2\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Times"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u8 Dzu2\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Times"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u6 Dxu2+u7 Dyu2+u8 Dzu2\>\"", "\[Rule]", 
        RowBox[{"TotalLayer", "[", "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u9 u11-u6 Dxu2-u7 Dyu2-u8 Dzu2\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Subtract"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<2q(u9 u11-u6 Dxu2-u7 Dyu2-u8 Dzu2)\>\"", "\[Rule]", 
        RowBox[{"ConstantTimesLayer", "[", 
         RowBox[{"\"\<Scaling\>\"", "\[Rule]", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"2", "q"}], ",", 
            RowBox[{"{", 
             RowBox[{"nX", ",", "nY", ",", "nZ"}], "}"}]}], "]"}]}], "]"}]}], 
       ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Dtu1\>\"", "\[Rule]", 
        RowBox[{"TotalLayer", "[", "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
       "\"\<(-2\[Lambda](Sum[u^2[1:5]]-v^2)-q^2 (u6^2+u7^2+u8^2-u9^2))u2\>\"",
         "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Times"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u9 u10\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Times"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u6 Dxu1\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Times"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u7 Dyu1\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Times"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u8 Dzu1\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Times"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u6 Dxu1+u7 Dyu1+u8 Dzu1\>\"", "\[Rule]", 
        RowBox[{"TotalLayer", "[", "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u6 Dxu1+u7 Dyu1+u8 Dzu1-u9 u10\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Subtract"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<2q(u6 Dxu1+u7 Dyu1+u8 Dzu1-u9 u10)\>\"", "\[Rule]", 
        RowBox[{"ConstantTimesLayer", "[", 
         RowBox[{"\"\<Scaling\>\"", "\[Rule]", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"2", "q"}], ",", 
            RowBox[{"{", 
             RowBox[{"nX", ",", "nY", ",", "nZ"}], "}"}]}], "]"}]}], "]"}]}], 
       ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Dtu2\>\"", "\[Rule]", 
        RowBox[{"TotalLayer", "[", "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<-2\[Lambda](Sum[u^2[1:5]]-v^2)-\[Omega]^2\>\"", "\[Rule]", 
        RowBox[{"ConstantPlusLayer", "[", 
         RowBox[{"\"\<Biases\>\"", "\[Rule]", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["\[Omega]", "2"]}], ",", 
            RowBox[{"{", 
             RowBox[{"nX", ",", "nY", ",", "nZ"}], "}"}]}], "]"}]}], "]"}]}], 
       ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
       "\"\<(-2\[Lambda](Sum[u^2[1:5]]-v^2)-\[Omega]^2)\>\"", "\[Rule]", 
        RowBox[{"ReplicateLayer", "@", "3"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
       "\"\<(-2\[Lambda](Sum[u^2[1:5]]-v^2)-\[Omega]^2)u[3:5]\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Times"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<-2q^2 Sum[u^2[1:2]] u6\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Times"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u2 Dxu1\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Times"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u1 Dxu2\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Times"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u2 Dxu1 - u1 Dxu2\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Subtract"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<2q(u2 Dxu1 - u1 Dxu2)\>\"", "\[Rule]", 
        RowBox[{"ConstantTimesLayer", "[", 
         RowBox[{"\"\<Scaling\>\"", "\[Rule]", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"2", "q"}], ",", 
            RowBox[{"{", 
             RowBox[{"nX", ",", "nY", ",", "nZ"}], "}"}]}], "]"}]}], "]"}]}], 
       ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Dtu6\>\"", "\[Rule]", 
        RowBox[{"TotalLayer", "[", "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<-2q^2 Sum[u^2[1:2]] u7\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Times"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u2 Dyu1\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Times"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u1 Dyu2\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Times"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u2 Dyu1 - u1 Dyu2\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Subtract"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<2q(u2 Dyu1 - u1 Dyu2)\>\"", "\[Rule]", 
        RowBox[{"ConstantTimesLayer", "[", 
         RowBox[{"\"\<Scaling\>\"", "\[Rule]", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"2", "q"}], ",", 
            RowBox[{"{", 
             RowBox[{"nX", ",", "nY", ",", "nZ"}], "}"}]}], "]"}]}], "]"}]}], 
       ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Dtu7\>\"", "\[Rule]", 
        RowBox[{"TotalLayer", "[", "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<-2q^2 Sum[u^2[1:2]] u8\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Times"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u2 Dzu1\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Times"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u1 Dzu2\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Times"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u2 Dzu1 - u1 Dzu2\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Subtract"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<2q(u2 Dzu1 - u1 Dzu2)\>\"", "\[Rule]", 
        RowBox[{"ConstantTimesLayer", "[", 
         RowBox[{"\"\<Scaling\>\"", "\[Rule]", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"2", "q"}], ",", 
            RowBox[{"{", 
             RowBox[{"nX", ",", "nY", ",", "nZ"}], "}"}]}], "]"}]}], "]"}]}], 
       ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Dtu8\>\"", "\[Rule]", 
        RowBox[{"TotalLayer", "[", "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<-2q^2 Sum[u^2[1:2]] u9\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Times"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u2 u10\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Times"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u1 u11\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Times"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u2 u10 - u1 u11\>\"", "\[Rule]", 
        RowBox[{"ThreadingLayer", "@", "Subtract"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<2q(u2 u10 - u1 u11)\>\"", "\[Rule]", 
        RowBox[{"ConstantTimesLayer", "[", 
         RowBox[{"\"\<Scaling\>\"", "\[Rule]", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"2", "q"}], ",", 
            RowBox[{"{", 
             RowBox[{"nX", ",", "nY", ",", "nZ"}], "}"}]}], "]"}]}], "]"}]}], 
       ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Dtu9\>\"", "\[Rule]", 
        RowBox[{"TotalLayer", "[", "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<{Dtu1}\>\"", "\[Rule]", 
        RowBox[{"ReshapeLayer", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "nX", ",", "nY", ",", "nZ"}], "}"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<{Dtu2}\>\"", "\[Rule]", 
        RowBox[{"ReshapeLayer", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "nX", ",", "nY", ",", "nZ"}], "}"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<{Dtu6}\>\"", "\[Rule]", 
        RowBox[{"ReshapeLayer", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "nX", ",", "nY", ",", "nZ"}], "}"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<{Dtu7}\>\"", "\[Rule]", 
        RowBox[{"ReshapeLayer", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "nX", ",", "nY", ",", "nZ"}], "}"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<{Dtu8}\>\"", "\[Rule]", 
        RowBox[{"ReshapeLayer", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "nX", ",", "nY", ",", "nZ"}], "}"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<{Dtu9}\>\"", "\[Rule]", 
        RowBox[{"ReshapeLayer", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "nX", ",", "nY", ",", "nZ"}], "}"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Dtu[1:9]\>\"", "\[Rule]", 
        RowBox[{"CatenateLayer", "[", "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Output\>\"", "\[Rule]", 
        RowBox[{"TotalLayer", "[", "]"}]}]}], 
      RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"NetPort", "[", "\"\<u\>\"", "]"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<u1\>\"", ",", "\"\<u2\>\"", ",", "\"\<u6\>\"", ",", 
          "\"\<u7\>\"", ",", "\"\<u8\>\"", ",", "\"\<u9\>\"", ",", 
          "\"\<u10\>\"", ",", "\"\<u11\>\"", ",", "\"\<u[1:2]\>\"", ",", 
          "\"\<u[3:5]\>\"", ",", "\"\<u[1:9]\>\"", ",", 
          RowBox[{"NetPort", "[", 
           RowBox[{"\"\<u^2\>\"", ",", "1"}], "]"}], ",", 
          RowBox[{"NetPort", "[", 
           RowBox[{"\"\<u^2\>\"", ",", "2"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u[1:2]\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Dx[1:2]\>\"", ",", "\"\<Dy[1:2]\>\"", ",", "\"\<Dz[1:2]\>\""}], 
         "}"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Dx[1:2]\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<Dxu1\>\"", ",", "\"\<Dxu2\>\""}], "}"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Dy[1:2]\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<Dyu1\>\"", ",", "\"\<Dyu2\>\""}], "}"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Dz[1:2]\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<Dzu1\>\"", ",", "\"\<Dzu2\>\""}], "}"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u[1:9]\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<D2x[1:9]\>\"", ",", "\"\<D2y[1:9]\>\"", ",", 
          "\"\<D2z[1:9]\>\""}], "}"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<D2x[1:9]\>\"", ",", "\"\<D2y[1:9]\>\"", ",", 
          "\"\<D2z[1:9]\>\""}], "}"}], "\[Rule]", 
        "\"\<(D2x+D2y+D2z)[1:9]\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u^2\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<u^2[1:5]\>\"", ",", "\"\<u^2[1:2]\>\"", ",", "\"\<u^2[6:8]\>\"",
           ",", "\"\<u9^2\>\""}], "}"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u^2[1:5]\>\"", "\[Rule]", "\"\<Sum[u^2[1:5]]\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u^2[1:2]\>\"", "\[Rule]", "\"\<Sum[u^2[1:2]]\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u^2[6:8]\>\"", "\[Rule]", "\"\<Sum[u^2[6:8]]\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Sum[u^2[6:8]]\>\"", "\[Rule]", 
        RowBox[{"NetPort", "[", 
         RowBox[{"\"\<u6^2+u7^2+u8^2-u9^2\>\"", ",", "1"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u9^2\>\"", "\[Rule]", 
        RowBox[{"NetPort", "[", 
         RowBox[{"\"\<u6^2+u7^2+u8^2-u9^2\>\"", ",", "2"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
       "\"\<Sum[u^2[1:5]]\>\"", "\[Rule]", "\"\<Sum[u^2[1:5]]-v^2\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
       "\"\<Sum[u^2[1:5]]-v^2\>\"", "\[Rule]", 
        "\"\<-2\[Lambda](Sum[u^2[1:5]]-v^2)\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
       "\"\<Sum[u^2[1:2]]\>\"", "\[Rule]", "\"\<-2q^2 Sum[u^2[1:2]]\>\""}], 
       ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
       "\"\<u6^2+u7^2+u8^2-u9^2\>\"", "\[Rule]", 
        "\"\<-q^2 (u6^2+u7^2+u8^2-u9^2)\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<-2\[Lambda](Sum[u^2[1:5]]-v^2)\>\"", ",", 
          "\"\<-q^2 (u6^2+u7^2+u8^2-u9^2)\>\""}], "}"}], "\[Rule]", 
        "\"\<-2\[Lambda](Sum[u^2[1:5]]-v^2)-q^2 (u6^2+u7^2+u8^2-u9^2)\>\""}], 
       ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<-2\[Lambda](Sum[u^2[1:5]]-v^2)-q^2 (u6^2+u7^2+u8^2-u9^2)\>\"", 
          ",", "\"\<u1\>\""}], "}"}], "\[Rule]", 
        "\"\<(-2\[Lambda](Sum[u^2[1:5]]-v^2)-q^2 \
(u6^2+u7^2+u8^2-u9^2))u1\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<u9\>\"", ",", "\"\<u11\>\""}], "}"}], "\[Rule]", 
        "\"\<u9 u11\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<u6\>\"", ",", "\"\<Dxu2\>\""}], "}"}], "\[Rule]", 
        "\"\<u6 Dxu2\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<u7\>\"", ",", "\"\<Dyu2\>\""}], "}"}], "\[Rule]", 
        "\"\<u7 Dyu2\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<u8\>\"", ",", "\"\<Dzu2\>\""}], "}"}], "\[Rule]", 
        "\"\<u8 Dzu2\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<u6 Dxu2\>\"", ",", "\"\<u7 Dyu2\>\"", ",", "\"\<u8 Dzu2\>\""}], 
         "}"}], "\[Rule]", "\"\<u6 Dxu2+u7 Dyu2+u8 Dzu2\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u9 u11\>\"", "\[Rule]", 
        RowBox[{"NetPort", "[", 
         RowBox[{"\"\<u9 u11-u6 Dxu2-u7 Dyu2-u8 Dzu2\>\"", ",", "1"}], 
         "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u6 Dxu2+u7 Dyu2+u8 Dzu2\>\"", "\[Rule]", 
        RowBox[{"NetPort", "[", 
         RowBox[{"\"\<u9 u11-u6 Dxu2-u7 Dyu2-u8 Dzu2\>\"", ",", "2"}], 
         "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
       "\"\<u9 u11-u6 Dxu2-u7 Dyu2-u8 Dzu2\>\"", "\[Rule]", 
        "\"\<2q(u9 u11-u6 Dxu2-u7 Dyu2-u8 Dzu2)\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<(-2\[Lambda](Sum[u^2[1:5]]-v^2)-q^2 \
(u6^2+u7^2+u8^2-u9^2))u1\>\"", ",", 
          "\"\<2q(u9 u11-u6 Dxu2-u7 Dyu2-u8 Dzu2)\>\""}], "}"}], "\[Rule]", 
        "\"\<Dtu1\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<-2\[Lambda](Sum[u^2[1:5]]-v^2)-q^2 (u6^2+u7^2+u8^2-u9^2)\>\"", 
          ",", "\"\<u2\>\""}], "}"}], "\[Rule]", 
        "\"\<(-2\[Lambda](Sum[u^2[1:5]]-v^2)-q^2 \
(u6^2+u7^2+u8^2-u9^2))u2\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<u6\>\"", ",", "\"\<Dxu1\>\""}], "}"}], "\[Rule]", 
        "\"\<u6 Dxu1\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<u7\>\"", ",", "\"\<Dyu1\>\""}], "}"}], "\[Rule]", 
        "\"\<u7 Dyu1\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<u8\>\"", ",", "\"\<Dzu1\>\""}], "}"}], "\[Rule]", 
        "\"\<u8 Dzu1\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<u6 Dxu1\>\"", ",", "\"\<u7 Dyu1\>\"", ",", "\"\<u8 Dzu1\>\""}], 
         "}"}], "\[Rule]", "\"\<u6 Dxu1+u7 Dyu1+u8 Dzu1\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<u9\>\"", ",", "\"\<u10\>\""}], "}"}], "\[Rule]", 
        "\"\<u9 u10\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u6 Dxu1+u7 Dyu1+u8 Dzu1\>\"", "\[Rule]", 
        RowBox[{"NetPort", "[", 
         RowBox[{"\"\<u6 Dxu1+u7 Dyu1+u8 Dzu1-u9 u10\>\"", ",", "1"}], 
         "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u9 u10\>\"", "\[Rule]", 
        RowBox[{"NetPort", "[", 
         RowBox[{"\"\<u6 Dxu1+u7 Dyu1+u8 Dzu1-u9 u10\>\"", ",", "2"}], 
         "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
       "\"\<u6 Dxu1+u7 Dyu1+u8 Dzu1-u9 u10\>\"", "\[Rule]", 
        "\"\<2q(u6 Dxu1+u7 Dyu1+u8 Dzu1-u9 u10)\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<(-2\[Lambda](Sum[u^2[1:5]]-v^2)-q^2 \
(u6^2+u7^2+u8^2-u9^2))u2\>\"", ",", 
          "\"\<2q(u6 Dxu1+u7 Dyu1+u8 Dzu1-u9 u10)\>\""}], "}"}], "\[Rule]", 
        "\"\<Dtu2\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
       "\"\<-2\[Lambda](Sum[u^2[1:5]]-v^2)\>\"", "\[Rule]", 
        "\"\<-2\[Lambda](Sum[u^2[1:5]]-v^2)-\[Omega]^2\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
       "\"\<-2\[Lambda](Sum[u^2[1:5]]-v^2)-\[Omega]^2\>\"", "\[Rule]", 
        "\"\<(-2\[Lambda](Sum[u^2[1:5]]-v^2)-\[Omega]^2)\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<(-2\[Lambda](Sum[u^2[1:5]]-v^2)-\[Omega]^2)\>\"", ",", 
          "\"\<u[3:5]\>\""}], "}"}], "\[Rule]", 
        "\"\<(-2\[Lambda](Sum[u^2[1:5]]-v^2)-\[Omega]^2)u[3:5]\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<-2q^2 Sum[u^2[1:2]]\>\"", ",", "\"\<u6\>\""}], "}"}], 
        "\[Rule]", "\"\<-2q^2 Sum[u^2[1:2]] u6\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<u2\>\"", ",", "\"\<Dxu1\>\""}], "}"}], "\[Rule]", 
        "\"\<u2 Dxu1\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<u1\>\"", ",", "\"\<Dxu2\>\""}], "}"}], "\[Rule]", 
        "\"\<u1 Dxu2\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u2 Dxu1\>\"", "\[Rule]", 
        RowBox[{"NetPort", "[", 
         RowBox[{"\"\<u2 Dxu1 - u1 Dxu2\>\"", ",", "1"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u1 Dxu2\>\"", "\[Rule]", 
        RowBox[{"NetPort", "[", 
         RowBox[{"\"\<u2 Dxu1 - u1 Dxu2\>\"", ",", "2"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
       "\"\<u2 Dxu1 - u1 Dxu2\>\"", "\[Rule]", 
        "\"\<2q(u2 Dxu1 - u1 Dxu2)\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<-2q^2 Sum[u^2[1:2]] u6\>\"", ",", 
          "\"\<2q(u2 Dxu1 - u1 Dxu2)\>\""}], "}"}], "\[Rule]", 
        "\"\<Dtu6\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<-2q^2 Sum[u^2[1:2]]\>\"", ",", "\"\<u7\>\""}], "}"}], 
        "\[Rule]", "\"\<-2q^2 Sum[u^2[1:2]] u7\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<u2\>\"", ",", "\"\<Dyu1\>\""}], "}"}], "\[Rule]", 
        "\"\<u2 Dyu1\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<u1\>\"", ",", "\"\<Dyu2\>\""}], "}"}], "\[Rule]", 
        "\"\<u1 Dyu2\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u2 Dyu1\>\"", "\[Rule]", 
        RowBox[{"NetPort", "[", 
         RowBox[{"\"\<u2 Dyu1 - u1 Dyu2\>\"", ",", "1"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u1 Dyu2\>\"", "\[Rule]", 
        RowBox[{"NetPort", "[", 
         RowBox[{"\"\<u2 Dyu1 - u1 Dyu2\>\"", ",", "2"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
       "\"\<u2 Dyu1 - u1 Dyu2\>\"", "\[Rule]", 
        "\"\<2q(u2 Dyu1 - u1 Dyu2)\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<-2q^2 Sum[u^2[1:2]] u7\>\"", ",", 
          "\"\<2q(u2 Dyu1 - u1 Dyu2)\>\""}], "}"}], "\[Rule]", 
        "\"\<Dtu7\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<-2q^2 Sum[u^2[1:2]]\>\"", ",", "\"\<u8\>\""}], "}"}], 
        "\[Rule]", "\"\<-2q^2 Sum[u^2[1:2]] u8\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<u2\>\"", ",", "\"\<Dzu1\>\""}], "}"}], "\[Rule]", 
        "\"\<u2 Dzu1\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<u1\>\"", ",", "\"\<Dzu2\>\""}], "}"}], "\[Rule]", 
        "\"\<u1 Dzu2\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u2 Dzu1\>\"", "\[Rule]", 
        RowBox[{"NetPort", "[", 
         RowBox[{"\"\<u2 Dzu1 - u1 Dzu2\>\"", ",", "1"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u1 Dzu2\>\"", "\[Rule]", 
        RowBox[{"NetPort", "[", 
         RowBox[{"\"\<u2 Dzu1 - u1 Dzu2\>\"", ",", "2"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
       "\"\<u2 Dzu1 - u1 Dzu2\>\"", "\[Rule]", 
        "\"\<2q(u2 Dzu1 - u1 Dzu2)\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<-2q^2 Sum[u^2[1:2]] u8\>\"", ",", 
          "\"\<2q(u2 Dzu1 - u1 Dzu2)\>\""}], "}"}], "\[Rule]", 
        "\"\<Dtu8\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<-2q^2 Sum[u^2[1:2]]\>\"", ",", "\"\<u9\>\""}], "}"}], 
        "\[Rule]", "\"\<-2q^2 Sum[u^2[1:2]] u9\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<u2\>\"", ",", "\"\<u10\>\""}], "}"}], "\[Rule]", 
        "\"\<u2 u10\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<u1\>\"", ",", "\"\<u11\>\""}], "}"}], "\[Rule]", 
        "\"\<u1 u11\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u2 u10\>\"", "\[Rule]", 
        RowBox[{"NetPort", "[", 
         RowBox[{"\"\<u2 u10 - u1 u11\>\"", ",", "1"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<u1 u11\>\"", "\[Rule]", 
        RowBox[{"NetPort", "[", 
         RowBox[{"\"\<u2 u10 - u1 u11\>\"", ",", "2"}], "]"}]}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
       "\"\<u2 u10 - u1 u11\>\"", "\[Rule]", "\"\<2q(u2 u10 - u1 u11)\>\""}], 
       ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<-2q^2 Sum[u^2[1:2]] u9\>\"", ",", 
          "\"\<2q(u2 u10 - u1 u11)\>\""}], "}"}], "\[Rule]", "\"\<Dtu9\>\""}],
        ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Dtu1\>\"", "\[Rule]", "\"\<{Dtu1}\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Dtu2\>\"", "\[Rule]", "\"\<{Dtu2}\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Dtu6\>\"", "\[Rule]", "\"\<{Dtu6}\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Dtu7\>\"", "\[Rule]", "\"\<{Dtu7}\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Dtu8\>\"", "\[Rule]", "\"\<{Dtu8}\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Dtu9\>\"", "\[Rule]", "\"\<{Dtu9}\>\""}], ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<{Dtu1}\>\"", ",", "\"\<{Dtu2}\>\"", ",", 
          "\"\<(-2\[Lambda](Sum[u^2[1:5]]-v^2)-\[Omega]^2)u[3:5]\>\"", ",", 
          "\"\<{Dtu6}\>\"", ",", "\"\<{Dtu7}\>\"", ",", "\"\<{Dtu8}\>\"", 
          ",", "\"\<{Dtu9}\>\""}], "}"}], "\[Rule]", "\"\<Dtu[1:9]\>\""}], 
       ",", 
       RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<(D2x+D2y+D2z)[1:9]\>\"", ",", "\"\<Dtu[1:9]\>\""}], 
         "}"}], "\[Rule]", "\"\<Output\>\""}]}], 
      RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"\"\<u\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"18", ",", "nX", ",", "nY", ",", "nZ"}], "}"}]}]}], 
    "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.80069459145792*^9, 3.800694692518278*^9}, {
   3.800694764157752*^9, 3.80069496964317*^9}, {3.8006950363861666`*^9, 
   3.8006950532969303`*^9}, {3.8006951130920672`*^9, 
   3.8006951328198195`*^9}, {3.8006953328268423`*^9, 
   3.8006954536556497`*^9}, {3.8006954955156813`*^9, 3.800695617160309*^9}, {
   3.800695725133503*^9, 3.8006958210509443`*^9}, {3.800695855798998*^9, 
   3.800695959187709*^9}, {3.8006961030040317`*^9, 3.8006961658100386`*^9}, {
   3.8006962082515516`*^9, 3.8006963686747265`*^9}, {3.8006964237683935`*^9, 
   3.8006964239678307`*^9}, {3.8006964832253294`*^9, 3.800696610654481*^9}, {
   3.800696672761409*^9, 3.8006967209484696`*^9}, {3.8006968397347403`*^9, 
   3.8006970251009254`*^9}, {3.800697173161892*^9, 3.800697241542535*^9}, {
   3.8006972722963023`*^9, 3.8006972940929985`*^9}, {3.800697328358348*^9, 
   3.800697529947139*^9}, {3.800697588341781*^9, 3.8006976583276377`*^9}, {
   3.800702171934509*^9, 3.8007021822288923`*^9}, {3.800717284567644*^9, 
   3.8007172942577596`*^9}, {3.800717330451912*^9, 3.800717454369461*^9}, {
   3.8007174891444426`*^9, 3.8007175636182413`*^9}, {3.8007176158126316`*^9, 
   3.8007176216350594`*^9}, {3.800717673385638*^9, 3.800717696061982*^9}, {
   3.800717787792622*^9, 3.800717800055853*^9}, {3.8007179282638893`*^9, 
   3.800717997569512*^9}, {3.8007181013509445`*^9, 3.8007182318827705`*^9}, {
   3.800718270059657*^9, 3.800718390650136*^9}, {3.8007184416148243`*^9, 
   3.800718501679122*^9}, {3.8007185379181914`*^9, 3.800718561450286*^9}, {
   3.8007203608881245`*^9, 3.8007204163328214`*^9}, {3.8007204505313463`*^9, 
   3.8007205033245068`*^9}, {3.8007205384086294`*^9, 3.800720627243013*^9}, {
   3.800720681138853*^9, 3.8007207865659065`*^9}, {3.800720827462467*^9, 
   3.8007208290801396`*^9}, {3.8007208689335403`*^9, 
   3.8007209137037897`*^9}, {3.800721014610918*^9, 3.800721031320228*^9}, {
   3.8007210890956874`*^9, 3.8007211189587746`*^9}, {3.8007212060877237`*^9, 
   3.800721348187635*^9}, {3.8007214199287415`*^9, 3.8007215600559697`*^9}, {
   3.800721600712185*^9, 3.800721625135856*^9}, {3.800721655669219*^9, 
   3.8007216575212326`*^9}, {3.800721771744708*^9, 3.80072179355637*^9}, {
   3.800721855209494*^9, 3.800721869055421*^9}, {3.800721901172516*^9, 
   3.8007220132936525`*^9}, {3.8007220452800584`*^9, 3.800722216407362*^9}, {
   3.8007223379871864`*^9, 3.8007227885685782`*^9}, {3.800723110794226*^9, 
   3.8007232466364813`*^9}, {3.800762296536271*^9, 3.800762297086832*^9}, {
   3.8008492035046473`*^9, 3.80084936004697*^9}, {3.8008494016694174`*^9, 
   3.8008494638680706`*^9}, {3.800849658047206*^9, 3.800849741422515*^9}, {
   3.8008498468273497`*^9, 3.8008498897405267`*^9}, {3.8026900958084784`*^9, 
   3.802690116230177*^9}, {3.8028452324739556`*^9, 3.802845287240259*^9}, {
   3.807266474859313*^9, 3.807266475338049*^9}, {3.8074214105289106`*^9, 
   3.80742144046086*^9}, {3.8074215168927712`*^9, 3.8074215332987275`*^9}, {
   3.80742157841706*^9, 3.807421668546295*^9}, {3.8074220350136547`*^9, 
   3.8074221624447975`*^9}, {3.8074222164908185`*^9, 3.807422409163943*^9}, {
   3.807422439388069*^9, 3.8074224631760235`*^9}, {3.8240389080210743`*^9, 
   3.8240389412539263`*^9}, {3.824039303088874*^9, 3.824039362943631*^9}, {
   3.8240394230817037`*^9, 3.8240394534515038`*^9}, {3.8240878238618135`*^9, 
   3.8240879240441*^9}, {3.824091318102107*^9, 3.8240913557910604`*^9}, {
   3.8240914402639165`*^9, 3.8240918551046667`*^9}, {3.824091902962867*^9, 
   3.8240919558964653`*^9}, {3.8240919866001506`*^9, 
   3.8240922366607037`*^9}, {3.8240922908386803`*^9, 
   3.8240925351965103`*^9}, {3.8240926023329563`*^9, 
   3.8240927106108503`*^9}, {3.824092759412708*^9, 3.824092781881566*^9}, 
   3.824092821723544*^9, {3.8240928579776444`*^9, 3.8240928603760223`*^9}, {
   3.824092908623797*^9, 3.8240929261547537`*^9}, {3.8240929562945976`*^9, 
   3.8240929575970335`*^9}, {3.8240929973269625`*^9, 
   3.8240934365353556`*^9}, {3.824093467652053*^9, 3.8240935273517513`*^9}, {
   3.824093883755951*^9, 3.824093885698325*^9}, {3.842414548554057*^9, 
   3.842414552833851*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"0d72d1ee-ab7e-4c3c-bf2b-2d2b7919d999"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"lX", "=", "20."}], ",", 
     RowBox[{"nX", "=", "21"}], ",", 
     RowBox[{"lY", "=", "20."}], ",", 
     RowBox[{"nY", "=", "21"}], ",", 
     RowBox[{"lZ", "=", "20."}], ",", 
     RowBox[{"nZ", "=", "21"}], ",", 
     RowBox[{"kerOrderX", "=", "2"}], ",", 
     RowBox[{"kerOrderY", "=", "2"}], ",", 
     RowBox[{"kerOrderZ", "=", "2"}], ",", 
     RowBox[{"v", "=", "2."}], ",", 
     RowBox[{"\[Lambda]", "=", "2."}], ",", 
     RowBox[{"q", "=", "1."}], ",", 
     RowBox[{"\[Omega]", "=", "1."}], ",", "\[IndentingNewLine]", "inputOld", 
     ",", "inputNew", ",", "nnOld", ",", "nnNew"}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"inputOld", "=", 
     RowBox[{"RandomInteger", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"18", ",", "nX", ",", "nY", ",", "nZ"}], "}"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"inputNew", "=", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<u\>\"", "->", 
        RowBox[{"inputOld", "[", 
         RowBox[{"[", 
          RowBox[{";;", "9"}], "]"}], "]"}]}], ",", 
       RowBox[{"\"\<Du\>\"", "->", 
        RowBox[{"inputOld", "[", 
         RowBox[{"[", 
          RowBox[{"10", ";;"}], "]"}], "]"}]}]}], "|>"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"nnOld", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"NNEqsOld", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
       RowBox[{"kerOrderX", ",", "kerOrderY", ",", "kerOrderZ"}], "]"}], "[", 
      RowBox[{"v", ",", "\[Lambda]", ",", "q", ",", "\[Omega]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"nnNew", "=", 
     RowBox[{
      RowBox[{"NNEqsWrapper", "[", 
       RowBox[{"nX", ",", "nY", ",", "nZ"}], "]"}], "@", 
      RowBox[{
       RowBox[{
        RowBox[{"NNEqs", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lX", ",", "nX"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"lY", ",", "nY"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
        RowBox[{"kerOrderX", ",", "kerOrderY", ",", "kerOrderZ"}], "]"}], "[", 
       RowBox[{"v", ",", "\[Lambda]", ",", "q", ",", "\[Omega]"}], "]"}]}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"nnOld", "[", 
         RowBox[{"inputOld", ",", 
          RowBox[{"TargetDevice", "\[Rule]", "DEVICE"}]}], "]"}], "-", 
        RowBox[{"nnNew", "[", 
         RowBox[{"inputNew", ",", 
          RowBox[{"TargetDevice", "\[Rule]", "DEVICE"}]}], "]"}]}], "//", 
       "Flatten"}], "//", "Abs"}], "//", "Max"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.8424158487892194`*^9, 3.842416144863482*^9}, {
   3.8424161918171115`*^9, 3.8424162430638237`*^9}, 3.8424197054732366`*^9},
 CellLabel->
  "In[158]:=",ExpressionUUID->"7661b55a-5820-427f-bd8c-64b96d5d1489"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"lX", "=", "20."}], ",", 
     RowBox[{"nX", "=", "101"}], ",", 
     RowBox[{"lY", "=", "20."}], ",", 
     RowBox[{"nY", "=", "101"}], ",", 
     RowBox[{"lZ", "=", "20."}], ",", 
     RowBox[{"nZ", "=", "101"}], ",", 
     RowBox[{"kerOrderX", "=", "2"}], ",", 
     RowBox[{"kerOrderY", "=", "2"}], ",", 
     RowBox[{"kerOrderZ", "=", "2"}], ",", 
     RowBox[{"v", "=", "2."}], ",", 
     RowBox[{"\[Lambda]", "=", "2."}], ",", 
     RowBox[{"q", "=", "1."}], ",", 
     RowBox[{"\[Omega]", "=", "1."}], ",", "\[IndentingNewLine]", 
     RowBox[{"numTests", "=", "100"}], ",", "datasetOld", ",", "datasetNew", 
     ",", "nnOld", ",", "nnNew", ",", "timingOld", ",", "timingNew"}], 
    "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"datasetOld", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RandomInteger", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"18", ",", "nX", ",", "nY", ",", "nZ"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", "numTests", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"datasetNew", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<u\>\"", "->", 
          RowBox[{"inputOld", "[", 
           RowBox[{"[", 
            RowBox[{";;", "9"}], "]"}], "]"}]}], ",", 
         RowBox[{"\"\<Du\>\"", "->", 
          RowBox[{"inputOld", "[", 
           RowBox[{"[", 
            RowBox[{"10", ";;"}], "]"}], "]"}]}]}], "|>"}], ",", 
       RowBox[{"{", 
        RowBox[{"inputOld", ",", "datasetOld"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"nnOld", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"NNEqsOld", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
       RowBox[{"kerOrderX", ",", "kerOrderY", ",", "kerOrderZ"}], "]"}], "[", 
      RowBox[{"v", ",", "\[Lambda]", ",", "q", ",", "\[Omega]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"nnNew", "=", 
     RowBox[{
      RowBox[{"NNEqsWrapper", "[", 
       RowBox[{"nX", ",", "nY", ",", "nZ"}], "]"}], "@", 
      RowBox[{
       RowBox[{
        RowBox[{"NNEqs", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lX", ",", "nX"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"lY", ",", "nY"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
        RowBox[{"kerOrderX", ",", "kerOrderY", ",", "kerOrderZ"}], "]"}], "[", 
       RowBox[{"v", ",", "\[Lambda]", ",", "q", ",", "\[Omega]"}], "]"}]}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"timingNew", "=", 
     RowBox[{"First", "@", 
      RowBox[{"AbsoluteTiming", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"nnNew", "[", 
          RowBox[{"#", ",", 
           RowBox[{"TargetDevice", "\[Rule]", "DEVICE"}]}], "]"}], "&"}], "/@",
         "datasetNew"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<New version runs \>\"", ",", "numTests", ",", 
      "\"\< evaluations in \>\"", ",", "timingNew", ",", 
      "\"\< seconds...\>\""}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"timingOld", "=", 
     RowBox[{"First", "@", 
      RowBox[{"AbsoluteTiming", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"nnOld", "[", 
          RowBox[{"#", ",", 
           RowBox[{"TargetDevice", "\[Rule]", "DEVICE"}]}], "]"}], "&"}], "/@",
         "datasetOld"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<Old version runs \>\"", ",", "numTests", ",", 
      "\"\< evaluations in \>\"", ",", "timingOld", ",", 
      "\"\< seconds...\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.8424162771399994`*^9, 3.8424165353439827`*^9}, {
   3.8424166683713427`*^9, 3.842416668806968*^9}, 3.8424167745443044`*^9, 
   3.842416816637211*^9, {3.842417029510305*^9, 3.8424170318643217`*^9}, {
   3.8424200590414505`*^9, 
   3.8424200650206556`*^9}},ExpressionUUID->"56c1e191-22ae-457d-929c-\
710450f3b66f"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["One Runge-Kutta time-step", "Subsection",
 CellChangeTimes->{{3.8240941842143345`*^9, 
  3.824094192652728*^9}},ExpressionUUID->"a3be89cb-2d2d-44e3-bff3-\
58dbb90b9e0e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "NNRK4Step"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"NNRK4Step", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lX_Real", ",", "nX_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"lY_Real", ",", "nY_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"lZ_Real", ",", "nZ_Integer"}], "}"}]}], "]"}], "[", 
     RowBox[{
      RowBox[{"kerOrderX_Integer", "?", "EvenQ"}], ",", 
      RowBox[{"kerOrderY_Integer", "?", "EvenQ"}], ",", 
      RowBox[{"kerOrderZ_Integer", "?", "EvenQ"}]}], "]"}], "[", 
    RowBox[{
    "v_Real", ",", "\[Lambda]_Real", ",", "q_Real", ",", "\[Omega]_Real"}], 
    "]"}], "[", "dt_Real", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"NNRK4Step", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lX", ",", "nX"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"lY", ",", "nY"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
      RowBox[{"kerOrderX", ",", "kerOrderY", ",", "kerOrderZ"}], "]"}], "[", 
     RowBox[{"v", ",", "\[Lambda]", ",", "q", ",", "\[Omega]"}], "]"}], "[", 
    "dt", "]"}], "=", "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"neuralNetwork", "=", 
       RowBox[{
        RowBox[{"NNEqsWrapper", "[", 
         RowBox[{"nX", ",", "nY", ",", "nZ"}], "]"}], "@", 
        RowBox[{
         RowBox[{
          RowBox[{"NNEqs", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{"kerOrderX", ",", "kerOrderY", ",", "kerOrderZ"}], "]"}], 
         "[", 
         RowBox[{"v", ",", "\[Lambda]", ",", "q", ",", "\[Omega]"}], 
         "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"NetGraph", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"<|", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\"\<net1\>\"", "->", "neuralNetwork"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<u1\>\"", "->", 
          RowBox[{"FunctionLayer", "@", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"u", ",", "kk1"}], "}"}], ",", 
             RowBox[{"u", "+", 
              RowBox[{
               FractionBox["dt", "2"], "kk1"}]}]}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<Du1\>\"", "->", 
          RowBox[{"FunctionLayer", "@", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Du", ",", "k1"}], "}"}], ",", 
             RowBox[{"Du", "+", 
              RowBox[{
               FractionBox["dt", "2"], "k1"}]}]}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<net2\>\"", "->", "neuralNetwork"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<kk2\>\"", "->", 
          RowBox[{"FunctionLayer", "@", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Du", ",", "kk1"}], "}"}], ",", 
             RowBox[{"Du", "+", 
              RowBox[{
               FractionBox["dt", "2"], "kk1"}]}]}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<u2\>\"", "->", 
          RowBox[{"FunctionLayer", "@", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"u1", ",", "kk2"}], "}"}], ",", 
             RowBox[{"u1", "+", 
              RowBox[{
               FractionBox["dt", "2"], "kk2"}]}]}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<Du2\>\"", "->", 
          RowBox[{"FunctionLayer", "@", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Du1", ",", "k2"}], "}"}], ",", 
             RowBox[{"Du1", "+", 
              RowBox[{
               FractionBox["dt", "2"], "k2"}]}]}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<net3\>\"", "->", "neuralNetwork"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<kk3\>\"", "->", 
          RowBox[{"FunctionLayer", "@", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Du", ",", "kk2"}], "}"}], ",", 
             RowBox[{"Du", "+", 
              RowBox[{
               FractionBox["dt", "2"], "kk2"}]}]}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<u3\>\"", "->", 
          RowBox[{"FunctionLayer", "@", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"u2", ",", "kk3"}], "}"}], ",", 
             RowBox[{"u2", "+", 
              RowBox[{"dt", " ", "kk3"}]}]}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<Du3\>\"", "->", 
          RowBox[{"FunctionLayer", "@", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Du2", ",", "k3"}], "}"}], ",", 
             RowBox[{"Du2", "+", 
              RowBox[{"dt", " ", "k3"}]}]}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<net4\>\"", "->", "neuralNetwork"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<kk4\>\"", "->", 
          RowBox[{"FunctionLayer", "@", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Du", ",", "kk3"}], "}"}], ",", 
             RowBox[{"Du", "+", 
              RowBox[{"dt", " ", "kk3"}]}]}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<u4\>\"", "->", 
          RowBox[{"FunctionLayer", "@", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"u", ",", "kk1", ",", "kk2", ",", "kk3", ",", "kk4"}], 
              "}"}], ",", 
             RowBox[{"u", "+", 
              RowBox[{
               FractionBox["dt", "6"], 
               RowBox[{"(", 
                RowBox[{"kk1", "+", 
                 RowBox[{"2", "kk2"}], "+", 
                 RowBox[{"2", "kk3"}], "+", "kk4"}], ")"}]}]}]}], "]"}]}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<Du4\>\"", "->", 
          RowBox[{"FunctionLayer", "@", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Du", ",", "k1", ",", "k2", ",", "k3", ",", "k4"}], 
              "}"}], ",", 
             RowBox[{"Du", "+", 
              RowBox[{
               FractionBox["dt", "6"], 
               RowBox[{"(", 
                RowBox[{"k1", "+", 
                 RowBox[{"2", "k2"}], "+", 
                 RowBox[{"2", "k3"}], "+", "k4"}], ")"}]}]}]}], "]"}]}]}]}], 
        "\[IndentingNewLine]", "|>"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"NetPort", "[", "\"\<u\>\"", "]"}], "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<net1\>\"", ",", "\"\<u\>\""}], "]"}], ",", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<u1\>\"", ",", "\"\<u$\>\""}], "]"}], ",", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<u4\>\"", ",", "\"\<u$\>\""}], "]"}]}], "}"}]}], ",",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NetPort", "[", "\"\<Du\>\"", "]"}], "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<net1\>\"", ",", "\"\<Du\>\""}], "]"}], ",", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<Du1\>\"", ",", "\"\<Du$\>\""}], "]"}], ",", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<u1\>\"", ",", "\"\<kk1$\>\""}], "]"}], ",", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<kk2\>\"", ",", "\"\<kk1$\>\""}], "]"}], ",", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<u4\>\"", ",", "\"\<kk1$\>\""}], "]"}], ",", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<kk2\>\"", ",", "\"\<Du$\>\""}], "]"}], ",", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<kk3\>\"", ",", "\"\<Du$\>\""}], "]"}], ",", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<kk4\>\"", ",", "\"\<Du$\>\""}], "]"}], ",", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<Du4\>\"", ",", "\"\<Du$\>\""}], "]"}]}], "}"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<net1\>\"", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<Du1\>\"", ",", "\"\<k1$\>\""}], "]"}], ",", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<Du4\>\"", ",", "\"\<k1$\>\""}], "]"}]}], "}"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<u1\>\"", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<net2\>\"", ",", "\"\<u\>\""}], "]"}], ",", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<u2\>\"", ",", "\"\<u1$\>\""}], "]"}]}], "}"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<Du1\>\"", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<net2\>\"", ",", "\"\<Du\>\""}], "]"}], ",", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<Du2\>\"", ",", "\"\<Du1$\>\""}], "]"}]}], "}"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<kk2\>\"", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<u2\>\"", ",", "\"\<kk2$\>\""}], "]"}], ",", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<kk3\>\"", ",", "\"\<kk2$\>\""}], "]"}], ",", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<u4\>\"", ",", "\"\<kk2$\>\""}], "]"}]}], "}"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<net2\>\"", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<Du2\>\"", ",", "\"\<k2$\>\""}], "]"}], ",", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<Du4\>\"", ",", "\"\<k2$\>\""}], "]"}]}], "}"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<u2\>\"", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<net3\>\"", ",", "\"\<u\>\""}], "]"}], ",", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<u3\>\"", ",", "\"\<u2$\>\""}], "]"}]}], "}"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<Du2\>\"", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<net3\>\"", ",", "\"\<Du\>\""}], "]"}], ",", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<Du3\>\"", ",", "\"\<Du2$\>\""}], "]"}]}], "}"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<kk3\>\"", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<u3\>\"", ",", "\"\<kk3$\>\""}], "]"}], ",", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<kk4\>\"", ",", "\"\<kk3$\>\""}], "]"}], ",", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<u4\>\"", ",", "\"\<kk3$\>\""}], "]"}]}], "}"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<net3\>\"", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<Du3\>\"", ",", "\"\<k3$\>\""}], "]"}], ",", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<Du4\>\"", ",", "\"\<k3$\>\""}], "]"}]}], "}"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<u3\>\"", "->", 
          RowBox[{"NetPort", "[", 
           RowBox[{"\"\<net4\>\"", ",", "\"\<u\>\""}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<Du3\>\"", "->", 
          RowBox[{"NetPort", "[", 
           RowBox[{"\"\<net4\>\"", ",", "\"\<Du\>\""}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<kk4\>\"", "->", 
          RowBox[{"NetPort", "[", 
           RowBox[{"\"\<u4\>\"", ",", "\"\<kk4$\>\""}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<net4\>\"", "->", 
          RowBox[{"NetPort", "[", 
           RowBox[{"\"\<Du4\>\"", ",", "\"\<k4$\>\""}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<u4\>\"", "->", 
          RowBox[{"NetPort", "[", "\"\<u\>\"", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<Du4\>\"", "->", 
          RowBox[{"NetPort", "[", "\"\<Du\>\"", "]"}]}]}], 
        "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<u\>\"", "->", 
        RowBox[{"{", 
         RowBox[{"9", ",", "nX", ",", "nY", ",", "nZ"}], "}"}]}], ",", 
       RowBox[{"\"\<Du\>\"", "->", 
        RowBox[{"{", 
         RowBox[{"9", ",", "nX", ",", "nY", ",", "nZ"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8424173110204773`*^9, 3.842417598148626*^9}, {
  3.842417633111213*^9, 3.842417636227459*^9}, {3.8424176711165686`*^9, 
  3.842417705012207*^9}, {3.8424177593007917`*^9, 3.8424180626107035`*^9}, {
  3.8424181970460634`*^9, 3.8424182974654903`*^9}, {3.8424183311763544`*^9, 
  3.8424184442785063`*^9}, {3.842418494355383*^9, 3.84241885824929*^9}, {
  3.8424188912388134`*^9, 3.842418906295625*^9}, {3.8424189952858424`*^9, 
  3.842419040233901*^9}, {3.842419445883648*^9, 3.842419470431817*^9}, {
  3.842419509768843*^9, 3.8424195236995535`*^9}, {3.842425016337194*^9, 
  3.84242504954782*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"e12b2917-8cba-46a9-bc62-d38a6629ff34"],

Cell[CellGroupData[{

Cell["Checks and timings", "Subsubsection",
 CellChangeTimes->{{3.8424195577583437`*^9, 
  3.8424195599661007`*^9}},ExpressionUUID->"130f8670-13bb-463d-95ed-\
4f197976c137"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "NNRK4StepOld"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"NNRK4StepOld", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lX_Real", ",", "nX_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"lY_Real", ",", "nY_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"lZ_Real", ",", "nZ_Integer"}], "}"}]}], "]"}], "[", 
     RowBox[{
      RowBox[{"kerOrderX_Integer", "?", "EvenQ"}], ",", 
      RowBox[{"kerOrderY_Integer", "?", "EvenQ"}], ",", 
      RowBox[{"kerOrderZ_Integer", "?", "EvenQ"}]}], "]"}], "[", 
    RowBox[{
    "v_Real", ",", "\[Lambda]_Real", ",", "q_Real", ",", "\[Omega]_Real"}], 
    "]"}], "[", "dt_Real", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"NNRK4StepOld", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lX", ",", "nX"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"lY", ",", "nY"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
      RowBox[{"kerOrderX", ",", "kerOrderY", ",", "kerOrderZ"}], "]"}], "[", 
     RowBox[{"v", ",", "\[Lambda]", ",", "q", ",", "\[Omega]"}], "]"}], "[", 
    "dt", "]"}], "=", "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"neuralNetwork", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"NNEqsOld", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lX", ",", "nX"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"lY", ",", "nY"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
         RowBox[{"kerOrderX", ",", "kerOrderY", ",", "kerOrderZ"}], "]"}], 
        "[", 
        RowBox[{"v", ",", "\[Lambda]", ",", "q", ",", "\[Omega]"}], "]"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"NetGraph", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\"\<k1\>\"", "\[Rule]", "neuralNetwork"}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<u[1:9]\>\"", "\[Rule]", 
          RowBox[{"PartLayer", "[", 
           RowBox[{"1", ";;", "9"}], "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<u[10:18]\>\"", "\[Rule]", 
          RowBox[{"PartLayer", "[", 
           RowBox[{"10", ";;", "18"}], "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<dt/2 k1\>\"", "\[Rule]", 
          RowBox[{"ConstantTimesLayer", "[", 
           RowBox[{"\"\<Scaling\>\"", "\[Rule]", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              FractionBox["dt", "2"], ",", 
              RowBox[{"{", 
               RowBox[{"9", ",", "nX", ",", "nY", ",", "nZ"}], "}"}]}], 
             "]"}]}], "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<dt/2 kk1\>\"", "\[Rule]", 
          RowBox[{"ConstantTimesLayer", "[", 
           RowBox[{"\"\<Scaling\>\"", "\[Rule]", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              FractionBox["dt", "2"], ",", 
              RowBox[{"{", 
               RowBox[{"9", ",", "nX", ",", "nY", ",", "nZ"}], "}"}]}], 
             "]"}]}], "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<u[1:9]+dt/2 kk1\>\"", "\[Rule]", 
          RowBox[{"TotalLayer", "[", "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<u[10:18]+dt/2 k1\>\"", "\[Rule]", 
          RowBox[{"TotalLayer", "[", "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<u1\>\"", "\[Rule]", 
          RowBox[{"CatenateLayer", "[", "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<k2\>\"", "\[Rule]", "neuralNetwork"}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<kk2\>\"", "\[Rule]", 
          RowBox[{"TotalLayer", "[", "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<u1[1:9]\>\"", "\[Rule]", 
          RowBox[{"PartLayer", "[", 
           RowBox[{"1", ";;", "9"}], "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<u1[10:18]\>\"", "\[Rule]", 
          RowBox[{"PartLayer", "[", 
           RowBox[{"10", ";;", "18"}], "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<dt/2 k2\>\"", "\[Rule]", 
          RowBox[{"ConstantTimesLayer", "[", 
           RowBox[{"\"\<Scaling\>\"", "\[Rule]", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              FractionBox["dt", "2"], ",", 
              RowBox[{"{", 
               RowBox[{"9", ",", "nX", ",", "nY", ",", "nZ"}], "}"}]}], 
             "]"}]}], "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<dt/2 kk2\>\"", "\[Rule]", 
          RowBox[{"ConstantTimesLayer", "[", 
           RowBox[{"\"\<Scaling\>\"", "\[Rule]", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              FractionBox["dt", "2"], ",", 
              RowBox[{"{", 
               RowBox[{"9", ",", "nX", ",", "nY", ",", "nZ"}], "}"}]}], 
             "]"}]}], "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<u1[1:9]+dt/2 kk2\>\"", "\[Rule]", 
          RowBox[{"TotalLayer", "[", "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<u1[10:18]+dt/2 k2\>\"", "\[Rule]", 
          RowBox[{"TotalLayer", "[", "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<u2\>\"", "\[Rule]", 
          RowBox[{"CatenateLayer", "[", "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<k3\>\"", "\[Rule]", "neuralNetwork"}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<kk3\>\"", "\[Rule]", 
          RowBox[{"TotalLayer", "[", "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<u2[1:9]\>\"", "\[Rule]", 
          RowBox[{"PartLayer", "[", 
           RowBox[{"1", ";;", "9"}], "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<u2[10:18]\>\"", "\[Rule]", 
          RowBox[{"PartLayer", "[", 
           RowBox[{"10", ";;", "18"}], "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<dt k3\>\"", "\[Rule]", 
          RowBox[{"ConstantTimesLayer", "[", 
           RowBox[{"\"\<Scaling\>\"", "\[Rule]", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"dt", ",", 
              RowBox[{"{", 
               RowBox[{"9", ",", "nX", ",", "nY", ",", "nZ"}], "}"}]}], 
             "]"}]}], "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<dt kk3\>\"", "\[Rule]", 
          RowBox[{"ConstantTimesLayer", "[", 
           RowBox[{"\"\<Scaling\>\"", "\[Rule]", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"dt", ",", 
              RowBox[{"{", 
               RowBox[{"9", ",", "nX", ",", "nY", ",", "nZ"}], "}"}]}], 
             "]"}]}], "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<u2[1:9]+dt kk3\>\"", "\[Rule]", 
          RowBox[{"TotalLayer", "[", "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<u2[10:18]+dt k3\>\"", "\[Rule]", 
          RowBox[{"TotalLayer", "[", "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<u3\>\"", "\[Rule]", 
          RowBox[{"CatenateLayer", "[", "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<k4\>\"", "\[Rule]", "neuralNetwork"}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<kk4\>\"", "\[Rule]", 
          RowBox[{"TotalLayer", "[", "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<k1+k4\>\"", "\[Rule]", 
          RowBox[{"TotalLayer", "[", "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<k2+k3\>\"", "\[Rule]", 
          RowBox[{"TotalLayer", "[", "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<2(k2+k3)\>\"", "\[Rule]", 
          RowBox[{"ConstantTimesLayer", "[", 
           RowBox[{"\"\<Scaling\>\"", "\[Rule]", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"2", ",", 
              RowBox[{"{", 
               RowBox[{"9", ",", "nX", ",", "nY", ",", "nZ"}], "}"}]}], 
             "]"}]}], "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<kk1+kk4\>\"", "\[Rule]", 
          RowBox[{"TotalLayer", "[", "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<kk2+kk3\>\"", "\[Rule]", 
          RowBox[{"TotalLayer", "[", "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<2(kk2+kk3)\>\"", "\[Rule]", 
          RowBox[{"ConstantTimesLayer", "[", 
           RowBox[{"\"\<Scaling\>\"", "\[Rule]", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"2", ",", 
              RowBox[{"{", 
               RowBox[{"9", ",", "nX", ",", "nY", ",", "nZ"}], "}"}]}], 
             "]"}]}], "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<k1+2(k2+k3)+k4\>\"", "\[Rule]", 
          RowBox[{"TotalLayer", "[", "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<kk1+2(kk2+kk3)+kk4\>\"", "\[Rule]", 
          RowBox[{"TotalLayer", "[", "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<k's\>\"", "\[Rule]", 
          RowBox[{"CatenateLayer", "[", "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<dt/6 k's\>\"", "\[Rule]", 
          RowBox[{"ConstantTimesLayer", "[", 
           RowBox[{"\"\<Scaling\>\"", "\[Rule]", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              RowBox[{"dt", "/", "6"}], ",", 
              RowBox[{"{", 
               RowBox[{"18", ",", "nX", ",", "nY", ",", "nZ"}], "}"}]}], 
             "]"}]}], "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<u4\>\"", "\[Rule]", 
          RowBox[{"TotalLayer", "[", "]"}]}]}], 
        RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"NetPort", "[", "\"\<Input\>\"", "]"}], "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<k1\>\"", ",", "\"\<u[1:9]\>\"", ",", "\"\<u[10:18]\>\""}], 
           "}"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<u[10:18]\>\"", "\[Rule]", "\"\<dt/2 kk1\>\""}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<k1\>\"", "\[Rule]", "\"\<dt/2 k1\>\""}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<u[1:9]\>\"", ",", "\"\<dt/2 kk1\>\""}], "}"}], 
          "\[Rule]", "\"\<u[1:9]+dt/2 kk1\>\""}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<u[10:18]\>\"", ",", "\"\<dt/2 k1\>\""}], "}"}], 
          "\[Rule]", "\"\<u[10:18]+dt/2 k1\>\""}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<u[1:9]+dt/2 kk1\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", 
           RowBox[{"\"\<u1\>\"", ",", "1"}], "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<u[10:18]+dt/2 k1\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", 
           RowBox[{"\"\<u1\>\"", ",", "2"}], "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<u1\>\"", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<k2\>\"", ",", "\"\<u1[1:9]\>\"", ",", "\"\<u1[10:18]\>\""}], 
           "}"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<u[10:18]\>\"", ",", "\"\<dt/2 kk1\>\""}], "}"}], 
          "\[Rule]", "\"\<kk2\>\""}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<k2\>\"", "\[Rule]", "\"\<dt/2 k2\>\""}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<kk2\>\"", "\[Rule]", "\"\<dt/2 kk2\>\""}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<u1[1:9]\>\"", ",", "\"\<dt/2 kk2\>\""}], "}"}], 
          "\[Rule]", "\"\<u1[1:9]+dt/2 kk2\>\""}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<u1[10:18]\>\"", ",", "\"\<dt/2 k2\>\""}], "}"}], 
          "\[Rule]", "\"\<u1[10:18]+dt/2 k2\>\""}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<u1[1:9]+dt/2 kk2\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", 
           RowBox[{"\"\<u2\>\"", ",", "1"}], "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<u1[10:18]+dt/2 k2\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", 
           RowBox[{"\"\<u2\>\"", ",", "2"}], "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<u2\>\"", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<k3\>\"", ",", "\"\<u2[1:9]\>\"", ",", "\"\<u2[10:18]\>\""}], 
           "}"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<u[10:18]\>\"", ",", "\"\<dt/2 kk2\>\""}], "}"}], 
          "\[Rule]", "\"\<kk3\>\""}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<k3\>\"", "\[Rule]", "\"\<dt k3\>\""}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<kk3\>\"", "\[Rule]", "\"\<dt kk3\>\""}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<u2[1:9]\>\"", ",", "\"\<dt kk3\>\""}], "}"}], 
          "\[Rule]", "\"\<u2[1:9]+dt kk3\>\""}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<u2[10:18]\>\"", ",", "\"\<dt k3\>\""}], "}"}], 
          "\[Rule]", "\"\<u2[10:18]+dt k3\>\""}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<u2[1:9]+dt kk3\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", 
           RowBox[{"\"\<u3\>\"", ",", "1"}], "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<u2[10:18]+dt k3\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", 
           RowBox[{"\"\<u3\>\"", ",", "2"}], "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<u3\>\"", "\[Rule]", "\"\<k4\>\""}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<u[10:18]\>\"", ",", "\"\<dt kk3\>\""}], "}"}], 
          "\[Rule]", "\"\<kk4\>\""}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<k1\>\"", ",", "\"\<k4\>\""}], "}"}], "\[Rule]", 
          "\"\<k1+k4\>\""}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<k2\>\"", ",", "\"\<k3\>\""}], "}"}], "\[Rule]", 
          "\"\<k2+k3\>\""}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<k2+k3\>\"", "\[Rule]", "\"\<2(k2+k3)\>\""}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<u[10:18]\>\"", ",", "\"\<kk4\>\""}], "}"}], 
          "\[Rule]", "\"\<kk1+kk4\>\""}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<kk2\>\"", ",", "\"\<kk3\>\""}], "}"}], "\[Rule]", 
          "\"\<kk2+kk3\>\""}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<kk2+kk3\>\"", "\[Rule]", "\"\<2(kk2+kk3)\>\""}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<k1+k4\>\"", ",", "\"\<2(k2+k3)\>\""}], "}"}], 
          "\[Rule]", "\"\<k1+2(k2+k3)+k4\>\""}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<kk1+kk4\>\"", ",", "\"\<2(kk2+kk3)\>\""}], "}"}], 
          "\[Rule]", "\"\<kk1+2(kk2+kk3)+kk4\>\""}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<kk1+2(kk2+kk3)+kk4\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", 
           RowBox[{"\"\<k's\>\"", ",", "1"}], "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<k1+2(k2+k3)+k4\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", 
           RowBox[{"\"\<k's\>\"", ",", "2"}], "]"}]}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\"\<k's\>\"", "\[Rule]", "\"\<dt/6 k's\>\""}], ",", 
         RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NetPort", "[", "\"\<Input\>\"", "]"}], ",", 
            "\"\<dt/6 k's\>\""}], "}"}], "\[Rule]", "\"\<u4\>\""}]}], 
        RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"\"\<Input\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"18", ",", "nX", ",", "nY", ",", "nZ"}], "}"}]}]}], "]"}]}], 
    RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.8008508917808094`*^9, 3.800850955695613*^9}, {
   3.800850998480788*^9, 3.800851113183956*^9}, {3.8008511895595207`*^9, 
   3.800851311696757*^9}, {3.80085134362809*^9, 3.8008515792824473`*^9}, {
   3.800851614197531*^9, 3.8008518756994696`*^9}, {3.8008519705297923`*^9, 
   3.8008525212150016`*^9}, {3.800852586829217*^9, 3.8008528122718563`*^9}, {
   3.8008528580052524`*^9, 3.8008530121897373`*^9}, 3.8008532662227745`*^9, {
   3.8008534433905697`*^9, 3.8008534856928883`*^9}, {3.8008535207817593`*^9, 
   3.8008536359957294`*^9}, {3.800853898701729*^9, 3.800854050918399*^9}, 
   3.8008540843893976`*^9, {3.800854898682342*^9, 3.8008549183436685`*^9}, {
   3.823930504998147*^9, 3.823930508360839*^9}, {3.8239305445280476`*^9, 
   3.823930544996622*^9}, {3.8240942034512196`*^9, 3.8240945781725783`*^9}, {
   3.8424173042712984`*^9, 3.84241733265392*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"390bf43d-3cbc-45d1-8e28-f8737dedf312"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"lX", "=", "20."}], ",", 
     RowBox[{"nX", "=", "21"}], ",", 
     RowBox[{"lY", "=", "20."}], ",", 
     RowBox[{"nY", "=", "21"}], ",", 
     RowBox[{"lZ", "=", "20."}], ",", 
     RowBox[{"nZ", "=", "21"}], ",", 
     RowBox[{"kerOrderX", "=", "2"}], ",", 
     RowBox[{"kerOrderY", "=", "2"}], ",", 
     RowBox[{"kerOrderZ", "=", "2"}], ",", 
     RowBox[{"v", "=", "2."}], ",", 
     RowBox[{"\[Lambda]", "=", "2."}], ",", 
     RowBox[{"q", "=", "1."}], ",", 
     RowBox[{"\[Omega]", "=", "1."}], ",", 
     RowBox[{"dt", "=", ".001"}], ",", "\[IndentingNewLine]", "inputOld", ",",
      "inputNew", ",", "nnOld", ",", "nnNew", ",", "resOld", ",", "resNew"}], 
    "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"inputOld", "=", 
     RowBox[{"RandomInteger", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"18", ",", "nX", ",", "nY", ",", "nZ"}], "}"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"inputNew", "=", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<u\>\"", "->", 
        RowBox[{"inputOld", "[", 
         RowBox[{"[", 
          RowBox[{";;", "9"}], "]"}], "]"}]}], ",", 
       RowBox[{"\"\<Du\>\"", "->", 
        RowBox[{"inputOld", "[", 
         RowBox[{"[", 
          RowBox[{"10", ";;"}], "]"}], "]"}]}]}], "|>"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"nnOld", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"NNRK4StepOld", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lX", ",", "nX"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"lY", ",", "nY"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
        RowBox[{"kerOrderX", ",", "kerOrderY", ",", "kerOrderZ"}], "]"}], "[", 
       RowBox[{"v", ",", "\[Lambda]", ",", "q", ",", "\[Omega]"}], "]"}], "[",
       "dt", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"nnNew", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"NNRK4Step", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lX", ",", "nX"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"lY", ",", "nY"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
        RowBox[{"kerOrderX", ",", "kerOrderY", ",", "kerOrderZ"}], "]"}], "[", 
       RowBox[{"v", ",", "\[Lambda]", ",", "q", ",", "\[Omega]"}], "]"}], "[",
       "dt", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"resOld", "=", 
     RowBox[{"nnOld", "[", 
      RowBox[{"inputOld", ",", 
       RowBox[{"TargetDevice", "\[Rule]", "DEVICE"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"resNew", "=", 
     RowBox[{"nnNew", "[", 
      RowBox[{"inputNew", ",", 
       RowBox[{"TargetDevice", "\[Rule]", "DEVICE"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Catenate", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"resNew", "@", "\"\<u\>\""}], ",", 
           RowBox[{"resNew", "@", "\"\<Du\>\""}]}], "}"}], "]"}], "-", 
        "resOld"}], "//", "Flatten"}], "//", "Abs"}], "//", "Max"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8424196247057843`*^9, 3.8424198526061354`*^9}, {
  3.842419883213168*^9, 3.8424199600163565`*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"2c7f46fa-d826-43b3-8e00-26d3d0a66670"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"lX", "=", "20."}], ",", 
     RowBox[{"nX", "=", "101"}], ",", 
     RowBox[{"lY", "=", "20."}], ",", 
     RowBox[{"nY", "=", "101"}], ",", 
     RowBox[{"lZ", "=", "20."}], ",", 
     RowBox[{"nZ", "=", "101"}], ",", 
     RowBox[{"kerOrderX", "=", "2"}], ",", 
     RowBox[{"kerOrderY", "=", "2"}], ",", 
     RowBox[{"kerOrderZ", "=", "2"}], ",", 
     RowBox[{"v", "=", "2."}], ",", 
     RowBox[{"\[Lambda]", "=", "2."}], ",", 
     RowBox[{"q", "=", "1."}], ",", 
     RowBox[{"\[Omega]", "=", "1."}], ",", 
     RowBox[{"dt", "=", ".001"}], ",", "\[IndentingNewLine]", 
     RowBox[{"numTests", "=", "100"}], ",", "datasetOld", ",", "datasetNew", 
     ",", "nnOld", ",", "nnNew", ",", "timingOld", ",", "timingNew"}], 
    "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"datasetOld", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RandomInteger", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"18", ",", "nX", ",", "nY", ",", "nZ"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", "numTests", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"datasetNew", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<u\>\"", "->", 
          RowBox[{"inputOld", "[", 
           RowBox[{"[", 
            RowBox[{";;", "9"}], "]"}], "]"}]}], ",", 
         RowBox[{"\"\<Du\>\"", "->", 
          RowBox[{"inputOld", "[", 
           RowBox[{"[", 
            RowBox[{"10", ";;"}], "]"}], "]"}]}]}], "|>"}], ",", 
       RowBox[{"{", 
        RowBox[{"inputOld", ",", "datasetOld"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "\"\<Datasets created!\>\"", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"timingNew", ",", "nnNew"}], "}"}], "=", 
     RowBox[{"AbsoluteTiming", "@", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"NNRK4Step", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lX", ",", "nX"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"lY", ",", "nY"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
         RowBox[{"kerOrderX", ",", "kerOrderY", ",", "kerOrderZ"}], "]"}], 
        "[", 
        RowBox[{"v", ",", "\[Lambda]", ",", "q", ",", "\[Omega]"}], "]"}], 
       "[", "dt", "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<New version created in \>\"", ",", "timingNew", ",", 
      "\"\< seconds...\>\""}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"timingOld", ",", "nnOld"}], "}"}], "=", 
     RowBox[{"AbsoluteTiming", "@", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"NNRK4StepOld", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lX", ",", "nX"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"lY", ",", "nY"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
         RowBox[{"kerOrderX", ",", "kerOrderY", ",", "kerOrderZ"}], "]"}], 
        "[", 
        RowBox[{"v", ",", "\[Lambda]", ",", "q", ",", "\[Omega]"}], "]"}], 
       "[", "dt", "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<Old version created in \>\"", ",", "timingOld", ",", 
      "\"\< seconds...\>\""}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"timingNew", "=", 
     RowBox[{"First", "@", 
      RowBox[{"AbsoluteTiming", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"nnNew", "[", 
          RowBox[{"#", ",", 
           RowBox[{"TargetDevice", "\[Rule]", "DEVICE"}]}], "]"}], "&"}], "/@",
         "datasetNew"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<New version runs \>\"", ",", "numTests", ",", 
      "\"\< evaluations in \>\"", ",", "timingNew", ",", 
      "\"\< seconds...\>\""}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"timingOld", "=", 
     RowBox[{"First", "@", 
      RowBox[{"AbsoluteTiming", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"nnOld", "[", 
          RowBox[{"#", ",", 
           RowBox[{"TargetDevice", "\[Rule]", "DEVICE"}]}], "]"}], "&"}], "/@",
         "datasetOld"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<Old version runs \>\"", ",", "numTests", ",", 
      "\"\< evaluations in \>\"", ",", "timingOld", ",", 
      "\"\< seconds...\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.842420002825097*^9, 3.842420038197727*^9}, {
  3.8424200737240906`*^9, 3.8424200783528967`*^9}, {3.842420267251314*^9, 
  3.8424203091912556`*^9}, {3.8424203544634557`*^9, 3.842420446478484*^9}, {
  3.842422774185089*^9, 3.8424228013081956`*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"7083aa98-d094-4228-ba99-97a52e3e7864"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Runge-Kutta time-evolution", "Subsection",
 CellChangeTimes->{{3.824094663551671*^9, 
  3.824094672736038*^9}},ExpressionUUID->"1bf374c5-addc-41b6-a36a-\
4ca67fcd00f5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "RK4State"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RK4State", "[", "seed_Association", "]"}], ":=", 
  RowBox[{"<|", 
   RowBox[{
    RowBox[{"\"\<u\>\"", "->", 
     RowBox[{
      RowBox[{"seed", "[", "\"\<fields\>\"", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{";;", "9"}], "]"}], "]"}]}], ",", 
    RowBox[{"\"\<Du\>\"", "->", 
     RowBox[{
      RowBox[{"seed", "[", "\"\<fields\>\"", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"10", ";;"}], "]"}], "]"}]}]}], "|>"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.842424780105682*^9, 3.842424836003484*^9}, {
  3.842424894751328*^9, 3.8424248980287046`*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"882c104f-19ea-4ad3-ae5a-4cbd1ed1df39"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "RK4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"RK4", "[", 
       RowBox[{
        RowBox[{"kerOrderX_Integer", "?", "EvenQ"}], ",", 
        RowBox[{"kerOrderY_Integer", "?", "EvenQ"}], ",", 
        RowBox[{"kerOrderZ_Integer", "?", "EvenQ"}]}], "]"}], "[", 
      RowBox[{
      "dt_Real", ",", "numSteps_Integer", ",", "checkpointInterval_Integer"}],
       "]"}], "[", 
     RowBox[{"seed_Association", ",", "outputFile_String"}], "]"}], "/;", 
    RowBox[{"FileExistsQ", "@", "outputFile"}]}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<File \>\"", ",", "outputFile", ",", 
     "\"\< already exists, aborting!\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RK4", "[", 
     RowBox[{
     "dt_Real", ",", "numSteps_Integer", ",", "checkpointInterval_Integer"}], 
     "]"}], "[", 
    RowBox[{"seed_NumericArray", ",", "outputFile_String"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"RK4", "[", 
      RowBox[{"2", ",", "2", ",", "2"}], "]"}], "[", 
     RowBox[{"dt", ",", "numSteps", ",", "checkpointInterval"}], "]"}], "[", 
    RowBox[{"seed", ",", "outputFile"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RK4", "[", 
     RowBox[{
      RowBox[{"kerOrderX_Integer", "?", "EvenQ"}], ",", 
      RowBox[{"kerOrderY_Integer", "?", "EvenQ"}], ",", 
      RowBox[{"kerOrderZ_Integer", "?", "EvenQ"}]}], "]"}], "[", 
    RowBox[{
    "dt_Real", ",", "numSteps_Integer", ",", "checkpointInterval_Integer"}], 
    "]"}], "[", 
   RowBox[{"seed_Association", ",", "outputFile_String"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"start", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ",", "lX", ",", "nX", ",", "lY", 
      ",", "nY", ",", "lZ", ",", "nZ", ",", "v", ",", "\[Lambda]", ",", "q", 
      ",", "\[Omega]", ",", "state", ",", "step", ",", "params", ",", 
      "lastCheckpoint"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "lX", ",", "nX", ",", "lY", ",", "nY", ",", "lZ", ",", "nZ", ",", "v", 
        ",", "\[Lambda]", ",", "q", ",", "\[Omega]"}], "}"}], "=", 
      RowBox[{"seed", "/@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<lX\>\"", ",", "\"\<nX\>\"", ",", "\"\<lY\>\"", ",", "\"\<nY\>\"",
          ",", "\"\<lZ\>\"", ",", "\"\<nZ\>\"", ",", "\"\<v\>\"", ",", 
         "\"\<\[Lambda]\>\"", ",", "\"\<q\>\"", ",", "\"\<\[Omega]\>\""}], 
        "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"RK4State", "@", "seed"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"step", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"NNRK4Step", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lX", ",", "nX"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"lY", ",", "nY"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
         RowBox[{"kerOrderX", ",", "kerOrderY", ",", "kerOrderZ"}], "]"}], 
        "[", 
        RowBox[{"v", ",", "\[Lambda]", ",", "q", ",", "\[Omega]"}], "]"}], 
       "[", "dt", "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"params", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<lR\>\"", "\[Rule]", 
         RowBox[{"seed", "@", "\"\<lR\>\""}]}], ",", 
        RowBox[{"\"\<nR\>\"", "\[Rule]", 
         RowBox[{"seed", "@", "\"\<nR\>\""}]}], ",", 
        RowBox[{"\"\<\[Epsilon]\>\"", "\[Rule]", 
         RowBox[{"seed", "@", "\"\<\[Epsilon]\>\""}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<v\>\"", "\[Rule]", "v"}], ",", 
        RowBox[{"\"\<\[Lambda]\>\"", "\[Rule]", "\[Lambda]"}], ",", 
        RowBox[{"\"\<q\>\"", "\[Rule]", "q"}], ",", 
        RowBox[{"\"\<\[Omega]\>\"", "\[Rule]", "\[Omega]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<r\[Phi]\>\"", "\[Rule]", 
         RowBox[{"seed", "@", "\"\<r\[Phi]\>\""}]}], ",", 
        RowBox[{"\"\<r\[Chi]\>\"", "\[Rule]", 
         RowBox[{"seed", "@", "\"\<r\[Chi]\>\""}]}], ",", 
        RowBox[{"\"\<rA\>\"", "\[Rule]", 
         RowBox[{"seed", "@", "\"\<rA\>\""}]}], ",", 
        RowBox[{"\"\<\[Chi]0\>\"", "\[Rule]", 
         RowBox[{"seed", "@", "\"\<\[Chi]0\>\""}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<lX\>\"", "\[Rule]", "lX"}], ",", 
        RowBox[{"\"\<nX\>\"", "\[Rule]", "nX"}], ",", 
        RowBox[{"\"\<lY\>\"", "\[Rule]", "lY"}], ",", 
        RowBox[{"\"\<nY\>\"", "\[Rule]", "nY"}], ",", 
        RowBox[{"\"\<lZ\>\"", "\[Rule]", "lZ"}], ",", 
        RowBox[{"\"\<nZ\>\"", "\[Rule]", "nZ"}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<kerOrderX\>\"", "\[Rule]", "kerOrderX"}], ",", 
        RowBox[{"\"\<kerOrderY\>\"", "\[Rule]", "kerOrderY"}], ",", 
        RowBox[{"\"\<kerOrderZ\>\"", "\[Rule]", "kerOrderZ"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<dt\>\"", "\[Rule]", "dt"}], ",", 
        RowBox[{
        "\"\<checkpointInterval\>\"", "\[Rule]", "checkpointInterval"}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"outputFile", ",", 
       RowBox[{"Values", "@", "params"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Attributes\>\"", ",", 
         RowBox[{"Keys", "@", "params"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"ProgressIndicator", "[", 
       RowBox[{
        RowBox[{"Dynamic", "@", "i"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "numSteps"}], "}"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"lastCheckpoint", "=", "start"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"i", ",", "checkpointInterval"}], "]"}], "\[Equal]", 
           "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Checkpoint at step \>\"", ",", "i", ",", "\"\<: done \>\"", 
             ",", "checkpointInterval", ",", "\"\< iterations in \>\"", ",", 
             RowBox[{"Quantity", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"AbsoluteTime", "[", "]"}], "-", "lastCheckpoint"}], 
               ",", "\"\<s\>\""}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Export", "[", 
            RowBox[{"outputFile", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"IntegerString", "[", 
                  RowBox[{"i", ",", "10", ",", "10"}], "]"}], "<>", 
                 "\"\</u\>\""}], "->", 
                RowBox[{"state", "@", "\"\<u\>\""}]}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"IntegerString", "[", 
                  RowBox[{"i", ",", "10", ",", "10"}], "]"}], "<>", 
                 "\"\</Du\>\""}], "->", 
                RowBox[{"state", "@", "\"\<Du\>\""}]}]}], "}"}], ",", 
             "\"\<Datasets\>\"", ",", 
             RowBox[{"OverwriteTarget", "\[Rule]", "\"\<Append\>\""}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"lastCheckpoint", "=", 
            RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"state", "=", 
         RowBox[{"step", "[", 
          RowBox[{"state", ",", 
           RowBox[{"TargetDevice", "\[Rule]", "DEVICE"}]}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "numSteps"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Finished in \>\"", ",", 
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"AbsoluteTime", "[", "]"}], "-", "start"}], ",", 
         "\"\<s\>\""}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"SimulationLoad", "@", "outputFile"}]}]}], "\[IndentingNewLine]",
    "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.800854989007703*^9, 3.80085525913616*^9}, {
   3.800855430244308*^9, 3.80085544751931*^9}, {3.800855578430224*^9, 
   3.800855587009677*^9}, {3.8008559478765345`*^9, 3.8008559536145673`*^9}, {
   3.800856154559411*^9, 3.8008562246700635`*^9}, {3.800856288300909*^9, 
   3.80085631884888*^9}, {3.800856515423174*^9, 3.8008565185381737`*^9}, {
   3.8008566249811773`*^9, 3.8008566308812065`*^9}, {3.8008571092891364`*^9, 
   3.8008573869873953`*^9}, {3.8008574274045706`*^9, 
   3.8008574345766172`*^9}, {3.800857485819962*^9, 3.800857488360962*^9}, {
   3.8008578669520674`*^9, 3.80085788527003*^9}, {3.8008580555433617`*^9, 
   3.8008581363113327`*^9}, {3.800858180422333*^9, 3.8008581812213335`*^9}, {
   3.800882106341996*^9, 3.8008821072359967`*^9}, 3.800886433966361*^9, {
   3.8008871833400774`*^9, 3.800887184900076*^9}, {3.800887343469245*^9, 
   3.8008873473082867`*^9}, {3.801374954905203*^9, 3.80137495498617*^9}, {
   3.8014939627286997`*^9, 3.8014939640966983`*^9}, 3.801829397507085*^9, {
   3.802001219562689*^9, 3.8020012195917034`*^9}, {3.802004090598442*^9, 
   3.8020040912904453`*^9}, {3.8026855067905874`*^9, 
   3.8026855119330473`*^9}, {3.802685543302114*^9, 3.802685544893458*^9}, {
   3.802796663854616*^9, 3.8027966861872244`*^9}, 3.802846526220479*^9, {
   3.8051143421403666`*^9, 3.8051143628725214`*^9}, 3.809781660747204*^9, {
   3.814367450990576*^9, 3.8143674816979303`*^9}, {3.8240287012498236`*^9, 
   3.8240287077425904`*^9}, {3.824028740197332*^9, 3.8240288034505873`*^9}, {
   3.824028840356558*^9, 3.8240288806966963`*^9}, {3.8240289927269726`*^9, 
   3.8240290113079576`*^9}, {3.8240292540592747`*^9, 3.824029333104753*^9}, {
   3.8240307541802897`*^9, 3.8240307616044755`*^9}, {3.8240308197950726`*^9, 
   3.824030823315151*^9}, {3.8240308968562765`*^9, 3.8240309475072174`*^9}, {
   3.824030986340235*^9, 3.8240310116063805`*^9}, {3.824031100232574*^9, 
   3.824031103512735*^9}, {3.824031135170458*^9, 3.824031138050459*^9}, {
   3.824031379555524*^9, 3.8240313860190153`*^9}, {3.824094689537483*^9, 
   3.824094749665656*^9}, {3.824094801569251*^9, 3.824094807461421*^9}, {
   3.8240948831391363`*^9, 3.8240949381296525`*^9}, {3.824095258530509*^9, 
   3.824095263042104*^9}, {3.824095296575801*^9, 3.824095325164962*^9}, {
   3.8240971694067616`*^9, 3.824097238664398*^9}, {3.8240973296244855`*^9, 
   3.8240974032927437`*^9}, 3.824097439393462*^9, {3.8240974752675505`*^9, 
   3.824097497649829*^9}, {3.8240975730838394`*^9, 3.8240975903989396`*^9}, {
   3.8240976230335717`*^9, 3.824097696325532*^9}, {3.8240977362217474`*^9, 
   3.824097754940392*^9}, {3.824097883718726*^9, 3.824097966919017*^9}, 
   3.8240980031816645`*^9, {3.824098236070883*^9, 3.824098252740413*^9}, {
   3.8240982843615255`*^9, 3.8240983061766014`*^9}, {3.824100284950329*^9, 
   3.824100350850209*^9}, {3.824185700174421*^9, 3.8241859368388224`*^9}, {
   3.824187696173435*^9, 3.824187696390998*^9}, {3.824187951587983*^9, 
   3.824187963860873*^9}, {3.8241911650265594`*^9, 3.82419117984309*^9}, 
   3.824191583499179*^9, {3.8241922308372493`*^9, 3.8241922310227675`*^9}, {
   3.8242053137320757`*^9, 3.8242053395787835`*^9}, {3.8249763803177724`*^9, 
   3.824976416178567*^9}, 3.841915055392074*^9, {3.8424241346783*^9, 
   3.842424146176277*^9}, 3.842424194934371*^9, {3.8424244596201468`*^9, 
   3.8424245598050356`*^9}, {3.842424594097185*^9, 3.842424601439571*^9}, {
   3.84242480460811*^9, 3.84242480505754*^9}, 3.842424900033537*^9, {
   3.8424252494256225`*^9, 3.842425250065919*^9}, {3.8617879428533654`*^9, 
   3.8617879494429502`*^9}, {3.8617884387046003`*^9, 3.8617884441713333`*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"1d0acf7f-a632-4360-9e1c-a7b6a7587a9e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "twogoto1", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"twogoto1", "=", 
   RowBox[{"NetGraph", "[", 
    RowBox[{
     RowBox[{"<|", 
      RowBox[{"\"\<allfields\>\"", "->", 
       RowBox[{"CatenateLayer", "[", "]"}]}], "|>"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"NetPort", "[", "\"\<u\>\"", "]"}], "->", 
        "\"\<allfields\>\""}], ",", 
       RowBox[{
        RowBox[{"NetPort", "[", "\"\<Du\>\"", "]"}], "->", 
        "\"\<allfields\>\""}]}], "}"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.87647268896555*^9, 3.8764727083711643`*^9}, 
   3.876472748229621*^9},
 CellLabel->
  "In[111]:=",ExpressionUUID->"daec7dd3-6be3-4503-968c-e512eec6b583"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "onegoesto2", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"onegoesto2", "=", 
   RowBox[{"NetGraph", "[", 
    RowBox[{
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<us\>\"", "->", 
        RowBox[{"PartLayer", "[", 
         RowBox[{"1", ";;", "9"}], "]"}]}], ",", 
       RowBox[{"\"\<Dus\>\"", "->", 
        RowBox[{"PartLayer", "[", 
         RowBox[{"10", ";;", "18"}], "]"}]}]}], "|>"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"NetPort", "[", "\"\<input\>\"", "]"}], "->", 
        RowBox[{"{", 
         RowBox[{"\"\<us\>\"", ",", "\"\<Dus\>\""}], "}"}]}], ",", 
       RowBox[{"\"\<us\>\"", "->", 
        RowBox[{"NetPort", "[", "\"\<u\>\"", "]"}]}], ",", 
       RowBox[{"\"\<Dus\>\"", "->", 
        RowBox[{"NetPort", "[", "\"\<Du\>\"", "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8764727012564373`*^9, 3.876472704932556*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"0446d980-9f59-4ea6-8253-b4179649dd59"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "try", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"try", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"lX_Real", ",", "nX_Integer"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"lY_Real", ",", "nY_Integer"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"lZ_Real", ",", "nZ_Integer"}], "}"}], ",", 
    RowBox[{"kerOrderX_Integer", "?", "EvenQ"}], ",", 
    RowBox[{"kerOrderY_Integer", "?", "EvenQ"}], ",", 
    RowBox[{"kerOrderZ_Integer", "?", "EvenQ"}], ",", "v_Real", ",", 
    "\[Lambda]_Real", ",", "q_Real", ",", "\[Omega]_Real", ",", "dt_Real"}], 
   "]"}], ":=", 
  RowBox[{"NetGraph", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<twogoto1\>\"", "->", "twogoto1"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<onegoesto2\>\"", "->", "onegoesto2"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Input\>\"", "->", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"NNRK4Step", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lX", ",", "nX"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lY", ",", "nY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
          RowBox[{"kerOrderX", ",", "kerOrderY", ",", "kerOrderZ"}], "]"}], 
         "[", 
         RowBox[{"v", ",", "\[Lambda]", ",", "q", ",", "\[Omega]"}], "]"}], 
        "[", "dt", "]"}]}]}], "|>"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"NetPort", "[", "\"\<Input\>\"", "]"}], "->", 
       "\"\<onegoesto2\>\""}], ",", 
      RowBox[{
       RowBox[{"NetPort", "[", 
        RowBox[{"\"\<onegoesto2\>\"", ",", "\"\<Du\>\""}], "]"}], "->", 
       RowBox[{"NetPort", "[", 
        RowBox[{"\"\<Input\>\"", ",", "\"\<Du\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NetPort", "[", 
        RowBox[{"\"\<onegoesto2\>\"", ",", "\"\<u\>\""}], "]"}], "->", 
       RowBox[{"NetPort", "[", 
        RowBox[{"\"\<Input\>\"", ",", "\"\<u\>\""}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"NetPort", "[", 
        RowBox[{"\"\<Input\>\"", ",", "\"\<Du\>\""}], "]"}], "->", 
       RowBox[{"NetPort", "[", 
        RowBox[{"\"\<twogoto1\>\"", ",", "\"\<Du\>\""}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"NetPort", "[", 
        RowBox[{"\"\<Input\>\"", ",", "\"\<u\>\""}], "]"}], "->", 
       RowBox[{"NetPort", "[", 
        RowBox[{"\"\<twogoto1\>\"", ",", "\"\<u\>\""}], "]"}]}]}], "}"}]}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.876471642350628*^9, 3.87647165451968*^9}, {
   3.876471763896923*^9, 3.8764717729692955`*^9}, 3.876472696255105*^9},
 CellLabel->
  "In[115]:=",ExpressionUUID->"298444c5-2314-4de3-9755-e13a13084d25"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "RK4Nest"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RK4Nest", "[", 
     RowBox[{
     "seed_", ",", "outputFile_String", ",", "numSteps_Integer", ",", 
      "checkpointInterval_"}], "]"}], "[", 
    RowBox[{"kerOrderX_", ",", "kerOrderY_", ",", "kerOrderZ_"}], "]"}], "[", 
   "dt_Real", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"start", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ",", "numStepsOld", ",", "lX", 
      ",", "nX", ",", "lY", ",", "nY", ",", "lZ", ",", "nZ", ",", "v", ",", 
      "\[Lambda]", ",", "q", ",", "\[Omega]", ",", "u", ",", "step", ",", 
      "multistep", ",", "params", ",", "lastCheckpoint", ",", "state"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "lX", ",", "nX", ",", "lY", ",", "nY", ",", "lZ", ",", "nZ", ",", "v", 
        ",", "\[Lambda]", ",", "q", ",", "\[Omega]", ",", "u"}], "}"}], "=", 
      RowBox[{"seed", "/@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<lX\>\"", ",", "\"\<nX\>\"", ",", "\"\<lY\>\"", ",", "\"\<nY\>\"",
          ",", "\"\<lZ\>\"", ",", "\"\<nZ\>\"", ",", "\"\<v\>\"", ",", 
         "\"\<\[Lambda]\>\"", ",", "\"\<q\>\"", ",", "\"\<\[Omega]\>\"", ",", 
         "\"\<fields\>\""}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<u\>\"", "->", 
         RowBox[{"u", "[", 
          RowBox[{"[", 
           RowBox[{";;", "9"}], "]"}], "]"}]}], ",", 
        RowBox[{"\"\<Du\>\"", "->", 
         RowBox[{"u", "[", 
          RowBox[{"[", 
           RowBox[{"10", ";;"}], "]"}], "]"}]}]}], "|>"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"step", "=", 
      RowBox[{"try", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lX", ",", "nX"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"lY", ",", "nY"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"lZ", ",", "nZ"}], "}"}], ",", "kerOrderX", ",", "kerOrderY",
         ",", "kerOrderZ", ",", "v", ",", "\[Lambda]", ",", "q", ",", 
        "\[Omega]", ",", "dt"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"multistep", "=", 
      RowBox[{"NetNestOperator", "[", 
       RowBox[{"step", ",", "EXECUTIONSTEPS"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"params", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<lR\>\"", "\[Rule]", 
         RowBox[{"seed", "@", "\"\<lR\>\""}]}], ",", 
        RowBox[{"\"\<nR\>\"", "\[Rule]", 
         RowBox[{"seed", "@", "\"\<nR\>\""}]}], ",", 
        RowBox[{"\"\<\[Epsilon]\>\"", "\[Rule]", 
         RowBox[{"seed", "@", "\"\<\[Epsilon]\>\""}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<v\>\"", "\[Rule]", "v"}], ",", 
        RowBox[{"\"\<\[Lambda]\>\"", "\[Rule]", "\[Lambda]"}], ",", 
        RowBox[{"\"\<q\>\"", "\[Rule]", "q"}], ",", 
        RowBox[{"\"\<\[Omega]\>\"", "\[Rule]", "\[Omega]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<r\[Phi]\>\"", "\[Rule]", 
         RowBox[{"seed", "@", "\"\<r\[Phi]\>\""}]}], ",", 
        RowBox[{"\"\<r\[Chi]\>\"", "\[Rule]", 
         RowBox[{"seed", "@", "\"\<r\[Chi]\>\""}]}], ",", 
        RowBox[{"\"\<rA\>\"", "\[Rule]", 
         RowBox[{"seed", "@", "\"\<rA\>\""}]}], ",", 
        RowBox[{"\"\<\[Chi]0\>\"", "\[Rule]", 
         RowBox[{"seed", "@", "\"\<\[Chi]0\>\""}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<lX\>\"", "\[Rule]", "lX"}], ",", 
        RowBox[{"\"\<nX\>\"", "\[Rule]", "nX"}], ",", 
        RowBox[{"\"\<lY\>\"", "\[Rule]", "lY"}], ",", 
        RowBox[{"\"\<nY\>\"", "\[Rule]", "nY"}], ",", 
        RowBox[{"\"\<lZ\>\"", "\[Rule]", "lZ"}], ",", 
        RowBox[{"\"\<nZ\>\"", "\[Rule]", "nZ"}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<kerOrderX\>\"", "\[Rule]", "kerOrderX"}], ",", 
        RowBox[{"\"\<kerOrderY\>\"", "\[Rule]", "kerOrderY"}], ",", 
        RowBox[{"\"\<kerOrderZ\>\"", "\[Rule]", "kerOrderZ"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<dt\>\"", "\[Rule]", "dt"}], ",", 
        RowBox[{
        "\"\<checkpointInterval\>\"", "\[Rule]", "checkpointInterval"}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"outputFile", ",", 
       RowBox[{"Values", "@", "params"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Attributes\>\"", ",", 
         RowBox[{"Keys", "@", "params"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"lastCheckpoint", "=", "start"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"i", ",", "checkpointInterval"}], "]"}], "\[Equal]", 
           "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Checkpoint at step \>\"", ",", "i", ",", "\"\<: done \>\"", 
             ",", "checkpointInterval", ",", "\"\< iterations in \>\"", ",", 
             RowBox[{"Quantity", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"AbsoluteTime", "[", "]"}], "-", "lastCheckpoint"}], 
               ",", "\"\<s\>\""}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Export", "[", 
            RowBox[{"outputFile", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"IntegerString", "[", 
                  RowBox[{"i", ",", "10", ",", "10"}], "]"}], "<>", 
                 "\"\</u\>\""}], "->", 
                RowBox[{"state", "@", "\"\<u\>\""}]}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"IntegerString", "[", 
                  RowBox[{"i", ",", "10", ",", "10"}], "]"}], "<>", 
                 "\"\</Du\>\""}], "->", 
                RowBox[{"state", "@", "\"\<Du\>\""}]}]}], "}"}], ",", 
             "\"\<Datasets\>\"", ",", 
             RowBox[{"OverwriteTarget", "\[Rule]", "\"\<Append\>\""}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"lastCheckpoint", "=", 
            RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"u", "=", 
         RowBox[{"multistep", "[", 
          RowBox[{"u", ",", 
           RowBox[{"TargetDevice", "\[Rule]", "DEVICE"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"state", "=", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<u\>\"", "->", 
            RowBox[{"u", "[", 
             RowBox[{"[", 
              RowBox[{";;", "9"}], "]"}], "]"}]}], ",", 
           RowBox[{"\"\<Du\>\"", "->", 
            RowBox[{"u", "[", 
             RowBox[{"[", 
              RowBox[{"10", ";;"}], "]"}], "]"}]}]}], "|>"}]}], ";"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"0", "+", "numSteps"}], ",", "EXECUTIONSTEPS"}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Finished in \>\"", ",", 
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"AbsoluteTime", "[", "]"}], "-", "start"}], ",", 
         "\"\<s\>\""}], "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.809159554969497*^9, 3.809159555923971*^9}, {
   3.8091596023720884`*^9, 3.809159887592437*^9}, {3.809159936099119*^9, 
   3.809159967556321*^9}, {3.809358521856835*^9, 3.809358522569976*^9}, {
   3.8096930486091156`*^9, 3.80969305176495*^9}, {3.8143674958169317`*^9, 
   3.814367501747286*^9}, {3.8241904912181654`*^9, 3.8241904934509287`*^9}, 
   3.8241906159733987`*^9, {3.8241906584347367`*^9, 3.8241906587002525`*^9}, {
   3.8241908540579195`*^9, 3.8241910377270575`*^9}, {3.824191131987714*^9, 
   3.8241911416154795`*^9}, {3.824191193085602*^9, 3.8241911968819494`*^9}, {
   3.8241915919195147`*^9, 3.8241915920120354`*^9}, {3.8241916834674397`*^9, 
   3.824191741614108*^9}, {3.8241917871484194`*^9, 3.824191798955763*^9}, {
   3.8241918369925475`*^9, 3.8241918533592625`*^9}, {3.824273054627248*^9, 
   3.824273080822134*^9}, {3.824273644804274*^9, 3.8242736679800463`*^9}, 
   3.842424066605218*^9, 3.8760516453756084`*^9, {3.876051681591704*^9, 
   3.8760516919438934`*^9}, {3.876051730224795*^9, 3.87605173247841*^9}, {
   3.8763884336122885`*^9, 3.8763885164086103`*^9}, {3.8763885537752314`*^9, 
   3.876388566854083*^9}, {3.8763886811420107`*^9, 3.876388690662054*^9}, {
   3.876388723822522*^9, 3.8763888112497606`*^9}, {3.876388880063116*^9, 
   3.8763889045909667`*^9}, 3.876389088214984*^9, {3.876470449959558*^9, 
   3.8764704836454663`*^9}, {3.8764705640931654`*^9, 
   3.8764705642968807`*^9}, {3.876470722315053*^9, 3.8764707638747644`*^9}, {
   3.876471668938577*^9, 3.8764716783968325`*^9}, {3.87647180948763*^9, 
   3.8764718246380877`*^9}, 3.876472039375816*^9, {3.876476383896468*^9, 
   3.8764763869717937`*^9}, {3.8764765639565353`*^9, 
   3.8764766056281676`*^9}, {3.876476858536825*^9, 3.876476918611493*^9}, 
   3.8764793579925976`*^9, {3.8764797814614296`*^9, 3.8764798022300606`*^9}, {
   3.8764798590816336`*^9, 3.8764798611079626`*^9}, 3.876480289141343*^9, {
   3.8764981014083376`*^9, 3.8764981031458807`*^9}, {3.8768166708870635`*^9, 
   3.8768167137361064`*^9}, {3.876816829231166*^9, 3.8768168841731405`*^9}, {
   3.87690075634657*^9, 3.876900768978731*^9}, {3.876900954979482*^9, 
   3.8769009784341636`*^9}, 3.876901153844361*^9, {3.8769012715017257`*^9, 
   3.876901280698701*^9}, {3.8769015333889427`*^9, 3.876901542273898*^9}, {
   3.8769018513889437`*^9, 3.876901856218858*^9}, {3.876901931269149*^9, 
   3.8769019584745655`*^9}, {3.876902094349774*^9, 3.876902099562598*^9}, {
   3.8769021406062107`*^9, 3.876902142915117*^9}, {3.876902411133363*^9, 
   3.8769024123069754`*^9}, {3.8769025634415903`*^9, 3.8769025771955075`*^9}, 
   3.8769026125901513`*^9, {3.8769027435898786`*^9, 3.8769027598436375`*^9}, {
   3.876903263519014*^9, 3.876903306374321*^9}, {3.876903391970056*^9, 
   3.876903400375661*^9}, {3.876903464305011*^9, 3.876903479261238*^9}, {
   3.876903605929271*^9, 3.8769036801518955`*^9}, {3.876903715660861*^9, 
   3.8769037210471497`*^9}, {3.876903783523472*^9, 3.876903832407092*^9}, 
   3.876903871198675*^9, {3.876903947481395*^9, 3.8769039878894744`*^9}, {
   3.876904037551314*^9, 3.876904060862666*^9}, {3.876904104768038*^9, 
   3.8769041052321653`*^9}, {3.8769044954826164`*^9, 
   3.8769045152377386`*^9}, {3.876904568061514*^9, 3.876904576675867*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"ec619336-1d38-4559-aa46-e6db060223d6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "RK4Extender"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RK4Extender", "[", 
   RowBox[{"simulationFile_String", ",", "numSteps_Integer"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"start", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ",", 
      RowBox[{"simulation", "=", 
       RowBox[{"SimulationLoad", "@", "simulationFile"}]}], ",", "kerOrderX", 
      ",", "kerOrderY", ",", "kerOrderZ", ",", "dt", ",", "numStepsOld", ",", 
      "checkpointInterval", ",", "seed", ",", "lX", ",", "nX", ",", "lY", ",",
       "nY", ",", "lZ", ",", "nZ", ",", "v", ",", "\[Lambda]", ",", "q", ",", 
      "\[Omega]", ",", "u", ",", "step", ",", "multistep", ",", "params", ",",
       "lastCheckpoint"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "kerOrderX", ",", "kerOrderY", ",", "kerOrderZ", ",", "dt", ",", 
        "checkpointInterval"}], "}"}], "=", 
      RowBox[{"simulation", "/@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<kerOrderX\>\"", ",", "\"\<kerOrderY\>\"", ",", 
         "\"\<kerOrderZ\>\"", ",", "\"\<dt\>\"", ",", 
         "\"\<checkpointInterval\>\""}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numStepsOld", "=", 
      RowBox[{"Last", "@", 
       RowBox[{"simulation", "@", "\"\<snapshots\>\""}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"seed", "=", 
      RowBox[{"SimulationSnapshot", "@", "simulation"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "lX", ",", "nX", ",", "lY", ",", "nY", ",", "lZ", ",", "nZ", ",", "v", 
        ",", "\[Lambda]", ",", "q", ",", "\[Omega]", ",", "u"}], "}"}], "=", 
      RowBox[{"seed", "/@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<lX\>\"", ",", "\"\<nX\>\"", ",", "\"\<lY\>\"", ",", "\"\<nY\>\"",
          ",", "\"\<lZ\>\"", ",", "\"\<nZ\>\"", ",", "\"\<v\>\"", ",", 
         "\"\<\[Lambda]\>\"", ",", "\"\<q\>\"", ",", "\"\<\[Omega]\>\"", ",", 
         "\"\<fields\>\""}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"step", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"NNRK4Step", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lX", ",", "nX"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"lY", ",", "nY"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
         RowBox[{"kerOrderX", ",", "kerOrderY", ",", "kerOrderZ"}], "]"}], 
        "[", 
        RowBox[{"v", ",", "\[Lambda]", ",", "q", ",", "\[Omega]"}], "]"}], 
       "[", "dt", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"multistep", "=", 
      RowBox[{"NetNestOperator", "[", 
       RowBox[{"step", ",", "EXECUTIONSTEPS"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"ProgressIndicator", "[", 
         RowBox[{
          RowBox[{"Dynamic", "@", "i"}], ",", 
          RowBox[{"{", 
           RowBox[{"numStepsOld", ",", 
            RowBox[{"numStepsOld", "+", "numSteps"}]}], "}"}]}], "]"}], "]"}],
        ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"lastCheckpoint", "=", "start"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"i", ",", "checkpointInterval"}], "]"}], "\[Equal]", 
           "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"PrintTemporary", "[", 
            RowBox[{
            "\"\<Checkpoint at step \>\"", ",", "i", ",", "\"\<: done \>\"", 
             ",", "checkpointInterval", ",", "\"\< iterations in \>\"", ",", 
             RowBox[{"Quantity", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"AbsoluteTime", "[", "]"}], "-", "lastCheckpoint"}], 
               ",", "\"\<s\>\""}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "\[NotEqual]", "numStepsOld"}], ",", 
             RowBox[{"Export", "[", 
              RowBox[{"simulationFile", ",", "u", ",", 
               RowBox[{"{", 
                RowBox[{"\"\<Datasets\>\"", ",", 
                 RowBox[{"IntegerString", "[", 
                  RowBox[{"i", ",", "10", ",", "10"}], "]"}]}], "}"}], ",", 
               RowBox[{"OverwriteTarget", "\[Rule]", "\"\<Append\>\""}]}], 
              "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"lastCheckpoint", "=", 
            RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"u", "=", 
         RowBox[{"multistep", "[", 
          RowBox[{"u", ",", 
           RowBox[{"TargetDevice", "\[Rule]", "\"\<GPU\>\""}]}], "]"}]}], 
        ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "numStepsOld", ",", 
         RowBox[{"numStepsOld", "+", "numSteps"}], ",", "EXECUTIONSTEPS"}], 
        "}"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Finished in \>\"", ",", 
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"AbsoluteTime", "[", "]"}], "-", "start"}], ",", 
         "\"\<s\>\""}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"SimulationLoad", "@", "simulationFile"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.809159554969497*^9, 3.809159555923971*^9}, {
   3.8091596023720884`*^9, 3.809159887592437*^9}, {3.809159936099119*^9, 
   3.809159967556321*^9}, {3.809358521856835*^9, 3.809358522569976*^9}, {
   3.8096930486091156`*^9, 3.80969305176495*^9}, {3.8143674958169317`*^9, 
   3.814367501747286*^9}, {3.8241904912181654`*^9, 3.8241904934509287`*^9}, 
   3.8241906159733987`*^9, {3.8241906584347367`*^9, 3.8241906587002525`*^9}, {
   3.8241908540579195`*^9, 3.8241910377270575`*^9}, {3.824191131987714*^9, 
   3.8241911416154795`*^9}, {3.824191193085602*^9, 3.8241911968819494`*^9}, {
   3.8241915919195147`*^9, 3.8241915920120354`*^9}, {3.8241916834674397`*^9, 
   3.824191741614108*^9}, {3.8241917871484194`*^9, 3.824191798955763*^9}, {
   3.8241918369925475`*^9, 3.8241918533592625`*^9}, {3.824273054627248*^9, 
   3.824273080822134*^9}, {3.824273644804274*^9, 3.8242736679800463`*^9}, 
   3.842424066605218*^9, 3.8760516453756084`*^9, {3.876051681591704*^9, 
   3.8760516919438934`*^9}, {3.876051730224795*^9, 3.87605173247841*^9}, {
   3.8763884336122885`*^9, 3.8763884350517845`*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"4a9c0907-e7b2-4818-8a19-0484853c585f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "RK4Old"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"RK4Old", "[", 
       RowBox[{
        RowBox[{"kerOrderX_Integer", "?", "EvenQ"}], ",", 
        RowBox[{"kerOrderY_Integer", "?", "EvenQ"}], ",", 
        RowBox[{"kerOrderZ_Integer", "?", "EvenQ"}]}], "]"}], "[", 
      RowBox[{
      "dt_Real", ",", "numSteps_Integer", ",", "checkpointInterval_Integer"}],
       "]"}], "[", 
     RowBox[{"seed_Association", ",", "outputFile_String"}], "]"}], "/;", 
    RowBox[{
     RowBox[{"Mod", "[", 
      RowBox[{"checkpointInterval", ",", "EXECUTIONSTEPS"}], "]"}], 
     "\[NotEqual]", "0"}]}], ":=", "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", 
    "\"\<Please make sure that checkpointInterval is divisible by \
EXECUTIONSTEPS!\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"RK4Old", "[", 
       RowBox[{
        RowBox[{"kerOrderX_Integer", "?", "EvenQ"}], ",", 
        RowBox[{"kerOrderY_Integer", "?", "EvenQ"}], ",", 
        RowBox[{"kerOrderZ_Integer", "?", "EvenQ"}]}], "]"}], "[", 
      RowBox[{
      "dt_Real", ",", "numSteps_Integer", ",", "checkpointInterval_Integer"}],
       "]"}], "[", 
     RowBox[{"seed_Association", ",", "outputFile_String"}], "]"}], "/;", 
    RowBox[{"FileExistsQ", "@", "outputFile"}]}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<File \>\"", ",", "outputFile", ",", 
     "\"\< already exists, aborting!\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RK4Old", "[", 
     RowBox[{
     "dt_Real", ",", "numSteps_Integer", ",", "checkpointInterval_Integer"}], 
     "]"}], "[", 
    RowBox[{"seed_NumericArray", ",", "outputFile_String"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"RK4Old", "[", 
      RowBox[{"2", ",", "2", ",", "2"}], "]"}], "[", 
     RowBox[{"dt", ",", "numSteps", ",", "checkpointInterval"}], "]"}], "[", 
    RowBox[{"seed", ",", "outputFile"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RK4Old", "[", 
     RowBox[{
      RowBox[{"kerOrderX_Integer", "?", "EvenQ"}], ",", 
      RowBox[{"kerOrderY_Integer", "?", "EvenQ"}], ",", 
      RowBox[{"kerOrderZ_Integer", "?", "EvenQ"}]}], "]"}], "[", 
    RowBox[{
    "dt_Real", ",", "numSteps_Integer", ",", "checkpointInterval_Integer"}], 
    "]"}], "[", 
   RowBox[{"seed_Association", ",", "outputFile_String"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"start", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ",", "lX", ",", "nX", ",", "lY", 
      ",", "nY", ",", "lZ", ",", "nZ", ",", "v", ",", "\[Lambda]", ",", "q", 
      ",", "\[Omega]", ",", "u", ",", "step", ",", "multistep", ",", "params",
       ",", "lastCheckpoint"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "lX", ",", "nX", ",", "lY", ",", "nY", ",", "lZ", ",", "nZ", ",", "v", 
        ",", "\[Lambda]", ",", "q", ",", "\[Omega]", ",", "u"}], "}"}], "=", 
      RowBox[{"seed", "/@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<lX\>\"", ",", "\"\<nX\>\"", ",", "\"\<lY\>\"", ",", "\"\<nY\>\"",
          ",", "\"\<lZ\>\"", ",", "\"\<nZ\>\"", ",", "\"\<v\>\"", ",", 
         "\"\<\[Lambda]\>\"", ",", "\"\<q\>\"", ",", "\"\<\[Omega]\>\"", ",", 
         "\"\<fields\>\""}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"step", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"NNRK4Step", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lX", ",", "nX"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"lY", ",", "nY"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
         RowBox[{"kerOrderX", ",", "kerOrderY", ",", "kerOrderZ"}], "]"}], 
        "[", 
        RowBox[{"v", ",", "\[Lambda]", ",", "q", ",", "\[Omega]"}], "]"}], 
       "[", "dt", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"multistep", "=", 
      RowBox[{"NetNestOperator", "[", 
       RowBox[{"step", ",", "EXECUTIONSTEPS"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"params", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<lR\>\"", "\[Rule]", 
         RowBox[{"seed", "@", "\"\<lR\>\""}]}], ",", 
        RowBox[{"\"\<nR\>\"", "\[Rule]", 
         RowBox[{"seed", "@", "\"\<nR\>\""}]}], ",", 
        RowBox[{"\"\<\[Epsilon]\>\"", "\[Rule]", 
         RowBox[{"seed", "@", "\"\<\[Epsilon]\>\""}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<v\>\"", "\[Rule]", "v"}], ",", 
        RowBox[{"\"\<\[Lambda]\>\"", "\[Rule]", "\[Lambda]"}], ",", 
        RowBox[{"\"\<q\>\"", "\[Rule]", "q"}], ",", 
        RowBox[{"\"\<\[Omega]\>\"", "\[Rule]", "\[Omega]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<r\[Phi]\>\"", "\[Rule]", 
         RowBox[{"seed", "@", "\"\<r\[Phi]\>\""}]}], ",", 
        RowBox[{"\"\<r\[Chi]\>\"", "\[Rule]", 
         RowBox[{"seed", "@", "\"\<r\[Chi]\>\""}]}], ",", 
        RowBox[{"\"\<rA\>\"", "\[Rule]", 
         RowBox[{"seed", "@", "\"\<rA\>\""}]}], ",", 
        RowBox[{"\"\<\[Chi]0\>\"", "\[Rule]", 
         RowBox[{"seed", "@", "\"\<\[Chi]0\>\""}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<lX\>\"", "\[Rule]", "lX"}], ",", 
        RowBox[{"\"\<nX\>\"", "\[Rule]", "nX"}], ",", 
        RowBox[{"\"\<lY\>\"", "\[Rule]", "lY"}], ",", 
        RowBox[{"\"\<nY\>\"", "\[Rule]", "nY"}], ",", 
        RowBox[{"\"\<lZ\>\"", "\[Rule]", "lZ"}], ",", 
        RowBox[{"\"\<nZ\>\"", "\[Rule]", "nZ"}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<kerOrderX\>\"", "\[Rule]", "kerOrderX"}], ",", 
        RowBox[{"\"\<kerOrderY\>\"", "\[Rule]", "kerOrderY"}], ",", 
        RowBox[{"\"\<kerOrderZ\>\"", "\[Rule]", "kerOrderZ"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<dt\>\"", "\[Rule]", "dt"}], ",", 
        RowBox[{
        "\"\<checkpointInterval\>\"", "\[Rule]", "checkpointInterval"}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"outputFile", ",", "params", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Attributes\>\"", ",", "\"\<parameters\>\""}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"ProgressIndicator", "[", 
       RowBox[{
        RowBox[{"Dynamic", "@", "i"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "numSteps"}], "}"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"lastCheckpoint", "=", "start"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"i", ",", "checkpointInterval"}], "]"}], "\[Equal]", 
           "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Checkpoint at step \>\"", ",", "i", ",", "\"\<: done \>\"", 
             ",", "checkpointInterval", ",", "\"\< iterations in \>\"", ",", 
             RowBox[{"Quantity", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"AbsoluteTime", "[", "]"}], "-", "lastCheckpoint"}], 
               ",", "\"\<s\>\""}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Export", "[", 
            RowBox[{"outputFile", ",", "u", ",", 
             RowBox[{"{", 
              RowBox[{"\"\<Datasets\>\"", ",", 
               RowBox[{"IntegerString", "[", 
                RowBox[{"i", ",", "10", ",", "10"}], "]"}]}], "}"}], ",", 
             RowBox[{"OverwriteTarget", "\[Rule]", "\"\<Append\>\""}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"lastCheckpoint", "=", 
            RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"u", "=", 
         RowBox[{"multistep", "[", 
          RowBox[{"u", ",", 
           RowBox[{"TargetDevice", "\[Rule]", "DEVICE"}]}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "numSteps", ",", "EXECUTIONSTEPS"}], 
        "}"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Finished in \>\"", ",", 
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"AbsoluteTime", "[", "]"}], "-", "start"}], ",", 
         "\"\<s\>\""}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"SimulationLoad", "@", "outputFile"}]}]}], "\[IndentingNewLine]",
    "]"}]}]}], "Input",
 CellChangeTimes->{{3.8424240724183197`*^9, 3.8424240785944185`*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"c57267fa-f9b9-41ea-9305-82240b815220"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Runs", "Section",
 CellChangeTimes->{{3.8245625218056993`*^9, 
  3.8245625221528254`*^9}},ExpressionUUID->"8920c554-ed25-4076-8d68-\
a9b83526b532"],

Cell[BoxData[
 RowBox[{"VortexSize", "@", "Type1Vortex"}]], "Input",
 CellChangeTimes->{3.8419053789489813`*^9},
 CellLabel->"In[84]:=",ExpressionUUID->"00e0c70d-67e4-433e-9df2-c052178444f2"],

Cell[CellGroupData[{

Cell["Type 1", "Subsection",
 CellChangeTimes->{{3.8245625241702843`*^9, 3.824562527027708*^9}, {
  3.8245785905774317`*^9, 
  3.824578592618604*^9}},ExpressionUUID->"c05b1918-5b5c-4982-88e7-\
cdf43776b597"],

Cell[CellGroupData[{

Cell["No rotation parallel", "Subsubsection",
 CellChangeTimes->{{3.8245786100769663`*^9, 3.824578611646942*^9}, 
   3.82457887558888*^9, {3.824752762531498*^9, 3.82475277150473*^9}, {
   3.8247528052552147`*^9, 
   3.824752805673813*^9}},ExpressionUUID->"335a2716-9c41-4d66-b36f-\
0672f5c68c21"],

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"lX", ",", 
     RowBox[{"nX", "=", "101"}], ",", "lY", ",", 
     RowBox[{"nY", "=", "101"}], ",", "lZ", ",", 
     RowBox[{"nZ", "=", "101"}], ",", 
     RowBox[{"state", "=", "Type1Vortex"}], ",", "a", ",", 
     RowBox[{"\[Beta]", "=", "0.5"}], ",", 
     RowBox[{"v1", "=", "1"}], ",", 
     RowBox[{"\[Alpha]1", "=", "0."}], ",", 
     RowBox[{"\[Theta]1", "=", "0."}], ",", 
     RowBox[{"v2", "=", "1"}], ",", 
     RowBox[{"\[Alpha]2", "=", "0."}], ",", 
     RowBox[{"\[Theta]2", "=", "0."}], ",", "\[IndentingNewLine]", "seed", 
     ",", 
     RowBox[{"kerOrder", "=", "2"}], ",", 
     RowBox[{"dt", "=", ".001"}], ",", 
     RowBox[{"numSteps", "=", "40000"}], ",", 
     RowBox[{"checkpointInterval", "=", "100"}], ",", "\[IndentingNewLine]", 
     RowBox[{"filename", "=", "\"\<type1_norot_parallel_101\>\""}], ",", 
     "simulation", ",", "videoPhi", ",", "videoChi"}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lX", ",", "lY", ",", "lZ", ",", "a"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "3"}], "}"}], 
      RowBox[{"VortexSize", "@", "state"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"seed", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BiStringSeed", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
       RowBox[{"a", ",", "\[Beta]", ",", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "\[Alpha]1", ",", "\[Theta]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "\[Alpha]2", ",", "\[Theta]2"}], "}"}]}], "]"}], 
      "@", "state"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"simulation", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"RK4", "[", 
        RowBox[{"kerOrder", ",", "kerOrder", ",", "kerOrder"}], "]"}], "[", 
       RowBox[{"dt", ",", "numSteps", ",", "checkpointInterval"}], "]"}], "[", 
      RowBox[{"seed", ",", 
       RowBox[{"filename", "<>", "\"\<.h5\>\""}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"videoPhi", "=", 
     RowBox[{
      RowBox[{"MakeVideo", "[", "\[Phi]\[Chi]Plot", "]"}], "@", 
      "simulation"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"filename", "<>", "\"\<_phi.mp4\>\""}], ",", 
      RowBox[{"Video", "@", "videoPhi"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8008655175234547`*^9, 3.800865572441064*^9}, {
   3.800865655532649*^9, 3.800865664939019*^9}, {3.8008659126390123`*^9, 
   3.800865913900205*^9}, {3.800866180026248*^9, 3.8008661965193157`*^9}, {
   3.8008666616079464`*^9, 3.8008666619599876`*^9}, {3.800866702477378*^9, 
   3.800866725882569*^9}, {3.8008669928542557`*^9, 3.8008669946932564`*^9}, {
   3.800871890116412*^9, 3.8008719064843993`*^9}, {3.8008817692973204`*^9, 
   3.8008817867823486`*^9}, {3.800885598627492*^9, 3.800885628927495*^9}, {
   3.800885661093522*^9, 3.8008856663045225`*^9}, {3.8008859903423786`*^9, 
   3.8008859971363797`*^9}, {3.800886077186352*^9, 3.8008860784143486`*^9}, {
   3.8008862149615173`*^9, 3.8008862264630585`*^9}, {3.801374601635149*^9, 
   3.8013746104866834`*^9}, {3.8013746552042212`*^9, 3.801374655250216*^9}, {
   3.801374723585723*^9, 3.8013747368168364`*^9}, {3.8013759804885597`*^9, 
   3.8013759859298277`*^9}, {3.8013760225995626`*^9, 
   3.8013760482444105`*^9}, {3.8014551122863717`*^9, 3.801455113964009*^9}, {
   3.80145522148755*^9, 3.801455224260547*^9}, {3.801455454684285*^9, 
   3.8014554560818157`*^9}, {3.8014578669779243`*^9, 3.801457869986229*^9}, {
   3.801461650966761*^9, 3.8014616533797665`*^9}, 3.8020023787728558`*^9, 
   3.8020040351479917`*^9, {3.8027521942173414`*^9, 3.802752195456332*^9}, 
   3.804224177291499*^9, {3.804398721343706*^9, 3.80439872283424*^9}, {
   3.8073380130941696`*^9, 3.807338013300682*^9}, {3.809177239744445*^9, 
   3.8091772612784185`*^9}, {3.8092381709472494`*^9, 3.809238174449216*^9}, {
   3.8092383956506824`*^9, 3.809238407328707*^9}, {3.8092384453792825`*^9, 
   3.8092384546432247`*^9}, {3.80931912183934*^9, 3.8093191602498507`*^9}, {
   3.809319193193473*^9, 3.8093191936535845`*^9}, {3.80931951881666*^9, 
   3.809319523819171*^9}, {3.8206398062301455`*^9, 3.8206398074394927`*^9}, {
   3.820639869225546*^9, 3.820639870293442*^9}, {3.8239291802728786`*^9, 
   3.8239291803822155`*^9}, {3.8241831648149033`*^9, 3.824183175809044*^9}, {
   3.8241834414068575`*^9, 3.82418345273517*^9}, {3.824183597709011*^9, 
   3.824183645573535*^9}, {3.8241839855419664`*^9, 3.8241840529478545`*^9}, {
   3.824184167488969*^9, 3.824184182364702*^9}, {3.824184301263216*^9, 
   3.82418430479608*^9}, {3.8241844969721727`*^9, 3.8241844977567787`*^9}, {
   3.8241845322263722`*^9, 3.8241845359960938`*^9}, {3.824184575504114*^9, 
   3.824184579622549*^9}, {3.8241852377228055`*^9, 3.824185239209339*^9}, {
   3.824185282567751*^9, 3.824185283561133*^9}, {3.8241854932111673`*^9, 
   3.8241854953488283`*^9}, {3.824198492256491*^9, 3.8241984972746563`*^9}, {
   3.824203272150124*^9, 3.8242032934353576`*^9}, {3.8242064952047157`*^9, 
   3.824206499301737*^9}, {3.824230765612233*^9, 3.8242307657535734`*^9}, {
   3.8242313205108147`*^9, 3.8242313264191475`*^9}, {3.8242719659124117`*^9, 
   3.824271967209079*^9}, 3.824309689093691*^9, 3.824562549001395*^9, {
   3.8245626600711117`*^9, 3.8245626617047606`*^9}, {3.824562887053009*^9, 
   3.8245628916064787`*^9}, {3.824563342059928*^9, 3.824563374691862*^9}, {
   3.824566225981886*^9, 3.8245662538834257`*^9}, {3.824566428403637*^9, 
   3.8245664298790765`*^9}, {3.8245786137096996`*^9, 3.82457890531155*^9}, {
   3.8246180375292625`*^9, 3.8246180395787134`*^9}, {3.8247528099656897`*^9, 
   3.82475281784761*^9}, {3.82489107437361*^9, 3.824891074515231*^9}, {
   3.8250077846955523`*^9, 3.825007787103342*^9}, {3.8251368800986166`*^9, 
   3.825136900391225*^9}, {3.825137497178655*^9, 3.8251375000399942`*^9}, 
   3.825140817227046*^9},
 CellLabel->"In[82]:=",ExpressionUUID->"3bd9be92-f349-4fa9-8d9e-3331fcb9903e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["No rotation antiparallel", "Subsubsection",
 CellChangeTimes->{{3.8245786100769663`*^9, 3.824578611646942*^9}, 
   3.82457887558888*^9, {3.824752762531498*^9, 
   3.82475277150473*^9}},ExpressionUUID->"a5d1f054-a064-4bce-944c-\
4029a9c42fcf"],

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"lX", ",", 
     RowBox[{"nX", "=", "101"}], ",", "lY", ",", 
     RowBox[{"nY", "=", "101"}], ",", "lZ", ",", 
     RowBox[{"nZ", "=", "101"}], ",", 
     RowBox[{"state", "=", "Type1Vortex"}], ",", "a", ",", 
     RowBox[{"\[Beta]", "=", "0.5"}], ",", 
     RowBox[{"v1", "=", "1"}], ",", 
     RowBox[{"\[Alpha]1", "=", "0."}], ",", 
     RowBox[{"\[Theta]1", "=", "0."}], ",", 
     RowBox[{"v2", "=", "1"}], ",", 
     RowBox[{"\[Alpha]2", "=", 
      RowBox[{"N", "@", "\[Pi]"}]}], ",", 
     RowBox[{"\[Theta]2", "=", "0."}], ",", "\[IndentingNewLine]", "seed", 
     ",", 
     RowBox[{"kerOrder", "=", "2"}], ",", 
     RowBox[{"dt", "=", ".001"}], ",", 
     RowBox[{"numSteps", "=", "40000"}], ",", 
     RowBox[{"checkpointInterval", "=", "100"}], ",", "\[IndentingNewLine]", 
     RowBox[{"filename", "=", "\"\<type1_norot_antiparallel_101\>\""}], ",", 
     "simulation", ",", "videoPhi", ",", "videoChi"}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lX", ",", "lY", ",", "lZ", ",", "a"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "3"}], "}"}], 
      RowBox[{"VortexSize", "@", "state"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"seed", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BiStringSeed", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
       RowBox[{"a", ",", "\[Beta]", ",", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "\[Alpha]1", ",", "\[Theta]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "\[Alpha]2", ",", "\[Theta]2"}], "}"}]}], "]"}], 
      "@", "state"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"simulation", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"RK4", "[", 
        RowBox[{"kerOrder", ",", "kerOrder", ",", "kerOrder"}], "]"}], "[", 
       RowBox[{"dt", ",", "numSteps", ",", "checkpointInterval"}], "]"}], "[", 
      RowBox[{"seed", ",", 
       RowBox[{"filename", "<>", "\"\<.h5\>\""}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"videoPhi", "=", 
     RowBox[{
      RowBox[{"MakeVideo", "[", "\[Phi]\[Chi]Plot", "]"}], "@", 
      "simulation"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"filename", "<>", "\"\<_phi.mp4\>\""}], ",", 
      RowBox[{"Video", "@", "videoPhi"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8008655175234547`*^9, 3.800865572441064*^9}, {
   3.800865655532649*^9, 3.800865664939019*^9}, {3.8008659126390123`*^9, 
   3.800865913900205*^9}, {3.800866180026248*^9, 3.8008661965193157`*^9}, {
   3.8008666616079464`*^9, 3.8008666619599876`*^9}, {3.800866702477378*^9, 
   3.800866725882569*^9}, {3.8008669928542557`*^9, 3.8008669946932564`*^9}, {
   3.800871890116412*^9, 3.8008719064843993`*^9}, {3.8008817692973204`*^9, 
   3.8008817867823486`*^9}, {3.800885598627492*^9, 3.800885628927495*^9}, {
   3.800885661093522*^9, 3.8008856663045225`*^9}, {3.8008859903423786`*^9, 
   3.8008859971363797`*^9}, {3.800886077186352*^9, 3.8008860784143486`*^9}, {
   3.8008862149615173`*^9, 3.8008862264630585`*^9}, {3.801374601635149*^9, 
   3.8013746104866834`*^9}, {3.8013746552042212`*^9, 3.801374655250216*^9}, {
   3.801374723585723*^9, 3.8013747368168364`*^9}, {3.8013759804885597`*^9, 
   3.8013759859298277`*^9}, {3.8013760225995626`*^9, 
   3.8013760482444105`*^9}, {3.8014551122863717`*^9, 3.801455113964009*^9}, {
   3.80145522148755*^9, 3.801455224260547*^9}, {3.801455454684285*^9, 
   3.8014554560818157`*^9}, {3.8014578669779243`*^9, 3.801457869986229*^9}, {
   3.801461650966761*^9, 3.8014616533797665`*^9}, 3.8020023787728558`*^9, 
   3.8020040351479917`*^9, {3.8027521942173414`*^9, 3.802752195456332*^9}, 
   3.804224177291499*^9, {3.804398721343706*^9, 3.80439872283424*^9}, {
   3.8073380130941696`*^9, 3.807338013300682*^9}, {3.809177239744445*^9, 
   3.8091772612784185`*^9}, {3.8092381709472494`*^9, 3.809238174449216*^9}, {
   3.8092383956506824`*^9, 3.809238407328707*^9}, {3.8092384453792825`*^9, 
   3.8092384546432247`*^9}, {3.80931912183934*^9, 3.8093191602498507`*^9}, {
   3.809319193193473*^9, 3.8093191936535845`*^9}, {3.80931951881666*^9, 
   3.809319523819171*^9}, {3.8206398062301455`*^9, 3.8206398074394927`*^9}, {
   3.820639869225546*^9, 3.820639870293442*^9}, {3.8239291802728786`*^9, 
   3.8239291803822155`*^9}, {3.8241831648149033`*^9, 3.824183175809044*^9}, {
   3.8241834414068575`*^9, 3.82418345273517*^9}, {3.824183597709011*^9, 
   3.824183645573535*^9}, {3.8241839855419664`*^9, 3.8241840529478545`*^9}, {
   3.824184167488969*^9, 3.824184182364702*^9}, {3.824184301263216*^9, 
   3.82418430479608*^9}, {3.8241844969721727`*^9, 3.8241844977567787`*^9}, {
   3.8241845322263722`*^9, 3.8241845359960938`*^9}, {3.824184575504114*^9, 
   3.824184579622549*^9}, {3.8241852377228055`*^9, 3.824185239209339*^9}, {
   3.824185282567751*^9, 3.824185283561133*^9}, {3.8241854932111673`*^9, 
   3.8241854953488283`*^9}, {3.824198492256491*^9, 3.8241984972746563`*^9}, {
   3.824203272150124*^9, 3.8242032934353576`*^9}, {3.8242064952047157`*^9, 
   3.824206499301737*^9}, {3.824230765612233*^9, 3.8242307657535734`*^9}, {
   3.8242313205108147`*^9, 3.8242313264191475`*^9}, {3.8242719659124117`*^9, 
   3.824271967209079*^9}, 3.824309689093691*^9, 3.824562549001395*^9, {
   3.8245626600711117`*^9, 3.8245626617047606`*^9}, {3.824562887053009*^9, 
   3.8245628916064787`*^9}, {3.824563342059928*^9, 3.824563374691862*^9}, {
   3.824566225981886*^9, 3.8245662538834257`*^9}, {3.824566428403637*^9, 
   3.8245664298790765`*^9}, {3.8245786137096996`*^9, 3.82457890531155*^9}, {
   3.8246180375292625`*^9, 3.8246180395787134`*^9}, {3.8247528310663123`*^9, 
   3.8247528503175898`*^9}, {3.8248910525162907`*^9, 3.824891052641543*^9}, {
   3.8250077659801064`*^9, 3.8250077692191954`*^9}, {3.825137639523538*^9, 
   3.8251376478919125`*^9}, {3.8251382541210575`*^9, 3.8251382568464465`*^9}, 
   3.8251408183465233`*^9},ExpressionUUID->"d43bf8f7-ac33-4061-aa30-\
272c6f3069f2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["No rotation orthogonal", "Subsubsection",
 CellChangeTimes->{{3.8245786100769663`*^9, 3.824578611646942*^9}, 
   3.82457887558888*^9, {3.824752762531498*^9, 3.82475277150473*^9}, {
   3.824752845734484*^9, 
   3.824752847001648*^9}},ExpressionUUID->"7b4c802a-78f7-4166-97f7-\
d0341bbbeb33"],

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"lX", ",", 
     RowBox[{"nX", "=", "101"}], ",", "lY", ",", 
     RowBox[{"nY", "=", "101"}], ",", "lZ", ",", 
     RowBox[{"nZ", "=", "101"}], ",", 
     RowBox[{"state", "=", "Type1Vortex"}], ",", "a", ",", 
     RowBox[{"\[Beta]", "=", "0.5"}], ",", 
     RowBox[{"v1", "=", "1"}], ",", 
     RowBox[{"\[Alpha]1", "=", "0."}], ",", 
     RowBox[{"\[Theta]1", "=", "0."}], ",", 
     RowBox[{"v2", "=", "1"}], ",", 
     RowBox[{"\[Alpha]2", "=", 
      FractionBox["\[Pi]", "2."]}], ",", 
     RowBox[{"\[Theta]2", "=", "0."}], ",", "\[IndentingNewLine]", "seed", 
     ",", 
     RowBox[{"kerOrder", "=", "2"}], ",", 
     RowBox[{"dt", "=", ".001"}], ",", 
     RowBox[{"numSteps", "=", "40000"}], ",", 
     RowBox[{"checkpointInterval", "=", "100"}], ",", "\[IndentingNewLine]", 
     RowBox[{"filename", "=", "\"\<type1_norot_orthogonal_101\>\""}], ",", 
     "simulation", ",", "videoPhi", ",", "videoChi"}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lX", ",", "lY", ",", "lZ", ",", "a"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "3"}], "}"}], 
      RowBox[{"VortexSize", "@", "state"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"seed", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BiStringSeed", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
       RowBox[{"a", ",", "\[Beta]", ",", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "\[Alpha]1", ",", "\[Theta]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "\[Alpha]2", ",", "\[Theta]2"}], "}"}]}], "]"}], 
      "@", "state"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"simulation", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"RK4", "[", 
        RowBox[{"kerOrder", ",", "kerOrder", ",", "kerOrder"}], "]"}], "[", 
       RowBox[{"dt", ",", "numSteps", ",", "checkpointInterval"}], "]"}], "[", 
      RowBox[{"seed", ",", 
       RowBox[{"filename", "<>", "\"\<.h5\>\""}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"videoPhi", "=", 
     RowBox[{
      RowBox[{"MakeVideo", "[", 
       RowBox[{"\[Phi]\[Chi]Plot", "[", 
        RowBox[{".75", ",", "True"}], "]"}], "]"}], "@", "simulation"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"filename", "<>", "\"\<_phi.mp4\>\""}], ",", 
      RowBox[{"Video", "@", "videoPhi"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8008655175234547`*^9, 3.800865572441064*^9}, {
   3.800865655532649*^9, 3.800865664939019*^9}, {3.8008659126390123`*^9, 
   3.800865913900205*^9}, {3.800866180026248*^9, 3.8008661965193157`*^9}, {
   3.8008666616079464`*^9, 3.8008666619599876`*^9}, {3.800866702477378*^9, 
   3.800866725882569*^9}, {3.8008669928542557`*^9, 3.8008669946932564`*^9}, {
   3.800871890116412*^9, 3.8008719064843993`*^9}, {3.8008817692973204`*^9, 
   3.8008817867823486`*^9}, {3.800885598627492*^9, 3.800885628927495*^9}, {
   3.800885661093522*^9, 3.8008856663045225`*^9}, {3.8008859903423786`*^9, 
   3.8008859971363797`*^9}, {3.800886077186352*^9, 3.8008860784143486`*^9}, {
   3.8008862149615173`*^9, 3.8008862264630585`*^9}, {3.801374601635149*^9, 
   3.8013746104866834`*^9}, {3.8013746552042212`*^9, 3.801374655250216*^9}, {
   3.801374723585723*^9, 3.8013747368168364`*^9}, {3.8013759804885597`*^9, 
   3.8013759859298277`*^9}, {3.8013760225995626`*^9, 
   3.8013760482444105`*^9}, {3.8014551122863717`*^9, 3.801455113964009*^9}, {
   3.80145522148755*^9, 3.801455224260547*^9}, {3.801455454684285*^9, 
   3.8014554560818157`*^9}, {3.8014578669779243`*^9, 3.801457869986229*^9}, {
   3.801461650966761*^9, 3.8014616533797665`*^9}, 3.8020023787728558`*^9, 
   3.8020040351479917`*^9, {3.8027521942173414`*^9, 3.802752195456332*^9}, 
   3.804224177291499*^9, {3.804398721343706*^9, 3.80439872283424*^9}, {
   3.8073380130941696`*^9, 3.807338013300682*^9}, {3.809177239744445*^9, 
   3.8091772612784185`*^9}, {3.8092381709472494`*^9, 3.809238174449216*^9}, {
   3.8092383956506824`*^9, 3.809238407328707*^9}, {3.8092384453792825`*^9, 
   3.8092384546432247`*^9}, {3.80931912183934*^9, 3.8093191602498507`*^9}, {
   3.809319193193473*^9, 3.8093191936535845`*^9}, {3.80931951881666*^9, 
   3.809319523819171*^9}, {3.8206398062301455`*^9, 3.8206398074394927`*^9}, {
   3.820639869225546*^9, 3.820639870293442*^9}, {3.8239291802728786`*^9, 
   3.8239291803822155`*^9}, {3.8241831648149033`*^9, 3.824183175809044*^9}, {
   3.8241834414068575`*^9, 3.82418345273517*^9}, {3.824183597709011*^9, 
   3.824183645573535*^9}, {3.8241839855419664`*^9, 3.8241840529478545`*^9}, {
   3.824184167488969*^9, 3.824184182364702*^9}, {3.824184301263216*^9, 
   3.82418430479608*^9}, {3.8241844969721727`*^9, 3.8241844977567787`*^9}, {
   3.8241845322263722`*^9, 3.8241845359960938`*^9}, {3.824184575504114*^9, 
   3.824184579622549*^9}, {3.8241852377228055`*^9, 3.824185239209339*^9}, {
   3.824185282567751*^9, 3.824185283561133*^9}, {3.8241854932111673`*^9, 
   3.8241854953488283`*^9}, {3.824198492256491*^9, 3.8241984972746563`*^9}, {
   3.824203272150124*^9, 3.8242032934353576`*^9}, {3.8242064952047157`*^9, 
   3.824206499301737*^9}, {3.824230765612233*^9, 3.8242307657535734`*^9}, {
   3.8242313205108147`*^9, 3.8242313264191475`*^9}, {3.8242719659124117`*^9, 
   3.824271967209079*^9}, 3.824309689093691*^9, 3.824562549001395*^9, {
   3.8245626600711117`*^9, 3.8245626617047606`*^9}, {3.824562887053009*^9, 
   3.8245628916064787`*^9}, {3.824563342059928*^9, 3.824563374691862*^9}, {
   3.824566225981886*^9, 3.8245662538834257`*^9}, {3.824566428403637*^9, 
   3.8245664298790765`*^9}, {3.8245786137096996`*^9, 3.82457890531155*^9}, {
   3.8246180375292625`*^9, 3.8246180395787134`*^9}, {3.8247528310663123`*^9, 
   3.8247528746308713`*^9}, {3.8248910150251193`*^9, 3.824891015134577*^9}, {
   3.825007745224698*^9, 3.8250077478153253`*^9}, {3.825138268619187*^9, 
   3.825138274351777*^9}, {3.8251388681673965`*^9, 3.8251388704814*^9}, 
   3.825140819660021*^9},ExpressionUUID->"adf5ada1-5810-45df-a2aa-\
626e7400b849"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Rotating ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Nu]", "=", "1"}], TraditionalForm]],ExpressionUUID->
  "adb22f53-d341-4a72-8431-03b5e361a793"]
}], "Subsubsection",
 CellChangeTimes->{{3.8245786100769663`*^9, 3.824578611646942*^9}, 
   3.82457887558888*^9, {3.8303312378528924`*^9, 3.8303312551575317`*^9}, {
   3.8303313136924157`*^9, 3.83033131697615*^9}, {3.830346727301775*^9, 
   3.830346744453307*^9}},ExpressionUUID->"24109c74-cbe7-42c1-8d35-\
53d2a5b88e73"],

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"lX", ",", 
     RowBox[{"nX", "=", "101"}], ",", "lY", ",", 
     RowBox[{"nY", "=", "101"}], ",", "lZ", ",", 
     RowBox[{"nZ", "=", "101"}], ",", 
     RowBox[{"state", "=", "Type1Vortex"}], ",", "a", ",", 
     RowBox[{"\[Beta]", "=", "0.5"}], ",", 
     RowBox[{"v1", "=", "1"}], ",", 
     RowBox[{"\[Alpha]1", "=", "0."}], ",", 
     RowBox[{"\[Theta]1", "=", "0."}], ",", 
     RowBox[{"v2", "=", "1"}], ",", 
     RowBox[{"\[Alpha]2", "=", "0."}], ",", 
     RowBox[{"\[Theta]2", "=", 
      RowBox[{"\[Pi]", "/", "2."}]}], ",", 
     RowBox[{"\[Nu]1", "=", "1."}], ",", 
     RowBox[{"\[Nu]2", "=", "1."}], ",", "\[IndentingNewLine]", "seed", ",", 
     RowBox[{"kerOrder", "=", "2"}], ",", 
     RowBox[{"dt", "=", ".001"}], ",", 
     RowBox[{"numSteps", "=", "40000"}], ",", 
     RowBox[{"checkpointInterval", "=", "100"}], ",", "\[IndentingNewLine]", 
     RowBox[{"filename", "=", "\"\<type1_rotating_p1.0_p1.0_101\>\""}], ",", 
     "simulation", ",", "videoPhi", ",", "videoChi"}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lX", ",", "lY", ",", "lZ", ",", "a"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "3"}], "}"}], 
      RowBox[{"VortexSize", "@", "state"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"seed", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BiStringSeed", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "\[Alpha]1", ",", 
          FractionBox["\[Pi]", "2."], ",", "\[Nu]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "\[Alpha]2", ",", 
          FractionBox["\[Pi]", "2."], ",", "\[Nu]2"}], "}"}], ",", "a", ",", 
        "\[Beta]", ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}]}], "]"}], "@", 
      "state"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"simulation", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"RK4", "[", 
        RowBox[{"kerOrder", ",", "kerOrder", ",", "kerOrder"}], "]"}], "[", 
       RowBox[{"dt", ",", "numSteps", ",", "checkpointInterval"}], "]"}], "[", 
      RowBox[{"seed", ",", 
       RowBox[{"filename", "<>", "\"\<.h5\>\""}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"videoPhi", "=", 
     RowBox[{
      RowBox[{"MakeVideo", "[", 
       RowBox[{"\[Phi]\[Chi]Plot", "[", 
        RowBox[{".75", ",", "False", ",", "True"}], "]"}], "]"}], "@", 
      "simulation"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"filename", "<>", "\"\<.mp4\>\""}], ",", 
      RowBox[{"Video", "@", "videoPhi"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8008655175234547`*^9, 3.800865572441064*^9}, {
   3.800865655532649*^9, 3.800865664939019*^9}, {3.8008659126390123`*^9, 
   3.800865913900205*^9}, {3.800866180026248*^9, 3.8008661965193157`*^9}, {
   3.8008666616079464`*^9, 3.8008666619599876`*^9}, {3.800866702477378*^9, 
   3.800866725882569*^9}, {3.8008669928542557`*^9, 3.8008669946932564`*^9}, {
   3.800871890116412*^9, 3.8008719064843993`*^9}, {3.8008817692973204`*^9, 
   3.8008817867823486`*^9}, {3.800885598627492*^9, 3.800885628927495*^9}, {
   3.800885661093522*^9, 3.8008856663045225`*^9}, {3.8008859903423786`*^9, 
   3.8008859971363797`*^9}, {3.800886077186352*^9, 3.8008860784143486`*^9}, {
   3.8008862149615173`*^9, 3.8008862264630585`*^9}, {3.801374601635149*^9, 
   3.8013746104866834`*^9}, {3.8013746552042212`*^9, 3.801374655250216*^9}, {
   3.801374723585723*^9, 3.8013747368168364`*^9}, {3.8013759804885597`*^9, 
   3.8013759859298277`*^9}, {3.8013760225995626`*^9, 
   3.8013760482444105`*^9}, {3.8014551122863717`*^9, 3.801455113964009*^9}, {
   3.80145522148755*^9, 3.801455224260547*^9}, {3.801455454684285*^9, 
   3.8014554560818157`*^9}, {3.8014578669779243`*^9, 3.801457869986229*^9}, {
   3.801461650966761*^9, 3.8014616533797665`*^9}, 3.8020023787728558`*^9, 
   3.8020040351479917`*^9, {3.8027521942173414`*^9, 3.802752195456332*^9}, 
   3.804224177291499*^9, {3.804398721343706*^9, 3.80439872283424*^9}, {
   3.8073380130941696`*^9, 3.807338013300682*^9}, {3.809177239744445*^9, 
   3.8091772612784185`*^9}, {3.8092381709472494`*^9, 3.809238174449216*^9}, {
   3.8092383956506824`*^9, 3.809238407328707*^9}, {3.8092384453792825`*^9, 
   3.8092384546432247`*^9}, {3.80931912183934*^9, 3.8093191602498507`*^9}, {
   3.809319193193473*^9, 3.8093191936535845`*^9}, {3.80931951881666*^9, 
   3.809319523819171*^9}, {3.8206398062301455`*^9, 3.8206398074394927`*^9}, {
   3.820639869225546*^9, 3.820639870293442*^9}, {3.8239291802728786`*^9, 
   3.8239291803822155`*^9}, {3.8241831648149033`*^9, 3.824183175809044*^9}, {
   3.8241834414068575`*^9, 3.82418345273517*^9}, {3.824183597709011*^9, 
   3.824183645573535*^9}, {3.8241839855419664`*^9, 3.8241840529478545`*^9}, {
   3.824184167488969*^9, 3.824184182364702*^9}, {3.824184301263216*^9, 
   3.82418430479608*^9}, {3.8241844969721727`*^9, 3.8241844977567787`*^9}, {
   3.8241845322263722`*^9, 3.8241845359960938`*^9}, {3.824184575504114*^9, 
   3.824184579622549*^9}, {3.8241852377228055`*^9, 3.824185239209339*^9}, {
   3.824185282567751*^9, 3.824185283561133*^9}, {3.8241854932111673`*^9, 
   3.8241854953488283`*^9}, {3.824198492256491*^9, 3.8241984972746563`*^9}, {
   3.824203272150124*^9, 3.8242032934353576`*^9}, {3.8242064952047157`*^9, 
   3.824206499301737*^9}, {3.824230765612233*^9, 3.8242307657535734`*^9}, {
   3.8242313205108147`*^9, 3.8242313264191475`*^9}, {3.8242719659124117`*^9, 
   3.824271967209079*^9}, 3.824309689093691*^9, 3.824562549001395*^9, {
   3.8245626600711117`*^9, 3.8245626617047606`*^9}, {3.824562887053009*^9, 
   3.8245628916064787`*^9}, {3.824563342059928*^9, 3.824563374691862*^9}, {
   3.824566225981886*^9, 3.8245662538834257`*^9}, {3.824566428403637*^9, 
   3.8245664298790765`*^9}, {3.8245786137096996`*^9, 3.82457890531155*^9}, {
   3.8246180375292625`*^9, 3.8246180395787134`*^9}, {3.825007713187192*^9, 
   3.825007716407056*^9}, {3.8251388833793783`*^9, 3.8251388937044554`*^9}, {
   3.8251396579194775`*^9, 3.8251396608811035`*^9}, 3.825140821148675*^9, {
   3.8254135800344915`*^9, 3.8254135802423563`*^9}, {3.8303312500921955`*^9, 
   3.830331407706549*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"c14df63e-2056-4b7c-a8f3-d6f0ccf4b74d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Parallel", "Subsubsection",
 CellChangeTimes->{{3.8245786100769663`*^9, 3.824578611646942*^9}, 
   3.82457887558888*^9},ExpressionUUID->"3b1ff988-cfcc-4872-ae1e-\
b5db07f51e99"],

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"lX", ",", 
     RowBox[{"nX", "=", "101"}], ",", "lY", ",", 
     RowBox[{"nY", "=", "101"}], ",", "lZ", ",", 
     RowBox[{"nZ", "=", "101"}], ",", 
     RowBox[{"state", "=", "Type1Vortex"}], ",", "a", ",", 
     RowBox[{"\[Beta]", "=", "0.5"}], ",", 
     RowBox[{"v1", "=", "1"}], ",", 
     RowBox[{"\[Alpha]1", "=", "0."}], ",", 
     RowBox[{"\[Theta]1", "=", "0."}], ",", 
     RowBox[{"v2", "=", "1"}], ",", 
     RowBox[{"\[Alpha]2", "=", "0."}], ",", 
     RowBox[{"\[Theta]2", "=", 
      RowBox[{"\[Pi]", "/", "2."}]}], ",", "\[IndentingNewLine]", "seed", ",", 
     RowBox[{"kerOrder", "=", "2"}], ",", 
     RowBox[{"dt", "=", ".001"}], ",", 
     RowBox[{"numSteps", "=", "40000"}], ",", 
     RowBox[{"checkpointInterval", "=", "100"}], ",", "\[IndentingNewLine]", 
     RowBox[{"filename", "=", "\"\<type1_parallel_101\>\""}], ",", 
     "simulation", ",", "videoPhi", ",", "videoChi"}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lX", ",", "lY", ",", "lZ", ",", "a"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "3"}], "}"}], 
      RowBox[{"VortexSize", "@", "state"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"seed", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BiStringSeed", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
       RowBox[{"a", ",", "\[Beta]", ",", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "\[Alpha]1", ",", "\[Theta]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "\[Alpha]2", ",", "\[Theta]2"}], "}"}]}], "]"}], 
      "@", "state"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"simulation", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"RK4", "[", 
        RowBox[{"kerOrder", ",", "kerOrder", ",", "kerOrder"}], "]"}], "[", 
       RowBox[{"dt", ",", "numSteps", ",", "checkpointInterval"}], "]"}], "[", 
      RowBox[{"seed", ",", 
       RowBox[{"filename", "<>", "\"\<.h5\>\""}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"videoPhi", "=", 
     RowBox[{
      RowBox[{"MakeVideo", "[", "\[Phi]\[Chi]Plot", "]"}], "@", 
      "simulation"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"filename", "<>", "\"\<_phi.mp4\>\""}], ",", 
      RowBox[{"Video", "@", "videoPhi"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8008655175234547`*^9, 3.800865572441064*^9}, {
   3.800865655532649*^9, 3.800865664939019*^9}, {3.8008659126390123`*^9, 
   3.800865913900205*^9}, {3.800866180026248*^9, 3.8008661965193157`*^9}, {
   3.8008666616079464`*^9, 3.8008666619599876`*^9}, {3.800866702477378*^9, 
   3.800866725882569*^9}, {3.8008669928542557`*^9, 3.8008669946932564`*^9}, {
   3.800871890116412*^9, 3.8008719064843993`*^9}, {3.8008817692973204`*^9, 
   3.8008817867823486`*^9}, {3.800885598627492*^9, 3.800885628927495*^9}, {
   3.800885661093522*^9, 3.8008856663045225`*^9}, {3.8008859903423786`*^9, 
   3.8008859971363797`*^9}, {3.800886077186352*^9, 3.8008860784143486`*^9}, {
   3.8008862149615173`*^9, 3.8008862264630585`*^9}, {3.801374601635149*^9, 
   3.8013746104866834`*^9}, {3.8013746552042212`*^9, 3.801374655250216*^9}, {
   3.801374723585723*^9, 3.8013747368168364`*^9}, {3.8013759804885597`*^9, 
   3.8013759859298277`*^9}, {3.8013760225995626`*^9, 
   3.8013760482444105`*^9}, {3.8014551122863717`*^9, 3.801455113964009*^9}, {
   3.80145522148755*^9, 3.801455224260547*^9}, {3.801455454684285*^9, 
   3.8014554560818157`*^9}, {3.8014578669779243`*^9, 3.801457869986229*^9}, {
   3.801461650966761*^9, 3.8014616533797665`*^9}, 3.8020023787728558`*^9, 
   3.8020040351479917`*^9, {3.8027521942173414`*^9, 3.802752195456332*^9}, 
   3.804224177291499*^9, {3.804398721343706*^9, 3.80439872283424*^9}, {
   3.8073380130941696`*^9, 3.807338013300682*^9}, {3.809177239744445*^9, 
   3.8091772612784185`*^9}, {3.8092381709472494`*^9, 3.809238174449216*^9}, {
   3.8092383956506824`*^9, 3.809238407328707*^9}, {3.8092384453792825`*^9, 
   3.8092384546432247`*^9}, {3.80931912183934*^9, 3.8093191602498507`*^9}, {
   3.809319193193473*^9, 3.8093191936535845`*^9}, {3.80931951881666*^9, 
   3.809319523819171*^9}, {3.8206398062301455`*^9, 3.8206398074394927`*^9}, {
   3.820639869225546*^9, 3.820639870293442*^9}, {3.8239291802728786`*^9, 
   3.8239291803822155`*^9}, {3.8241831648149033`*^9, 3.824183175809044*^9}, {
   3.8241834414068575`*^9, 3.82418345273517*^9}, {3.824183597709011*^9, 
   3.824183645573535*^9}, {3.8241839855419664`*^9, 3.8241840529478545`*^9}, {
   3.824184167488969*^9, 3.824184182364702*^9}, {3.824184301263216*^9, 
   3.82418430479608*^9}, {3.8241844969721727`*^9, 3.8241844977567787`*^9}, {
   3.8241845322263722`*^9, 3.8241845359960938`*^9}, {3.824184575504114*^9, 
   3.824184579622549*^9}, {3.8241852377228055`*^9, 3.824185239209339*^9}, {
   3.824185282567751*^9, 3.824185283561133*^9}, {3.8241854932111673`*^9, 
   3.8241854953488283`*^9}, {3.824198492256491*^9, 3.8241984972746563`*^9}, {
   3.824203272150124*^9, 3.8242032934353576`*^9}, {3.8242064952047157`*^9, 
   3.824206499301737*^9}, {3.824230765612233*^9, 3.8242307657535734`*^9}, {
   3.8242313205108147`*^9, 3.8242313264191475`*^9}, {3.8242719659124117`*^9, 
   3.824271967209079*^9}, 3.824309689093691*^9, 3.824562549001395*^9, {
   3.8245626600711117`*^9, 3.8245626617047606`*^9}, {3.824562887053009*^9, 
   3.8245628916064787`*^9}, {3.824563342059928*^9, 3.824563374691862*^9}, {
   3.824566225981886*^9, 3.8245662538834257`*^9}, {3.824566428403637*^9, 
   3.8245664298790765`*^9}, {3.8245786137096996`*^9, 3.82457890531155*^9}, {
   3.8246180375292625`*^9, 3.8246180395787134`*^9}, {3.825007713187192*^9, 
   3.825007716407056*^9}, {3.8251388833793783`*^9, 3.8251388937044554`*^9}, {
   3.8251396579194775`*^9, 3.8251396608811035`*^9}, 3.825140821148675*^9, {
   3.8254135800344915`*^9, 
   3.8254135802423563`*^9}},ExpressionUUID->"4488574f-6738-48bb-8cba-\
4d303f049927"]
}, Closed]],

Cell[CellGroupData[{

Cell["Antiparallel", "Subsubsection",
 CellChangeTimes->{{3.8245786100769663`*^9, 
  3.824578611646942*^9}},ExpressionUUID->"b00f8e0a-bb43-4900-b1a8-\
ae0fd9d1dfb7"],

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"lX", ",", 
     RowBox[{"nX", "=", "101"}], ",", "lY", ",", 
     RowBox[{"nY", "=", "101"}], ",", "lZ", ",", 
     RowBox[{"nZ", "=", "101"}], ",", 
     RowBox[{"state", "=", "Type1Vortex"}], ",", "a", ",", 
     RowBox[{"\[Beta]", "=", "0.5"}], ",", 
     RowBox[{"v1", "=", "1"}], ",", 
     RowBox[{"\[Alpha]1", "=", "0."}], ",", 
     RowBox[{"\[Theta]1", "=", "0."}], ",", 
     RowBox[{"v2", "=", "1"}], ",", 
     RowBox[{"\[Alpha]2", "=", 
      RowBox[{"N", "@", "\[Pi]"}]}], ",", 
     RowBox[{"\[Theta]2", "=", 
      FractionBox["\[Pi]", "2."]}], ",", "\[IndentingNewLine]", "seed", ",", 
     RowBox[{"kerOrder", "=", "2"}], ",", 
     RowBox[{"dt", "=", ".001"}], ",", 
     RowBox[{"numSteps", "=", "40000"}], ",", 
     RowBox[{"checkpointInterval", "=", "100"}], ",", "\[IndentingNewLine]", 
     RowBox[{"filename", "=", "\"\<type1_antiparallel_101\>\""}], ",", 
     "simulation", ",", "videoPhi", ",", "videoChi"}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lX", ",", "lY", ",", "lZ", ",", "a"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "3"}], "}"}], 
      RowBox[{"VortexSize", "@", "state"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"seed", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BiStringSeed", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
       RowBox[{"a", ",", "\[Beta]", ",", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "\[Alpha]1", ",", "\[Theta]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "\[Alpha]2", ",", "\[Theta]2"}], "}"}]}], "]"}], 
      "@", "state"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"simulation", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"RK4", "[", 
        RowBox[{"kerOrder", ",", "kerOrder", ",", "kerOrder"}], "]"}], "[", 
       RowBox[{"dt", ",", "numSteps", ",", "checkpointInterval"}], "]"}], "[", 
      RowBox[{"seed", ",", 
       RowBox[{"filename", "<>", "\"\<.h5\>\""}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"videoPhi", "=", 
     RowBox[{
      RowBox[{"MakeVideo", "[", "\[Phi]\[Chi]Plot", "]"}], "@", 
      "simulation"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"filename", "<>", "\"\<_phi.mp4\>\""}], ",", 
      RowBox[{"Video", "@", "videoPhi"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8008655175234547`*^9, 3.800865572441064*^9}, {
   3.800865655532649*^9, 3.800865664939019*^9}, {3.8008659126390123`*^9, 
   3.800865913900205*^9}, {3.800866180026248*^9, 3.8008661965193157`*^9}, {
   3.8008666616079464`*^9, 3.8008666619599876`*^9}, {3.800866702477378*^9, 
   3.800866725882569*^9}, {3.8008669928542557`*^9, 3.8008669946932564`*^9}, {
   3.800871890116412*^9, 3.8008719064843993`*^9}, {3.8008817692973204`*^9, 
   3.8008817867823486`*^9}, {3.800885598627492*^9, 3.800885628927495*^9}, {
   3.800885661093522*^9, 3.8008856663045225`*^9}, {3.8008859903423786`*^9, 
   3.8008859971363797`*^9}, {3.800886077186352*^9, 3.8008860784143486`*^9}, {
   3.8008862149615173`*^9, 3.8008862264630585`*^9}, {3.801374601635149*^9, 
   3.8013746104866834`*^9}, {3.8013746552042212`*^9, 3.801374655250216*^9}, {
   3.801374723585723*^9, 3.8013747368168364`*^9}, {3.8013759804885597`*^9, 
   3.8013759859298277`*^9}, {3.8013760225995626`*^9, 
   3.8013760482444105`*^9}, {3.8014551122863717`*^9, 3.801455113964009*^9}, {
   3.80145522148755*^9, 3.801455224260547*^9}, {3.801455454684285*^9, 
   3.8014554560818157`*^9}, {3.8014578669779243`*^9, 3.801457869986229*^9}, {
   3.801461650966761*^9, 3.8014616533797665`*^9}, 3.8020023787728558`*^9, 
   3.8020040351479917`*^9, {3.8027521942173414`*^9, 3.802752195456332*^9}, 
   3.804224177291499*^9, {3.804398721343706*^9, 3.80439872283424*^9}, {
   3.8073380130941696`*^9, 3.807338013300682*^9}, {3.809177239744445*^9, 
   3.8091772612784185`*^9}, {3.8092381709472494`*^9, 3.809238174449216*^9}, {
   3.8092383956506824`*^9, 3.809238407328707*^9}, {3.8092384453792825`*^9, 
   3.8092384546432247`*^9}, {3.80931912183934*^9, 3.8093191602498507`*^9}, {
   3.809319193193473*^9, 3.8093191936535845`*^9}, {3.80931951881666*^9, 
   3.809319523819171*^9}, {3.8206398062301455`*^9, 3.8206398074394927`*^9}, {
   3.820639869225546*^9, 3.820639870293442*^9}, {3.8239291802728786`*^9, 
   3.8239291803822155`*^9}, {3.8241831648149033`*^9, 3.824183175809044*^9}, {
   3.8241834414068575`*^9, 3.82418345273517*^9}, {3.824183597709011*^9, 
   3.824183645573535*^9}, {3.8241839855419664`*^9, 3.8241840529478545`*^9}, {
   3.824184167488969*^9, 3.824184182364702*^9}, {3.824184301263216*^9, 
   3.82418430479608*^9}, {3.8241844969721727`*^9, 3.8241844977567787`*^9}, {
   3.8241845322263722`*^9, 3.8241845359960938`*^9}, {3.824184575504114*^9, 
   3.824184579622549*^9}, {3.8241852377228055`*^9, 3.824185239209339*^9}, {
   3.824185282567751*^9, 3.824185283561133*^9}, {3.8241854932111673`*^9, 
   3.8241854953488283`*^9}, {3.824198492256491*^9, 3.8241984972746563`*^9}, {
   3.824203272150124*^9, 3.8242032934353576`*^9}, {3.8242064952047157`*^9, 
   3.824206499301737*^9}, {3.824230765612233*^9, 3.8242307657535734`*^9}, {
   3.8242313205108147`*^9, 3.8242313264191475`*^9}, {3.8242719659124117`*^9, 
   3.824271967209079*^9}, 3.824309689093691*^9, 3.824562549001395*^9, {
   3.8245626600711117`*^9, 3.8245626617047606`*^9}, {3.824562887053009*^9, 
   3.8245628916064787`*^9}, {3.824563342059928*^9, 3.824563374691862*^9}, {
   3.824566225981886*^9, 3.8245662538834257`*^9}, {3.824566428403637*^9, 
   3.8245664298790765`*^9}, {3.8245786137096996`*^9, 3.824578865727969*^9}, {
   3.824618056580138*^9, 3.8246180571426563`*^9}, {3.8248909607427697`*^9, 
   3.824890960883395*^9}, {3.825007648981662*^9, 3.825007652530813*^9}, {
   3.8251396716419916`*^9, 3.8251396776936517`*^9}, {3.8251408224304533`*^9, 
   3.8251408252134523`*^9}},ExpressionUUID->"ec47fa7c-24ff-4af3-b91e-\
57584e33945c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Orthogonal", "Subsubsection",
 CellChangeTimes->{{3.8245786100769663`*^9, 3.824578611646942*^9}, {
  3.8245788985777416`*^9, 
  3.8245788996312227`*^9}},ExpressionUUID->"db83e2c5-108d-46f9-a790-\
08e63378d03a"],

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"lX", ",", 
     RowBox[{"nX", "=", "101"}], ",", "lY", ",", 
     RowBox[{"nY", "=", "101"}], ",", "lZ", ",", 
     RowBox[{"nZ", "=", "101"}], ",", 
     RowBox[{"state", "=", "Type1Vortex"}], ",", "a", ",", 
     RowBox[{"\[Beta]", "=", "0.5"}], ",", 
     RowBox[{"v1", "=", "1"}], ",", 
     RowBox[{"\[Alpha]1", "=", "0."}], ",", 
     RowBox[{"\[Theta]1", "=", "0."}], ",", 
     RowBox[{"v2", "=", "1"}], ",", 
     RowBox[{"\[Alpha]2", "=", 
      FractionBox["\[Pi]", "2."]}], ",", 
     RowBox[{"\[Theta]2", "=", 
      FractionBox["\[Pi]", "2."]}], ",", "\[IndentingNewLine]", "seed", ",", 
     RowBox[{"kerOrder", "=", "2"}], ",", 
     RowBox[{"dt", "=", ".001"}], ",", 
     RowBox[{"numSteps", "=", "40000"}], ",", 
     RowBox[{"checkpointInterval", "=", "100"}], ",", "\[IndentingNewLine]", 
     RowBox[{"filename", "=", "\"\<type1_orthogonal_101\>\""}], ",", 
     "simulation", ",", "videoPhi", ",", "videoChi"}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lX", ",", "lY", ",", "lZ", ",", "a"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "3"}], "}"}], 
      RowBox[{"VortexSize", "@", "state"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"seed", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BiStringSeed", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
       RowBox[{"a", ",", "\[Beta]", ",", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "\[Alpha]1", ",", "\[Theta]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "\[Alpha]2", ",", "\[Theta]2"}], "}"}]}], "]"}], 
      "@", "state"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"simulation", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"RK4", "[", 
        RowBox[{"kerOrder", ",", "kerOrder", ",", "kerOrder"}], "]"}], "[", 
       RowBox[{"dt", ",", "numSteps", ",", "checkpointInterval"}], "]"}], "[", 
      RowBox[{"seed", ",", 
       RowBox[{"filename", "<>", "\"\<.h5\>\""}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"videoPhi", "=", 
     RowBox[{
      RowBox[{"MakeVideo", "[", 
       RowBox[{"\[Phi]\[Chi]Plot", "[", 
        RowBox[{".75", ",", "True"}], "]"}], "]"}], "@", "simulation"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"filename", "<>", "\"\<_phi.mp4\>\""}], ",", 
      RowBox[{"Video", "@", "videoPhi"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8008655175234547`*^9, 3.800865572441064*^9}, {
   3.800865655532649*^9, 3.800865664939019*^9}, {3.8008659126390123`*^9, 
   3.800865913900205*^9}, {3.800866180026248*^9, 3.8008661965193157`*^9}, {
   3.8008666616079464`*^9, 3.8008666619599876`*^9}, {3.800866702477378*^9, 
   3.800866725882569*^9}, {3.8008669928542557`*^9, 3.8008669946932564`*^9}, {
   3.800871890116412*^9, 3.8008719064843993`*^9}, {3.8008817692973204`*^9, 
   3.8008817867823486`*^9}, {3.800885598627492*^9, 3.800885628927495*^9}, {
   3.800885661093522*^9, 3.8008856663045225`*^9}, {3.8008859903423786`*^9, 
   3.8008859971363797`*^9}, {3.800886077186352*^9, 3.8008860784143486`*^9}, {
   3.8008862149615173`*^9, 3.8008862264630585`*^9}, {3.801374601635149*^9, 
   3.8013746104866834`*^9}, {3.8013746552042212`*^9, 3.801374655250216*^9}, {
   3.801374723585723*^9, 3.8013747368168364`*^9}, {3.8013759804885597`*^9, 
   3.8013759859298277`*^9}, {3.8013760225995626`*^9, 
   3.8013760482444105`*^9}, {3.8014551122863717`*^9, 3.801455113964009*^9}, {
   3.80145522148755*^9, 3.801455224260547*^9}, {3.801455454684285*^9, 
   3.8014554560818157`*^9}, {3.8014578669779243`*^9, 3.801457869986229*^9}, {
   3.801461650966761*^9, 3.8014616533797665`*^9}, 3.8020023787728558`*^9, 
   3.8020040351479917`*^9, {3.8027521942173414`*^9, 3.802752195456332*^9}, 
   3.804224177291499*^9, {3.804398721343706*^9, 3.80439872283424*^9}, {
   3.8073380130941696`*^9, 3.807338013300682*^9}, {3.809177239744445*^9, 
   3.8091772612784185`*^9}, {3.8092381709472494`*^9, 3.809238174449216*^9}, {
   3.8092383956506824`*^9, 3.809238407328707*^9}, {3.8092384453792825`*^9, 
   3.8092384546432247`*^9}, {3.80931912183934*^9, 3.8093191602498507`*^9}, {
   3.809319193193473*^9, 3.8093191936535845`*^9}, {3.80931951881666*^9, 
   3.809319523819171*^9}, {3.8206398062301455`*^9, 3.8206398074394927`*^9}, {
   3.820639869225546*^9, 3.820639870293442*^9}, {3.8239291802728786`*^9, 
   3.8239291803822155`*^9}, {3.8241831648149033`*^9, 3.824183175809044*^9}, {
   3.8241834414068575`*^9, 3.82418345273517*^9}, {3.824183597709011*^9, 
   3.824183645573535*^9}, {3.8241839855419664`*^9, 3.8241840529478545`*^9}, {
   3.824184167488969*^9, 3.824184182364702*^9}, {3.824184301263216*^9, 
   3.82418430479608*^9}, {3.8241844969721727`*^9, 3.8241844977567787`*^9}, {
   3.8241845322263722`*^9, 3.8241845359960938`*^9}, {3.824184575504114*^9, 
   3.824184579622549*^9}, {3.8241852377228055`*^9, 3.824185239209339*^9}, {
   3.824185282567751*^9, 3.824185283561133*^9}, {3.8241854932111673`*^9, 
   3.8241854953488283`*^9}, {3.824198492256491*^9, 3.8241984972746563`*^9}, {
   3.824203272150124*^9, 3.8242032934353576`*^9}, {3.8242064952047157`*^9, 
   3.824206499301737*^9}, {3.824230765612233*^9, 3.8242307657535734`*^9}, {
   3.8242313205108147`*^9, 3.8242313264191475`*^9}, {3.8242719659124117`*^9, 
   3.824271967209079*^9}, 3.824309689093691*^9, 3.824562549001395*^9, {
   3.8245626600711117`*^9, 3.8245626617047606`*^9}, {3.824562887053009*^9, 
   3.8245628916064787`*^9}, {3.824563342059928*^9, 3.824563374691862*^9}, {
   3.824566225981886*^9, 3.8245662538834257`*^9}, {3.824566428403637*^9, 
   3.8245664298790765`*^9}, {3.8245786137096996`*^9, 3.824578865727969*^9}, {
   3.8245789102547054`*^9, 3.8245789113749886`*^9}, {3.8245790036819935`*^9, 
   3.8245790228840384`*^9}, {3.824618060989061*^9, 3.8246180616771336`*^9}, {
   3.824890928601282*^9, 3.8248909287892904`*^9}, 3.8250076380101833`*^9, {
   3.8251408004672484`*^9, 3.8251408070417566`*^9}, {3.8251471868033557`*^9, 
   3.8251471891333017`*^9}, 
   3.8254135644934783`*^9},ExpressionUUID->"7907bf69-7725-4027-b3ee-\
c289f813b256"]
}, Closed]],

Cell[CellGroupData[{

Cell["Parallel vvbar", "Subsubsection",
 CellChangeTimes->{{3.8245786100769663`*^9, 3.824578611646942*^9}, 
   3.82457887558888*^9, {3.824664366766571*^9, 
   3.824664370598066*^9}},ExpressionUUID->"976bac13-2866-4b61-b818-\
2903608478be"],

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"lX", ",", 
     RowBox[{"nX", "=", "101"}], ",", "lY", ",", 
     RowBox[{"nY", "=", "101"}], ",", "lZ", ",", 
     RowBox[{"nZ", "=", "101"}], ",", 
     RowBox[{"state", "=", "Type1Vortex"}], ",", "a", ",", 
     RowBox[{"\[Beta]", "=", "0.5"}], ",", 
     RowBox[{"v1", "=", "1"}], ",", 
     RowBox[{"\[Alpha]1", "=", "0."}], ",", 
     RowBox[{"\[Theta]1", "=", "0."}], ",", 
     RowBox[{"v2", "=", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"\[Alpha]2", "=", "0."}], ",", 
     RowBox[{"\[Theta]2", "=", 
      RowBox[{"\[Pi]", "/", "2."}]}], ",", "\[IndentingNewLine]", "seed", ",", 
     RowBox[{"kerOrder", "=", "2"}], ",", 
     RowBox[{"dt", "=", ".001"}], ",", 
     RowBox[{"numSteps", "=", "40000"}], ",", 
     RowBox[{"checkpointInterval", "=", "100"}], ",", "\[IndentingNewLine]", 
     RowBox[{"filename", "=", "\"\<type1_parallel_vvbar_101\>\""}], ",", 
     "simulation", ",", "videoPhi", ",", "videoChi"}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lX", ",", "lY", ",", "lZ", ",", "a"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "3"}], "}"}], 
      RowBox[{"VortexSize", "@", "state"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"seed", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BiStringSeed", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
       RowBox[{"a", ",", "\[Beta]", ",", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "\[Alpha]1", ",", "\[Theta]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "\[Alpha]2", ",", "\[Theta]2"}], "}"}]}], "]"}], 
      "@", "state"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"simulation", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"RK4", "[", 
        RowBox[{"kerOrder", ",", "kerOrder", ",", "kerOrder"}], "]"}], "[", 
       RowBox[{"dt", ",", "numSteps", ",", "checkpointInterval"}], "]"}], "[", 
      RowBox[{"seed", ",", 
       RowBox[{"filename", "<>", "\"\<.h5\>\""}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"videoPhi", "=", 
     RowBox[{
      RowBox[{"MakeVideo", "[", "\[Phi]\[Chi]Plot", "]"}], "@", 
      "simulation"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"filename", "<>", "\"\<_phi.mp4\>\""}], ",", 
      RowBox[{"Video", "@", "videoPhi"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8008655175234547`*^9, 3.800865572441064*^9}, {
   3.800865655532649*^9, 3.800865664939019*^9}, {3.8008659126390123`*^9, 
   3.800865913900205*^9}, {3.800866180026248*^9, 3.8008661965193157`*^9}, {
   3.8008666616079464`*^9, 3.8008666619599876`*^9}, {3.800866702477378*^9, 
   3.800866725882569*^9}, {3.8008669928542557`*^9, 3.8008669946932564`*^9}, {
   3.800871890116412*^9, 3.8008719064843993`*^9}, {3.8008817692973204`*^9, 
   3.8008817867823486`*^9}, {3.800885598627492*^9, 3.800885628927495*^9}, {
   3.800885661093522*^9, 3.8008856663045225`*^9}, {3.8008859903423786`*^9, 
   3.8008859971363797`*^9}, {3.800886077186352*^9, 3.8008860784143486`*^9}, {
   3.8008862149615173`*^9, 3.8008862264630585`*^9}, {3.801374601635149*^9, 
   3.8013746104866834`*^9}, {3.8013746552042212`*^9, 3.801374655250216*^9}, {
   3.801374723585723*^9, 3.8013747368168364`*^9}, {3.8013759804885597`*^9, 
   3.8013759859298277`*^9}, {3.8013760225995626`*^9, 
   3.8013760482444105`*^9}, {3.8014551122863717`*^9, 3.801455113964009*^9}, {
   3.80145522148755*^9, 3.801455224260547*^9}, {3.801455454684285*^9, 
   3.8014554560818157`*^9}, {3.8014578669779243`*^9, 3.801457869986229*^9}, {
   3.801461650966761*^9, 3.8014616533797665`*^9}, 3.8020023787728558`*^9, 
   3.8020040351479917`*^9, {3.8027521942173414`*^9, 3.802752195456332*^9}, 
   3.804224177291499*^9, {3.804398721343706*^9, 3.80439872283424*^9}, {
   3.8073380130941696`*^9, 3.807338013300682*^9}, {3.809177239744445*^9, 
   3.8091772612784185`*^9}, {3.8092381709472494`*^9, 3.809238174449216*^9}, {
   3.8092383956506824`*^9, 3.809238407328707*^9}, {3.8092384453792825`*^9, 
   3.8092384546432247`*^9}, {3.80931912183934*^9, 3.8093191602498507`*^9}, {
   3.809319193193473*^9, 3.8093191936535845`*^9}, {3.80931951881666*^9, 
   3.809319523819171*^9}, {3.8206398062301455`*^9, 3.8206398074394927`*^9}, {
   3.820639869225546*^9, 3.820639870293442*^9}, {3.8239291802728786`*^9, 
   3.8239291803822155`*^9}, {3.8241831648149033`*^9, 3.824183175809044*^9}, {
   3.8241834414068575`*^9, 3.82418345273517*^9}, {3.824183597709011*^9, 
   3.824183645573535*^9}, {3.8241839855419664`*^9, 3.8241840529478545`*^9}, {
   3.824184167488969*^9, 3.824184182364702*^9}, {3.824184301263216*^9, 
   3.82418430479608*^9}, {3.8241844969721727`*^9, 3.8241844977567787`*^9}, {
   3.8241845322263722`*^9, 3.8241845359960938`*^9}, {3.824184575504114*^9, 
   3.824184579622549*^9}, {3.8241852377228055`*^9, 3.824185239209339*^9}, {
   3.824185282567751*^9, 3.824185283561133*^9}, {3.8241854932111673`*^9, 
   3.8241854953488283`*^9}, {3.824198492256491*^9, 3.8241984972746563`*^9}, {
   3.824203272150124*^9, 3.8242032934353576`*^9}, {3.8242064952047157`*^9, 
   3.824206499301737*^9}, {3.824230765612233*^9, 3.8242307657535734`*^9}, {
   3.8242313205108147`*^9, 3.8242313264191475`*^9}, {3.8242719659124117`*^9, 
   3.824271967209079*^9}, 3.824309689093691*^9, 3.824562549001395*^9, {
   3.8245626600711117`*^9, 3.8245626617047606`*^9}, {3.824562887053009*^9, 
   3.8245628916064787`*^9}, {3.824563342059928*^9, 3.824563374691862*^9}, {
   3.824566225981886*^9, 3.8245662538834257`*^9}, {3.824566428403637*^9, 
   3.8245664298790765`*^9}, {3.8245786137096996`*^9, 3.82457890531155*^9}, {
   3.8246180375292625`*^9, 3.8246180395787134`*^9}, {3.8246643772592344`*^9, 
   3.824664382122279*^9}, {3.824890901731453*^9, 3.8248909018567944`*^9}, {
   3.825000045604291*^9, 3.8250000483425083`*^9}, {3.8251471685483966`*^9, 
   3.8251471739181027`*^9}, {3.8254107123235884`*^9, 3.8254107147492423`*^9}, 
   3.8254135608638067`*^9},ExpressionUUID->"c1f9ce1e-8483-45cc-856d-\
db66b703cd87"]
}, Closed]],

Cell[CellGroupData[{

Cell["Antiparallel vvbar", "Subsubsection",
 CellChangeTimes->{{3.8245786100769663`*^9, 3.824578611646942*^9}, {
  3.824664405388324*^9, 
  3.82466440616995*^9}},ExpressionUUID->"e827d3ff-5b0a-4f53-a77b-\
2f3d82663285"],

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"lX", ",", 
     RowBox[{"nX", "=", "101"}], ",", "lY", ",", 
     RowBox[{"nY", "=", "101"}], ",", "lZ", ",", 
     RowBox[{"nZ", "=", "101"}], ",", 
     RowBox[{"state", "=", "Type1Vortex"}], ",", "a", ",", 
     RowBox[{"\[Beta]", "=", "0.5"}], ",", 
     RowBox[{"v1", "=", "1"}], ",", 
     RowBox[{"\[Alpha]1", "=", "0."}], ",", 
     RowBox[{"\[Theta]1", "=", "0."}], ",", 
     RowBox[{"v2", "=", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"\[Alpha]2", "=", 
      RowBox[{"N", "@", "\[Pi]"}]}], ",", 
     RowBox[{"\[Theta]2", "=", 
      FractionBox["\[Pi]", "2."]}], ",", "\[IndentingNewLine]", "seed", ",", 
     RowBox[{"kerOrder", "=", "2"}], ",", 
     RowBox[{"dt", "=", ".001"}], ",", 
     RowBox[{"numSteps", "=", "40000"}], ",", 
     RowBox[{"checkpointInterval", "=", "100"}], ",", "\[IndentingNewLine]", 
     RowBox[{"filename", "=", "\"\<type1_antiparallel_vvbar_101\>\""}], ",", 
     "simulation", ",", "videoPhi", ",", "videoChi"}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lX", ",", "lY", ",", "lZ", ",", "a"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "3"}], "}"}], 
      RowBox[{"VortexSize", "@", "state"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"seed", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BiStringSeed", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
       RowBox[{"a", ",", "\[Beta]", ",", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "\[Alpha]1", ",", "\[Theta]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "\[Alpha]2", ",", "\[Theta]2"}], "}"}]}], "]"}], 
      "@", "state"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"simulation", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"RK4", "[", 
        RowBox[{"kerOrder", ",", "kerOrder", ",", "kerOrder"}], "]"}], "[", 
       RowBox[{"dt", ",", "numSteps", ",", "checkpointInterval"}], "]"}], "[", 
      RowBox[{"seed", ",", 
       RowBox[{"filename", "<>", "\"\<.h5\>\""}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"videoPhi", "=", 
     RowBox[{
      RowBox[{"MakeVideo", "[", "\[Phi]2Plot", "]"}], "@", "simulation"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"filename", "<>", "\"\<_phi.mp4\>\""}], ",", 
      RowBox[{"Video", "@", "videoPhi"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8008655175234547`*^9, 3.800865572441064*^9}, {
   3.800865655532649*^9, 3.800865664939019*^9}, {3.8008659126390123`*^9, 
   3.800865913900205*^9}, {3.800866180026248*^9, 3.8008661965193157`*^9}, {
   3.8008666616079464`*^9, 3.8008666619599876`*^9}, {3.800866702477378*^9, 
   3.800866725882569*^9}, {3.8008669928542557`*^9, 3.8008669946932564`*^9}, {
   3.800871890116412*^9, 3.8008719064843993`*^9}, {3.8008817692973204`*^9, 
   3.8008817867823486`*^9}, {3.800885598627492*^9, 3.800885628927495*^9}, {
   3.800885661093522*^9, 3.8008856663045225`*^9}, {3.8008859903423786`*^9, 
   3.8008859971363797`*^9}, {3.800886077186352*^9, 3.8008860784143486`*^9}, {
   3.8008862149615173`*^9, 3.8008862264630585`*^9}, {3.801374601635149*^9, 
   3.8013746104866834`*^9}, {3.8013746552042212`*^9, 3.801374655250216*^9}, {
   3.801374723585723*^9, 3.8013747368168364`*^9}, {3.8013759804885597`*^9, 
   3.8013759859298277`*^9}, {3.8013760225995626`*^9, 
   3.8013760482444105`*^9}, {3.8014551122863717`*^9, 3.801455113964009*^9}, {
   3.80145522148755*^9, 3.801455224260547*^9}, {3.801455454684285*^9, 
   3.8014554560818157`*^9}, {3.8014578669779243`*^9, 3.801457869986229*^9}, {
   3.801461650966761*^9, 3.8014616533797665`*^9}, 3.8020023787728558`*^9, 
   3.8020040351479917`*^9, {3.8027521942173414`*^9, 3.802752195456332*^9}, 
   3.804224177291499*^9, {3.804398721343706*^9, 3.80439872283424*^9}, {
   3.8073380130941696`*^9, 3.807338013300682*^9}, {3.809177239744445*^9, 
   3.8091772612784185`*^9}, {3.8092381709472494`*^9, 3.809238174449216*^9}, {
   3.8092383956506824`*^9, 3.809238407328707*^9}, {3.8092384453792825`*^9, 
   3.8092384546432247`*^9}, {3.80931912183934*^9, 3.8093191602498507`*^9}, {
   3.809319193193473*^9, 3.8093191936535845`*^9}, {3.80931951881666*^9, 
   3.809319523819171*^9}, {3.8206398062301455`*^9, 3.8206398074394927`*^9}, {
   3.820639869225546*^9, 3.820639870293442*^9}, {3.8239291802728786`*^9, 
   3.8239291803822155`*^9}, {3.8241831648149033`*^9, 3.824183175809044*^9}, {
   3.8241834414068575`*^9, 3.82418345273517*^9}, {3.824183597709011*^9, 
   3.824183645573535*^9}, {3.8241839855419664`*^9, 3.8241840529478545`*^9}, {
   3.824184167488969*^9, 3.824184182364702*^9}, {3.824184301263216*^9, 
   3.82418430479608*^9}, {3.8241844969721727`*^9, 3.8241844977567787`*^9}, {
   3.8241845322263722`*^9, 3.8241845359960938`*^9}, {3.824184575504114*^9, 
   3.824184579622549*^9}, {3.8241852377228055`*^9, 3.824185239209339*^9}, {
   3.824185282567751*^9, 3.824185283561133*^9}, {3.8241854932111673`*^9, 
   3.8241854953488283`*^9}, {3.824198492256491*^9, 3.8241984972746563`*^9}, {
   3.824203272150124*^9, 3.8242032934353576`*^9}, {3.8242064952047157`*^9, 
   3.824206499301737*^9}, {3.824230765612233*^9, 3.8242307657535734`*^9}, {
   3.8242313205108147`*^9, 3.8242313264191475`*^9}, {3.8242719659124117`*^9, 
   3.824271967209079*^9}, 3.824309689093691*^9, 3.824562549001395*^9, {
   3.8245626600711117`*^9, 3.8245626617047606`*^9}, {3.824562887053009*^9, 
   3.8245628916064787`*^9}, {3.824563342059928*^9, 3.824563374691862*^9}, {
   3.824566225981886*^9, 3.8245662538834257`*^9}, {3.824566428403637*^9, 
   3.8245664298790765`*^9}, {3.8245786137096996`*^9, 3.824578865727969*^9}, {
   3.824618056580138*^9, 3.8246180571426563`*^9}, {3.824664407686081*^9, 
   3.824664413008768*^9}, {3.8248851565148363`*^9, 3.824885159298009*^9}, {
   3.825007609521739*^9, 3.82500760967799*^9}, {3.825410748383306*^9, 
   3.8254107513753347`*^9}, {3.825413598276783*^9, 
   3.825413599949432*^9}},ExpressionUUID->"e576f237-4163-40dc-9115-\
0e9f4a4e621a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Orthogonal vvbar", "Subsubsection",
 CellChangeTimes->{{3.8245786100769663`*^9, 3.824578611646942*^9}, {
  3.8245788985777416`*^9, 3.8245788996312227`*^9}, {3.82469641167889*^9, 
  3.824696412960477*^9}},ExpressionUUID->"d8e9a12e-1780-4072-8b61-\
2ecffa18b771"],

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"lX", ",", 
     RowBox[{"nX", "=", "101"}], ",", "lY", ",", 
     RowBox[{"nY", "=", "101"}], ",", "lZ", ",", 
     RowBox[{"nZ", "=", "101"}], ",", 
     RowBox[{"state", "=", "Type1Vortex"}], ",", "a", ",", 
     RowBox[{"\[Beta]", "=", "0.5"}], ",", 
     RowBox[{"v1", "=", "1"}], ",", 
     RowBox[{"\[Alpha]1", "=", "0."}], ",", 
     RowBox[{"\[Theta]1", "=", "0."}], ",", 
     RowBox[{"v2", "=", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"\[Alpha]2", "=", 
      RowBox[{"\[Pi]", "/", "2."}]}], ",", 
     RowBox[{"\[Theta]2", "=", 
      RowBox[{"\[Pi]", "/", "2."}]}], ",", "\[IndentingNewLine]", "seed", ",", 
     RowBox[{"kerOrder", "=", "2"}], ",", 
     RowBox[{"dt", "=", ".001"}], ",", 
     RowBox[{"numSteps", "=", "40000"}], ",", 
     RowBox[{"checkpointInterval", "=", "100"}], ",", "\[IndentingNewLine]", 
     RowBox[{"filename", "=", "\"\<type1_orthogonal_vvbar_101\>\""}], ",", 
     "simulation", ",", "videoPhi", ",", "videoChi"}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lX", ",", "lY", ",", "lZ", ",", "a"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "3"}], "}"}], 
      RowBox[{"VortexSize", "@", "state"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"seed", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BiStringSeed", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
       RowBox[{"a", ",", "\[Beta]", ",", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "\[Alpha]1", ",", "\[Theta]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "\[Alpha]2", ",", "\[Theta]2"}], "}"}]}], "]"}], 
      "@", "state"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"simulation", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"RK4", "[", 
        RowBox[{"kerOrder", ",", "kerOrder", ",", "kerOrder"}], "]"}], "[", 
       RowBox[{"dt", ",", "numSteps", ",", "checkpointInterval"}], "]"}], "[", 
      RowBox[{"seed", ",", 
       RowBox[{"filename", "<>", "\"\<.h5\>\""}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"videoPhi", "=", 
     RowBox[{
      RowBox[{"MakeVideo", "[", 
       RowBox[{"\[Phi]\[Chi]Plot", "[", 
        RowBox[{".75", ",", "True"}], "]"}], "]"}], "@", "simulation"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"filename", "<>", "\"\<_phi.mp4\>\""}], ",", 
      RowBox[{"Video", "@", "videoPhi"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8008655175234547`*^9, 3.800865572441064*^9}, {
   3.800865655532649*^9, 3.800865664939019*^9}, {3.8008659126390123`*^9, 
   3.800865913900205*^9}, {3.800866180026248*^9, 3.8008661965193157`*^9}, {
   3.8008666616079464`*^9, 3.8008666619599876`*^9}, {3.800866702477378*^9, 
   3.800866725882569*^9}, {3.8008669928542557`*^9, 3.8008669946932564`*^9}, {
   3.800871890116412*^9, 3.8008719064843993`*^9}, {3.8008817692973204`*^9, 
   3.8008817867823486`*^9}, {3.800885598627492*^9, 3.800885628927495*^9}, {
   3.800885661093522*^9, 3.8008856663045225`*^9}, {3.8008859903423786`*^9, 
   3.8008859971363797`*^9}, {3.800886077186352*^9, 3.8008860784143486`*^9}, {
   3.8008862149615173`*^9, 3.8008862264630585`*^9}, {3.801374601635149*^9, 
   3.8013746104866834`*^9}, {3.8013746552042212`*^9, 3.801374655250216*^9}, {
   3.801374723585723*^9, 3.8013747368168364`*^9}, {3.8013759804885597`*^9, 
   3.8013759859298277`*^9}, {3.8013760225995626`*^9, 
   3.8013760482444105`*^9}, {3.8014551122863717`*^9, 3.801455113964009*^9}, {
   3.80145522148755*^9, 3.801455224260547*^9}, {3.801455454684285*^9, 
   3.8014554560818157`*^9}, {3.8014578669779243`*^9, 3.801457869986229*^9}, {
   3.801461650966761*^9, 3.8014616533797665`*^9}, 3.8020023787728558`*^9, 
   3.8020040351479917`*^9, {3.8027521942173414`*^9, 3.802752195456332*^9}, 
   3.804224177291499*^9, {3.804398721343706*^9, 3.80439872283424*^9}, {
   3.8073380130941696`*^9, 3.807338013300682*^9}, {3.809177239744445*^9, 
   3.8091772612784185`*^9}, {3.8092381709472494`*^9, 3.809238174449216*^9}, {
   3.8092383956506824`*^9, 3.809238407328707*^9}, {3.8092384453792825`*^9, 
   3.8092384546432247`*^9}, {3.80931912183934*^9, 3.8093191602498507`*^9}, {
   3.809319193193473*^9, 3.8093191936535845`*^9}, {3.80931951881666*^9, 
   3.809319523819171*^9}, {3.8206398062301455`*^9, 3.8206398074394927`*^9}, {
   3.820639869225546*^9, 3.820639870293442*^9}, {3.8239291802728786`*^9, 
   3.8239291803822155`*^9}, {3.8241831648149033`*^9, 3.824183175809044*^9}, {
   3.8241834414068575`*^9, 3.82418345273517*^9}, {3.824183597709011*^9, 
   3.824183645573535*^9}, {3.8241839855419664`*^9, 3.8241840529478545`*^9}, {
   3.824184167488969*^9, 3.824184182364702*^9}, {3.824184301263216*^9, 
   3.82418430479608*^9}, {3.8241844969721727`*^9, 3.8241844977567787`*^9}, {
   3.8241845322263722`*^9, 3.8241845359960938`*^9}, {3.824184575504114*^9, 
   3.824184579622549*^9}, {3.8241852377228055`*^9, 3.824185239209339*^9}, {
   3.824185282567751*^9, 3.824185283561133*^9}, {3.8241854932111673`*^9, 
   3.8241854953488283`*^9}, {3.824198492256491*^9, 3.8241984972746563`*^9}, {
   3.824203272150124*^9, 3.8242032934353576`*^9}, {3.8242064952047157`*^9, 
   3.824206499301737*^9}, {3.824230765612233*^9, 3.8242307657535734`*^9}, {
   3.8242313205108147`*^9, 3.8242313264191475`*^9}, {3.8242719659124117`*^9, 
   3.824271967209079*^9}, 3.824309689093691*^9, 3.824562549001395*^9, {
   3.8245626600711117`*^9, 3.8245626617047606`*^9}, {3.824562887053009*^9, 
   3.8245628916064787`*^9}, {3.824563342059928*^9, 3.824563374691862*^9}, {
   3.824566225981886*^9, 3.8245662538834257`*^9}, {3.824566428403637*^9, 
   3.8245664298790765`*^9}, {3.8245786137096996`*^9, 3.824578865727969*^9}, {
   3.8245789102547054`*^9, 3.8245789113749886`*^9}, {3.8245790036819935`*^9, 
   3.8245790228840384`*^9}, {3.824618060989061*^9, 3.8246180616771336`*^9}, {
   3.82466441991033*^9, 3.8246644249354677`*^9}, {3.8247097468099117`*^9, 
   3.8247097473102427`*^9}, {3.8248183806431084`*^9, 3.824818382233919*^9}, {
   3.824885102110565*^9, 3.8248851044385443`*^9}, 3.825007596371708*^9, {
   3.8254136166603384`*^9, 3.825413622388464*^9}, {3.8254165302197733`*^9, 
   3.8254165349378843`*^9}},ExpressionUUID->"9a72dfe8-9dad-4419-bd39-\
9e7bc83fd6e0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Square vvbar parallel", "Subsubsection",
 CellChangeTimes->{{3.8248163525866833`*^9, 3.8248163892176137`*^9}, {
  3.8248366212643104`*^9, 
  3.824836622493015*^9}},ExpressionUUID->"952b9704-d578-44fa-9abf-\
caf74fb7d18d"],

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"lX", ",", 
     RowBox[{"nX", "=", "101"}], ",", "lY", ",", 
     RowBox[{"nY", "=", "101"}], ",", "lZ", ",", 
     RowBox[{"nZ", "=", "101"}], ",", 
     RowBox[{"state", "=", "Type1Vortex"}], ",", "a", ",", 
     RowBox[{"\[Beta]", "=", "0.5"}], ",", 
     RowBox[{"v1", "=", "1"}], ",", 
     RowBox[{"\[Alpha]11", "=", "0."}], ",", 
     RowBox[{"\[Alpha]12", "=", 
      FractionBox["\[Pi]", "2."]}], ",", 
     RowBox[{"\[Nu]1", "=", "0."}], ",", 
     RowBox[{"v2", "=", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"\[Alpha]21", "=", "0."}], ",", 
     RowBox[{"\[Alpha]22", "=", 
      FractionBox["\[Pi]", "2."]}], ",", 
     RowBox[{"\[Nu]2", "=", "0."}], ",", 
     RowBox[{"v3", "=", "1"}], ",", 
     RowBox[{"\[Alpha]31", "=", "0."}], ",", 
     RowBox[{"\[Alpha]32", "=", 
      FractionBox["\[Pi]", "2."]}], ",", 
     RowBox[{"\[Nu]3", "=", "0."}], ",", 
     RowBox[{"v4", "=", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"\[Alpha]41", "=", "0."}], ",", 
     RowBox[{"\[Alpha]42", "=", 
      FractionBox["\[Pi]", "2."]}], ",", 
     RowBox[{"\[Nu]4", "=", "0."}], ",", "\[IndentingNewLine]", 
     RowBox[{"kerOrder", "=", "2"}], ",", 
     RowBox[{"dt", "=", ".001"}], ",", 
     RowBox[{"numSteps", "=", "40000"}], ",", 
     RowBox[{"checkpointInterval", "=", "100"}], ",", "\[IndentingNewLine]", 
     RowBox[{"filename", "=", "\"\<type1_square_vvbar_parallel_101\>\""}], 
     ",", "seed", ",", "simulation", ",", "videoPhi", ",", "videoChi"}], 
    "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lX", ",", "lY", ",", "lZ", ",", "a"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "5"}], "}"}], 
      RowBox[{"VortexSize", "@", "state"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"seed", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"SquareStringSeed", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "\[Alpha]11", ",", "\[Alpha]12", ",", "\[Nu]1"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "\[Alpha]21", ",", "\[Alpha]22", ",", "\[Nu]2"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v3", ",", "\[Alpha]31", ",", "\[Alpha]32", ",", "\[Nu]3"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v4", ",", "\[Alpha]41", ",", "\[Alpha]42", ",", "\[Nu]4"}], 
         "}"}], ",", "a", ",", "\[Beta]"}], "]"}], "@", "state"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"simulation", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"RK4", "[", 
        RowBox[{"kerOrder", ",", "kerOrder", ",", "kerOrder"}], "]"}], "[", 
       RowBox[{"dt", ",", "numSteps", ",", "checkpointInterval"}], "]"}], "[", 
      RowBox[{"seed", ",", 
       RowBox[{"filename", "<>", "\"\<.h5\>\""}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"videoPhi", "=", 
     RowBox[{
      RowBox[{"MakeVideo", "[", 
       RowBox[{"\[Phi]\[Chi]Plot", "[", 
        RowBox[{".75", ",", "False", ",", "False"}], "]"}], "]"}], "@", 
      "simulation"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"filename", "<>", "\"\<.mp4\>\""}], ",", 
      RowBox[{"Video", "@", "videoPhi"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8240936174164696`*^9, 3.824093621801115*^9}, {
   3.8240936674799075`*^9, 3.8240937093871517`*^9}, {3.824094592274681*^9, 
   3.824094600944376*^9}, {3.824095357324941*^9, 3.8240954168133745`*^9}, 
   3.8240956200630207`*^9, 3.824095838048913*^9, {3.8240972660132923`*^9, 
   3.824097290907387*^9}, {3.8240981263128614`*^9, 3.8240981314460793`*^9}, {
   3.8241003904693623`*^9, 3.824100392510171*^9}, {3.8241011469386253`*^9, 
   3.8241011469698877`*^9}, {3.8241011883058333`*^9, 3.824101199385211*^9}, {
   3.8241020321785717`*^9, 3.8241020324878707`*^9}, {3.824108149840335*^9, 
   3.824108168303398*^9}, {3.824118813450972*^9, 3.8241188348096046`*^9}, {
   3.8241188714006524`*^9, 3.8241188818734183`*^9}, {3.824186131768591*^9, 
   3.82418620259708*^9}, 3.82419208178848*^9, {3.8241960905735717`*^9, 
   3.824196090698599*^9}, {3.82419800213855*^9, 3.8241980032074347`*^9}, 
   3.824199363420474*^9, {3.8242033321187387`*^9, 3.8242033346424246`*^9}, {
   3.824204769159194*^9, 3.8242047739224815`*^9}, {3.824206309785636*^9, 
   3.8242063098485956`*^9}, {3.8242066230041647`*^9, 
   3.8242066558739667`*^9}, {3.8242308032656155`*^9, 3.824230806313859*^9}, {
   3.8242720458535013`*^9, 3.8242720490770683`*^9}, {3.824309729234103*^9, 
   3.8243097303910275`*^9}, {3.8245791568142433`*^9, 3.824579157502578*^9}, {
   3.824810154596073*^9, 3.8248101556804953`*^9}, 3.8248116459964285`*^9, 
   3.8248131062659216`*^9, {3.8248164124967175`*^9, 3.824816571900181*^9}, {
   3.824816618309616*^9, 3.824816645968729*^9}, {3.82481839023558*^9, 
   3.8248184104800215`*^9}, {3.8248367288082094`*^9, 3.8248367306476145`*^9}, 
   3.8248731184536095`*^9, {3.824884659104869*^9, 3.8248846592686267`*^9}, {
   3.824988761177867*^9, 3.824988765071019*^9}, {3.825416542617953*^9, 
   3.825416547531782*^9}, {3.825418065925462*^9, 3.8254180699864516`*^9}, {
   3.8303624339792175`*^9, 
   3.8303626132904763`*^9}},ExpressionUUID->"8dc5b65e-c97f-42c0-a074-\
8a781ee04e12"]
}, Closed]],

Cell[CellGroupData[{

Cell["Square vvbar rotating", "Subsubsection",
 CellChangeTimes->{{3.8248163525866833`*^9, 3.8248163892176137`*^9}, {
  3.8248366212643104`*^9, 3.824836622493015*^9}, {3.8303626234442434`*^9, 
  3.8303626245644445`*^9}},ExpressionUUID->"03dbb3fd-6645-431f-a170-\
72e50efe8ede"],

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"lX", ",", 
     RowBox[{"nX", "=", "101"}], ",", "lY", ",", 
     RowBox[{"nY", "=", "101"}], ",", "lZ", ",", 
     RowBox[{"nZ", "=", "101"}], ",", 
     RowBox[{"state", "=", "Type1Vortex"}], ",", "a", ",", 
     RowBox[{"\[Beta]", "=", "0.75"}], ",", 
     RowBox[{"v1", "=", "1"}], ",", 
     RowBox[{"\[Alpha]11", "=", "0."}], ",", 
     RowBox[{"\[Alpha]12", "=", 
      RowBox[{"\[Pi]", "/", "2."}]}], ",", 
     RowBox[{"\[Nu]1", "=", ".1"}], ",", 
     RowBox[{"v2", "=", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"\[Alpha]21", "=", "0."}], ",", 
     RowBox[{"\[Alpha]22", "=", 
      RowBox[{"\[Pi]", "/", "2."}]}], ",", 
     RowBox[{"\[Nu]2", "=", 
      RowBox[{"-", ".1"}]}], ",", 
     RowBox[{"v3", "=", "1"}], ",", 
     RowBox[{"\[Alpha]31", "=", "0."}], ",", 
     RowBox[{"\[Alpha]32", "=", 
      RowBox[{"\[Pi]", "/", "2."}]}], ",", 
     RowBox[{"\[Nu]3", "=", ".1"}], ",", 
     RowBox[{"v4", "=", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"\[Alpha]41", "=", "0."}], ",", 
     RowBox[{"\[Alpha]42", "=", 
      RowBox[{"\[Pi]", "/", "2."}]}], ",", 
     RowBox[{"\[Nu]4", "=", 
      RowBox[{"-", ".1"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"kerOrder", "=", "2"}], ",", 
     RowBox[{"dt", "=", ".001"}], ",", 
     RowBox[{"numSteps", "=", "30000"}], ",", 
     RowBox[{"checkpointInterval", "=", "100"}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "filename", "=", "\"\<type1_square_vvbar_nu_0.1_beta_0.75_n_101\>\""}], 
     ",", "seed", ",", "simulation", ",", "videoPhi", ",", "videoChi"}], 
    "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lX", ",", "lY", ",", "lZ", ",", "a"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "5"}], "}"}], 
      RowBox[{"VortexSize", "@", "state"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"seed", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"SquareStringSeed", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "\[Alpha]11", ",", "\[Alpha]12", ",", "\[Nu]1"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "\[Alpha]21", ",", "\[Alpha]22", ",", "\[Nu]2"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v3", ",", "\[Alpha]31", ",", "\[Alpha]32", ",", "\[Nu]3"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v4", ",", "\[Alpha]41", ",", "\[Alpha]42", ",", "\[Nu]4"}], 
         "}"}], ",", "a", ",", "\[Beta]"}], "]"}], "@", "state"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"simulation", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"RK4", "[", 
        RowBox[{"kerOrder", ",", "kerOrder", ",", "kerOrder"}], "]"}], "[", 
       RowBox[{"dt", ",", "numSteps", ",", "checkpointInterval"}], "]"}], "[", 
      RowBox[{"seed", ",", 
       RowBox[{"filename", "<>", "\"\<.h5\>\""}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"videoPhi", "=", 
     RowBox[{
      RowBox[{"MakeVideo", "[", 
       RowBox[{"\[Phi]\[Chi]Plot", "[", 
        RowBox[{".75", ",", "False", ",", "True"}], "]"}], "]"}], "@", 
      "simulation"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"filename", "<>", "\"\<.mp4\>\""}], ",", 
      RowBox[{"Video", "@", "videoPhi"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8240936174164696`*^9, 3.824093621801115*^9}, {
   3.8240936674799075`*^9, 3.8240937093871517`*^9}, {3.824094592274681*^9, 
   3.824094600944376*^9}, {3.824095357324941*^9, 3.8240954168133745`*^9}, 
   3.8240956200630207`*^9, 3.824095838048913*^9, {3.8240972660132923`*^9, 
   3.824097290907387*^9}, {3.8240981263128614`*^9, 3.8240981314460793`*^9}, {
   3.8241003904693623`*^9, 3.824100392510171*^9}, {3.8241011469386253`*^9, 
   3.8241011469698877`*^9}, {3.8241011883058333`*^9, 3.824101199385211*^9}, {
   3.8241020321785717`*^9, 3.8241020324878707`*^9}, {3.824108149840335*^9, 
   3.824108168303398*^9}, {3.824118813450972*^9, 3.8241188348096046`*^9}, {
   3.8241188714006524`*^9, 3.8241188818734183`*^9}, {3.824186131768591*^9, 
   3.82418620259708*^9}, 3.82419208178848*^9, {3.8241960905735717`*^9, 
   3.824196090698599*^9}, {3.82419800213855*^9, 3.8241980032074347`*^9}, 
   3.824199363420474*^9, {3.8242033321187387`*^9, 3.8242033346424246`*^9}, {
   3.824204769159194*^9, 3.8242047739224815`*^9}, {3.824206309785636*^9, 
   3.8242063098485956`*^9}, {3.8242066230041647`*^9, 
   3.8242066558739667`*^9}, {3.8242308032656155`*^9, 3.824230806313859*^9}, {
   3.8242720458535013`*^9, 3.8242720490770683`*^9}, {3.824309729234103*^9, 
   3.8243097303910275`*^9}, {3.8245791568142433`*^9, 3.824579157502578*^9}, {
   3.824810154596073*^9, 3.8248101556804953`*^9}, 3.8248116459964285`*^9, 
   3.8248131062659216`*^9, {3.8248164124967175`*^9, 3.824816571900181*^9}, {
   3.824816618309616*^9, 3.824816645968729*^9}, {3.82481839023558*^9, 
   3.8248184104800215`*^9}, {3.8248367288082094`*^9, 3.8248367306476145`*^9}, 
   3.8248731184536095`*^9, {3.824884659104869*^9, 3.8248846592686267`*^9}, {
   3.824988761177867*^9, 3.824988765071019*^9}, {3.825416542617953*^9, 
   3.825416547531782*^9}, {3.825418065925462*^9, 3.8254180699864516`*^9}, {
   3.8303624339792175`*^9, 3.83036267534939*^9}, {3.8304154319644184`*^9, 
   3.8304154329814816`*^9}, {3.830415503495144*^9, 3.830415552325143*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"529a0369-dae8-44c3-892f-f93ac82e60e8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Square vvbar antiparallel", "Subsubsection",
 CellChangeTimes->{{3.8248163525866833`*^9, 3.8248163892176137`*^9}, {
  3.8248366212643104`*^9, 
  3.82483662995718*^9}},ExpressionUUID->"214163e9-6366-468d-b0bc-\
900fdc70a717"],

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"lX", ",", 
     RowBox[{"nX", "=", "101"}], ",", "lY", ",", 
     RowBox[{"nY", "=", "101"}], ",", "lZ", ",", 
     RowBox[{"nZ", "=", "101"}], ",", 
     RowBox[{"state", "=", "Type1Vortex"}], ",", "a", ",", 
     RowBox[{"\[Beta]", "=", "0.5"}], ",", 
     RowBox[{"v1", "=", "1"}], ",", 
     RowBox[{"\[Alpha]1", "=", "0."}], ",", 
     RowBox[{"v2", "=", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"\[Alpha]2", "=", "0."}], ",", 
     RowBox[{"v3", "=", "1"}], ",", 
     RowBox[{"\[Alpha]3", "=", 
      RowBox[{"N", "@", "\[Pi]"}]}], ",", 
     RowBox[{"v4", "=", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"\[Alpha]4", "=", 
      RowBox[{"N", "@", "\[Pi]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"kerOrder", "=", "2"}], ",", 
     RowBox[{"dt", "=", ".001"}], ",", 
     RowBox[{"numSteps", "=", "40000"}], ",", 
     RowBox[{"checkpointInterval", "=", "100"}], ",", "\[IndentingNewLine]", 
     RowBox[{"filename", "=", "\"\<type1_square_vvbar_antiparallel_101\>\""}],
      ",", "seed", ",", "simulation", ",", "videoPhi", ",", "videoChi"}], 
    "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lX", ",", "lY", ",", "lZ", ",", "a"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "5"}], "}"}], 
      RowBox[{"VortexSize", "@", "state"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"seed", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"SquareStringSeed", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
       RowBox[{"a", ",", "\[Beta]", ",", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "\[Alpha]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "\[Alpha]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v3", ",", "\[Alpha]3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v4", ",", "\[Alpha]4"}], "}"}]}], "]"}], "@", "state"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"simulation", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"RK4", "[", 
        RowBox[{"kerOrder", ",", "kerOrder", ",", "kerOrder"}], "]"}], "[", 
       RowBox[{"dt", ",", "numSteps", ",", "checkpointInterval"}], "]"}], "[", 
      RowBox[{"seed", ",", 
       RowBox[{"filename", "<>", "\"\<.h5\>\""}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"videoPhi", "=", 
     RowBox[{
      RowBox[{"MakeVideo", "[", "\[Phi]\[Chi]Plot", "]"}], "@", 
      "simulation"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"filename", "<>", "\"\<_phi.mp4\>\""}], ",", 
      RowBox[{"Video", "@", "videoPhi"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8240936174164696`*^9, 3.824093621801115*^9}, {
   3.8240936674799075`*^9, 3.8240937093871517`*^9}, {3.824094592274681*^9, 
   3.824094600944376*^9}, {3.824095357324941*^9, 3.8240954168133745`*^9}, 
   3.8240956200630207`*^9, 3.824095838048913*^9, {3.8240972660132923`*^9, 
   3.824097290907387*^9}, {3.8240981263128614`*^9, 3.8240981314460793`*^9}, {
   3.8241003904693623`*^9, 3.824100392510171*^9}, {3.8241011469386253`*^9, 
   3.8241011469698877`*^9}, {3.8241011883058333`*^9, 3.824101199385211*^9}, {
   3.8241020321785717`*^9, 3.8241020324878707`*^9}, {3.824108149840335*^9, 
   3.824108168303398*^9}, {3.824118813450972*^9, 3.8241188348096046`*^9}, {
   3.8241188714006524`*^9, 3.8241188818734183`*^9}, {3.824186131768591*^9, 
   3.82418620259708*^9}, 3.82419208178848*^9, {3.8241960905735717`*^9, 
   3.824196090698599*^9}, {3.82419800213855*^9, 3.8241980032074347`*^9}, 
   3.824199363420474*^9, {3.8242033321187387`*^9, 3.8242033346424246`*^9}, {
   3.824204769159194*^9, 3.8242047739224815`*^9}, {3.824206309785636*^9, 
   3.8242063098485956`*^9}, {3.8242066230041647`*^9, 
   3.8242066558739667`*^9}, {3.8242308032656155`*^9, 3.824230806313859*^9}, {
   3.8242720458535013`*^9, 3.8242720490770683`*^9}, {3.824309729234103*^9, 
   3.8243097303910275`*^9}, {3.8245791568142433`*^9, 3.824579157502578*^9}, {
   3.824810154596073*^9, 3.8248101556804953`*^9}, 3.8248116459964285`*^9, 
   3.8248131062659216`*^9, {3.8248164124967175`*^9, 3.824816571900181*^9}, {
   3.824816618309616*^9, 3.824816645968729*^9}, {3.82481839023558*^9, 
   3.8248184104800215`*^9}, {3.824836642854515*^9, 3.8248366480432653`*^9}, {
   3.8248368829354534`*^9, 3.824836892397981*^9}, {3.8250075575644436`*^9, 
   3.8250075608174114`*^9}, {3.8254180876816835`*^9, 
   3.8254180912268963`*^9}, {3.8254208807193727`*^9, 
   3.825420885639598*^9}},ExpressionUUID->"0b4a9c46-d387-4cdf-9b40-\
198d3fe8f059"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Type 2", "Subsection",
 CellChangeTimes->{{3.8245786051341205`*^9, 
  3.8245786058240194`*^9}},ExpressionUUID->"f33597ea-6836-45b6-a9ce-\
54e797df637f"],

Cell[CellGroupData[{

Cell["Parallel", "Subsubsection",
 CellChangeTimes->{{3.8245786100769663`*^9, 3.824578611646942*^9}, 
   3.82457887558888*^9},ExpressionUUID->"f034d747-518f-46df-947b-\
ee3c84a01ba1"],

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"lX", ",", 
     RowBox[{"nX", "=", "101"}], ",", "lY", ",", 
     RowBox[{"nY", "=", "101"}], ",", "lZ", ",", 
     RowBox[{"nZ", "=", "101"}], ",", 
     RowBox[{"state", "=", "Type2Vortex"}], ",", "a", ",", 
     RowBox[{"\[Beta]", "=", "0.5"}], ",", 
     RowBox[{"v1", "=", "1"}], ",", 
     RowBox[{"\[Alpha]1", "=", "0."}], ",", 
     RowBox[{"\[Theta]1", "=", "0."}], ",", 
     RowBox[{"v2", "=", "1"}], ",", 
     RowBox[{"\[Alpha]2", "=", "0."}], ",", 
     RowBox[{"\[Theta]2", "=", 
      FractionBox["\[Pi]", "2."]}], ",", "\[IndentingNewLine]", "seed", ",", 
     RowBox[{"kerOrder", "=", "2"}], ",", 
     RowBox[{"dt", "=", ".001"}], ",", 
     RowBox[{"numSteps", "=", "40000"}], ",", 
     RowBox[{"checkpointInterval", "=", "100"}], ",", "\[IndentingNewLine]", 
     RowBox[{"filename", "=", "\"\<type2_parallel_101\>\""}], ",", 
     "simulation", ",", "videoPhi", ",", "videoChi"}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lX", ",", "lY", ",", "lZ", ",", "a"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "3"}], "}"}], 
      RowBox[{"VortexSize", "@", "state"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"seed", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BiStringSeed", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
       RowBox[{"a", ",", "\[Beta]", ",", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "\[Alpha]1", ",", "\[Theta]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "\[Alpha]2", ",", "\[Theta]2"}], "}"}]}], "]"}], 
      "@", "state"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"simulation", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"RK4", "[", 
        RowBox[{"kerOrder", ",", "kerOrder", ",", "kerOrder"}], "]"}], "[", 
       RowBox[{"dt", ",", "numSteps", ",", "checkpointInterval"}], "]"}], "[", 
      RowBox[{"seed", ",", 
       RowBox[{"filename", "<>", "\"\<.h5\>\""}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"videoPhi", "=", 
     RowBox[{
      RowBox[{"MakeVideo", "[", "\[Phi]\[Chi]Plot", "]"}], "@", 
      "simulation"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"filename", "<>", "\"\<_phi.mp4\>\""}], ",", 
      RowBox[{"Video", "@", "videoPhi"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8008655175234547`*^9, 3.800865572441064*^9}, {
   3.800865655532649*^9, 3.800865664939019*^9}, {3.8008659126390123`*^9, 
   3.800865913900205*^9}, {3.800866180026248*^9, 3.8008661965193157`*^9}, {
   3.8008666616079464`*^9, 3.8008666619599876`*^9}, {3.800866702477378*^9, 
   3.800866725882569*^9}, {3.8008669928542557`*^9, 3.8008669946932564`*^9}, {
   3.800871890116412*^9, 3.8008719064843993`*^9}, {3.8008817692973204`*^9, 
   3.8008817867823486`*^9}, {3.800885598627492*^9, 3.800885628927495*^9}, {
   3.800885661093522*^9, 3.8008856663045225`*^9}, {3.8008859903423786`*^9, 
   3.8008859971363797`*^9}, {3.800886077186352*^9, 3.8008860784143486`*^9}, {
   3.8008862149615173`*^9, 3.8008862264630585`*^9}, {3.801374601635149*^9, 
   3.8013746104866834`*^9}, {3.8013746552042212`*^9, 3.801374655250216*^9}, {
   3.801374723585723*^9, 3.8013747368168364`*^9}, {3.8013759804885597`*^9, 
   3.8013759859298277`*^9}, {3.8013760225995626`*^9, 
   3.8013760482444105`*^9}, {3.8014551122863717`*^9, 3.801455113964009*^9}, {
   3.80145522148755*^9, 3.801455224260547*^9}, {3.801455454684285*^9, 
   3.8014554560818157`*^9}, {3.8014578669779243`*^9, 3.801457869986229*^9}, {
   3.801461650966761*^9, 3.8014616533797665`*^9}, 3.8020023787728558`*^9, 
   3.8020040351479917`*^9, {3.8027521942173414`*^9, 3.802752195456332*^9}, 
   3.804224177291499*^9, {3.804398721343706*^9, 3.80439872283424*^9}, {
   3.8073380130941696`*^9, 3.807338013300682*^9}, {3.809177239744445*^9, 
   3.8091772612784185`*^9}, {3.8092381709472494`*^9, 3.809238174449216*^9}, {
   3.8092383956506824`*^9, 3.809238407328707*^9}, {3.8092384453792825`*^9, 
   3.8092384546432247`*^9}, {3.80931912183934*^9, 3.8093191602498507`*^9}, {
   3.809319193193473*^9, 3.8093191936535845`*^9}, {3.80931951881666*^9, 
   3.809319523819171*^9}, {3.8206398062301455`*^9, 3.8206398074394927`*^9}, {
   3.820639869225546*^9, 3.820639870293442*^9}, {3.8239291802728786`*^9, 
   3.8239291803822155`*^9}, {3.8241831648149033`*^9, 3.824183175809044*^9}, {
   3.8241834414068575`*^9, 3.82418345273517*^9}, {3.824183597709011*^9, 
   3.824183645573535*^9}, {3.8241839855419664`*^9, 3.8241840529478545`*^9}, {
   3.824184167488969*^9, 3.824184182364702*^9}, {3.824184301263216*^9, 
   3.82418430479608*^9}, {3.8241844969721727`*^9, 3.8241844977567787`*^9}, {
   3.8241845322263722`*^9, 3.8241845359960938`*^9}, {3.824184575504114*^9, 
   3.824184579622549*^9}, {3.8241852377228055`*^9, 3.824185239209339*^9}, {
   3.824185282567751*^9, 3.824185283561133*^9}, {3.8241854932111673`*^9, 
   3.8241854953488283`*^9}, {3.824198492256491*^9, 3.8241984972746563`*^9}, {
   3.824203272150124*^9, 3.8242032934353576`*^9}, {3.8242064952047157`*^9, 
   3.824206499301737*^9}, {3.824230765612233*^9, 3.8242307657535734`*^9}, {
   3.8242313205108147`*^9, 3.8242313264191475`*^9}, {3.8242719659124117`*^9, 
   3.824271967209079*^9}, 3.824309689093691*^9, 3.824562549001395*^9, {
   3.8245626600711117`*^9, 3.8245626617047606`*^9}, {3.824562887053009*^9, 
   3.8245628916064787`*^9}, {3.824563342059928*^9, 3.824563374691862*^9}, {
   3.824566225981886*^9, 3.8245662538834257`*^9}, {3.824566428403637*^9, 
   3.8245664298790765`*^9}, {3.8245786137096996`*^9, 3.82457890531155*^9}, {
   3.824579038020715*^9, 3.824579039537761*^9}, {3.824642508856879*^9, 
   3.8246425095453105`*^9}, {3.8249225500345917`*^9, 
   3.8249225501909122`*^9}, {3.825008386119288*^9, 
   3.825008389656028*^9}},ExpressionUUID->"e13c66de-b624-4c94-8d02-\
6988d59996e1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"videoPhi", "=", 
   RowBox[{
    RowBox[{"MakeVideo", "[", "\[Phi]\[Chi]Plot", "]"}], "@", 
    RowBox[{"SimulationLoad", "@", "\"\<type2_parallel_101.h5\>\""}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<type2_parallel_101_phi.mp4\>\"", ",", 
   RowBox[{"Video", "@", "videoPhi"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8249225551005096`*^9, 3.8249225594302235`*^9}, {
  3.825008391792447*^9, 
  3.825008394330624*^9}},ExpressionUUID->"6dcbffc1-1c1f-484d-a5db-\
9f00353b4f8d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Antiparallel", "Subsubsection",
 CellChangeTimes->{{3.8245786100769663`*^9, 
  3.824578611646942*^9}},ExpressionUUID->"e03fc387-e29b-46f0-a2f0-\
612ee9e0cec5"],

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"lX", ",", 
     RowBox[{"nX", "=", "101"}], ",", "lY", ",", 
     RowBox[{"nY", "=", "101"}], ",", "lZ", ",", 
     RowBox[{"nZ", "=", "101"}], ",", 
     RowBox[{"state", "=", "Type2Vortex"}], ",", "a", ",", 
     RowBox[{"\[Beta]", "=", "0.5"}], ",", 
     RowBox[{"v1", "=", "1"}], ",", 
     RowBox[{"\[Alpha]1", "=", "0."}], ",", 
     RowBox[{"\[Theta]1", "=", "0."}], ",", 
     RowBox[{"v2", "=", "1"}], ",", 
     RowBox[{"\[Alpha]2", "=", 
      RowBox[{"N", "@", "\[Pi]"}]}], ",", 
     RowBox[{"\[Theta]2", "=", 
      RowBox[{"\[Pi]", "/", "2."}]}], ",", "\[IndentingNewLine]", "seed", ",", 
     RowBox[{"kerOrder", "=", "2"}], ",", 
     RowBox[{"dt", "=", ".001"}], ",", 
     RowBox[{"numSteps", "=", "40000"}], ",", 
     RowBox[{"checkpointInterval", "=", "100"}], ",", "\[IndentingNewLine]", 
     RowBox[{"filename", "=", "\"\<type2_antiparallel_101\>\""}], ",", 
     "simulation", ",", "videoPhi", ",", "videoChi"}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lX", ",", "lY", ",", "lZ", ",", "a"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "3"}], "}"}], 
      RowBox[{"VortexSize", "@", "state"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"seed", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BiStringSeed", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
       RowBox[{"a", ",", "\[Beta]", ",", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "\[Alpha]1", ",", "\[Theta]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "\[Alpha]2", ",", "\[Theta]2"}], "}"}]}], "]"}], 
      "@", "state"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"simulation", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"RK4", "[", 
        RowBox[{"kerOrder", ",", "kerOrder", ",", "kerOrder"}], "]"}], "[", 
       RowBox[{"dt", ",", "numSteps", ",", "checkpointInterval"}], "]"}], "[", 
      RowBox[{"seed", ",", 
       RowBox[{"filename", "<>", "\"\<.h5\>\""}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"videoPhi", "=", 
     RowBox[{
      RowBox[{"MakeVideo", "[", "\[Phi]\[Chi]Plot", "]"}], "@", 
      "simulation"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"filename", "<>", "\"\<_phi.mp4\>\""}], ",", 
      RowBox[{"Video", "@", "videoPhi"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8008655175234547`*^9, 3.800865572441064*^9}, {
   3.800865655532649*^9, 3.800865664939019*^9}, {3.8008659126390123`*^9, 
   3.800865913900205*^9}, {3.800866180026248*^9, 3.8008661965193157`*^9}, {
   3.8008666616079464`*^9, 3.8008666619599876`*^9}, {3.800866702477378*^9, 
   3.800866725882569*^9}, {3.8008669928542557`*^9, 3.8008669946932564`*^9}, {
   3.800871890116412*^9, 3.8008719064843993`*^9}, {3.8008817692973204`*^9, 
   3.8008817867823486`*^9}, {3.800885598627492*^9, 3.800885628927495*^9}, {
   3.800885661093522*^9, 3.8008856663045225`*^9}, {3.8008859903423786`*^9, 
   3.8008859971363797`*^9}, {3.800886077186352*^9, 3.8008860784143486`*^9}, {
   3.8008862149615173`*^9, 3.8008862264630585`*^9}, {3.801374601635149*^9, 
   3.8013746104866834`*^9}, {3.8013746552042212`*^9, 3.801374655250216*^9}, {
   3.801374723585723*^9, 3.8013747368168364`*^9}, {3.8013759804885597`*^9, 
   3.8013759859298277`*^9}, {3.8013760225995626`*^9, 
   3.8013760482444105`*^9}, {3.8014551122863717`*^9, 3.801455113964009*^9}, {
   3.80145522148755*^9, 3.801455224260547*^9}, {3.801455454684285*^9, 
   3.8014554560818157`*^9}, {3.8014578669779243`*^9, 3.801457869986229*^9}, {
   3.801461650966761*^9, 3.8014616533797665`*^9}, 3.8020023787728558`*^9, 
   3.8020040351479917`*^9, {3.8027521942173414`*^9, 3.802752195456332*^9}, 
   3.804224177291499*^9, {3.804398721343706*^9, 3.80439872283424*^9}, {
   3.8073380130941696`*^9, 3.807338013300682*^9}, {3.809177239744445*^9, 
   3.8091772612784185`*^9}, {3.8092381709472494`*^9, 3.809238174449216*^9}, {
   3.8092383956506824`*^9, 3.809238407328707*^9}, {3.8092384453792825`*^9, 
   3.8092384546432247`*^9}, {3.80931912183934*^9, 3.8093191602498507`*^9}, {
   3.809319193193473*^9, 3.8093191936535845`*^9}, {3.80931951881666*^9, 
   3.809319523819171*^9}, {3.8206398062301455`*^9, 3.8206398074394927`*^9}, {
   3.820639869225546*^9, 3.820639870293442*^9}, {3.8239291802728786`*^9, 
   3.8239291803822155`*^9}, {3.8241831648149033`*^9, 3.824183175809044*^9}, {
   3.8241834414068575`*^9, 3.82418345273517*^9}, {3.824183597709011*^9, 
   3.824183645573535*^9}, {3.8241839855419664`*^9, 3.8241840529478545`*^9}, {
   3.824184167488969*^9, 3.824184182364702*^9}, {3.824184301263216*^9, 
   3.82418430479608*^9}, {3.8241844969721727`*^9, 3.8241844977567787`*^9}, {
   3.8241845322263722`*^9, 3.8241845359960938`*^9}, {3.824184575504114*^9, 
   3.824184579622549*^9}, {3.8241852377228055`*^9, 3.824185239209339*^9}, {
   3.824185282567751*^9, 3.824185283561133*^9}, {3.8241854932111673`*^9, 
   3.8241854953488283`*^9}, {3.824198492256491*^9, 3.8241984972746563`*^9}, {
   3.824203272150124*^9, 3.8242032934353576`*^9}, {3.8242064952047157`*^9, 
   3.824206499301737*^9}, {3.824230765612233*^9, 3.8242307657535734`*^9}, {
   3.8242313205108147`*^9, 3.8242313264191475`*^9}, {3.8242719659124117`*^9, 
   3.824271967209079*^9}, 3.824309689093691*^9, 3.824562549001395*^9, {
   3.8245626600711117`*^9, 3.8245626617047606`*^9}, {3.824562887053009*^9, 
   3.8245628916064787`*^9}, {3.824563342059928*^9, 3.824563374691862*^9}, {
   3.824566225981886*^9, 3.8245662538834257`*^9}, {3.824566428403637*^9, 
   3.8245664298790765`*^9}, {3.8245786137096996`*^9, 3.824578865727969*^9}, {
   3.8245790414392343`*^9, 3.8245790436442304`*^9}, {3.8246425142906165`*^9, 
   3.8246425147440557`*^9}, {3.824922568733594*^9, 3.824922568858593*^9}, {
   3.825008405455348*^9, 
   3.82500840853547*^9}},ExpressionUUID->"16e55ca7-960f-4e96-8d60-\
22716e0661e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"videoPhi", "=", 
   RowBox[{
    RowBox[{"MakeVideo", "[", "\[Phi]\[Chi]Plot", "]"}], "@", 
    RowBox[{"SimulationLoad", "@", "\"\<type2_antiparallel_101.h5\>\""}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<type2_antiparallel_101_phi.mp4\>\"", ",", 
   RowBox[{"Video", "@", "videoPhi"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.824922578019773*^9, 3.824922581770694*^9}, {
  3.825008412193222*^9, 
  3.8250084133973756`*^9}},ExpressionUUID->"42463eef-18b2-4223-a35c-\
78154bf4746f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Orthogonal", "Subsubsection",
 CellChangeTimes->{{3.8245786100769663`*^9, 3.824578611646942*^9}, {
  3.8245788985777416`*^9, 
  3.8245788996312227`*^9}},ExpressionUUID->"12c73537-8aee-432c-b275-\
b35edb83e0e7"],

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"lX", ",", 
     RowBox[{"nX", "=", "101"}], ",", "lY", ",", 
     RowBox[{"nY", "=", "101"}], ",", "lZ", ",", 
     RowBox[{"nZ", "=", "101"}], ",", 
     RowBox[{"state", "=", "Type2Vortex"}], ",", "a", ",", 
     RowBox[{"\[Beta]", "=", "0.5"}], ",", 
     RowBox[{"v1", "=", "1"}], ",", 
     RowBox[{"\[Alpha]1", "=", "0."}], ",", 
     RowBox[{"\[Theta]1", "=", "0."}], ",", 
     RowBox[{"v2", "=", "1"}], ",", 
     RowBox[{"\[Alpha]2", "=", 
      FractionBox["\[Pi]", "2."]}], ",", 
     RowBox[{"\[Theta]2", "=", 
      FractionBox["\[Pi]", "2."]}], ",", "\[IndentingNewLine]", "seed", ",", 
     RowBox[{"kerOrder", "=", "2"}], ",", 
     RowBox[{"dt", "=", ".001"}], ",", 
     RowBox[{"numSteps", "=", "40000"}], ",", 
     RowBox[{"checkpointInterval", "=", "100"}], ",", "\[IndentingNewLine]", 
     RowBox[{"filename", "=", "\"\<type2_orthogonal_101\>\""}], ",", 
     "simulation", ",", "videoPhi", ",", "videoChi"}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lX", ",", "lY", ",", "lZ", ",", "a"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "3"}], "}"}], 
      RowBox[{"VortexSize", "@", "state"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"seed", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BiStringSeed", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
       RowBox[{"a", ",", "\[Beta]", ",", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "\[Alpha]1", ",", "\[Theta]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "\[Alpha]2", ",", "\[Theta]2"}], "}"}]}], "]"}], 
      "@", "state"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"simulation", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"RK4", "[", 
        RowBox[{"kerOrder", ",", "kerOrder", ",", "kerOrder"}], "]"}], "[", 
       RowBox[{"dt", ",", "numSteps", ",", "checkpointInterval"}], "]"}], "[", 
      RowBox[{"seed", ",", 
       RowBox[{"filename", "<>", "\"\<.h5\>\""}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"videoPhi", "=", 
     RowBox[{
      RowBox[{"MakeVideo", "[", 
       RowBox[{"\[Phi]\[Chi]Plot", "[", 
        RowBox[{".75", ",", "True"}], "]"}], "]"}], "@", "simulation"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"filename", "<>", "\"\<_phi.mp4\>\""}], ",", 
      RowBox[{"Video", "@", "videoPhi"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8008655175234547`*^9, 3.800865572441064*^9}, {
   3.800865655532649*^9, 3.800865664939019*^9}, {3.8008659126390123`*^9, 
   3.800865913900205*^9}, {3.800866180026248*^9, 3.8008661965193157`*^9}, {
   3.8008666616079464`*^9, 3.8008666619599876`*^9}, {3.800866702477378*^9, 
   3.800866725882569*^9}, {3.8008669928542557`*^9, 3.8008669946932564`*^9}, {
   3.800871890116412*^9, 3.8008719064843993`*^9}, {3.8008817692973204`*^9, 
   3.8008817867823486`*^9}, {3.800885598627492*^9, 3.800885628927495*^9}, {
   3.800885661093522*^9, 3.8008856663045225`*^9}, {3.8008859903423786`*^9, 
   3.8008859971363797`*^9}, {3.800886077186352*^9, 3.8008860784143486`*^9}, {
   3.8008862149615173`*^9, 3.8008862264630585`*^9}, {3.801374601635149*^9, 
   3.8013746104866834`*^9}, {3.8013746552042212`*^9, 3.801374655250216*^9}, {
   3.801374723585723*^9, 3.8013747368168364`*^9}, {3.8013759804885597`*^9, 
   3.8013759859298277`*^9}, {3.8013760225995626`*^9, 
   3.8013760482444105`*^9}, {3.8014551122863717`*^9, 3.801455113964009*^9}, {
   3.80145522148755*^9, 3.801455224260547*^9}, {3.801455454684285*^9, 
   3.8014554560818157`*^9}, {3.8014578669779243`*^9, 3.801457869986229*^9}, {
   3.801461650966761*^9, 3.8014616533797665`*^9}, 3.8020023787728558`*^9, 
   3.8020040351479917`*^9, {3.8027521942173414`*^9, 3.802752195456332*^9}, 
   3.804224177291499*^9, {3.804398721343706*^9, 3.80439872283424*^9}, {
   3.8073380130941696`*^9, 3.807338013300682*^9}, {3.809177239744445*^9, 
   3.8091772612784185`*^9}, {3.8092381709472494`*^9, 3.809238174449216*^9}, {
   3.8092383956506824`*^9, 3.809238407328707*^9}, {3.8092384453792825`*^9, 
   3.8092384546432247`*^9}, {3.80931912183934*^9, 3.8093191602498507`*^9}, {
   3.809319193193473*^9, 3.8093191936535845`*^9}, {3.80931951881666*^9, 
   3.809319523819171*^9}, {3.8206398062301455`*^9, 3.8206398074394927`*^9}, {
   3.820639869225546*^9, 3.820639870293442*^9}, {3.8239291802728786`*^9, 
   3.8239291803822155`*^9}, {3.8241831648149033`*^9, 3.824183175809044*^9}, {
   3.8241834414068575`*^9, 3.82418345273517*^9}, {3.824183597709011*^9, 
   3.824183645573535*^9}, {3.8241839855419664`*^9, 3.8241840529478545`*^9}, {
   3.824184167488969*^9, 3.824184182364702*^9}, {3.824184301263216*^9, 
   3.82418430479608*^9}, {3.8241844969721727`*^9, 3.8241844977567787`*^9}, {
   3.8241845322263722`*^9, 3.8241845359960938`*^9}, {3.824184575504114*^9, 
   3.824184579622549*^9}, {3.8241852377228055`*^9, 3.824185239209339*^9}, {
   3.824185282567751*^9, 3.824185283561133*^9}, {3.8241854932111673`*^9, 
   3.8241854953488283`*^9}, {3.824198492256491*^9, 3.8241984972746563`*^9}, {
   3.824203272150124*^9, 3.8242032934353576`*^9}, {3.8242064952047157`*^9, 
   3.824206499301737*^9}, {3.824230765612233*^9, 3.8242307657535734`*^9}, {
   3.8242313205108147`*^9, 3.8242313264191475`*^9}, {3.8242719659124117`*^9, 
   3.824271967209079*^9}, 3.824309689093691*^9, 3.824562549001395*^9, {
   3.8245626600711117`*^9, 3.8245626617047606`*^9}, {3.824562887053009*^9, 
   3.8245628916064787`*^9}, {3.824563342059928*^9, 3.824563374691862*^9}, {
   3.824566225981886*^9, 3.8245662538834257`*^9}, {3.824566428403637*^9, 
   3.8245664298790765`*^9}, {3.8245786137096996`*^9, 3.824578865727969*^9}, {
   3.8245789102547054`*^9, 3.8245789113749886`*^9}, {3.8245790036819935`*^9, 
   3.8245790487364583`*^9}, {3.8246425180970955`*^9, 3.824642518644557*^9}, {
   3.82492259133667*^9, 3.8249225914773307`*^9}, 
   3.825008436180629*^9},ExpressionUUID->"31fa8f6c-e700-4526-8060-\
2f08a88a7d7e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"videoPhi", "=", 
   RowBox[{
    RowBox[{"MakeVideo", "[", 
     RowBox[{"\[Phi]\[Chi]Plot", "[", 
      RowBox[{".75", ",", "True"}], "]"}], "]"}], "@", 
    RowBox[{"SimulationLoad", "@", "\"\<type2_orthogonal_101.h5\>\""}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<type2_orthogonal_101_phi.mp4\>\"", ",", 
   RowBox[{"Video", "@", "videoPhi"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.824922596963995*^9, 3.824922600965993*^9}, {
  3.825008426838578*^9, 
  3.8250084327638197`*^9}},ExpressionUUID->"8eb3aa1c-23a0-4c81-8b3c-\
112314055cf8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Parallel vvbar", "Subsubsection",
 CellChangeTimes->{{3.8245786100769663`*^9, 3.824578611646942*^9}, 
   3.82457887558888*^9, {3.824709771003086*^9, 
   3.8247097719723654`*^9}},ExpressionUUID->"074aedb4-e3b6-49d8-8a40-\
934a232b65a1"],

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"lX", ",", 
     RowBox[{"nX", "=", "101"}], ",", "lY", ",", 
     RowBox[{"nY", "=", "101"}], ",", "lZ", ",", 
     RowBox[{"nZ", "=", "101"}], ",", 
     RowBox[{"state", "=", "Type2Vortex"}], ",", "a", ",", 
     RowBox[{"\[Beta]", "=", "0.5"}], ",", 
     RowBox[{"v1", "=", "1"}], ",", 
     RowBox[{"\[Alpha]1", "=", "0."}], ",", 
     RowBox[{"\[Theta]1", "=", "0."}], ",", 
     RowBox[{"v2", "=", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"\[Alpha]2", "=", "0."}], ",", 
     RowBox[{"\[Theta]2", "=", 
      FractionBox["\[Pi]", "2."]}], ",", "\[IndentingNewLine]", "seed", ",", 
     RowBox[{"kerOrder", "=", "2"}], ",", 
     RowBox[{"dt", "=", ".001"}], ",", 
     RowBox[{"numSteps", "=", "40000"}], ",", 
     RowBox[{"checkpointInterval", "=", "100"}], ",", "\[IndentingNewLine]", 
     RowBox[{"filename", "=", "\"\<type2_parallel_vvbar_101\>\""}], ",", 
     "simulation", ",", "videoPhi", ",", "videoChi"}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lX", ",", "lY", ",", "lZ", ",", "a"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "3"}], "}"}], 
      RowBox[{"VortexSize", "@", "state"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"seed", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BiStringSeed", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
       RowBox[{"a", ",", "\[Beta]", ",", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "\[Alpha]1", ",", "\[Theta]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "\[Alpha]2", ",", "\[Theta]2"}], "}"}]}], "]"}], 
      "@", "state"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"simulation", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"RK4", "[", 
        RowBox[{"kerOrder", ",", "kerOrder", ",", "kerOrder"}], "]"}], "[", 
       RowBox[{"dt", ",", "numSteps", ",", "checkpointInterval"}], "]"}], "[", 
      RowBox[{"seed", ",", 
       RowBox[{"filename", "<>", "\"\<.h5\>\""}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"videoPhi", "=", 
     RowBox[{
      RowBox[{"MakeVideo", "[", "\[Phi]\[Chi]Plot", "]"}], "@", 
      "simulation"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"filename", "<>", "\"\<_phi.mp4\>\""}], ",", 
      RowBox[{"Video", "@", "videoPhi"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8008655175234547`*^9, 3.800865572441064*^9}, {
   3.800865655532649*^9, 3.800865664939019*^9}, {3.8008659126390123`*^9, 
   3.800865913900205*^9}, {3.800866180026248*^9, 3.8008661965193157`*^9}, {
   3.8008666616079464`*^9, 3.8008666619599876`*^9}, {3.800866702477378*^9, 
   3.800866725882569*^9}, {3.8008669928542557`*^9, 3.8008669946932564`*^9}, {
   3.800871890116412*^9, 3.8008719064843993`*^9}, {3.8008817692973204`*^9, 
   3.8008817867823486`*^9}, {3.800885598627492*^9, 3.800885628927495*^9}, {
   3.800885661093522*^9, 3.8008856663045225`*^9}, {3.8008859903423786`*^9, 
   3.8008859971363797`*^9}, {3.800886077186352*^9, 3.8008860784143486`*^9}, {
   3.8008862149615173`*^9, 3.8008862264630585`*^9}, {3.801374601635149*^9, 
   3.8013746104866834`*^9}, {3.8013746552042212`*^9, 3.801374655250216*^9}, {
   3.801374723585723*^9, 3.8013747368168364`*^9}, {3.8013759804885597`*^9, 
   3.8013759859298277`*^9}, {3.8013760225995626`*^9, 
   3.8013760482444105`*^9}, {3.8014551122863717`*^9, 3.801455113964009*^9}, {
   3.80145522148755*^9, 3.801455224260547*^9}, {3.801455454684285*^9, 
   3.8014554560818157`*^9}, {3.8014578669779243`*^9, 3.801457869986229*^9}, {
   3.801461650966761*^9, 3.8014616533797665`*^9}, 3.8020023787728558`*^9, 
   3.8020040351479917`*^9, {3.8027521942173414`*^9, 3.802752195456332*^9}, 
   3.804224177291499*^9, {3.804398721343706*^9, 3.80439872283424*^9}, {
   3.8073380130941696`*^9, 3.807338013300682*^9}, {3.809177239744445*^9, 
   3.8091772612784185`*^9}, {3.8092381709472494`*^9, 3.809238174449216*^9}, {
   3.8092383956506824`*^9, 3.809238407328707*^9}, {3.8092384453792825`*^9, 
   3.8092384546432247`*^9}, {3.80931912183934*^9, 3.8093191602498507`*^9}, {
   3.809319193193473*^9, 3.8093191936535845`*^9}, {3.80931951881666*^9, 
   3.809319523819171*^9}, {3.8206398062301455`*^9, 3.8206398074394927`*^9}, {
   3.820639869225546*^9, 3.820639870293442*^9}, {3.8239291802728786`*^9, 
   3.8239291803822155`*^9}, {3.8241831648149033`*^9, 3.824183175809044*^9}, {
   3.8241834414068575`*^9, 3.82418345273517*^9}, {3.824183597709011*^9, 
   3.824183645573535*^9}, {3.8241839855419664`*^9, 3.8241840529478545`*^9}, {
   3.824184167488969*^9, 3.824184182364702*^9}, {3.824184301263216*^9, 
   3.82418430479608*^9}, {3.8241844969721727`*^9, 3.8241844977567787`*^9}, {
   3.8241845322263722`*^9, 3.8241845359960938`*^9}, {3.824184575504114*^9, 
   3.824184579622549*^9}, {3.8241852377228055`*^9, 3.824185239209339*^9}, {
   3.824185282567751*^9, 3.824185283561133*^9}, {3.8241854932111673`*^9, 
   3.8241854953488283`*^9}, {3.824198492256491*^9, 3.8241984972746563`*^9}, {
   3.824203272150124*^9, 3.8242032934353576`*^9}, {3.8242064952047157`*^9, 
   3.824206499301737*^9}, {3.824230765612233*^9, 3.8242307657535734`*^9}, {
   3.8242313205108147`*^9, 3.8242313264191475`*^9}, {3.8242719659124117`*^9, 
   3.824271967209079*^9}, 3.824309689093691*^9, 3.824562549001395*^9, {
   3.8245626600711117`*^9, 3.8245626617047606`*^9}, {3.824562887053009*^9, 
   3.8245628916064787`*^9}, {3.824563342059928*^9, 3.824563374691862*^9}, {
   3.824566225981886*^9, 3.8245662538834257`*^9}, {3.824566428403637*^9, 
   3.8245664298790765`*^9}, {3.8245786137096996`*^9, 3.82457890531155*^9}, {
   3.824579038020715*^9, 3.824579039537761*^9}, {3.824642508856879*^9, 
   3.8246425095453105`*^9}, {3.8247097738558483`*^9, 
   3.8247097772710667`*^9}, {3.8249226101107063`*^9, 3.824922610267437*^9}, {
   3.825008454485981*^9, 
   3.8250084578260593`*^9}},ExpressionUUID->"18e41ec5-5495-416d-bc2a-\
c8f28fb2ef3d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"videoPhi", "=", 
   RowBox[{
    RowBox[{"MakeVideo", "[", "\[Phi]\[Chi]Plot", "]"}], "@", 
    RowBox[{
    "SimulationLoad", "@", "\"\<type2_parallel_vvbar_101.h5\>\""}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<type2_parallel_vvbar_101_phi.mp4\>\"", ",", 
   RowBox[{"Video", "@", "videoPhi"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8249226193490906`*^9, 3.8249226227262764`*^9}, {
  3.8250084607179365`*^9, 
  3.82500846270275*^9}},ExpressionUUID->"97dfa079-c1fa-4a9e-88ec-\
08ac6ae20213"]
}, Closed]],

Cell[CellGroupData[{

Cell["Antiparallel vvbar", "Subsubsection",
 CellChangeTimes->{{3.8245786100769663`*^9, 3.824578611646942*^9}, {
  3.8247098005795126`*^9, 
  3.8247098013454337`*^9}},ExpressionUUID->"96346a76-a1f1-4eca-9a44-\
5ad352290df0"],

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"lX", ",", 
     RowBox[{"nX", "=", "101"}], ",", "lY", ",", 
     RowBox[{"nY", "=", "101"}], ",", "lZ", ",", 
     RowBox[{"nZ", "=", "101"}], ",", 
     RowBox[{"state", "=", "Type2Vortex"}], ",", "a", ",", 
     RowBox[{"\[Beta]", "=", "0.5"}], ",", 
     RowBox[{"v1", "=", "1"}], ",", 
     RowBox[{"\[Alpha]1", "=", "0."}], ",", 
     RowBox[{"\[Theta]1", "=", "0."}], ",", 
     RowBox[{"v2", "=", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"\[Alpha]2", "=", 
      RowBox[{"N", "@", "\[Pi]"}]}], ",", 
     RowBox[{"\[Theta]2", "=", 
      RowBox[{"\[Pi]", "/", "2."}]}], ",", "\[IndentingNewLine]", "seed", ",", 
     RowBox[{"kerOrder", "=", "2"}], ",", 
     RowBox[{"dt", "=", ".001"}], ",", 
     RowBox[{"numSteps", "=", "40000"}], ",", 
     RowBox[{"checkpointInterval", "=", "100"}], ",", "\[IndentingNewLine]", 
     RowBox[{"filename", "=", "\"\<type2_antiparallel_vvbar_101\>\""}], ",", 
     "simulation", ",", "videoPhi", ",", "videoChi"}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lX", ",", "lY", ",", "lZ", ",", "a"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "3"}], "}"}], 
      RowBox[{"VortexSize", "@", "state"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"seed", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BiStringSeed", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
       RowBox[{"a", ",", "\[Beta]", ",", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "\[Alpha]1", ",", "\[Theta]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "\[Alpha]2", ",", "\[Theta]2"}], "}"}]}], "]"}], 
      "@", "state"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"simulation", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"RK4", "[", 
        RowBox[{"kerOrder", ",", "kerOrder", ",", "kerOrder"}], "]"}], "[", 
       RowBox[{"dt", ",", "numSteps", ",", "checkpointInterval"}], "]"}], "[", 
      RowBox[{"seed", ",", 
       RowBox[{"filename", "<>", "\"\<.h5\>\""}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"videoPhi", "=", 
     RowBox[{
      RowBox[{"MakeVideo", "[", "\[Phi]2Plot", "]"}], "@", "simulation"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"filename", "<>", "\"\<_phi.mp4\>\""}], ",", 
      RowBox[{"Video", "@", "videoPhi"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8008655175234547`*^9, 3.800865572441064*^9}, {
   3.800865655532649*^9, 3.800865664939019*^9}, {3.8008659126390123`*^9, 
   3.800865913900205*^9}, {3.800866180026248*^9, 3.8008661965193157`*^9}, {
   3.8008666616079464`*^9, 3.8008666619599876`*^9}, {3.800866702477378*^9, 
   3.800866725882569*^9}, {3.8008669928542557`*^9, 3.8008669946932564`*^9}, {
   3.800871890116412*^9, 3.8008719064843993`*^9}, {3.8008817692973204`*^9, 
   3.8008817867823486`*^9}, {3.800885598627492*^9, 3.800885628927495*^9}, {
   3.800885661093522*^9, 3.8008856663045225`*^9}, {3.8008859903423786`*^9, 
   3.8008859971363797`*^9}, {3.800886077186352*^9, 3.8008860784143486`*^9}, {
   3.8008862149615173`*^9, 3.8008862264630585`*^9}, {3.801374601635149*^9, 
   3.8013746104866834`*^9}, {3.8013746552042212`*^9, 3.801374655250216*^9}, {
   3.801374723585723*^9, 3.8013747368168364`*^9}, {3.8013759804885597`*^9, 
   3.8013759859298277`*^9}, {3.8013760225995626`*^9, 
   3.8013760482444105`*^9}, {3.8014551122863717`*^9, 3.801455113964009*^9}, {
   3.80145522148755*^9, 3.801455224260547*^9}, {3.801455454684285*^9, 
   3.8014554560818157`*^9}, {3.8014578669779243`*^9, 3.801457869986229*^9}, {
   3.801461650966761*^9, 3.8014616533797665`*^9}, 3.8020023787728558`*^9, 
   3.8020040351479917`*^9, {3.8027521942173414`*^9, 3.802752195456332*^9}, 
   3.804224177291499*^9, {3.804398721343706*^9, 3.80439872283424*^9}, {
   3.8073380130941696`*^9, 3.807338013300682*^9}, {3.809177239744445*^9, 
   3.8091772612784185`*^9}, {3.8092381709472494`*^9, 3.809238174449216*^9}, {
   3.8092383956506824`*^9, 3.809238407328707*^9}, {3.8092384453792825`*^9, 
   3.8092384546432247`*^9}, {3.80931912183934*^9, 3.8093191602498507`*^9}, {
   3.809319193193473*^9, 3.8093191936535845`*^9}, {3.80931951881666*^9, 
   3.809319523819171*^9}, {3.8206398062301455`*^9, 3.8206398074394927`*^9}, {
   3.820639869225546*^9, 3.820639870293442*^9}, {3.8239291802728786`*^9, 
   3.8239291803822155`*^9}, {3.8241831648149033`*^9, 3.824183175809044*^9}, {
   3.8241834414068575`*^9, 3.82418345273517*^9}, {3.824183597709011*^9, 
   3.824183645573535*^9}, {3.8241839855419664`*^9, 3.8241840529478545`*^9}, {
   3.824184167488969*^9, 3.824184182364702*^9}, {3.824184301263216*^9, 
   3.82418430479608*^9}, {3.8241844969721727`*^9, 3.8241844977567787`*^9}, {
   3.8241845322263722`*^9, 3.8241845359960938`*^9}, {3.824184575504114*^9, 
   3.824184579622549*^9}, {3.8241852377228055`*^9, 3.824185239209339*^9}, {
   3.824185282567751*^9, 3.824185283561133*^9}, {3.8241854932111673`*^9, 
   3.8241854953488283`*^9}, {3.824198492256491*^9, 3.8241984972746563`*^9}, {
   3.824203272150124*^9, 3.8242032934353576`*^9}, {3.8242064952047157`*^9, 
   3.824206499301737*^9}, {3.824230765612233*^9, 3.8242307657535734`*^9}, {
   3.8242313205108147`*^9, 3.8242313264191475`*^9}, {3.8242719659124117`*^9, 
   3.824271967209079*^9}, 3.824309689093691*^9, 3.824562549001395*^9, {
   3.8245626600711117`*^9, 3.8245626617047606`*^9}, {3.824562887053009*^9, 
   3.8245628916064787`*^9}, {3.824563342059928*^9, 3.824563374691862*^9}, {
   3.824566225981886*^9, 3.8245662538834257`*^9}, {3.824566428403637*^9, 
   3.8245664298790765`*^9}, {3.8245786137096996`*^9, 3.824578865727969*^9}, {
   3.8245790414392343`*^9, 3.8245790436442304`*^9}, {3.8246425142906165`*^9, 
   3.8246425147440557`*^9}, {3.8247097811409483`*^9, 3.82470978513059*^9}, {
   3.8249226289022126`*^9, 3.824922629074114*^9}, 
   3.8250084768672857`*^9},ExpressionUUID->"5a605a2f-10d2-437c-b9e7-\
4023805f737f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"videoPhi", "=", 
   RowBox[{
    RowBox[{"MakeVideo", "[", "\[Phi]\[Chi]Plot", "]"}], "@", 
    RowBox[{
    "SimulationLoad", "@", "\"\<type2_antiparallel_vvbar_101.h5\>\""}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<type2_antiparallel_vvbar_101_phi.mp4\>\"", ",", 
   RowBox[{"Video", "@", "videoPhi"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.824922641610671*^9, 3.8249226450954885`*^9}, {
  3.825008469878722*^9, 
  3.8250084714575596`*^9}},ExpressionUUID->"bca7e7b9-b64d-4dcb-981a-\
c889d2341e77"]
}, Closed]],

Cell[CellGroupData[{

Cell["Orthogonal vvbar", "Subsubsection",
 CellChangeTimes->{{3.8245786100769663`*^9, 3.824578611646942*^9}, {
  3.8245788985777416`*^9, 3.8245788996312227`*^9}, {3.82470980328356*^9, 
  3.8247098048312736`*^9}},ExpressionUUID->"fb05f996-4825-487e-8af0-\
f94c86ca1e6d"],

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"lX", ",", 
     RowBox[{"nX", "=", "101"}], ",", "lY", ",", 
     RowBox[{"nY", "=", "101"}], ",", "lZ", ",", 
     RowBox[{"nZ", "=", "101"}], ",", 
     RowBox[{"state", "=", "Type2Vortex"}], ",", "a", ",", 
     RowBox[{"\[Beta]", "=", "0.5"}], ",", 
     RowBox[{"v1", "=", "1"}], ",", 
     RowBox[{"\[Alpha]1", "=", "0."}], ",", 
     RowBox[{"\[Theta]1", "=", "0."}], ",", 
     RowBox[{"v2", "=", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"\[Alpha]2", "=", 
      FractionBox["\[Pi]", "2."]}], ",", 
     RowBox[{"\[Theta]2", "=", 
      FractionBox["\[Pi]", "2."]}], ",", "\[IndentingNewLine]", "seed", ",", 
     RowBox[{"kerOrder", "=", "2"}], ",", 
     RowBox[{"dt", "=", ".001"}], ",", 
     RowBox[{"numSteps", "=", "40000"}], ",", 
     RowBox[{"checkpointInterval", "=", "100"}], ",", "\[IndentingNewLine]", 
     RowBox[{"filename", "=", "\"\<type2_orthogonal_vvbar_101\>\""}], ",", 
     "simulation", ",", "videoPhi", ",", "videoChi"}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lX", ",", "lY", ",", "lZ", ",", "a"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "3"}], "}"}], 
      RowBox[{"VortexSize", "@", "state"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"seed", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BiStringSeed", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lX", ",", "nX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lY", ",", "nY"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lZ", ",", "nZ"}], "}"}]}], "]"}], "[", 
       RowBox[{"a", ",", "\[Beta]", ",", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "\[Alpha]1", ",", "\[Theta]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "\[Alpha]2", ",", "\[Theta]2"}], "}"}]}], "]"}], 
      "@", "state"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"simulation", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"RK4", "[", 
        RowBox[{"kerOrder", ",", "kerOrder", ",", "kerOrder"}], "]"}], "[", 
       RowBox[{"dt", ",", "numSteps", ",", "checkpointInterval"}], "]"}], "[", 
      RowBox[{"seed", ",", 
       RowBox[{"filename", "<>", "\"\<.h5\>\""}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"videoPhi", "=", 
     RowBox[{
      RowBox[{"MakeVideo", "[", "\[Phi]\[Chi]Plot", "]"}], "@", 
      "simulation"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"filename", "<>", "\"\<_phi.mp4\>\""}], ",", 
      RowBox[{"Video", "@", "videoPhi"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8008655175234547`*^9, 3.800865572441064*^9}, {
   3.800865655532649*^9, 3.800865664939019*^9}, {3.8008659126390123`*^9, 
   3.800865913900205*^9}, {3.800866180026248*^9, 3.8008661965193157`*^9}, {
   3.8008666616079464`*^9, 3.8008666619599876`*^9}, {3.800866702477378*^9, 
   3.800866725882569*^9}, {3.8008669928542557`*^9, 3.8008669946932564`*^9}, {
   3.800871890116412*^9, 3.8008719064843993`*^9}, {3.8008817692973204`*^9, 
   3.8008817867823486`*^9}, {3.800885598627492*^9, 3.800885628927495*^9}, {
   3.800885661093522*^9, 3.8008856663045225`*^9}, {3.8008859903423786`*^9, 
   3.8008859971363797`*^9}, {3.800886077186352*^9, 3.8008860784143486`*^9}, {
   3.8008862149615173`*^9, 3.8008862264630585`*^9}, {3.801374601635149*^9, 
   3.8013746104866834`*^9}, {3.8013746552042212`*^9, 3.801374655250216*^9}, {
   3.801374723585723*^9, 3.8013747368168364`*^9}, {3.8013759804885597`*^9, 
   3.8013759859298277`*^9}, {3.8013760225995626`*^9, 
   3.8013760482444105`*^9}, {3.8014551122863717`*^9, 3.801455113964009*^9}, {
   3.80145522148755*^9, 3.801455224260547*^9}, {3.801455454684285*^9, 
   3.8014554560818157`*^9}, {3.8014578669779243`*^9, 3.801457869986229*^9}, {
   3.801461650966761*^9, 3.8014616533797665`*^9}, 3.8020023787728558`*^9, 
   3.8020040351479917`*^9, {3.8027521942173414`*^9, 3.802752195456332*^9}, 
   3.804224177291499*^9, {3.804398721343706*^9, 3.80439872283424*^9}, {
   3.8073380130941696`*^9, 3.807338013300682*^9}, {3.809177239744445*^9, 
   3.8091772612784185`*^9}, {3.8092381709472494`*^9, 3.809238174449216*^9}, {
   3.8092383956506824`*^9, 3.809238407328707*^9}, {3.8092384453792825`*^9, 
   3.8092384546432247`*^9}, {3.80931912183934*^9, 3.8093191602498507`*^9}, {
   3.809319193193473*^9, 3.8093191936535845`*^9}, {3.80931951881666*^9, 
   3.809319523819171*^9}, {3.8206398062301455`*^9, 3.8206398074394927`*^9}, {
   3.820639869225546*^9, 3.820639870293442*^9}, {3.8239291802728786`*^9, 
   3.8239291803822155`*^9}, {3.8241831648149033`*^9, 3.824183175809044*^9}, {
   3.8241834414068575`*^9, 3.82418345273517*^9}, {3.824183597709011*^9, 
   3.824183645573535*^9}, {3.8241839855419664`*^9, 3.8241840529478545`*^9}, {
   3.824184167488969*^9, 3.824184182364702*^9}, {3.824184301263216*^9, 
   3.82418430479608*^9}, {3.8241844969721727`*^9, 3.8241844977567787`*^9}, {
   3.8241845322263722`*^9, 3.8241845359960938`*^9}, {3.824184575504114*^9, 
   3.824184579622549*^9}, {3.8241852377228055`*^9, 3.824185239209339*^9}, {
   3.824185282567751*^9, 3.824185283561133*^9}, {3.8241854932111673`*^9, 
   3.8241854953488283`*^9}, {3.824198492256491*^9, 3.8241984972746563`*^9}, {
   3.824203272150124*^9, 3.8242032934353576`*^9}, {3.8242064952047157`*^9, 
   3.824206499301737*^9}, {3.824230765612233*^9, 3.8242307657535734`*^9}, {
   3.8242313205108147`*^9, 3.8242313264191475`*^9}, {3.8242719659124117`*^9, 
   3.824271967209079*^9}, 3.824309689093691*^9, 3.824562549001395*^9, {
   3.8245626600711117`*^9, 3.8245626617047606`*^9}, {3.824562887053009*^9, 
   3.8245628916064787`*^9}, {3.824563342059928*^9, 3.824563374691862*^9}, {
   3.824566225981886*^9, 3.8245662538834257`*^9}, {3.824566428403637*^9, 
   3.8245664298790765`*^9}, {3.8245786137096996`*^9, 3.824578865727969*^9}, {
   3.8245789102547054`*^9, 3.8245789113749886`*^9}, {3.8245790036819935`*^9, 
   3.8245790487364583`*^9}, {3.8246425180970955`*^9, 3.824642518644557*^9}, {
   3.82470979055801*^9, 3.824709793258105*^9}, {3.8248165845451694`*^9, 
   3.8248165939502*^9}, {3.8249226529881926`*^9, 3.8249226531600695`*^9}, {
   3.825008487322791*^9, 
   3.82500848772921*^9}},ExpressionUUID->"8304bba9-7723-436d-88ba-\
4b0051cf02fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"videoPhi", "=", 
   RowBox[{
    RowBox[{"MakeVideo", "[", "\[Phi]\[Chi]Plot", "]"}], "@", 
    RowBox[{
    "SimulationLoad", "@", "\"\<type2_orthogonal_vvbar_101.h5\>\""}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<type2_orthogonal_vvbar_101_phi.mp4\>\"", ",", 
   RowBox[{"Video", "@", "videoPhi"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8249226673846445`*^9, 3.824922670307804*^9}, {
  3.8250084836410923`*^9, 
  3.8250084851727304`*^9}},ExpressionUUID->"14565724-d23c-4655-8175-\
9b14ebd2503a"]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["export", "Section",
 CellChangeTimes->{{3.8604143236492167`*^9, 
  3.860414326191234*^9}},ExpressionUUID->"7ccb1fc2-aab4-430f-8d2e-\
545b92e70893"],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\<C:\\\\Users\\\\Gamer\\\\Dropbox\\\\non-Abelian_global_vortex_string\>\"\
", "]"}]], "Input",
 CellChangeTimes->{{3.8629075086459885`*^9, 3.8629075176495514`*^9}, {
   3.864749485716591*^9, 3.864749504764062*^9}, {3.865182137485755*^9, 
   3.865182137704977*^9}, 3.8724105453831077`*^9},
 CellLabel->
  "In[103]:=",ExpressionUUID->"640968f1-983c-4ea7-86f1-398b9cba4514"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"SetDirectory", "[", "\"\<E:\\\\TEMP\\\\simul\>\"", "]"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.8650698590613384`*^9, 3.865069862875038*^9}, {
  3.8652691097825975`*^9, 
  3.865269111464038*^9}},ExpressionUUID->"2271201f-a084-43e1-8afe-\
f5cbb2f54f59"],

Cell[BoxData[
 RowBox[{"numberofSnapshots", "[", "\"\<simul1squarev7LX116LR100.h5\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.862907496633365*^9, 3.862907503765024*^9}, {
   3.862990161779625*^9, 3.862990162109945*^9}, 3.864751810201024*^9, {
   3.86475184996568*^9, 3.864751857547944*^9}, 3.8647538810102224`*^9, 
   3.8648199310117292`*^9, 3.8649009984078217`*^9, 3.8650668233191133`*^9, 
   3.8650684205937977`*^9, 3.865069880882471*^9, {3.8652067555725594`*^9, 
   3.865206757549713*^9}, {3.865243246630131*^9, 3.8652432484345512`*^9}, 
   3.865243898701478*^9, 3.865244846330556*^9, 3.865269162198024*^9, {
   3.8653306500268116`*^9, 3.8653306593874125`*^9}, {3.8653453415457973`*^9, 
   3.865345349639268*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"4788e3c7-2593-4d5b-a266-cef5c97dff82"],

Cell[BoxData[
 RowBox[{"SimulationLoad", "[", "\"\<sample_simulation.h5\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{
  3.8648205605447006`*^9, {3.8724105497473574`*^9, 3.872410551980751*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"3972e71a-3687-4117-be0d-b67a4c7a25b9"],

Cell[BoxData[
 RowBox[{"SimulationSnapshot", "[", 
  RowBox[{"%104", ",", "10"}], "]"}]], "Input",
 CellChangeTimes->{{3.8724105746457925`*^9, 3.872410582970521*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"01300ae0-d92a-4aad-a207-f48b887344be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BPlot", "[", 
   RowBox[{"0.75", ",", "True", ",", "False", ",", "1."}], "]"}], "[", "%105",
   "]"}]], "Input",
 CellChangeTimes->{{3.8724105935345078`*^9, 3.872410629632989*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"79185e69-4683-4fd4-bd4b-29682990475c"],

Cell[BoxData[
 RowBox[{"skippedSimulation", "[", 
  RowBox[{"\"\<simul_v7L116_dt0005.h5\>\"", ",", "1", ",", "5"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.864752206670209*^9, 3.8647522119016075`*^9}, 
   3.864752429770985*^9, {3.864753510966764*^9, 3.864753511907215*^9}, 
   3.8647536403374577`*^9, 3.864753718814374*^9, 3.864753786023409*^9, 
   3.8647538509072633`*^9, 3.8648205299522753`*^9, 3.8649006363438225`*^9, {
   3.8652068011842384`*^9, 3.8652068119431973`*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"946cdb9e-4bb0-487c-81a6-49549b0275d8"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.8675866660526037`*^9},ExpressionUUID->"2a33fd7e-39d2-466e-b588-\
b506c0a1ed70"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "SetDirectory", "[", "\"\<F:\\\\Vortex_simulations\\\\simul_email\>\"", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeVideonew", "[", 
    RowBox[{"\[Phi]\[Chi]Plot", "[", 
     RowBox[{".75", ",", "False", ",", "True", ",", "1."}], "]"}], "]"}], "[", 
   RowBox[{
   "\"\<simul201_v6lX116_pi3k0.h5\>\"", ",", "2", ",", "1", ",", "1", ",", 
    "61"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8653471689718904`*^9, 3.8653472017842417`*^9}, 
   3.86758665038858*^9, {3.867586740958864*^9, 3.8675867457727814`*^9}, {
   3.868093331302492*^9, 3.8680933314749064`*^9}, {3.8680933706316614`*^9, 
   3.868093372223468*^9}, 
   3.8682652567805853`*^9},ExpressionUUID->"8e944b0e-851e-44cb-8a84-\
e0e4330849a6"],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  "\"\<F:\\\\Vortex_simulations\\\\simul_email\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeVideonew", "[", 
   RowBox[{"\[Phi]\[Chi]Plot", "[", 
    RowBox[{".75", ",", "False", ",", "True", ",", "0.50"}], "]"}], "]"}], 
  "[", 
  RowBox[{
  "\"\<simul201_v6lX116_pi3k0.h5\>\"", ",", "2", ",", "1", ",", "1", ",", 
   "1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8680933839902925`*^9, 3.868093385187002*^9}, 
   3.868094761374507*^9, {3.8682003281973457`*^9, 3.868200329426036*^9}, {
   3.8682004396889024`*^9, 3.8682004494272594`*^9}, {3.868201155845992*^9, 
   3.868201172866115*^9}, {3.868201653337693*^9, 3.8682017235132904`*^9}, {
   3.8682018221029053`*^9, 3.8682018238395057`*^9}, {3.8682018681385775`*^9, 
   3.8682018818068123`*^9}, 3.868201948261686*^9, {3.868218379572112*^9, 
   3.86821838064233*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"aac67fc9-65f6-458e-a6ec-98c5cf3b8370"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "SetDirectory", "[", "\"\<F:\\\\Vortex_simulations\\\\videos_email\>\"", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<simul201_v6lX116_pi3k0box050_full.mp4\>\"", ",", 
    RowBox[{"Video", "@", "%93"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.8682010349490147`*^9, {3.8682011109162908`*^9, 3.8682011454616766`*^9}, {
   3.868201967817973*^9, 3.8682019741592455`*^9}, {3.868202023768368*^9, 
   3.8682020331116266`*^9}, {3.868218390827137*^9, 3.8682184009122334`*^9}, {
   3.8682653089931307`*^9, 3.8682653137353487`*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"f1243898-bf2d-417d-8295-18ccbff6e298"],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  "\"\<F:\\\\Vortex_simulations\\\\simul_email\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeVideonew", "[", 
   RowBox[{"\[Phi]\[Chi]Plot", "[", 
    RowBox[{".75", ",", "False", ",", "True", ",", "0.50"}], "]"}], "]"}], 
  "[", 
  RowBox[{
  "\"\<simul201_v6lX116_pi3k8.h5\>\"", ",", "2", ",", "1", ",", "1", ",", 
   "1"}], "]"}]}], "Input",
 CellChangeTimes->{
  3.868202156707554*^9, {3.868218407615159*^9, 3.8682184093342004`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"69480092-e1cc-4995-8b66-c854b2296608"],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\<F:\\\\Vortex_simulations\\\\simul_email\>\"", "]"}]], "Input",
 CellLabel->"In[97]:=",ExpressionUUID->"2f7cdcef-2485-4eb3-902b-c037da458606"],

Cell[BoxData["ClearAll"], "Input",
 CellChangeTimes->{{3.8682741251587152`*^9, 3.8682741263795776`*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"ab83f3e9-8c14-4403-aa05-44ff3ef2735b"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"Unprotect", "@", "Out"}], "]"}]], "Input",
 CellChangeTimes->{{3.8682741607775173`*^9, 3.868274170858686*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"965239c9-4e15-4c53-9669-b7e8f8874bd7"],

Cell[BoxData[
 RowBox[{"MemoryInUse", "[", "]"}]], "Input",
 CellChangeTimes->{{3.868274204215329*^9, 3.8682742121225576`*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"2c89a90a-66c1-4753-bf25-eb830ef2b2aa"],

Cell[BoxData[
 RowBox[{"ClearSystemCache", "[", "]"}]], "Input",
 CellChangeTimes->{{3.868274239926012*^9, 3.868274244432976*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"62d9bb0c-c23b-4ebb-bf9f-780cc8f08d32"],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\<F:\\\\Vortex_simulations\\\\simul_of_list\>\"", "]"}]], "Input",
 CellChangeTimes->{
  3.8682746029557877`*^9, 3.8684312108799725`*^9, {3.869564110614128*^9, 
   3.869564114546444*^9}, {3.8695641490158625`*^9, 3.86956415664925*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"17c95609-6809-427b-86e3-5601f556a861"],

Cell[BoxData[
 RowBox[{"MemoryInUse", "[", "]"}]], "Input",
 CellLabel->"In[94]:=",ExpressionUUID->"1ac4c668-3f3e-40f1-a85c-6228fa86926b"],

Cell[BoxData[
 RowBox[{"numberofSnapshots", "[", "\"\<simul351_v6lX279alpha0beta90.h5\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.869564633054139*^9, 3.869564649744122*^9}, 
   3.871143456920723*^9},
 CellLabel->
  "In[125]:=",ExpressionUUID->"af5b5491-4c81-43a2-a83b-9e9983de40af"],

Cell[BoxData[
 RowBox[{"Clear", "[", "Out", "]"}]], "Input",
 CellChangeTimes->{{3.868275006623315*^9, 3.8682750087928143`*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"3326df16-dd7d-4d3a-8dcc-e637f07ac632"],

Cell[BoxData["Quit"], "Input",
 CellChangeTimes->{{3.868275243998875*^9, 3.8682752443641124`*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"c1f6285b-9eb8-4f4b-9d85-c9f39e1de0b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "SetDirectory", "[", "\"\<F:\\\\Vortex_simulations\\\\simul_of_list\>\"", 
   "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"MakeVideoExport", "[", 
   RowBox[{"\[Phi]\[Chi]Plot", "[", 
    RowBox[{".75", ",", "False", ",", "True", ",", "1."}], "]"}], "]"}], "[", 
  RowBox[{
  "\"\<simul351_v6lX279alpha0beta90.h5\>\"", ",", "4", ",", "1", ",", "1", 
   ",", "1"}], "]"}]}], "Input",
 CellChangeTimes->{
  3.8682746029557877`*^9, 3.8684312108799725`*^9, {3.869564110614128*^9, 
   3.869564114546444*^9}, {3.8695641490158625`*^9, 3.86956415664925*^9}, {
   3.8711508841561265`*^9, 3.871150890701354*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"b460a770-6feb-43d5-91a5-82e164e98777"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "SetDirectory", "[", "\"\<F:\\\\Vortex_simulations\\\\simul_of_list\>\"", 
   "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"MakeVideoExportchop", "[", 
   RowBox[{"\[Phi]\[Chi]Plot", "[", 
    RowBox[{".75", ",", "False", ",", "True", ",", "1."}], "]"}], "]"}], "[", 
  RowBox[{
  "\"\<simul351_v7lX279alpha0beta0.h5\>\"", ",", "130", ",", "1", ",", "1", 
   ",", "1"}], "]"}]}], "Input",
 CellChangeTimes->{
  3.871153679326459*^9, {3.871158350780283*^9, 3.8711583512180085`*^9}, {
   3.8711621452282543`*^9, 3.8711621542377615`*^9}, 3.8712010036117764`*^9, {
   3.8712037188460445`*^9, 3.8712037193051276`*^9}, {3.8712081634609013`*^9, 
   3.8712081730861907`*^9}, 3.871211033525951*^9, {3.871213814672521*^9, 
   3.871213815818729*^9}, {3.8712238174789643`*^9, 3.87122381946818*^9}, 
   3.8712264290542364`*^9, {3.8712289994987526`*^9, 3.871228999916712*^9}, {
   3.8712320235700693`*^9, 3.8712320284883766`*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"e4bfbe7d-6977-4f85-8b46-da0dfbb4bf31"],

Cell[BoxData["Quit"], "Input",
 CellChangeTimes->{{3.8712330760514126`*^9, 3.871233076487071*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"386d5a4d-e767-4805-8e3c-953b1c5938e1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "SetDirectory", "[", "\"\<F:\\\\Vortex_simulations\\\\simul_of_list\>\"", 
   "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeVideoExportchop", "[", 
    RowBox[{"\[Phi]\[Chi]Plot", "[", 
     RowBox[{".75", ",", "False", ",", "True", ",", "1."}], "]"}], "]"}], "[", 
   RowBox[{
   "\"\<simul351_v8lX279alpha180beta0.h5\>\"", ",", "130", ",", "1", ",", "1",
     ",", "1"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "SetDirectory", "[", "\"\<F:\\\\Vortex_simulations\\\\simul_of_list\>\"", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeVideoExportchop", "[", 
    RowBox[{"\[Phi]\[Chi]Plot", "[", 
     RowBox[{".75", ",", "False", ",", "True", ",", "1."}], "]"}], "]"}], "[", 
   RowBox[{
   "\"\<simul351_v8lX279alpha180beta90.h5\>\"", ",", "130", ",", "1", ",", 
    "1", ",", "1"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "SetDirectory", "[", "\"\<F:\\\\Vortex_simulations\\\\simul_of_list\>\"", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeVideoExportchop", "[", 
    RowBox[{"\[Phi]\[Chi]Plot", "[", 
     RowBox[{".75", ",", "False", ",", "True", ",", "1."}], "]"}], "]"}], "[", 
   RowBox[{
   "\"\<simul351_v8lX279alpha180beta180.h5\>\"", ",", "130", ",", "1", ",", 
    "1", ",", "1"}], "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8712328940718575`*^9, 3.8712328982954135`*^9}, {
   3.8712330028981733`*^9, 3.8712330658289795`*^9}, {3.8712331074696193`*^9, 
   3.8712331109213524`*^9}, {3.871234211490383*^9, 3.8712342233293295`*^9}, {
   3.8712384898471246`*^9, 3.871238491778863*^9}, {3.8712385275297008`*^9, 
   3.8712385320928063`*^9}, {3.871278716978773*^9, 3.8712787399407196`*^9}, {
   3.871288116697668*^9, 3.8712881269841623`*^9}, {3.8713004909457464`*^9, 
   3.871300554897355*^9}, {3.8713006126387696`*^9, 3.871300613007289*^9}, {
   3.871311348355775*^9, 3.871311379108616*^9}, {3.8713275365516443`*^9, 
   3.871327549798187*^9}, {3.871362930987523*^9, 3.8713629655620475`*^9}, {
   3.8713707412842464`*^9, 3.8713707743417554`*^9}, 
   3.871382764149579*^9},ExpressionUUID->"14b031bd-6473-49bf-a6db-\
fe85b6303729"],

Cell[BoxData["Quit"], "Input",
 CellChangeTimes->{{3.871648180501935*^9, 3.871648181121297*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"c4f0be77-53f4-439e-8651-cf89f26c2954"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "SetDirectory", "[", "\"\<F:\\\\Vortex_simulations\\\\simul_of_list\>\"", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeVideoExportchop", "[", 
    RowBox[{"\[Phi]\[Chi]Plot", "[", 
     RowBox[{".75", ",", "False", ",", "True", ",", "1."}], "]"}], "]"}], "[", 
   RowBox[{
   "\"\<simulreseed351_v5lX279withcurrents.h5\>\"", ",", "130", ",", "1", ",",
     "1", ",", "1"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8714625646752405`*^9, 3.8714625793705425`*^9}, {
   3.8714626227207212`*^9, 3.8714626636933184`*^9}, 3.871465780048174*^9, 
   3.871721372420931*^9},
 CellLabel->"In[99]:=",ExpressionUUID->"a4423218-088c-4527-94e1-e334cb9f8307"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "SetDirectory", "[", "\"\<F:\\\\Vortex_simulations\\\\simul_of_list\>\"", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeVideoExportchop", "[", 
    RowBox[{"\[Phi]\[Chi]Plot", "[", 
     RowBox[{".75", ",", "False", ",", "True", ",", "1."}], "]"}], "]"}], "[", 
   RowBox[{
   "\"\<simulreseed351_v5sep2lX279nocurrents.h5\>\"", ",", "130", ",", "1", 
    ",", "1", ",", "1"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.871721438590994*^9, 3.871809340659582*^9, 3.871892181158691*^9, 
   3.872148096104644*^9, {3.872320341965483*^9, 3.8723203554300985`*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"2181699b-7a61-4e8a-bbdf-48439f15fedc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SendMail", "[", 
   RowBox[{
    RowBox[{"{", "\"\<gianni2k@gmail.com\>\"", 
     RowBox[{"(*", 
      RowBox[{",", "\"\<martinonetto93@gmail.com\>\""}], "*)"}], "}"}], ",", 
    "\"\<Finished making video - \[DownExclamation]DALE con el otro!\>\""}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8714626697888007`*^9, 3.8714626741938996`*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"f5f03c24-8fe6-4bae-b957-330df92137b5"],

Cell[BoxData[
 RowBox[{"pp2", "//", "Dimensions"}]], "Input",
 CellChangeTimes->{{3.8724115838284364`*^9, 3.872411585476718*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"04efd389-2f64-4d45-bd17-93990407d686"],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\<F:\\\\Vortex_simulations\\\\simul_of_list\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.872587975749277*^9, 3.8725879792585697`*^9}, 
   3.8725884546980762`*^9},
 CellLabel->
  "In[201]:=",ExpressionUUID->"619b45f7-db30-4151-949c-9d9d5146157d"],

Cell[BoxData[
 RowBox[{"skippedSimulation", "[", 
  RowBox[{"\"\<simul351_v8lX279alpha90beta180.h5\>\"", ",", "1", ",", "14"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8725891365333133`*^9, 3.8725891641820755`*^9}},
 CellLabel->
  "In[208]:=",ExpressionUUID->"30c0d785-5f0d-4ac0-80cc-2550b2c635de"],

Cell[BoxData[
 RowBox[{"simul", "=", 
  RowBox[{"choppedSimulation", "[", 
   RowBox[{
   "\"\<simul351_v8lX279alpha90beta180.h5\>\"", ",", "1", ",", "120"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.8648205605447006`*^9, {3.8724105497473574`*^9, 3.872410551980751*^9}, {
   3.872412071810953*^9, 3.8724120732358356`*^9}, 3.872587944284069*^9, 
   3.8725880164873915`*^9, 3.8725884749092245`*^9, 3.8725891942781253`*^9, {
   3.872589257921336*^9, 3.87258925991416*^9}, {3.8725893325724545`*^9, 
   3.8725893494925537`*^9}},
 CellLabel->
  "In[216]:=",ExpressionUUID->"3b2a5045-1d7e-49d4-8171-93dfd81ddae1"],

Cell[BoxData[
 RowBox[{"f", "=", 
  RowBox[{
   RowBox[{"BPlot", "[", 
    RowBox[{
    "0.75", ",", "True", ",", "False", ",", "1.", ",", "12", ",", "0.95"}], 
    "]"}], "[", "simul", "]"}]}]], "Input",
 CellChangeTimes->{{3.8724105935345078`*^9, 3.872410629632989*^9}, {
   3.872412082049366*^9, 3.8724120825461826`*^9}, {3.872413738190611*^9, 
   3.8724137651703854`*^9}, {3.872413808157501*^9, 3.8724138106738977`*^9}, 
   3.8724140254502687`*^9, 3.872423418017868*^9, 3.872423741177703*^9, 
   3.872423814239263*^9, 3.8724241211764045`*^9, {3.8725880276860743`*^9, 
   3.8725880279254084`*^9}, 3.8725881456979637`*^9, 3.8725885086114516`*^9, {
   3.8725887320091953`*^9, 3.872588732097741*^9}, {3.8725892220289593`*^9, 
   3.8725892308303485`*^9}, 3.8725893677520094`*^9, 3.872589692986935*^9, {
   3.872589916885388*^9, 3.8725899171352897`*^9}, {3.8725912479882245`*^9, 
   3.8725912496737413`*^9}},
 CellLabel->
  "In[287]:=",ExpressionUUID->"5fa9b4a7-ffb8-47b5-a273-b382d79a1fa4"],

Cell[BoxData[
 RowBox[{"numberofSnapshots", "[", 
  "\"\<simul351_v8lX279alpha90beta180.h5\>\"", "]"}]], "Input",
 CellChangeTimes->{3.872591468481358*^9},
 CellLabel->
  "In[254]:=",ExpressionUUID->"950daf5f-53a9-45b2-abe3-002b5b4ad26b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "SetDirectory", "[", "\"\<F:\\\\Vortex_simulations\\\\simul_of_list\>\"", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeVideoBExportchop", "[", 
    RowBox[{"BPlot", "[", 
     RowBox[{
     "0.75", ",", "True", ",", "False", ",", "1.", ",", "12", ",", "0.95"}], 
     "]"}], "]"}], "[", 
   RowBox[{
   "\"\<simul351_v8lX279alpha90beta180.h5\>\"", ",", "120", ",", "1", ",", 
    "1", ",", "61"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8725914078041935`*^9, 3.8725914173996835`*^9}, {
   3.8725914797853723`*^9, 3.87259147998383*^9}, 3.8725931261285243`*^9},
 CellLabel->
  "In[288]:=",ExpressionUUID->"a6a7ac2e-31df-40ea-a330-b5fa2b589d8f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SendMail", "[", 
   RowBox[{
    RowBox[{"{", "\"\<gianni2k@gmail.com\>\"", 
     RowBox[{"(*", 
      RowBox[{",", "\"\<martinonetto93@gmail.com\>\""}], "*)"}], "}"}], ",", 
    "\"\<Finished making video - \[DownExclamation]DALE con el otro!\>\""}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.872595602728799*^9},ExpressionUUID->"11f326ae-297e-4ea3-9bb9-\
f25832803377"]
}, Closed]]
}, Open  ]]
},
Evaluator->"Local",
WindowSize->{1206.75, 657.},
WindowMargins->{{92.25, Automatic}, {35.25, Automatic}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"8c8feb71-080a-4b1f-97b1-86c0fd51d7f7"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 244, 5, 48, "Input",ExpressionUUID->"bd09108c-6d4e-44ca-95b8-51671364dc03"],
Cell[CellGroupData[{
Cell[827, 29, 159, 3, 98, "Title",ExpressionUUID->"10bf2179-5cd1-4f5f-974b-8e58188d73ae"],
Cell[CellGroupData[{
Cell[1011, 36, 220, 4, 54, "Subsection",ExpressionUUID->"2bc8e43f-60b8-46c3-9ef0-e2cad7283856"],
Cell[1234, 42, 446, 8, 35, "Text",ExpressionUUID->"d8409005-28ae-4865-a82d-105f787891b0"],
Cell[1683, 52, 348, 7, 28, "Input",ExpressionUUID->"e2a33282-ece9-49e3-a694-b4b2ad44bd2c"],
Cell[2034, 61, 496, 9, 35, "Text",ExpressionUUID->"46cd8e13-16fd-4914-ae5c-c75d436a13d1"],
Cell[2533, 72, 627, 20, 35, "Text",ExpressionUUID->"230eba1e-d0d4-41c6-9109-6683f22c4ee9"],
Cell[3163, 94, 381, 6, 64, "Input",ExpressionUUID->"b877b078-10b5-414a-b6ea-42021d06cc75",
 InitializationCell->True],
Cell[3547, 102, 241, 6, 35, "Text",ExpressionUUID->"615da762-8b08-467d-9bb0-d0815964ba86"],
Cell[3791, 110, 371, 7, 28, "Input",ExpressionUUID->"de92765d-2c4d-44bc-b566-f587eccb30b2"],
Cell[4165, 119, 862, 18, 58, "Text",ExpressionUUID->"33287a3a-a6ad-4501-b2c6-7f90e266b558"],
Cell[5030, 139, 1474, 28, 67, "Input",ExpressionUUID->"17453dc6-d650-4670-afb3-693b567e0412"],
Cell[6507, 169, 256, 6, 35, "Text",ExpressionUUID->"c337e044-888a-4402-9111-01cdf6e8680b"],
Cell[6766, 177, 434, 9, 48, "Input",ExpressionUUID->"394eb3b0-7095-4f21-91b2-1671415cb270"],
Cell[7203, 188, 1186, 30, 58, "Text",ExpressionUUID->"875099d6-384c-4e9a-98b0-3f3e423935ae"],
Cell[8392, 220, 601, 11, 44, "Input",ExpressionUUID->"eda00656-0c61-4c5d-b16b-5a04ad7dce81",
 InitializationCell->True],
Cell[8996, 233, 491, 13, 35, "Text",ExpressionUUID->"0495c2ad-c806-4aa7-a92d-1b74e2b3ba9a"],
Cell[9490, 248, 913, 14, 44, "Input",ExpressionUUID->"d69fbf29-3c84-4ec4-8504-d026c408d1c8",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[10440, 267, 191, 3, 54, "Subsection",ExpressionUUID->"eb2294c5-bc49-4220-8b23-f16185eb55b7"],
Cell[10634, 272, 2081, 63, 127, "Text",ExpressionUUID->"bd70798e-d46a-4b4f-9fbe-fbfa7b05fbbc"],
Cell[12718, 337, 272, 7, 28, "Input",ExpressionUUID->"9f9b0f91-60cf-4fe5-baa1-b1054723d0af"],
Cell[12993, 346, 3033, 57, 103, "Input",ExpressionUUID->"63bf18d6-b566-40ff-9cde-58432a260da8"],
Cell[CellGroupData[{
Cell[16051, 407, 3085, 56, 102, "Input",ExpressionUUID->"f0358cee-1759-4856-a079-f4b305167937"],
Cell[CellGroupData[{
Cell[19161, 467, 1164, 25, 22, "Print",ExpressionUUID->"9af924b4-f1a1-4291-85f2-a055e58064ad"],
Cell[20328, 494, 468, 11, 22, "Print",ExpressionUUID->"bd1fd804-b469-486d-927b-6615207572f9"]
}, Open  ]]
}, Open  ]],
Cell[20823, 509, 449, 12, 35, "Text",ExpressionUUID->"7a4e02b2-3edb-4d3c-a1e0-10863a6584c0"],
Cell[21275, 523, 211, 3, 28, "Input",ExpressionUUID->"cac3a15a-f526-4aeb-b5c8-c9859f4daeba"],
Cell[21489, 528, 191, 3, 35, "Text",ExpressionUUID->"1944f320-0692-4a6b-a89b-42fa78c799b9"],
Cell[21683, 533, 219, 3, 28, "Input",ExpressionUUID->"34d3994e-df0b-4c02-b89d-741ed0cd18cd"],
Cell[CellGroupData[{
Cell[21927, 540, 262, 4, 45, "Subsubsection",ExpressionUUID->"a99d3d92-9d18-456c-9ba4-5a5c48c0288d"],
Cell[22192, 546, 7042, 213, 461, "Text",ExpressionUUID->"6a3402e4-958f-499b-8181-f684751ea0d0"],
Cell[29237, 761, 577, 13, 28, "Input",ExpressionUUID->"3c323a71-1a58-4a02-a003-6e4ed214584c"],
Cell[29817, 776, 578, 14, 28, "Input",ExpressionUUID->"ecf072b6-ca4e-458b-8c29-0c4b8daa4b45"],
Cell[30398, 792, 344, 8, 28, "Input",ExpressionUUID->"f19cfe20-c5c1-4dbb-82b2-0efca1bef64e"],
Cell[30745, 802, 7271, 122, 105, "Input",ExpressionUUID->"7af1ef31-72e2-45a0-800d-5118c9e3daab"],
Cell[38019, 926, 343, 6, 28, "Input",ExpressionUUID->"258a0d9a-7d98-41d5-abc4-1063cf350a99"],
Cell[38365, 934, 779, 15, 28, "Input",ExpressionUUID->"d0d579ba-9165-4291-a108-8f2830c7a3e8"],
Cell[39147, 951, 7131, 122, 105, "Input",ExpressionUUID->"2c9e5d37-7426-44f2-8bef-fcf24c9dfc6a"],
Cell[46281, 1075, 651, 13, 28, "Input",ExpressionUUID->"53b20b84-f573-431d-a18b-23cfccd824e6"],
Cell[46935, 1090, 403, 12, 35, "Text",ExpressionUUID->"d56d85df-dbea-442e-8964-bdc7057b1949"],
Cell[47341, 1104, 259, 4, 28, "Input",ExpressionUUID->"700e483c-0238-483d-afe2-26cc24cf2caf"],
Cell[47603, 1110, 191, 3, 35, "Text",ExpressionUUID->"0424866f-e0b0-443f-8c8a-d8c5b0f81a1d"],
Cell[47797, 1115, 220, 4, 28, "Input",ExpressionUUID->"cb2ae4d1-eb32-4cf9-84ca-4c9dea23bdd3"],
Cell[48020, 1121, 151, 3, 28, "Input",ExpressionUUID->"d1239ec6-d2e6-471d-b7ac-b79d84f31fce"],
Cell[48174, 1126, 324, 8, 35, "Text",ExpressionUUID->"917a6534-26fa-4b4b-bec4-5ca1e1333c97"],
Cell[CellGroupData[{
Cell[48523, 1138, 287, 6, 28, "Input",ExpressionUUID->"0682a395-94bd-45f4-8138-00a6c4ae409c"],
Cell[48813, 1146, 195, 3, 32, "Output",ExpressionUUID->"caf936b2-582b-4c25-b947-854447405244"]
}, Open  ]],
Cell[49023, 1152, 416, 10, 28, "Input",ExpressionUUID->"27de5397-3a70-499d-8841-880e6624654d"],
Cell[49442, 1164, 241, 4, 28, "Input",ExpressionUUID->"7ccb58c9-d6e8-4404-8cda-c28619ffdbb5"],
Cell[49686, 1170, 451, 8, 28, "Input",ExpressionUUID->"2e56f7bd-e856-4eff-a7af-eb8511c76245"],
Cell[50140, 1180, 181, 3, 28, "Input",ExpressionUUID->"5ac909b6-626a-416e-ad5a-39faaecc955a"],
Cell[50324, 1185, 603, 16, 28, "Input",ExpressionUUID->"2a6904d5-bb6a-4ead-a496-216bc99288c4"],
Cell[CellGroupData[{
Cell[50952, 1205, 408, 10, 28, "Input",ExpressionUUID->"32ff5555-1389-457e-91dd-02eab13f1bf8"],
Cell[51363, 1217, 252, 6, 32, "Output",ExpressionUUID->"5b14b08e-a8d2-4608-9129-b53f9769cc1d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51652, 1228, 334, 7, 28, "Input",ExpressionUUID->"d8170dc2-0520-4080-ab58-e905a097a153"],
Cell[51989, 1237, 208, 5, 32, "Output",ExpressionUUID->"baa14b99-d1d6-4792-abf0-9ec6a8183607"]
}, Open  ]],
Cell[52212, 1245, 292, 7, 35, "Text",ExpressionUUID->"83758110-c4bb-4c2c-9a8c-081c8a9f45c0"],
Cell[CellGroupData[{
Cell[52529, 1256, 8486, 175, 333, "Input",ExpressionUUID->"238c3eed-6187-4359-aa88-cc86feb59a90"],
Cell[61018, 1433, 160, 3, 32, "Output",ExpressionUUID->"50cdbd87-8998-4e2c-92fc-7f6bdf32695e"]
}, Open  ]],
Cell[61193, 1439, 130, 3, 28, "Input",ExpressionUUID->"b13d8131-98a1-4194-a39d-59d7dc3e5e6b"],
Cell[CellGroupData[{
Cell[61348, 1446, 263, 5, 28, "Input",ExpressionUUID->"ea6664d9-4a01-42b8-b2cd-1804be5f5ad6"],
Cell[61614, 1453, 308, 5, 32, "Output",ExpressionUUID->"9facf7fc-3f86-44fb-b3d6-abd406ed51f6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61959, 1463, 644, 10, 28, "Input",ExpressionUUID->"d0024213-be48-4790-b948-5ff5cb540800"],
Cell[62606, 1475, 300, 5, 32, "Output",ExpressionUUID->"5c7760ac-456c-4e07-9d9e-d3953b8dfb84"]
}, Open  ]],
Cell[62921, 1483, 179, 3, 28, "Input",ExpressionUUID->"7977ad08-1e11-479d-aa50-cb29b860e5ee"],
Cell[63103, 1488, 654, 14, 28, "Input",ExpressionUUID->"ea5fd412-bf70-4317-890c-33763b79388d"],
Cell[63760, 1504, 580, 16, 28, "Input",ExpressionUUID->"65b5d63a-7aee-45de-abcb-577d6a95b544"],
Cell[64343, 1522, 149, 3, 48, "Input",ExpressionUUID->"87b9d3f5-3b96-4688-83b9-ae286ae09ae2"],
Cell[64495, 1527, 313, 8, 28, "Input",ExpressionUUID->"4da83574-415e-4ec4-bc8f-6cc1f6d0e960"],
Cell[64811, 1537, 336, 6, 28, "Input",ExpressionUUID->"7800ef88-b243-4e99-a94c-589ed0cabc0a"],
Cell[65150, 1545, 1041, 18, 28, "Input",ExpressionUUID->"d02b3c88-b8d7-439b-8375-44f053b3b51e"],
Cell[66194, 1565, 285, 6, 28, "Input",ExpressionUUID->"387c6d8d-4883-4548-9203-cdc6070f1d48"],
Cell[66482, 1573, 226, 5, 35, "Text",ExpressionUUID->"5f46d9be-ae69-41da-8faf-50ee7411a485"],
Cell[66711, 1580, 5861, 101, 127, "Input",ExpressionUUID->"0adddd70-5171-4b64-a900-95608303abbb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72609, 1686, 386, 5, 45, "Subsubsection",ExpressionUUID->"2055f859-b118-4b0c-9c30-6caffb82ab7d"],
Cell[72998, 1693, 3937, 96, 311, "Text",ExpressionUUID->"401f9fa8-e228-4535-9424-90ce5e54eb28"],
Cell[76938, 1791, 179, 3, 28, "Input",ExpressionUUID->"ebd24978-73b4-48fe-bf96-101404c34624"],
Cell[77120, 1796, 400, 10, 28, "Input",ExpressionUUID->"d6afdbf7-d842-4f7a-b9cc-7bdf7f787306"],
Cell[77523, 1808, 608, 12, 28, "Input",ExpressionUUID->"d40a1a77-58f9-42dd-ad2f-95e87955d723"],
Cell[78134, 1822, 193, 3, 28, "Input",ExpressionUUID->"afb85f60-371f-440f-93fb-9d6866cbc2ff"],
Cell[78330, 1827, 214, 4, 28, "Input",ExpressionUUID->"d7a24126-d723-4492-b2a2-3c33d338efdd"],
Cell[78547, 1833, 219, 3, 28, "Input",ExpressionUUID->"a4f111d1-458c-4c12-a176-056485f919bf"],
Cell[78769, 1838, 500, 11, 28, "Input",ExpressionUUID->"d8330c00-0f8e-4d27-9792-0f5410a43e03"],
Cell[79272, 1851, 458, 14, 28, "Input",ExpressionUUID->"67b35dac-8731-452f-8b1f-975c56fe26bc"],
Cell[79733, 1867, 154, 3, 28, "Input",ExpressionUUID->"39ac896b-a9a3-4296-bca2-5a4bec90f157"],
Cell[79890, 1872, 503, 9, 28, "Input",ExpressionUUID->"b0d4dc48-5b24-42c8-8012-8aad0835e9fa"],
Cell[80396, 1883, 271, 5, 28, "Input",ExpressionUUID->"7eadb021-46e1-4524-bc38-2c18e2d2876d"],
Cell[80670, 1890, 410, 9, 28, "Input",ExpressionUUID->"085ad4dc-2700-45f7-bb30-59f195b87a51"],
Cell[81083, 1901, 3799, 62, 67, "Input",ExpressionUUID->"5c12559d-b3ae-41a7-8386-93635d416f18"],
Cell[84885, 1965, 409, 10, 28, "Input",ExpressionUUID->"c55b2a2f-7ee8-4a00-939c-330c83667765"],
Cell[85297, 1977, 327, 8, 28, "Input",ExpressionUUID->"3975d977-c1ad-4652-a597-3fd01a86ea00"],
Cell[85627, 1987, 565, 15, 28, "Input",ExpressionUUID->"998df0ee-b688-4a1c-9418-e5bf5137510e"],
Cell[86195, 2004, 154, 3, 28, "Input",ExpressionUUID->"dd880424-6f74-42a4-9c3c-3c1d70eb4f4a"],
Cell[86352, 2009, 318, 6, 28, "Input",ExpressionUUID->"d0c5d424-8326-4961-97b1-42dcab2e3c43"],
Cell[86673, 2017, 478, 11, 48, "Input",ExpressionUUID->"b75fcbca-1479-4dc4-9358-d15f3b8d35cb"],
Cell[87154, 2030, 492, 14, 28, "Input",ExpressionUUID->"70a4fbcf-1e06-4ed4-b87a-4952c27c8ab9"],
Cell[87649, 2046, 286, 6, 28, "Input",ExpressionUUID->"0d243edf-ac1e-4cff-81b4-fa4725f99f3a"],
Cell[87938, 2054, 244, 5, 28, "Input",ExpressionUUID->"e4d36960-9f84-4ca6-9214-e057b58731ba"],
Cell[88185, 2061, 493, 14, 28, "Input",ExpressionUUID->"c3bfd89e-0441-4189-8a78-f10a0d6950e1"],
Cell[88681, 2077, 365, 10, 35, "Text",ExpressionUUID->"1b5db81d-5772-438e-a8cd-d49291ea22d6"],
Cell[89049, 2089, 220, 4, 28, "Input",ExpressionUUID->"fdc1536e-b2d5-4048-adf0-b9881bff358f"],
Cell[89272, 2095, 195, 3, 35, "Text",ExpressionUUID->"a0167bbb-5c29-47e8-9968-e703487b3366"],
Cell[89470, 2100, 229, 4, 28, "Input",ExpressionUUID->"7cd534b1-f1dc-4acc-9a60-015e4ab5fb3f"],
Cell[89702, 2106, 497, 14, 35, "Text",ExpressionUUID->"c92e8258-6dcf-4786-a8cb-c5f0c21fb209"],
Cell[90202, 2122, 992, 15, 28, "Input",ExpressionUUID->"cb67c7b5-c1da-4bef-b541-fb2285bdd545"],
Cell[91197, 2139, 362, 9, 35, "Text",ExpressionUUID->"5d06fee7-8288-4995-a07b-c8e5b1f62d2e"],
Cell[91562, 2150, 348, 8, 28, "Input",ExpressionUUID->"0ddee796-8057-439a-b51c-ee0fd7d76d7a"],
Cell[91913, 2160, 528, 9, 28, "Input",ExpressionUUID->"ad025a63-9122-40ff-8d04-0a400f390244"],
Cell[92444, 2171, 479, 12, 35, "Text",ExpressionUUID->"4f6b53f1-d27e-42b0-ab05-645ddb4b5afe"],
Cell[92926, 2185, 183, 3, 28, "Input",ExpressionUUID->"4606e522-e392-45a7-8803-50d0f398ddeb"],
Cell[93112, 2190, 268, 5, 28, "Input",ExpressionUUID->"29b34a1c-2e77-4626-b555-59b1f130e9e5"],
Cell[93383, 2197, 236, 4, 28, "Input",ExpressionUUID->"437e18f7-9d35-4d99-82be-658fd327695a"],
Cell[93622, 2203, 903, 17, 28, "Input",ExpressionUUID->"8c40eb66-376b-46ec-bb6f-e470259745ff"],
Cell[94528, 2222, 252, 5, 28, "Input",ExpressionUUID->"c7317551-a605-4f62-97f0-344631945198"],
Cell[94783, 2229, 590, 14, 28, "Input",ExpressionUUID->"26cfd6a6-9c91-448b-b663-ffda725cc042"],
Cell[95376, 2245, 351, 8, 28, "Input",ExpressionUUID->"83bea63f-c9e6-42f3-88ec-24d542eb20d8"],
Cell[95730, 2255, 715, 13, 28, "Input",ExpressionUUID->"2fb13c1e-3aaf-42a1-a6f4-79c2c3fdd91a"],
Cell[96448, 2270, 382, 9, 28, "Input",ExpressionUUID->"be4f1729-90c8-40c9-92f7-82bb163a6334"],
Cell[96833, 2281, 563, 15, 28, "Input",ExpressionUUID->"8eeec971-22f4-47e8-826f-0bf8aab554d9"],
Cell[97399, 2298, 806, 20, 48, "Input",ExpressionUUID->"6121026b-79a1-4df2-be20-8bf83e0c3230"],
Cell[98208, 2320, 501, 10, 28, "Input",ExpressionUUID->"486a25ff-7850-4e4c-affe-899100017b99"],
Cell[98712, 2332, 311, 7, 28, "Input",ExpressionUUID->"d536f59b-f8ed-4bad-a01e-9f04fbd584e4"],
Cell[99026, 2341, 389, 8, 28, "Input",ExpressionUUID->"2ee76e0b-f9ae-4757-810b-5cc0806ddff8"],
Cell[99418, 2351, 191, 3, 35, "Text",ExpressionUUID->"3cb8f53f-088c-4cd8-a821-ed895e95c717"],
Cell[99612, 2356, 448, 8, 28, "Input",ExpressionUUID->"e9276728-8459-431f-8491-c1abf6353f30"],
Cell[100063, 2366, 1068, 18, 28, "Input",ExpressionUUID->"8154d959-28bd-4c4f-b9f6-480a161896e0"],
Cell[101134, 2386, 193, 3, 28, "Input",ExpressionUUID->"4b8631fb-2742-43ec-afcf-7af045b2d79e"],
Cell[101330, 2391, 231, 4, 28, "Input",ExpressionUUID->"547acd7a-aefb-4a6e-8156-3e910e7dc16e"],
Cell[101564, 2397, 294, 6, 28, "Input",ExpressionUUID->"b504b5e8-08d0-41da-8546-5136fc155c57"],
Cell[101861, 2405, 894, 22, 67, "Input",ExpressionUUID->"6ecfd033-53e4-4968-8598-fde288134277"],
Cell[102758, 2429, 183, 3, 28, "Input",ExpressionUUID->"1f5612ab-b90c-48c5-a3c2-73869404488d"],
Cell[102944, 2434, 154, 3, 28, "Input",ExpressionUUID->"e0e99fbd-2472-41a9-af53-69445b3a4516"],
Cell[103101, 2439, 262, 5, 28, "Input",ExpressionUUID->"1045a8dd-5a5f-49ad-9c15-c3a8eb0fb2de"],
Cell[103366, 2446, 156, 3, 28, "Input",ExpressionUUID->"3aa6f3a6-3d28-486a-9ea1-33e76123924b"],
Cell[103525, 2451, 790, 15, 28, "Input",ExpressionUUID->"6e4f668d-d6e3-4ee1-9461-83f68b1c09e2"],
Cell[104318, 2468, 205, 4, 28, "Input",ExpressionUUID->"f4e7bd9a-ba22-41f1-a720-09bda7dcddb3"],
Cell[104526, 2474, 334, 8, 28, "Input",ExpressionUUID->"93ec7e53-2164-48de-87c1-8236c3c29f69"],
Cell[104863, 2484, 403, 9, 28, "Input",ExpressionUUID->"2f34e166-4fdc-4a2f-b543-b807365bbc70"],
Cell[105269, 2495, 325, 8, 28, "Input",ExpressionUUID->"c65c3788-7826-4c76-aac6-57c122e30039"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[105655, 2510, 154, 3, 98, "Title",ExpressionUUID->"3d16c9b1-a871-4d3e-8a36-7d5b44d97dbc"],
Cell[CellGroupData[{
Cell[105834, 2517, 187, 3, 67, "Section",ExpressionUUID->"ffd1bf7a-abf8-404a-9173-05f1b91a7f9b"],
Cell[106024, 2522, 353, 9, 35, "Text",ExpressionUUID->"ce79098f-deb5-4c8c-9524-8f14ef900f40"],
Cell[106380, 2533, 232, 3, 28, "Input",ExpressionUUID->"988a2715-c42e-4db6-a07c-4c2fbe617259"],
Cell[106615, 2538, 1058, 23, 83, "Input",ExpressionUUID->"4edac2ac-521b-41cf-993c-4294b8155fa0",
 InitializationCell->True],
Cell[107676, 2563, 342, 9, 35, "Text",ExpressionUUID->"e099e447-619f-451e-b8b6-6e10d7b831de"],
Cell[108021, 2574, 2050, 48, 159, "Input",ExpressionUUID->"54af700c-0dc2-48de-8cec-4107599b1e2d",
 InitializationCell->True],
Cell[110074, 2624, 371, 9, 35, "Text",ExpressionUUID->"338c32ad-3cd2-455a-b8ce-fba507abbb21"],
Cell[110448, 2635, 4436, 89, 311, "Input",ExpressionUUID->"69feff70-27d4-48ee-8f10-771fd8df581e",
 InitializationCell->True],
Cell[114887, 2726, 367, 9, 35, "Text",ExpressionUUID->"4e82ab4d-09d7-47bb-bc76-a328ff1bb7c2"],
Cell[115257, 2737, 710, 17, 121, "Input",ExpressionUUID->"3b376a89-5369-43ef-b5da-e0d9d132c594",
 InitializationCell->True],
Cell[115970, 2756, 381, 10, 35, "Text",ExpressionUUID->"cec5caee-3e5c-4ee5-99a0-ae5b06da16d3"],
Cell[116354, 2768, 715, 17, 121, "Input",ExpressionUUID->"5976d567-47c1-4f78-8369-2cda23941209",
 InitializationCell->True],
Cell[117072, 2787, 2943, 71, 197, "Input",ExpressionUUID->"553975b4-81c6-45f3-91b3-cbae6c09ed0c",
 InitializationCell->True],
Cell[120018, 2860, 472, 13, 28, "Input",ExpressionUUID->"5b8e3819-4264-4137-8cd3-3d652813c70a"],
Cell[120493, 2875, 322, 7, 28, "Input",ExpressionUUID->"df6d9be2-0bda-4919-9fba-a7974fae9c87"],
Cell[120818, 2884, 346, 7, 28, "Input",ExpressionUUID->"603c51fc-627e-4c4b-beec-faec90dc3928"],
Cell[121167, 2893, 2153, 55, 178, "Input",ExpressionUUID->"ddac07ce-b162-4dc7-90a5-a128f503e916",
 InitializationCell->True],
Cell[123323, 2950, 5213, 122, 292, "Input",ExpressionUUID->"cf7a9265-8f80-4bc8-bc4f-3f9b525fd615",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[128573, 3077, 168, 3, 67, "Section",ExpressionUUID->"27a0c25d-0412-423d-a08c-1f54c83b3ec8"],
Cell[128744, 3082, 247, 6, 35, "Text",ExpressionUUID->"19003989-fed3-4882-88bd-f081c034149f"],
Cell[128994, 3090, 432, 9, 64, "Input",ExpressionUUID->"4a29aeae-9e66-4782-b4b4-86cbbd45ad40",
 InitializationCell->True],
Cell[129429, 3101, 331, 9, 35, "Text",ExpressionUUID->"a66ea96b-4f42-4f49-9643-94324f163c79"],
Cell[129763, 3112, 250, 5, 44, "Input",ExpressionUUID->"e7be79e0-5e7b-405d-8ee8-6ee260a22e2a",
 InitializationCell->True],
Cell[130016, 3119, 467, 10, 44, "Input",ExpressionUUID->"d403d44b-5206-47c5-81dd-bf0bb670c9e2",
 InitializationCell->True],
Cell[130486, 3131, 1042, 28, 102, "Input",ExpressionUUID->"f6419de4-5784-4e6a-af92-d6faf98e3fce",
 InitializationCell->True],
Cell[131531, 3161, 1102, 30, 85, "Input",ExpressionUUID->"c0e07ac4-e4bd-47ef-b9e7-e79090dcc5d1",
 InitializationCell->True],
Cell[132636, 3193, 2702, 72, 268, "Input",ExpressionUUID->"7bc52b36-69fb-4b31-8e26-b63551f01026",
 InitializationCell->True],
Cell[135341, 3267, 713, 20, 35, "Text",ExpressionUUID->"1f89cc16-c4a7-4229-a695-7ab6d2b6e65c"],
Cell[136057, 3289, 6877, 155, 331, "Input",ExpressionUUID->"023ab5e7-0d4c-4fbd-af8f-4cae5d6da66e",
 InitializationCell->True],
Cell[142937, 3446, 14741, 328, 941, "Input",ExpressionUUID->"b78f5dd9-e99b-49e7-aeec-682b0e5b0aa1",
 InitializationCell->True],
Cell[157681, 3776, 19913, 451, 1159, "Input",ExpressionUUID->"91681008-2f71-4920-a7ed-a34b4f8d84b4",
 InitializationCell->True],
Cell[177597, 4229, 5351, 118, 265, "Input",ExpressionUUID->"a2ada6d9-9e60-4449-bcb7-fe520d688e06",
 InitializationCell->True],
Cell[182951, 4349, 545, 14, 35, "Text",ExpressionUUID->"2e9b00f3-e1bb-4480-adff-441dc7640061"],
Cell[183499, 4365, 3450, 70, 178, "Input",ExpressionUUID->"1218717e-9c97-4c2a-b990-1bbb5194081e",
 InitializationCell->True],
Cell[186952, 4437, 426, 10, 44, "Input",ExpressionUUID->"8c8255a7-c5a6-4d4b-80c0-e541e36205b9",
 InitializationCell->True],
Cell[187381, 4449, 2511, 60, 178, "Input",ExpressionUUID->"aab6802e-d85e-4de2-b99c-2f66805bd97f",
 InitializationCell->True],
Cell[189895, 4511, 3551, 85, 273, "Input",ExpressionUUID->"9792d112-4e62-4951-8199-462ef9a80a18",
 InitializationCell->True],
Cell[193449, 4598, 278, 6, 28, "Input",ExpressionUUID->"9933f7d9-7374-4ede-a8b4-bccfc1f0aa35"],
Cell[193730, 4606, 312, 6, 28, "Input",ExpressionUUID->"d3df1838-5571-48f8-a830-638492b436a3"],
Cell[194045, 4614, 198, 4, 28, "Input",ExpressionUUID->"39efd204-b024-4db0-968b-ce1e49283260"],
Cell[194246, 4620, 617, 12, 28, "Input",ExpressionUUID->"795798c0-17db-45e7-afc2-6109d7fefa86"],
Cell[194866, 4634, 3214, 80, 273, "Input",ExpressionUUID->"0b4cc546-30cd-4d1c-ac85-15242f79599c",
 InitializationCell->True],
Cell[198083, 4716, 3122, 79, 273, "Input",ExpressionUUID->"4f96b43d-8d1d-4ae6-9268-645e1bf7c0a4",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[201242, 4800, 169, 3, 67, "Section",ExpressionUUID->"c17ecf75-13ed-4806-ac22-3a48e0519ab0"],
Cell[CellGroupData[{
Cell[201436, 4807, 176, 3, 54, "Subsection",ExpressionUUID->"24ccef59-aba1-49a1-8bdc-93ac039a9f35"],
Cell[201615, 4812, 1150, 30, 140, "Input",ExpressionUUID->"0fab68e2-45f6-4fff-a16d-00a9a863cfa3",
 InitializationCell->True],
Cell[202768, 4844, 21782, 488, 991, "Input",ExpressionUUID->"d5953371-a362-4f19-a43c-668e4d135221",
 InitializationCell->True],
Cell[224553, 5334, 708, 15, 64, "Input",ExpressionUUID->"75232812-55f2-405d-b318-b39179c762e7",
 InitializationCell->True],
Cell[225264, 5351, 3001, 69, 186, "Input",ExpressionUUID->"9e6af472-9825-4797-8548-cc05962806e1",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[228302, 5425, 180, 3, 54, "Subsection",ExpressionUUID->"fe3d819f-6982-4e37-90bc-578cf35a0436"],
Cell[228485, 5430, 566, 14, 64, "Input",ExpressionUUID->"760e6e71-519b-48ed-bcfc-ef40ed51de56",
 InitializationCell->True],
Cell[229054, 5446, 7928, 181, 437, "Input",ExpressionUUID->"b8531f2d-8289-46d1-aa54-d55cfb4c1e90",
 InitializationCell->True],
Cell[236985, 5629, 156, 3, 28, "Input",ExpressionUUID->"1a2e0b96-fff3-4763-85d6-59087e104783"],
Cell[237144, 5634, 8038, 183, 437, "Input",ExpressionUUID->"71ee7b64-7b00-4554-8fdb-c2745d73ecc6",
 InitializationCell->True],
Cell[245185, 5819, 2352, 64, 140, "Input",ExpressionUUID->"1f8de27a-2d0c-447c-9db9-118e22b5211f",
 InitializationCell->True],
Cell[247540, 5885, 2012, 44, 91, "Input",ExpressionUUID->"c9493be2-53f6-460a-95d3-e5f6f7bbfa6c",
 InitializationCell->True],
Cell[249555, 5931, 8437, 224, 283, "Input",ExpressionUUID->"57ca39f7-537c-414f-8b0e-e2ac5425586d",
 InitializationCell->True],
Cell[257995, 6157, 17315, 390, 794, "Input",ExpressionUUID->"2290b599-7f53-4357-ba21-7917ad8c923a",
 InitializationCell->True],
Cell[275313, 6549, 32504, 757, 1255, "Input",ExpressionUUID->"e460a8a0-48fe-44f9-a973-4114d7ac7eb1",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[307854, 7311, 174, 3, 54, "Subsection",ExpressionUUID->"fb509134-cfdf-43f6-8d25-75a0e3fd4214"],
Cell[308031, 7316, 15648, 381, 1147, "Input",ExpressionUUID->"6049fdc6-c756-4bb7-9651-74757786aebe",
 InitializationCell->True],
Cell[323682, 7699, 4387, 99, 292, "Input",ExpressionUUID->"ed41a946-cb9f-4b88-90e9-009ed53d0ccc",
 InitializationCell->True],
Cell[328072, 7800, 4734, 104, 311, "Input",ExpressionUUID->"3136cdc3-d1e3-4b0a-bd99-4d97f87ccd28",
 InitializationCell->True],
Cell[332809, 7906, 6130, 135, 368, "Input",ExpressionUUID->"3a2c8054-9fd6-4757-955e-2d3c089166e9",
 InitializationCell->True],
Cell[338942, 8043, 8147, 192, 510, "Input",ExpressionUUID->"6753d486-b59a-4164-9585-f2b59599ff6e",
 InitializationCell->True],
Cell[347092, 8237, 8196, 194, 542, "Input",ExpressionUUID->"8445807b-69bc-4fcd-ae3b-c99ad99db46f",
 InitializationCell->True],
Cell[355291, 8433, 128, 3, 28, "Input",ExpressionUUID->"447cc4ae-02ff-40ee-b8e4-daaa5c2354fe"],
Cell[355422, 8438, 7595, 181, 542, "Input",ExpressionUUID->"0f89bd3d-4d6b-454e-9047-92636868f96b",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[363054, 8624, 171, 3, 54, "Subsection",ExpressionUUID->"8aec3de4-4265-456e-a44a-9694e3a5be6b"],
Cell[363228, 8629, 1019, 25, 83, "Input",ExpressionUUID->"6bde7676-0283-41dc-bdbc-d37b180d2c26",
 InitializationCell->True],
Cell[364250, 8656, 870, 22, 83, "Input",ExpressionUUID->"d72fdb1f-f8c5-45b2-9d72-5335887e8f1c",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[365169, 8684, 173, 3, 67, "Section",ExpressionUUID->"231f76a5-4215-4379-86f2-b236affed8f5"],
Cell[CellGroupData[{
Cell[365367, 8691, 222, 4, 54, "Subsection",ExpressionUUID->"f3bfdaa4-f6ea-4b9c-8767-6360022d1948"],
Cell[365592, 8697, 544, 13, 35, "Text",ExpressionUUID->"dbf594ef-369f-483e-968c-0c9b0c94e717"],
Cell[366139, 8712, 1182, 30, 67, "Input",ExpressionUUID->"023288c2-200c-45c4-86b9-f900cbe225d4",
 InitializationCell->True],
Cell[367324, 8744, 2645, 71, 104, "Text",ExpressionUUID->"993dc8d4-2594-43c0-ba1d-da4c5ef1aa8b"],
Cell[369972, 8817, 3143, 76, 311, "Input",ExpressionUUID->"b84cac42-2021-4a21-8816-6b5267723c1e",
 InitializationCell->True],
Cell[373118, 8895, 10967, 275, 616, "Input",ExpressionUUID->"badea568-5f37-4e99-94e9-77ed2ab7ff15",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[384122, 9175, 172, 3, 38, "Subsection",ExpressionUUID->"ab89dca9-81a3-435e-aec2-a17614f7ea33"],
Cell[384297, 9180, 53321, 1277, 2506, "Input",ExpressionUUID->"d5ab4c83-0f36-4bb2-abb1-21dd15fc0862",
 InitializationCell->True],
Cell[437621, 10459, 9178, 205, 1053, "Input",ExpressionUUID->"312f349b-9aac-4a26-8862-20ab253a54cf",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[446824, 10668, 173, 3, 45, "Subsubsection",ExpressionUUID->"6529f40d-80ba-412e-9029-03af047fb1be"],
Cell[447000, 10673, 45244, 953, 3504, "Input",ExpressionUUID->"0d72d1ee-ab7e-4c3c-bf2b-2d2b7919d999"],
Cell[492247, 11628, 3292, 87, 209, "Input",ExpressionUUID->"7661b55a-5820-427f-bd8c-64b96d5d1489"],
Cell[495542, 11717, 4464, 114, 269, "Input",ExpressionUUID->"56c1e191-22ae-457d-929c-710450f3b66f"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[500055, 11837, 175, 3, 54, "Subsection",ExpressionUUID->"a3be89cb-2d2d-44e3-bff3-58dbb90b9e0e"],
Cell[500233, 11842, 14231, 340, 1164, "Input",ExpressionUUID->"e12b2917-8cba-46a9-bc62-d38a6629ff34",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[514489, 12186, 173, 3, 45, "Subsubsection",ExpressionUUID->"130f8670-13bb-463d-95ed-4f197976c137"],
Cell[514665, 12191, 19874, 408, 1829, "Input",ExpressionUUID->"390bf43d-3cbc-45d1-8e28-f8737dedf312"],
Cell[534542, 12601, 3632, 96, 249, "Input",ExpressionUUID->"2c7f46fa-d826-43b3-8e00-26d3d0a66670"],
Cell[538177, 12699, 5185, 132, 329, "Input",ExpressionUUID->"7083aa98-d094-4228-ba99-97a52e3e7864"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[543411, 12837, 174, 3, 54, "Subsection",ExpressionUUID->"1bf374c5-addc-41b6-a36a-4ca67fcd00f5"],
Cell[543588, 12842, 790, 21, 64, "Input",ExpressionUUID->"882c104f-19ea-4ad3-ae5a-4cbd1ed1df39",
 InitializationCell->True],
Cell[544381, 12865, 12310, 253, 787, "Input",ExpressionUUID->"1d0acf7f-a632-4360-9e1c-a7b6a7587a9e",
 InitializationCell->True],
Cell[556694, 13120, 777, 22, 64, "Input",ExpressionUUID->"daec7dd3-6be3-4503-968c-e512eec6b583",
 InitializationCell->True],
Cell[557474, 13144, 1065, 29, 64, "Input",ExpressionUUID->"0446d980-9f59-4ea6-8253-b4179649dd59",
 InitializationCell->True],
Cell[558542, 13175, 2862, 72, 178, "Input",ExpressionUUID->"298444c5-2314-4de3-9755-e13a13084d25",
 InitializationCell->True],
Cell[561407, 13249, 11162, 224, 692, "Input",ExpressionUUID->"ec619336-1d38-4559-aa46-e6db060223d6",
 InitializationCell->True],
Cell[572572, 13475, 6973, 151, 520, "Input",ExpressionUUID->"4a9c0907-e7b2-4818-8a19-0484853c585f",
 InitializationCell->True],
Cell[579548, 13628, 9189, 215, 752, "Input",ExpressionUUID->"c57267fa-f9b9-41ea-9305-82240b815220"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[588786, 13849, 153, 3, 53, "Section",ExpressionUUID->"8920c554-ed25-4076-8d68-a9b83526b532"],
Cell[588942, 13854, 191, 3, 28, "Input",ExpressionUUID->"00e0c70d-67e4-433e-9df2-c052178444f2"],
Cell[CellGroupData[{
Cell[589158, 13861, 207, 4, 53, "Subsection",ExpressionUUID->"c05b1918-5b5c-4982-88e7-cdf43776b597"],
Cell[CellGroupData[{
Cell[589390, 13869, 296, 5, 44, "Subsubsection",ExpressionUUID->"335a2716-9c41-4d66-b36f-0672f5c68c21"],
Cell[589689, 13876, 6360, 115, 237, "Input",ExpressionUUID->"3bd9be92-f349-4fa9-8d9e-3331fcb9903e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[596086, 13996, 248, 4, 44, "Subsubsection",ExpressionUUID->"a5d1f054-a064-4bce-944c-4029a9c42fcf"],
Cell[596337, 14002, 6384, 116, 237, "Input",ExpressionUUID->"d43bf8f7-ac33-4061-aa30-272c6f3069f2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[602758, 14123, 296, 5, 44, "Subsubsection",ExpressionUUID->"7b4c802a-78f7-4166-97f7-d0341bbbeb33"],
Cell[603057, 14130, 6436, 118, 292, "Input",ExpressionUUID->"adf5ada1-5810-45df-a2aa-626e7400b849"]
}, Closed]],
Cell[CellGroupData[{
Cell[609530, 14253, 486, 11, 36, "Subsubsection",ExpressionUUID->"24109c74-cbe7-42c1-8d35-53d2a5b88e73"],
Cell[610019, 14266, 6738, 125, 272, "Input",ExpressionUUID->"c14df63e-2056-4b7c-a8f3-d6f0ccf4b74d"]
}, Closed]],
Cell[CellGroupData[{
Cell[616794, 14396, 183, 3, 36, "Subsubsection",ExpressionUUID->"3b1ff988-cfcc-4872-ae1e-b5db07f51e99"],
Cell[616980, 14401, 6317, 115, 237, "Input",ExpressionUUID->"4488574f-6738-48bb-8cba-4d303f049927"]
}, Closed]],
Cell[CellGroupData[{
Cell[623334, 14521, 165, 3, 36, "Subsubsection",ExpressionUUID->"b00f8e0a-bb43-4900-b1a8-ae0fd9d1dfb7"],
Cell[623502, 14526, 6320, 115, 292, "Input",ExpressionUUID->"ec47fa7c-24ff-4af3-b91e-57584e33945c"]
}, Closed]],
Cell[CellGroupData[{
Cell[629859, 14646, 216, 4, 36, "Subsubsection",ExpressionUUID->"db83e2c5-108d-46f9-a790-08e63378d03a"],
Cell[630078, 14652, 6492, 119, 292, "Input",ExpressionUUID->"7907bf69-7725-4027-b3ee-c289f813b256"]
}, Closed]],
Cell[CellGroupData[{
Cell[636607, 14776, 239, 4, 36, "Subsubsection",ExpressionUUID->"976bac13-2866-4b61-b818-2903608478be"],
Cell[636849, 14782, 6395, 116, 237, "Input",ExpressionUUID->"c1f9ce1e-8483-45cc-856d-db66b703cd87"]
}, Closed]],
Cell[CellGroupData[{
Cell[643281, 14903, 219, 4, 36, "Subsubsection",ExpressionUUID->"e827d3ff-5b0a-4f53-a77b-2f3d82663285"],
Cell[643503, 14909, 6384, 117, 292, "Input",ExpressionUUID->"e576f237-4163-40dc-9115-0e9f4a4e621a"]
}, Closed]],
Cell[CellGroupData[{
Cell[649924, 15031, 267, 4, 36, "Subsubsection",ExpressionUUID->"d8e9a12e-1780-4072-8b61-2ecffa18b771"],
Cell[650194, 15037, 6645, 121, 237, "Input",ExpressionUUID->"9a72dfe8-9dad-4419-bd39-9e7bc83fd6e0"]
}, Closed]],
Cell[CellGroupData[{
Cell[656876, 15163, 227, 4, 36, "Subsubsection",ExpressionUUID->"952b9704-d578-44fa-9abf-caf74fb7d18d"],
Cell[657106, 15169, 5674, 119, 292, "Input",ExpressionUUID->"8dc5b65e-c97f-42c0-a074-8a781ee04e12"]
}, Closed]],
Cell[CellGroupData[{
Cell[662817, 15293, 277, 4, 36, "Subsubsection",ExpressionUUID->"03dbb3fd-6645-431f-a170-72e50efe8ede"],
Cell[663097, 15299, 5861, 123, 256, "Input",ExpressionUUID->"529a0369-dae8-44c3-892f-f93ac82e60e8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[668995, 15427, 230, 4, 44, "Subsubsection",ExpressionUUID->"214163e9-6366-468d-b0bc-900fdc70a717"],
Cell[669228, 15433, 4936, 102, 237, "Input",ExpressionUUID->"0b4a9c46-d387-4cdf-9b40-198d3fe8f059"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[674213, 15541, 158, 3, 53, "Subsection",ExpressionUUID->"f33597ea-6836-45b6-a9ce-54e797df637f"],
Cell[CellGroupData[{
Cell[674396, 15548, 183, 3, 44, "Subsubsection",ExpressionUUID->"f034d747-518f-46df-947b-ee3c84a01ba1"],
Cell[674582, 15553, 6233, 114, 285, "Input",ExpressionUUID->"e13c66de-b624-4c94-8d02-6988d59996e1"],
Cell[680818, 15669, 552, 13, 48, "Input",ExpressionUUID->"6dcbffc1-1c1f-484d-a5db-9f00353b4f8d"]
}, Closed]],
Cell[CellGroupData[{
Cell[681407, 15687, 165, 3, 36, "Subsubsection",ExpressionUUID->"e03fc387-e29b-46f0-a2f0-612ee9e0cec5"],
Cell[681575, 15692, 6271, 115, 237, "Input",ExpressionUUID->"16e55ca7-960f-4e96-8d60-22716e0661e3"],
Cell[687849, 15809, 558, 13, 48, "Input",ExpressionUUID->"42463eef-18b2-4223-a35c-78154bf4746f"]
}, Closed]],
Cell[CellGroupData[{
Cell[688444, 15827, 216, 4, 36, "Subsubsection",ExpressionUUID->"12c73537-8aee-432c-b275-b35edb83e0e7"],
Cell[688663, 15833, 6357, 117, 292, "Input",ExpressionUUID->"31fa8f6c-e700-4526-8060-2f08a88a7d7e"],
Cell[695023, 15952, 617, 15, 48, "Input",ExpressionUUID->"8eb3aa1c-23a0-4c81-8b3c-112314055cf8"]
}, Closed]],
Cell[CellGroupData[{
Cell[695677, 15972, 241, 4, 36, "Subsubsection",ExpressionUUID->"074aedb4-e3b6-49d8-8a40-934a232b65a1"],
Cell[695921, 15978, 6315, 116, 292, "Input",ExpressionUUID->"18e41ec5-5495-416d-bc2a-c8f28fb2ef3d"],
Cell[702239, 16096, 570, 14, 48, "Input",ExpressionUUID->"97dfa079-c1fa-4a9e-88ec-08ac6ae20213"]
}, Closed]],
Cell[CellGroupData[{
Cell[702846, 16115, 224, 4, 36, "Subsubsection",ExpressionUUID->"96346a76-a1f1-4eca-9a44-5ad352290df0"],
Cell[703073, 16121, 6320, 116, 237, "Input",ExpressionUUID->"5a605a2f-10d2-437c-b9e7-4023805f737f"],
Cell[709396, 16239, 577, 14, 48, "Input",ExpressionUUID->"bca7e7b9-b64d-4dcb-981a-c889d2341e77"]
}, Closed]],
Cell[CellGroupData[{
Cell[710010, 16258, 269, 4, 36, "Subsubsection",ExpressionUUID->"fb05f996-4825-487e-8af0-f94c86ca1e6d"],
Cell[710282, 16264, 6445, 118, 292, "Input",ExpressionUUID->"8304bba9-7723-436d-88ba-4b0051cf02fe"],
Cell[716730, 16384, 575, 14, 48, "Input",ExpressionUUID->"14565724-d23c-4655-8175-9b14ebd2503a"]
}, Closed]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[717366, 16405, 153, 3, 53, "Section",ExpressionUUID->"7ccb1fc2-aab4-430f-8d2e-545b92e70893"],
Cell[717522, 16410, 421, 8, 28, "Input",ExpressionUUID->"640968f1-983c-4ea7-86f1-398b9cba4514"],
Cell[717946, 16420, 298, 7, 28, "Input",ExpressionUUID->"2271201f-a084-43e1-8afe-f5cbb2f54f59"],
Cell[718247, 16429, 803, 13, 28, "Input",ExpressionUUID->"4788e3c7-2593-4d5b-a266-cef5c97dff82"],
Cell[719053, 16444, 275, 6, 28, "Input",ExpressionUUID->"3972e71a-3687-4117-be0d-b67a4c7a25b9"],
Cell[719331, 16452, 249, 5, 28, "Input",ExpressionUUID->"01300ae0-d92a-4aad-a207-f48b887344be"],
Cell[719583, 16459, 298, 7, 28, "Input",ExpressionUUID->"79185e69-4683-4fd4-bd4b-29682990475c"],
Cell[719884, 16468, 560, 10, 28, "Input",ExpressionUUID->"946cdb9e-4bb0-487c-81a6-49549b0275d8"],
Cell[720447, 16480, 149, 3, 48, "Input",ExpressionUUID->"2a33fd7e-39d2-466e-b588-b506c0a1ed70"],
Cell[720599, 16485, 780, 18, 48, "Input",ExpressionUUID->"8e944b0e-851e-44cb-8a84-e0e4330849a6"],
Cell[721382, 16505, 961, 19, 48, "Input",ExpressionUUID->"aac67fc9-65f6-458e-a6ec-98c5cf3b8370"],
Cell[722346, 16526, 698, 14, 48, "Input",ExpressionUUID->"f1243898-bf2d-417d-8295-18ccbff6e298"],
Cell[723047, 16542, 580, 14, 48, "Input",ExpressionUUID->"69480092-e1cc-4995-8b66-c854b2296608"],
Cell[723630, 16558, 193, 3, 28, "Input",ExpressionUUID->"2f7cdcef-2485-4eb3-902b-c037da458606"],
Cell[723826, 16563, 183, 2, 28, "Input",ExpressionUUID->"ab83f3e9-8c14-4403-aa05-44ff3ef2735b"],
Cell[724012, 16567, 242, 5, 28, "Input",ExpressionUUID->"965239c9-4e15-4c53-9669-b7e8f8874bd7"],
Cell[724257, 16574, 210, 4, 28, "Input",ExpressionUUID->"2c89a90a-66c1-4753-bf25-eb830ef2b2aa"],
Cell[724470, 16580, 208, 3, 28, "Input",ExpressionUUID->"62d9bb0c-c23b-4ebb-bf9f-780cc8f08d32"],
Cell[724681, 16585, 367, 7, 28, "Input",ExpressionUUID->"17c95609-6809-427b-86e3-5601f556a861"],
Cell[725051, 16594, 138, 2, 28, "Input",ExpressionUUID->"1ac4c668-3f3e-40f1-a85c-6228fa86926b"],
Cell[725192, 16598, 286, 6, 28, "Input",ExpressionUUID->"af5b5491-4c81-43a2-a83b-9e9983de40af"],
Cell[725481, 16606, 211, 4, 28, "Input",ExpressionUUID->"3326df16-dd7d-4d3a-8dcc-e637f07ac632"],
Cell[725695, 16612, 181, 3, 28, "Input",ExpressionUUID->"c1f6285b-9eb8-4f4b-9d85-c9f39e1de0b9"],
Cell[725879, 16617, 720, 17, 48, "Input",ExpressionUUID->"b460a770-6feb-43d5-91a5-82e164e98777"],
Cell[726602, 16636, 1029, 20, 48, "Input",ExpressionUUID->"e4bfbe7d-6977-4f85-8b46-da0dfbb4bf31"],
Cell[727634, 16658, 181, 3, 28, "Input",ExpressionUUID->"386d5a4d-e767-4805-8e3c-953b1c5938e1"],
Cell[727818, 16663, 2187, 48, 142, "Input",ExpressionUUID->"14b031bd-6473-49bf-a6db-fe85b6303729"],
Cell[730008, 16713, 179, 3, 28, "Input",ExpressionUUID->"c4f0be77-53f4-439e-8651-cf89f26c2954"],
Cell[730190, 16718, 721, 16, 48, "Input",ExpressionUUID->"a4423218-088c-4527-94e1-e334cb9f8307"],
Cell[730914, 16736, 714, 16, 48, "Input",ExpressionUUID->"2181699b-7a61-4e8a-bbdf-48439f15fedc"],
Cell[731631, 16754, 463, 10, 28, "Input",ExpressionUUID->"f5f03c24-8fe6-4bae-b957-330df92137b5"],
Cell[732097, 16766, 212, 4, 28, "Input",ExpressionUUID->"04efd389-2f64-4d45-bd17-93990407d686"],
Cell[732312, 16772, 295, 6, 28, "Input",ExpressionUUID->"619b45f7-db30-4151-949c-9d9d5146157d"],
Cell[732610, 16780, 300, 6, 28, "Input",ExpressionUUID->"30c0d785-5f0d-4ac0-80cc-2550b2c635de"],
Cell[732913, 16788, 612, 13, 28, "Input",ExpressionUUID->"3b2a5045-1d7e-49d4-8171-93dfd81ddae1"],
Cell[733528, 16803, 989, 18, 28, "Input",ExpressionUUID->"5fa9b4a7-ffb8-47b5-a273-b382d79a1fa4"],
Cell[734520, 16823, 238, 5, 28, "Input",ExpressionUUID->"950daf5f-53a9-45b2-abe3-002b5b4ad26b"],
Cell[734761, 16830, 722, 18, 48, "Input",ExpressionUUID->"a6a7ac2e-31df-40ea-a330-b5fa2b589d8f"],
Cell[735486, 16850, 416, 11, 28, "Input",ExpressionUUID->"11f326ae-297e-4ea3-9bb9-f25832803377"]
}, Closed]]
}, Open  ]]
}
]
*)

